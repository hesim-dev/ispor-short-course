<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="learnCEA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-model-hesim.html">Simple Markov Cohort Model (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-07-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">expm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">hesim</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">data.table</span>)

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</pre></body></html></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">initial</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>),<span class="kw">nrow</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<p>Set duration of follow-up</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">follow_up</span> <span class="kw">&lt;-</span> <span class="fl">20</span></pre></body></html></div>
<p>Set discount rates</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">discount_LY</span> <span class="kw">&lt;-</span> <span class="fl">0.00</span>
<span class="no">discount_cost</span> <span class="kw">&lt;-</span> <span class="fl">0.06</span></pre></body></html></div>
<p>Number of PSA simulations</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">PSA_samples</span>  <span class="kw">&lt;-</span> <span class="fl">1000</span></pre></body></html></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package). See Appendix for more detail.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">transitions_mono</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1251</span>, <span class="fl">350</span>, <span class="fl">116</span>, <span class="fl">17</span>,
                             <span class="fl">0</span>, <span class="fl">731</span>, <span class="fl">512</span>, <span class="fl">15</span>,
                             <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1312</span>, <span class="fl">437</span>,
                             <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">469</span>),
                             <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">p_mono</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="no">PSA_samples</span>,<span class="no">transitions_mono</span>)</pre></body></html></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">p_mono</span>[, , <span class="fl">1</span>:<span class="fl">10</span>])</pre></body></html></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7198093 0.1984702 0.07105167 0.01066883
## [2,] 0.0000000 0.5687482 0.41643874 0.01481311
## [3,] 0.0000000 0.0000000 0.76279817 0.23720183
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 2
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.740474 0.1786508 0.07204981 0.008825461
## [2,] 0.000000 0.5618034 0.42336019 0.014836383
## [3,] 0.000000 0.0000000 0.73776156 0.262238436
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##          [,1]      [,2]      [,3]       [,4]
## [1,] 0.729239 0.1988398 0.0622381 0.00968311
## [2,] 0.000000 0.5666196 0.4179042 0.01547620
## [3,] 0.000000 0.0000000 0.7619564 0.23804362
## [4,] 0.000000 0.0000000 0.0000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7219703 0.2041789 0.06790716 0.005943677
## [2,] 0.0000000 0.5779670 0.40991363 0.012119344
## [3,] 0.0000000 0.0000000 0.74939509 0.250604912
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7095246 0.2140451 0.06816612 0.008264213
## [2,] 0.0000000 0.5827809 0.40786611 0.009353042
## [3,] 0.0000000 0.0000000 0.75237405 0.247625953
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]      [,3]       [,4]
## [1,] 0.7227076 0.1924681 0.0746206 0.01020371
## [2,] 0.0000000 0.5948396 0.3940906 0.01106978
## [3,] 0.0000000 0.0000000 0.7337880 0.26621198
## [4,] 0.0000000 0.0000000 0.0000000 1.00000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7252841 0.1913340 0.07401563 0.009366208
## [2,] 0.0000000 0.5623616 0.42068966 0.016948723
## [3,] 0.0000000 0.0000000 0.74547979 0.254520206
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7399754 0.1915951 0.06193743 0.006491973
## [2,] 0.0000000 0.5847929 0.40213513 0.013071966
## [3,] 0.0000000 0.0000000 0.73668760 0.263312402
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7105726 0.2111283 0.06936366 0.008935421
## [2,] 0.0000000 0.5922550 0.39716494 0.010580093
## [3,] 0.0000000 0.0000000 0.76348373 0.236516275
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7193898 0.2050885 0.06235855 0.01316317
## [2,] 0.0000000 0.6169066 0.37237895 0.01071447
## [3,] 0.0000000 0.0000000 0.74779850 0.25220150
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to a normal distribution of log-transformed relative risk</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">RR</span><span class="kw">&lt;-</span><span class="fl">0.509</span>
<span class="no">RR_low</span><span class="kw">&lt;-</span><span class="fl">0.365</span>
<span class="no">RR_high</span><span class="kw">&lt;-</span><span class="fl">0.710</span>

<span class="no">RR_combi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">PSA_samples</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">RR</span>), (<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">RR_high</span>)-<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">RR_low</span>))/<span class="fl">3.92</span> )   )</pre></body></html></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">RR_combi</span>[<span class="fl">1</span>:<span class="fl">10</span>]</pre></body></html></div>
<pre><code>##  [1] 0.3668203 0.4842062 0.5328439 0.5388386 0.4383977 0.3442814 0.4276820
##  [8] 0.5523177 0.6656419 0.4663607</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">p_combi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>, <span class="kw">dim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4</span>, <span class="no">PSA_samples</span>))</pre></body></html></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">PSA_samples</span>){
<span class="no">p_combi</span>[,,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="fl">1</span>-<span class="no">p_mono</span>[<span class="fl">1</span>,<span class="fl">2</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>]-<span class="no">p_mono</span>[<span class="fl">1</span>,<span class="fl">3</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>]-<span class="no">p_mono</span>[<span class="fl">1</span>,<span class="fl">4</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>]), <span class="no">p_mono</span>[<span class="fl">1</span>,<span class="fl">2</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>], <span class="no">p_mono</span>[<span class="fl">1</span>,<span class="fl">3</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>], <span class="no">p_mono</span>[<span class="fl">1</span>,<span class="fl">4</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>],
                                      <span class="fl">0</span>, (<span class="fl">1</span>-<span class="no">p_mono</span>[<span class="fl">2</span>,<span class="fl">3</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>]-<span class="no">p_mono</span>[<span class="fl">2</span>,<span class="fl">4</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>]), <span class="no">p_mono</span>[<span class="fl">2</span>,<span class="fl">3</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>], <span class="no">p_mono</span>[<span class="fl">2</span>,<span class="fl">4</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>],
                                      <span class="fl">0</span>, <span class="fl">0</span>, (<span class="fl">1</span>-<span class="no">p_mono</span>[<span class="fl">3</span>,<span class="fl">4</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>]), <span class="no">p_mono</span>[<span class="fl">3</span>,<span class="fl">4</span>,<span class="no">i</span>]*<span class="no">RR_combi</span>[<span class="no">i</span>],
                                      <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
                                      <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
}</pre></body></html></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">p_combi</span>[, , <span class="fl">1</span>:<span class="fl">10</span>])</pre></body></html></div>
<pre><code>## , , 1
## 
##           [,1]       [,2]      [,3]        [,4]
## [1,] 0.8972204 0.07280291 0.0260632 0.003913543
## [2,] 0.0000000 0.84180807 0.1527582 0.005433750
## [3,] 0.0000000 0.00000000 0.9129896 0.087010445
## [4,] 0.0000000 0.00000000 0.0000000 1.000000000
## 
## , , 2
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8743359 0.08650381 0.03488697 0.004273343
## [2,] 0.0000000 0.78782249 0.20499364 0.007183869
## [3,] 0.0000000 0.00000000 0.87302252 0.126977483
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8557267 0.1059506 0.03316319 0.005159586
## [2,] 0.0000000 0.7690759 0.22267770 0.008246399
## [3,] 0.0000000 0.0000000 0.87315990 0.126840095
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8501869 0.1100194 0.03659099 0.003202683
## [2,] 0.0000000 0.7725924 0.22087728 0.006530370
## [3,] 0.0000000 0.0000000 0.86496441 0.135035594
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8726562 0.09383687 0.02988387 0.003623012
## [2,] 0.0000000 0.81709207 0.17880758 0.004100353
## [3,] 0.0000000 0.00000000 0.89144134 0.108558656
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.9045334 0.06626319 0.02569048 0.003512949
## [2,] 0.0000000 0.86051082 0.13567806 0.003811120
## [3,] 0.0000000 0.00000000 0.90834817 0.091651833
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 7
## 
##          [,1]       [,2]       [,3]        [,4]
## [1,] 0.882509 0.08183011 0.03165515 0.004005758
## [2,] 0.000000 0.81282996 0.17992138 0.007248663
## [3,] 0.000000 0.00000000 0.89114630 0.108853702
## [4,] 0.000000 0.00000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8563838 0.1058214 0.03420914 0.003585632
## [2,] 0.0000000 0.7706738 0.22210637 0.007219879
## [3,] 0.0000000 0.0000000 0.85456789 0.145432109
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.807345 0.1405358 0.04617136 0.005947791
## [2,] 0.000000 0.7285878 0.26436962 0.007042553
## [3,] 0.000000 0.0000000 0.84256486 0.157435142
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8691344 0.09564521 0.02908158 0.006138783
## [2,] 0.0000000 0.82134030 0.17366289 0.004996810
## [3,] 0.0000000 0.00000000 0.88238314 0.117616859
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="co"># define LY by health state per cycle</span>
<span class="no">LY</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>),<span class="kw">nrow</span><span class="kw">=</span><span class="fl">1</span>)

<span class="co"># define costs by health state per cycle</span>
<span class="no">drug_cost_mono</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2278</span>, <span class="fl">2278</span>, <span class="fl">2278</span>, <span class="fl">0</span>),<span class="kw">nrow</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">drug_cost_combi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2278</span>+<span class="fl">2087</span>, <span class="fl">2278</span>+<span class="fl">2087</span>, <span class="fl">2278</span>+<span class="fl">2087</span>, <span class="fl">0</span>),<span class="kw">nrow</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">other_cost</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2756</span>, <span class="fl">3052</span>, <span class="fl">9007</span>, <span class="fl">0</span>),<span class="kw">nrow</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define an array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">trace_mono</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>, <span class="kw">dim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">follow_up</span>, <span class="fl">6</span>, <span class="no">PSA_samples</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">trace_mono</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</pre></body></html></div>
<p>Define a matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">Expected_LY_mono</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>, <span class="no">PSA_samples</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="no">PSA_samples</span>)
<span class="no">Expected_total_cost_mono</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>, <span class="no">PSA_samples</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="no">PSA_samples</span>)</pre></body></html></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">PSA_samples</span>){
<span class="kw">for</span>(<span class="no">t</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">follow_up</span>){
<span class="no">trace_mono</span>[<span class="no">t</span>,<span class="fl">1</span>:<span class="fl">4</span>,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">initial</span> <span class="kw">%*%</span> (<span class="no">p_mono</span>[,,<span class="no">i</span>] <span class="kw">%^%</span><span class="no">t</span>)
<span class="no">trace_mono</span>[<span class="no">t</span>,<span class="fl">5</span>,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  <span class="no">trace_mono</span>[<span class="no">t</span>,<span class="fl">1</span>:<span class="fl">4</span>,<span class="no">i</span>] * <span class="no">LY</span> * <span class="fl">1</span>/(<span class="fl">1</span>+<span class="no">discount_LY</span>)^<span class="no">t</span>  )
<span class="no">trace_mono</span>[<span class="no">t</span>,<span class="fl">6</span>,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  <span class="no">trace_mono</span>[<span class="no">t</span>,<span class="fl">1</span>:<span class="fl">4</span>,<span class="no">i</span>] * (<span class="no">drug_cost_mono</span> + <span class="no">other_cost</span>) * <span class="fl">1</span>/(<span class="fl">1</span>+<span class="no">discount_cost</span>)^<span class="no">t</span>  )
}
<span class="no">Expected_LY_mono</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">trace_mono</span>[,<span class="fl">5</span>,<span class="no">i</span>])
<span class="no">Expected_total_cost_mono</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">trace_mono</span>[,<span class="fl">6</span>,<span class="no">i</span>])
}</pre></body></html></div>
<p>Presentation of results for the first 10 PSA samples</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">trace_mono</span>[,,<span class="fl">1</span>:<span class="fl">10</span>]</pre></body></html></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.719809280 0.198470218 0.07105167 0.01066883 0.98933117 5172.8154
##  [2,] 0.518125399 0.255740275 0.18799243 0.03814190 0.96185810 5422.6001
##  [3,] 0.372951470 0.248284269 0.28671411 0.09205015 0.90794985 5404.0933
##  [4,] 0.268453929 0.215230979 0.34859901 0.16771608 0.83228392 5095.1568
##  [5,] 0.193235629 0.175692331 0.37461531 0.25645673 0.74354327 4585.7157
##  [6,] 0.139092799 0.138276206 0.37265068 0.34998031 0.65001969 3977.7880
##  [7,] 0.100120288 0.106250115 0.35172360 0.44190599 0.55809401 3351.5683
##  [8,] 0.072067512 0.080300452 0.31965450 0.52797754 0.47202246 2759.4163
##  [9,] 0.051874864 0.059973988 0.28239260 0.60575854 0.39424146 2230.0366
## [10,] 0.037340008 0.044405711 0.24406985 0.67418443 0.32581557 1775.1260
## [11,] 0.026877685 0.032666545 0.20732136 0.73313441 0.26686559 1395.4794
## [12,] 0.019346807 0.023913457 0.17365768 0.78308206 0.21691794 1085.6681
## [13,] 0.013926011 0.017440500 0.14379887 0.82483462 0.17516538  837.2676
## [14,] 0.010024072 0.012683150 0.11794188 0.85935089 0.14064911  640.9103
## [15,] 0.007215420 0.009202998 0.09595984 0.88762175 0.11237825  487.4829
## [16,] 0.005193726 0.006666234 0.07754314 0.91059690 0.08940310  368.7484
## [17,] 0.003738492 0.004822208 0.06229487 0.92914443 0.07085557  277.6021
## [18,] 0.002691002 0.003484601 0.04979219 0.94403221 0.05596779  208.1127
## [19,] 0.001937008 0.002515944 0.03962372 0.95592333 0.04407667  155.4451
## [20,] 0.001394276 0.001815377 0.03141026 0.96538008 0.03461992  115.7293
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.740473978 0.178650752 0.07204981 0.008825461 0.99117454 5181.9213
##  [2,] 0.548301713 0.232652837 0.18214020 0.036905246 0.96309475 5389.5004
##  [3,] 0.406003151 0.228659673 0.27237703 0.092960150 0.90703985 5320.1222
##  [4,] 0.300634768 0.200994555 0.32700715 0.171363523 0.82863648 4970.3657
##  [5,] 0.222612223 0.166628057 0.34800708 0.262752640 0.73724736 4435.7375
##  [6,] 0.164838558 0.133382054 0.34332910 0.358450286 0.64154971 3817.4971
##  [7,] 0.122058663 0.104383027 0.32164025 0.451918056 0.54808194 3192.6167
##  [8,] 0.090381264 0.080448614 0.29027974 0.538890384 0.46110962 2609.7702
##  [9,] 0.066924974 0.061342987 0.25472793 0.617004111 0.38299589 2094.4109
## [10,] 0.049556202 0.046418897 0.21872058 0.685304316 0.31469568 1655.7189
## [11,] 0.036695078 0.034931548 0.18458607 0.743787305 0.25621269 1292.7165
## [12,] 0.027171750 0.026180267 0.15361301 0.793034976 0.20696502  998.8320
## [13,] 0.020119974 0.019562417 0.12637117 0.833946434 0.16605357  764.9813
## [14,] 0.014898317 0.014584681 0.10296338 0.867553617 0.13244638  581.4826
## [15,] 0.011031816 0.010855319 0.08321042 0.894902442 0.10509756  439.1392
## [16,] 0.008168773 0.008069398 0.06678000 0.916981828 0.08301817  329.7747
## [17,] 0.006048764 0.005992773 0.05327254 0.934685925 0.06531408  246.4269
## [18,] 0.004478952 0.004447376 0.04227535 0.948798326 0.05120167  183.3450
## [19,] 0.003316548 0.003298719 0.03339467 0.959990058 0.04000994  135.8860
## [20,] 0.002455817 0.002445736 0.02627281 0.968825637 0.03117436  100.3659
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.729239001 0.198839789 0.06223810 0.00968311 0.99031689 5125.6247
##  [2,] 0.531789521 0.257668254 0.17590515 0.03463708 0.96536292 5371.5645
##  [3,] 0.387801659 0.251740803 0.27481026 0.08564728 0.91435272 5369.5381
##  [4,] 0.282800095 0.219751677 0.33873300 0.15871523 0.84128477 5083.2564
##  [5,] 0.206228859 0.180747522 0.36753586 0.24548776 0.75451224 4595.0269
##  [6,] 0.150390127 0.143421595 0.36841673 0.33777155 0.66222845 4003.5300
##  [7,] 0.109670346 0.111169030 0.35001395 0.42914667 0.57085333 3388.1461
##  [8,] 0.079975893 0.084797382 0.31997904 0.51524768 0.48475232 2801.7301
##  [9,] 0.058321541 0.063950250 0.28422480 0.59350341 0.40649659 2274.0279
## [10,] 0.042530342 0.047832109 0.24692180 0.66271575 0.33728425 1817.8851
## [11,] 0.031014784 0.035559335 0.21077988 0.72264600 0.27735400 1435.1329
## [12,] 0.022617190 0.026315590 0.17739577 0.77367145 0.22632855 1121.1770
## [13,] 0.016493337 0.019408127 0.14757289 0.81652565 0.18347435  868.2115
## [14,] 0.012027585 0.014276557 0.12158135 0.85211451 0.14788549  667.2935
## [15,] 0.008770984 0.010480940 0.09935449 0.88139358 0.11860642  509.5774
## [16,] 0.006396144 0.007682727 0.08062971 0.90529142 0.09470858  386.9753
## [17,] 0.004664317 0.005624991 0.06504505 0.92466564 0.07533436  292.4475
## [18,] 0.003401402 0.004114682 0.05220249 0.94028142 0.05971858  220.0716
## [19,] 0.002480435 0.003007794 0.04170726 0.95280451 0.04719549  164.9870
## [20,] 0.001808830 0.002197484 0.03319046 0.96280322 0.03719678  123.2790
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.721970303 0.204178865 0.06790716 0.005943677 0.99405632 5178.3058
##  [2,] 0.521241118 0.265419729 0.18361194 0.029727216 0.97027278 5438.4796
##  [3,] 0.376320608 0.259830272 0.28179305 0.082056071 0.91794393 5423.3762
##  [4,] 0.271692303 0.227010044 0.34323716 0.158060494 0.84193951 5109.8706
##  [5,] 0.196153774 0.186678147 0.36872460 0.248443477 0.75155652 4590.7729
##  [6,] 0.141617200 0.147944268 0.36616257 0.344275965 0.65572404 3971.4576
##  [7,] 0.102243412 0.114422148 0.34466162 0.438672817 0.56132718 3334.6428
##  [8,] 0.073816707 0.087008173 0.31213398 0.527041136 0.47295886 2734.1244
##  [9,] 0.053293471 0.065359667 0.27459019 0.606756670 0.39324333 2199.1376
## [10,] 0.038476303 0.048657133 0.23618737 0.676679196 0.32332080 1741.3020
## [11,] 0.027778748 0.035978266 0.19955569 0.736687294 0.26331271 1361.0021
## [12,] 0.020055431 0.026466085 0.16618041 0.787298072 0.21270193 1052.2676
## [13,] 0.014479426 0.019391420 0.13674550 0.829383654 0.17061635  806.1306
## [14,] 0.010453715 0.014163994 0.11140847 0.863973820 0.13602618  612.7472
## [15,] 0.007547272 0.010320749 0.09000486 0.892127122 0.10787288  462.6248
## [16,] 0.005448906 0.007506046 0.07219233 0.914852720 0.08514728  347.2462
## [17,] 0.003933949 0.005450799 0.05754743 0.933067827 0.06693217  259.3160
## [18,] 0.002840194 0.003953611 0.04562726 0.947578937 0.05242106  192.7850
## [19,] 0.002050536 0.002864964 0.03600635 0.959078148 0.04092185  142.7566
## [20,] 0.001480426 0.002074531 0.02829662 0.968148426 0.03185157  105.3392
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.709524601 0.214045066 0.06816612 0.008264213 0.99173579 5171.5676
##  [2,] 0.503425160 0.276611605 0.18695369 0.033009549 0.96699045 5445.3137
##  [3,] 0.357192536 0.268959618 0.28779614 0.086051707 0.91394829 5440.2640
##  [4,] 0.253436891 0.233199815 0.35057829 0.162785006 0.83721499 5128.8321
##  [5,] 0.179819709 0.190151302 0.37615612 0.253872873 0.74612713 4605.8308
##  [6,] 0.127586507 0.149306059 0.37282398 0.350283451 0.64971655 3979.7775
##  [7,] 0.090525766 0.114321975 0.35009705 0.445055213 0.55494479 3335.8520
##  [8,] 0.064230258 0.086001251 0.31620278 0.533565710 0.46643429 2729.2878
##  [9,] 0.045572948 0.063868052 0.27735809 0.613200911 0.38679909 2189.9160
## [10,] 0.032335128 0.046975742 0.23783317 0.682855957 0.31714404 1729.4062
## [11,] 0.022942569 0.034297738 0.20030348 0.742456214 0.25754379 1347.9042
## [12,] 0.016278317 0.024898808 0.16625593 0.792566944 0.20743306 1039.0903
## [13,] 0.011549866 0.017994842 0.13635166 0.834103634 0.16589637  793.6427
## [14,] 0.008194914 0.012959241 0.11071424 0.868131601 0.13186840  601.4126
## [15,] 0.005814493 0.009306479 0.08914277 0.895736254 0.10426375  452.6700
## [16,] 0.004125526 0.006668201 0.07126086 0.917945414 0.08205459  338.7280
## [17,] 0.002927162 0.004769148 0.05661578 0.935687914 0.06431209  252.1802
## [18,] 0.002076894 0.003405913 0.04474095 0.949776246 0.05022375  186.9120
## [19,] 0.001473607 0.002429450 0.03519266 0.960904286 0.03909571  137.9946
## [20,] 0.001045560 0.001731255 0.02756938 0.969653802 0.03034620  101.5272
## 
## , , 6
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.722707569 0.192468117 0.07462060 0.01020371 0.98979629 5194.39476
##  [2,] 0.522306231 0.253585828 0.18453445 0.03957349 0.96042651 5396.38065
##  [3,] 0.377474666 0.251370196 0.27431976 0.09683538 0.90316462 5319.58356
##  [4,] 0.272803799 0.222176792 0.32852257 0.17649684 0.82350316 4962.36686
##  [5,] 0.197157370 0.184665594 0.34898049 0.26919654 0.73080346 4420.03409
##  [6,] 0.142487124 0.147792921 0.34356468 0.36615528 0.63384472 3794.19903
##  [7,] 0.102976523 0.115337314 0.32097992 0.46070624 0.53929376 3162.60600
##  [8,] 0.074421913 0.088426902 0.28866874 0.54848245 0.45151755 2574.63812
##  [9,] 0.053785280 0.066923671 0.25222328 0.62706777 0.37293223 2056.13568
## [10,] 0.038871029 0.050160803 0.21546590 0.69550227 0.30449773 1616.31082
## [11,] 0.028092387 0.037319067 0.18077477 0.75381377 0.24618623 1253.94977
## [12,] 0.020302580 0.027605749 0.14945373 0.80263794 0.19736206  962.09648
## [13,] 0.014672829 0.020328593 0.12206151 0.84293707 0.15706293  731.23818
## [14,] 0.010604164 0.014916304 0.09867348 0.87580606 0.12419394  551.29075
## [15,] 0.007663710 0.010913772 0.07907508 0.90234744 0.09765256  412.72179
## [16,] 0.005538621 0.007966964 0.06289723 0.92359718 0.07640282  307.09944
## [17,] 0.004002803 0.005805074 0.04970624 0.94048589 0.05951411  227.28469
## [18,] 0.002892856 0.004223500 0.03906026 0.95382339 0.04617661  167.41840
## [19,] 0.002090689 0.003069088 0.03054226 0.96429797 0.03570203  122.80281
## [20,] 0.001510957 0.002228006 0.02377705 0.97248399 0.02751601   89.73909
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.725284139 0.191334026 0.07401563 0.009366208 0.99063379 5194.4878
##  [2,] 0.526037082 0.246370447 0.18935176 0.038240710 0.96175929 5427.2515
##  [3,] 0.381526352 0.239198075 0.28373838 0.095537197 0.90446280 5371.4786
##  [4,] 0.276715012 0.207514789 0.34038829 0.175381904 0.82461810 5022.1266
##  [5,] 0.200697009 0.169643350 0.36153316 0.268126484 0.73187352 4479.3715
##  [6,] 0.145562358 0.133801075 0.35573758 0.364898985 0.63510101 3849.3801
##  [7,] 0.105574069 0.103095621 0.33225780 0.459072513 0.54092749 3212.5509
##  [8,] 0.076571198 0.078176932 0.29887687 0.546375003 0.45362500 2619.4265
##  [9,] 0.055535875 0.058614381 0.26136236 0.624487386 0.37551261 2096.1826
## [10,] 0.040279290 0.043588381 0.22360934 0.692522987 0.30747701 1652.0240
## [11,] 0.029213930 0.032219231 0.18801473 0.750552114 0.24944789 1285.6448
## [12,] 0.021188400 0.023708478 0.15587776 0.799225359 0.20077464  990.0172
## [13,] 0.015367610 0.017386800 0.12774591 0.839499683 0.16050032  755.6020
## [14,] 0.011145884 0.012718016 0.10368388 0.872452218 0.12754778  572.3233
## [15,] 0.008083933 0.009284711 0.08346955 0.899161810 0.10083819  430.6742
## [16,] 0.005863148 0.006768096 0.06672918 0.920639576 0.07936042  322.2498
## [17,] 0.004252449 0.004927937 0.05302649 0.937793126 0.06220687  239.9299
## [18,] 0.003084233 0.003584921 0.04191806 0.951412790 0.04858721  177.8622
## [19,] 0.002236946 0.002606141 0.03298548 0.962171430 0.03782857  131.3435
## [20,] 0.001622421 0.001893597 0.02585196 0.970632024 0.02936798   96.6593
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.739975448 0.191595149 0.06193743 0.006491973 0.99350803 5136.9834
##  [2,] 0.547563664 0.253819189 0.16850785 0.030109292 0.96989071 5349.6822
##  [3,] 0.405183668 0.253342202 0.26012195 0.081352184 0.91864782 5310.9989
##  [4,] 0.299825966 0.225783946 0.31860245 0.155787641 0.84421236 4996.6702
##  [5,] 0.221863854 0.189482050 0.34407658 0.244577518 0.75542248 4490.8020
##  [6,] 0.164173805 0.153315795 0.34341601 0.339094386 0.66090561 3890.7293
##  [7,] 0.121484585 0.121112893 0.32481249 0.432590032 0.56740997 3273.8062
##  [8,] 0.089895610 0.094101817 0.29551353 0.520489047 0.47951095 2690.9512
##  [9,] 0.066520544 0.072253637 0.26111070 0.600115119 0.39988488 2170.2612
## [10,] 0.049223570 0.054998428 0.22553285 0.670245151 0.32975485 1723.2461
## [11,] 0.036424233 0.041593687 0.19131284 0.730669243 0.26933076 1350.6934
## [12,] 0.026953038 0.031302399 0.15992010 0.781824462 0.21817554 1047.2246
## [13,] 0.019944586 0.023469492 0.13206835 0.824517570 0.17548243  804.4737
## [14,] 0.014758504 0.017546078 0.10796634 0.859729077 0.14027092  613.1243
## [15,] 0.010920931 0.013088480 0.08750746 0.888483127 0.11151687  464.1069
## [16,] 0.008081221 0.009746448 0.07040541 0.911766918 0.08823308  349.2251
## [17,] 0.005979905 0.007247976 0.05628671 0.930485405 0.06951460  261.4146
## [18,] 0.004424983 0.005384286 0.04475077 0.945439961 0.05456004  194.7863
## [19,] 0.003274379 0.003996497 0.03540662 0.957322504 0.04267750  144.5493
## [20,] 0.002422960 0.002964478 0.02789356 0.966719005 0.03328099  106.8794
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.710572635 0.211128285 0.06936366 0.008935421 0.99106458 5174.6276
##  [2,] 0.504913470 0.275063757 0.18609869 0.033924078 0.96607592 5436.0520
##  [3,] 0.358777695 0.269509391 0.28635165 0.085361263 0.91463874 5435.7375
##  [4,] 0.254937612 0.235366395 0.35055064 0.159145353 0.84085465 5143.7159
##  [5,] 0.181151691 0.193221457 0.37880239 0.246824458 0.75317554 4645.3850
##  [6,] 0.128721434 0.152682614 0.37851559 0.340080357 0.65991964 4041.7718
##  [7,] 0.091465929 0.117603772 0.35855927 0.432371032 0.56762897 3414.1431
##  [8,] 0.064993186 0.088962463 0.32680667 0.519237680 0.48076232 2816.6793
##  [9,] 0.046182380 0.066410360 0.28935251 0.598054749 0.40194525 2279.8700
## [10,] 0.032815935 0.049082272 0.25049518 0.667606614 0.33239339 1816.8167
## [11,] 0.023318105 0.035997592 0.21301898 0.727665320 0.27233468 1429.2640
## [12,] 0.016569208 0.026242864 0.17855094 0.778636991 0.22136301 1112.3323
## [13,] 0.011773626 0.019040695 0.14789278 0.821292898 0.17870710  857.8467
## [14,] 0.008366016 0.013762692 0.12129269 0.856578603 0.14342140  656.4886
## [15,] 0.005944662 0.009917325 0.09865135 0.885486662 0.11451334  499.0762
## [16,] 0.004224114 0.007128671 0.07966986 0.908977356 0.09102264  377.2448
## [17,] 0.003001540 0.005113821 0.06395090 0.927933741 0.07206626  283.7418
## [18,] 0.002132812 0.003662396 0.05106470 0.943140094 0.05685991  212.4913
## [19,] 0.001515518 0.002619369 0.04058958 0.955275532 0.04472447  158.5285
## [20,] 0.001076886 0.001871303 0.03213493 0.964916883 0.03508312  117.8740
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.719389773 0.205088507 0.06235855 0.01316317 0.98683683 5111.5530
##  [2,] 0.517521646 0.274059024 0.16786238 0.04055695 0.95944305 5304.6151
##  [3,] 0.372299780 0.275206557 0.25985295 0.09264072 0.90735928 5267.3084
##  [4,] 0.267828654 0.246131142 0.32001485 0.16602536 0.83397464 4967.6122
##  [5,] 0.192673195 0.206768500 0.34766209 0.25289622 0.74710378 4480.0815
##  [6,] 0.138607126 0.167071906 0.34899225 0.34532872 0.65467128 3896.0483
##  [7,] 0.099712549 0.131494487 0.33183328 0.43695969 0.56304031 3290.4081
##  [8,] 0.071732188 0.101569712 0.30332814 0.52336996 0.47663004 2713.8875
##  [9,] 0.051603402 0.077370471 0.26912386 0.60190226 0.39809774 2195.4810
## [10,] 0.037122960 0.058313617 0.23327947 0.67128395 0.32871605 1747.9138
## [11,] 0.026705878 0.043587547 0.19847574 0.73123084 0.26876916 1373.1021
## [12,] 0.019211935 0.032366513 0.16631628 0.78210527 0.21789473 1066.5488
## [13,] 0.013820870 0.023907262 0.13762170 0.82465016 0.17534984  820.4968
## [14,] 0.009942592 0.017583049 0.11267771 0.85979664 0.14020336  626.0048
## [15,] 0.007152599 0.012886210 0.09142779 0.88853340 0.11146660  474.2018
## [16,] 0.005145507 0.009416504 0.07361414 0.91182385 0.08817615  356.9695
## [17,] 0.003701625 0.006864387 0.05887592 0.93055807 0.06944193  267.2472
## [18,] 0.002662911 0.004993846 0.04681431 0.94552894 0.05447106  199.1080
## [19,] 0.001915671 0.003626869 0.03703333 0.95742413 0.04257587  147.7049
## [20,] 0.001378114 0.002630322 0.02916349 0.96682807 0.03317193  109.1526</code></pre>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">Expected_LY_mono</span>[<span class="fl">1</span>:<span class="fl">10</span>]</pre></body></html></div>
<pre><code>##  [1] 8.042059 7.913119 8.195247 8.050147 7.964093 7.777549 7.822450 8.122190
##  [9] 8.138555 8.057394</code></pre>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">Expected_total_cost_mono</span>[<span class="fl">1</span>:<span class="fl">10</span>]</pre></body></html></div>
<pre><code>##  [1] 45346.76 43740.61 45619.48 45063.68 45008.11 43322.29 43926.59 44370.61
##  [9] 45909.69 44415.45</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define an array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">trace_combi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>, <span class="kw">dim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">follow_up</span>, <span class="fl">6</span>, <span class="no">PSA_samples</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">trace_combi</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</pre></body></html></div>
<p>Define a matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">Expected_LY_combi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>, <span class="no">PSA_samples</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="no">PSA_samples</span>)
<span class="no">Expected_total_cost_combi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>, <span class="no">PSA_samples</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="no">PSA_samples</span>)</pre></body></html></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">PSA_samples</span>){
<span class="kw">for</span>(<span class="no">t</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">2</span>){
<span class="no">trace_combi</span>[<span class="no">t</span>,<span class="fl">1</span>:<span class="fl">4</span>,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">initial</span> <span class="kw">%*%</span> (<span class="no">p_combi</span>[,,<span class="no">i</span>] <span class="kw">%^%</span><span class="no">t</span>)
<span class="no">trace_combi</span>[<span class="no">t</span>,<span class="fl">5</span>,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  <span class="no">trace_combi</span>[<span class="no">t</span>,<span class="fl">1</span>:<span class="fl">4</span>,<span class="no">i</span>] * <span class="no">LY</span> * <span class="fl">1</span>/(<span class="fl">1</span>+<span class="no">discount_LY</span>)^<span class="no">t</span>  )
<span class="no">trace_combi</span>[<span class="no">t</span>,<span class="fl">6</span>,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  <span class="no">trace_combi</span>[<span class="no">t</span>,<span class="fl">1</span>:<span class="fl">4</span>,<span class="no">i</span>] * (<span class="no">drug_cost_combi</span> + <span class="no">other_cost</span>) * <span class="fl">1</span>/(<span class="fl">1</span>+<span class="no">discount_cost</span>)^<span class="no">t</span>  )
}
<span class="kw">for</span>(<span class="no">t</span> <span class="kw">in</span> <span class="fl">3</span>:<span class="no">follow_up</span>){
<span class="no">trace_combi</span>[<span class="no">t</span>,<span class="fl">1</span>:<span class="fl">4</span>,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">trace_combi</span>[<span class="fl">2</span>,<span class="fl">1</span>:<span class="fl">4</span>,<span class="no">i</span>] <span class="kw">%*%</span> (<span class="no">p_mono</span>[,,<span class="no">i</span>] <span class="kw">%^%</span> (<span class="no">t</span>-<span class="fl">2</span>))
<span class="no">trace_combi</span>[<span class="no">t</span>,<span class="fl">5</span>,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  <span class="no">trace_combi</span>[<span class="no">t</span>,<span class="fl">1</span>:<span class="fl">4</span>,<span class="no">i</span>] * <span class="no">LY</span> * <span class="fl">1</span>/(<span class="fl">1</span>+<span class="no">discount_LY</span>)^<span class="no">t</span>  )
<span class="no">trace_combi</span>[<span class="no">t</span>,<span class="fl">6</span>,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  <span class="no">trace_combi</span>[<span class="no">t</span>,<span class="fl">1</span>:<span class="fl">4</span>,<span class="no">i</span>] * (<span class="no">drug_cost_mono</span> + <span class="no">other_cost</span>) * <span class="fl">1</span>/(<span class="fl">1</span>+<span class="no">discount_cost</span>)^<span class="no">t</span>  )
}
<span class="no">Expected_LY_combi</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">trace_combi</span>[,<span class="fl">5</span>,<span class="no">i</span>])
<span class="no">Expected_total_cost_combi</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">trace_combi</span>[,<span class="fl">6</span>,<span class="no">i</span>])
}</pre></body></html></div>
<p>Presentation of results for the first 10 PSA samples</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">trace_combi</span>[,,<span class="fl">1</span>:<span class="fl">10</span>]</pre></body></html></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.897220355 0.072802905 0.02606320 0.003913543 0.99608646 6865.6626
##  [2,] 0.805004366 0.126606322 0.05830109 0.010088217 0.98991178 6631.4324
##  [3,] 0.579449613 0.231776504 0.15439265 0.034381232 0.96561877 4949.2527
##  [4,] 0.417093208 0.246825949 0.25546201 0.080618832 0.91938117 4988.6996
##  [5,] 0.300227562 0.223162382 0.32728901 0.149321044 0.85067896 4778.1612
##  [6,] 0.216106585 0.186509422 0.36392059 0.233463401 0.76653660 4362.8736
##  [7,] 0.155555525 0.148967610 0.37062244 0.324854420 0.67514558 3830.4218
##  [8,] 0.111970311 0.115598192 0.35579849 0.416633010 0.58336699 3259.3965
##  [9,] 0.080597269 0.087969030 0.32749768 0.503936022 0.49606398 2705.2204
## [10,] 0.058014662 0.066028381 0.29217491 0.583782043 0.41621796 2200.7293
## [11,] 0.041759492 0.049067702 0.25448931 0.654683500 0.34531650 1761.3983
## [12,] 0.030058870 0.036195180 0.21752475 0.716221199 0.28377880 1391.0190
## [13,] 0.021636653 0.026551732 0.18313629 0.768675323 0.23132468 1086.3622
## [14,] 0.015574264 0.019395480 0.15229052 0.812739737 0.18726026  840.5387
## [15,] 0.011210500 0.014122171 0.12535054 0.849316793 0.15068321  645.2110
## [16,] 0.008069422 0.010256909 0.10229470 0.879378965 0.12062103  491.9345
## [17,] 0.005808445 0.007435138 0.08287493 0.903881484 0.09611852  372.8917
## [18,] 0.004180972 0.005381524 0.06672583 0.923711676 0.07628832  281.2320
## [19,] 0.003009503 0.003890530 0.05343648 0.939663488 0.06033651  211.1704
## [20,] 0.002166268 0.002810029 0.04259525 0.952428457 0.04757154  157.9509
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.874335884 0.086503806 0.03488697 0.004273343 0.99572666 6919.1067
##  [2,] 0.764463239 0.143783026 0.07869276 0.013060972 0.98693903 6730.5634
##  [3,] 0.566065136 0.217349729 0.17400794 0.042577200 0.95742280 5013.9759
##  [4,] 0.419156503 0.223235784 0.26117847 0.096429239 0.90357076 4948.4306
##  [5,] 0.310374483 0.200297252 0.31739673 0.171931534 0.82806847 4641.8419
##  [6,] 0.229824229 0.167976317 0.34132341 0.260876041 0.73912396 4162.1460
##  [7,] 0.170178861 0.135427941 0.33948857 0.354904625 0.64509538 3597.7195
##  [8,] 0.126013018 0.106486462 0.32005777 0.447442745 0.55255725 3020.2216
##  [9,] 0.093309361 0.082336780 0.29028767 0.534066192 0.46593381 2476.7818
## [10,] 0.069093154 0.062926872 0.25574412 0.612235854 0.38776415 1993.0715
## [11,] 0.051161682 0.047696076 0.22029706 0.680845178 0.31915482 1579.2144
## [12,] 0.037883894 0.035935892 0.18640552 0.739774698 0.26022530 1235.3824
## [13,] 0.028052038 0.026956893 0.15546618 0.789524890 0.21047511  956.1175
## [14,] 0.020771804 0.020155993 0.12813059 0.830941613 0.16905839  733.3131
## [15,] 0.015380981 0.015034604 0.10455967 0.865024741 0.13497526  558.0996
## [16,] 0.011389216 0.011194316 0.08461336 0.892803110 0.10719689  421.9340
## [17,] 0.008433418 0.008323697 0.06798430 0.915258583 0.08474142  317.1534
## [18,] 0.006244727 0.006182918 0.05428775 0.933284602 0.06671540  237.1926
## [19,] 0.004624058 0.004589210 0.04311895 0.947667783 0.05233222  176.6048
## [20,] 0.003423994 0.003404325 0.03408756 0.959084125 0.04091587  130.9765
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.855726651 0.105950570 0.03316319 0.005159586 0.99484041 6908.4180
##  [2,] 0.732268101 0.172148757 0.08092823 0.014654915 0.98534509 6740.3709
##  [3,] 0.533998459 0.243146897 0.17918044 0.043674204 0.95632580 5042.8982
##  [4,] 0.389412503 0.243951943 0.27137483 0.095260721 0.90473928 5008.4331
##  [5,] 0.283974785 0.215658656 0.33296062 0.167405943 0.83259406 4734.9642
##  [6,] 0.207085488 0.178661911 0.36150017 0.252752430 0.74724757 4282.1177
##  [7,] 0.151014815 0.142410178 0.36299953 0.343575480 0.65642452 3734.7642
##  [8,] 0.110125893 0.110720155 0.34550249 0.433651464 0.56634854 3164.3592
##  [9,] 0.080308096 0.084633621 0.31638227 0.518676017 0.48132398 2619.5899
## [10,] 0.058563796 0.063923515 0.28143645 0.596076237 0.40392376 2128.3400
## [11,] 0.042707004 0.047865130 0.24480110 0.664626763 0.33537324 1702.9401
## [12,] 0.031143613 0.035613173 0.20918880 0.724054412 0.27594559 1345.4406
## [13,] 0.022711137 0.026371712 0.17621395 0.774703196 0.22529680 1051.8233
## [14,] 0.016561847 0.019458607 0.14670169 0.817277853 0.18272215  814.9905
## [15,] 0.012077545 0.014318783 0.12094290 0.852660771 0.14733923  626.7146
## [16,] 0.008807417 0.010514800 0.09888878 0.881789006 0.11821099  478.8078
## [17,] 0.006422712 0.007709157 0.08029127 0.905576862 0.09442314  363.7547
## [18,] 0.004683692 0.005645250 0.06479987 0.924871187 0.07512881  274.9966
## [19,] 0.003415531 0.004130014 0.05202535 0.940429103 0.05957090  207.0045
## [20,] 0.002490738 0.003019290 0.04157958 0.952910396 0.04708960  155.2341
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.850186874 0.110019449 0.03659099 0.003202683 0.99679732 6942.9149
##  [2,] 0.722817721 0.178537276 0.08705989 0.011585116 0.98841488 6795.6219
##  [3,] 0.521852928 0.250772761 0.18751161 0.039862701 0.96013730 5104.6291
##  [4,] 0.376762317 0.251489726 0.27875300 0.092994958 0.90700504 5055.7670
##  [5,] 0.272011204 0.222279671 0.33757005 0.168139073 0.83186093 4755.2021
##  [6,] 0.196384011 0.184009260 0.36256031 0.257046417 0.74295358 4272.6669
##  [7,] 0.141783424 0.146448749 0.36046470 0.351303127 0.64869687 3699.1499
##  [8,] 0.102363421 0.113591727 0.33978992 0.444254929 0.55574507 3108.9981
##  [9,] 0.073903350 0.086552720 0.30815090 0.531393025 0.46860698 2551.5786
## [10,] 0.053356024 0.065114120 0.27142448 0.610105375 0.38989463 2054.1544
## [11,] 0.038521465 0.048527987 0.23371859 0.679231954 0.32076805 1627.8185
## [12,] 0.027811354 0.035912845 0.19765573 0.738620068 0.26137993 1273.2170
## [13,] 0.020078971 0.026434931 0.16473199 0.788754108 0.21124589  985.0196
## [14,] 0.014496421 0.019378220 0.13564889 0.830476470 0.16952353  755.0337
## [15,] 0.010465986 0.014159835 0.11058242 0.864791761 0.13520824  574.1902
## [16,] 0.007556131 0.010320851 0.08938495 0.892738073 0.10726193  433.7025
## [17,] 0.005455302 0.007507914 0.07172841 0.915308372 0.08469163  325.6622
## [18,] 0.003938566 0.005453184 0.05720097 0.933407280 0.06659272  243.2805
## [19,] 0.002843528 0.003955932 0.04536892 0.947831623 0.05216838  180.9187
## [20,] 0.002052943 0.002866987 0.03581393 0.959266141 0.04073386  134.0061
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.872656244 0.093836871 0.02988387 0.003623012 0.99637699 6896.0192
##  [2,] 0.761528921 0.158560695 0.06949681 0.010413574 0.98958643 6700.0743
##  [3,] 0.540323504 0.255407644 0.16886960 0.035399250 0.96460075 5026.8046
##  [4,] 0.383372818 0.264500264 0.26805698 0.084069934 0.91593007 5041.4451
##  [5,] 0.272012446 0.236204749 0.33569285 0.156089957 0.84391004 4794.8387
##  [6,] 0.192999522 0.195878526 0.36744853 0.243673420 0.75632658 4344.1423
##  [7,] 0.136937909 0.155464850 0.36950698 0.338090262 0.66190974 3782.7513
##  [8,] 0.097160815 0.119912821 0.35075083 0.432175533 0.56782447 3191.3117
##  [9,] 0.068937989 0.090679689 0.31942727 0.520955049 0.47904495 2625.1249
## [10,] 0.048913199 0.067602223 0.28201320 0.601471381 0.39852862 2115.7957
## [11,] 0.034705118 0.049866910 0.24308629 0.672341683 0.32765832 1677.1466
## [12,] 0.024624135 0.036489939 0.20559655 0.733289375 0.26671062 1311.3065
## [13,] 0.017471430 0.026536312 0.17124705 0.784745208 0.21525479 1013.5890
## [14,] 0.012396409 0.019204528 0.14085606 0.827543005 0.17245700  775.9393
## [15,] 0.008795557 0.013845421 0.11465433 0.862704688 0.13729531  589.1562
## [16,] 0.006240664 0.009951492 0.09250958 0.891298261 0.10870174  444.2013
## [17,] 0.004427905 0.007135322 0.07408609 0.914350686 0.08564931  332.8847
## [18,] 0.003141707 0.005106100 0.05895254 0.932799654 0.06720035  248.1521
## [19,] 0.002229119 0.003648205 0.04665112 0.947471554 0.05252845  184.1368
## [20,] 0.001581615 0.002603236 0.03673902 0.959076126 0.04092387  136.0831
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.904533374 0.066263192 0.02569048 0.003512949 0.99648705 6864.3296
##  [2,] 0.818180626 0.116957463 0.05556427 0.009297645 0.99070236 6618.6749
##  [3,] 0.591305331 0.227044618 0.14791736 0.033732692 0.96626731 4916.8326
##  [4,] 0.427340839 0.248862560 0.24213969 0.081656909 0.91834309 4919.0741
##  [5,] 0.308842459 0.230282799 0.30764203 0.153232714 0.84676729 4673.2484
##  [6,] 0.223202783 0.196423661 0.33954233 0.240831228 0.75916877 4231.3678
##  [7,] 0.161310341 0.159799996 0.34321633 0.335673329 0.66432667 3682.3990
##  [8,] 0.116580204 0.126102468 0.32686078 0.430456545 0.56954346 3104.1948
##  [9,] 0.084253396 0.097448717 0.29824161 0.520056280 0.47994372 2550.6028
## [10,] 0.060890567 0.074182451 0.26353678 0.601390203 0.39860980 2052.6191
## [11,] 0.044006074 0.055846154 0.22715843 0.672989345 0.32701066 1623.9118
## [12,] 0.031803523 0.041689272 0.19197834 0.734528870 0.26547113 1266.6647
## [13,] 0.022984646 0.030919595 0.15967395 0.786421809 0.21357819  976.3229
## [14,] 0.016611178 0.022816012 0.13106708 0.829505729 0.17049427  744.9773
## [15,] 0.012005024 0.016768990 0.10640657 0.864819421 0.13518058  563.5624
## [16,] 0.008676122 0.012285444 0.08558419 0.893454248 0.10654575  423.1597
## [17,] 0.006270299 0.008977746 0.06828965 0.916462310 0.08353769  315.6838
## [18,] 0.004531592 0.006547152 0.05411606 0.934805194 0.06519481  234.1726
## [19,] 0.003275016 0.004766692 0.04262804 0.949330253 0.05066975  172.8419
## [20,] 0.002366879 0.003465754 0.03340284 0.960764531 0.03923547  127.0100
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.882508981 0.081830112 0.03165515 0.004005758 0.99599424 6900.5406
##  [2,] 0.778822101 0.138729776 0.07086831 0.011579815 0.98842018 6695.0890
##  [3,] 0.564867317 0.227031469 0.16883808 0.039263134 0.96073687 5003.2557
##  [4,] 0.409689306 0.235752122 0.26318418 0.091374395 0.90862560 4981.4519
##  [5,] 0.297141155 0.210965449 0.32570038 0.166193019 0.83380698 4704.5754
##  [6,] 0.215511767 0.175492084 0.35354712 0.255449027 0.74455097 4236.8399
##  [7,] 0.156307266 0.139924746 0.35334118 0.350426808 0.64957319 3671.1850
##  [8,] 0.113367181 0.108595205 0.33384278 0.444194830 0.55580517 3084.9356
##  [9,] 0.082223418 0.082760774 0.30294887 0.532066934 0.46793307 2529.6590
## [10,] 0.059635341 0.062273620 0.26674468 0.611346355 0.38865364 2033.8617
## [11,] 0.043252567 0.046430564 0.22946459 0.680852282 0.31914772 1609.1864
## [12,] 0.031370401 0.034386455 0.19379544 0.740447707 0.25955229 1256.4280
## [13,] 0.022752454 0.025339847 0.16125851 0.790649190 0.20935081  970.2152
## [14,] 0.016501994 0.018603476 0.13255921 0.832335321 0.16766468  742.2510
## [15,] 0.011968635 0.013619274 0.10786791 0.866544184 0.13345582  563.3621
## [16,] 0.008680661 0.009948964 0.08702870 0.894341676 0.10565832  424.6834
## [17,] 0.006295946 0.007255821 0.06970607 0.916742166 0.08325783  318.2594
## [18,] 0.004566350 0.005285024 0.05548291 0.934665714 0.06533429  237.2811
## [19,] 0.003311901 0.003845793 0.04392273 0.948919580 0.05108042  176.1099
## [20,] 0.002402069 0.002796406 0.03460652 0.960195003 0.03980500  130.1883
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.856383828 0.105821399 0.03420914 0.003585632 0.99641437 6925.1238
##  [2,] 0.733393262 0.172177509 0.08203380 0.012395434 0.98760457 6760.8490
##  [3,] 0.542693007 0.241202776 0.17509640 0.041007817 0.95899218 5032.2500
##  [4,] 0.401579501 0.245031019 0.25960047 0.093789013 0.90621099 4956.2550
##  [5,] 0.297158972 0.220233085 0.31465283 0.167955116 0.83204488 4648.3925
##  [6,] 0.219890343 0.185724962 0.33876956 0.255615135 0.74438486 4173.2652
##  [7,] 0.162713455 0.150740562 0.33787331 0.348672674 0.65132733 3614.8827
##  [8,] 0.120403962 0.119327119 0.31960321 0.440665713 0.55933429 3042.2280
##  [9,] 0.089095976 0.092850467 0.29089086 0.527162700 0.47283730 2501.4253
## [10,] 0.065928835 0.071368651 0.25715250 0.605550017 0.39444998 2018.1764
## [11,] 0.048785719 0.054367525 0.22222436 0.674622396 0.32537760 1603.1030
## [12,] 0.036100234 0.041140850 0.18859468 0.734164232 0.26583577 1256.9848
## [13,] 0.026713287 0.030975507 0.15771550 0.784595704 0.21540430  974.9009
## [14,] 0.019767177 0.023232393 0.13029795 0.826702485 0.17329752  749.1468
## [15,] 0.014627225 0.017373433 0.10655577 0.861443571 0.13855643  571.1172
## [16,] 0.010823788 0.012962366 0.08639076 0.889823091 0.11017691  432.4189
## [17,] 0.008009337 0.009654085 0.06952602 0.912810560 0.08718944  325.4550
## [18,] 0.005926713 0.007180190 0.05559728 0.931295817 0.06870418  243.6714
## [19,] 0.004385622 0.005334454 0.04421232 0.946067605 0.05393239  181.5990
## [20,] 0.003245253 0.003959815 0.03498747 0.957807460 0.04219254  134.7857
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.807345019 0.140535832 0.04617136 0.005947791 0.99405221 6989.4920
##  [2,] 0.651805980 0.215853600 0.11333198 0.019008436 0.98099156 6904.5673
##  [3,] 0.463155493 0.265455045 0.21746826 0.053921207 0.94607879 5206.0841
##  [4,] 0.329105619 0.255002294 0.30358907 0.112303017 0.88769698 5102.5744
##  [5,] 0.233853447 0.220509880 0.35589125 0.189745418 0.81025458 4759.1145
##  [6,] 0.166169860 0.179971149 0.37551690 0.278342086 0.72165791 4253.3467
##  [7,] 0.118075755 0.141671964 0.36970543 0.370546855 0.62945315 3672.1997
##  [8,] 0.083901401 0.108835056 0.34672138 0.460542164 0.53945784 3083.8581
##  [9,] 0.059618039 0.082172062 0.31376131 0.544448592 0.45555141 2532.6688
## [10,] 0.042362947 0.061253866 0.27632284 0.620060348 0.37993965 2042.6312
## [11,] 0.030101951 0.045221923 0.23823433 0.686441799 0.31355820 1623.0537
## [12,] 0.021389623 0.033138282 0.20193658 0.743535520 0.25646448 1273.8103
## [13,] 0.015198881 0.024142266 0.16882031 0.791838538 0.20816146  989.4035
## [14,] 0.010799909 0.017507291 0.13953427 0.832158526 0.16784147  761.7860
## [15,] 0.007674120 0.012648946 0.11423455 0.865442383 0.13455762  582.1629
## [16,] 0.005453019 0.009111625 0.09277224 0.892663112 0.10733689  442.0452
## [17,] 0.003874766 0.006547692 0.07482716 0.914750385 0.08524962  333.7932
## [18,] 0.002753303 0.004695976 0.05999860 0.932552123 0.06744788  250.8370
## [19,] 0.001956422 0.003362515 0.04786401 0.946817054 0.05318295  187.7037
## [20,] 0.001390180 0.002404522 0.03801457 0.958190728 0.04180927  139.9407
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.869134427 0.095645213 0.02908158 0.006138783 0.99386122 6874.8921
##  [2,] 0.755394653 0.161685816 0.06754692 0.015372615 0.98462738 6658.6208
##  [3,] 0.543423188 0.254667805 0.15782519 0.044083813 0.95591619 4931.9481
##  [4,] 0.390933084 0.268556095 0.24674146 0.093769365 0.90623064 4898.1793
##  [5,] 0.281233263 0.245849905 0.30889555 0.164021284 0.83597872 4641.9637
##  [6,] 0.202316333 0.209344134 0.34007826 0.248261277 0.75173872 4210.0580
##  [7,] 0.145544301 0.170638528 0.34488151 0.338935658 0.66106434 3680.5333
##  [8,] 0.104703082 0.135117494 0.33052001 0.429659418 0.57034058 3122.7379
##  [9,] 0.075322326 0.104828270 0.30400641 0.515842996 0.48415700 2585.7792
## [10,] 0.054186111 0.080116993 0.27106837 0.594628527 0.40537147 2098.8960
## [11,] 0.038980934 0.060537649 0.23591737 0.664564048 0.33543595 1675.8287
## [12,] 0.028042485 0.045340615 0.20139240 0.725224503 0.27477550 1319.7243
## [13,] 0.020173477 0.033722115 0.16923351 0.776870896 0.22312910 1027.2696
## [14,] 0.014512593 0.024940743 0.14036796 0.820178703 0.17982130  791.7377
## [15,] 0.010440211 0.018362475 0.11515934 0.856037971 0.14396203  605.0348
## [16,] 0.007510581 0.013469099 0.09360482 0.885415500 0.11458450  458.9636
## [17,] 0.005403035 0.009849510 0.07548150 0.909265953 0.09073405  345.9280
## [18,] 0.003886888 0.007184328 0.06044963 0.928479155 0.07152085  259.2660
## [19,] 0.002796188 0.005229215 0.04812182 0.943852782 0.05614722  193.3509
## [20,] 0.002011549 0.003799403 0.03810704 0.956082011 0.04391799  143.5595</code></pre>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">Expected_LY_combi</span>[<span class="fl">1</span>:<span class="fl">10</span>]</pre></body></html></div>
<pre><code>##  [1] 9.258308 8.907993 9.090213 8.939687 9.048418 9.047078 8.928407 8.984268
##  [9] 8.780744 9.083315</code></pre>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">Expected_total_cost_combi</span>[<span class="fl">1</span>:<span class="fl">10</span>]</pre></body></html></div>
<pre><code>##  [1] 51811.56 49849.85 51385.96 50873.53 51230.90 50061.65 50269.36 50146.03
##  [9] 51131.07 50524.27</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="no">ICER</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>, <span class="no">PSA_samples</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="no">PSA_samples</span>)
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">PSA_samples</span>){
<span class="no">ICER</span>[<span class="no">i</span>]  <span class="kw">&lt;-</span> (<span class="no">Expected_total_cost_combi</span>[<span class="no">i</span>] - <span class="no">Expected_total_cost_mono</span>[<span class="no">i</span>]) / (<span class="no">Expected_LY_combi</span>[<span class="no">i</span>] - <span class="no">Expected_LY_mono</span>[<span class="no">i</span>])
}</pre></body></html></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">ICER</span>[<span class="fl">1</span>:<span class="fl">10</span>]</pre></body></html></div>
<pre><code>##  [1] 5315.357 6140.716 6443.236 6531.298 5738.863 5308.553 5735.101 6699.424
##  [9] 8130.606 5954.480</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">Results_by_PSA_sample</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">Expected_LY_mono</span>, <span class="no">Expected_LY_combi</span>, <span class="no">Expected_total_cost_mono</span>, <span class="no">Expected_total_cost_combi</span>, <span class="no">ICER</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">Results_by_PSA_sample</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</pre></body></html></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="no">Results_by_PSA_sample</span>[<span class="fl">1</span>:<span class="fl">10</span>,]</pre></body></html></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     8.042059      9.258308       45346.76        51811.56 5315.357
##  [2,]     7.913119      8.907993       43740.61        49849.85 6140.716
##  [3,]     8.195247      9.090213       45619.48        51385.96 6443.236
##  [4,]     8.050147      8.939687       45063.68        50873.53 6531.298
##  [5,]     7.964093      9.048418       45008.11        51230.90 5738.863
##  [6,]     7.777549      9.047078       43322.29        50061.65 5308.553
##  [7,]     7.822450      8.928407       43926.59        50269.36 5735.101
##  [8,]     8.122190      8.984268       44370.61        50146.03 6699.424
##  [9,]     8.138555      8.780744       45909.69        51131.07 8130.606
## [10,]     8.057394      9.083315       44415.45        50524.27 5954.480</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
