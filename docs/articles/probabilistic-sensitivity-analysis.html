<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7314121 0.1943750 0.06623907 0.007973856
## [2,] 0.0000000 0.5954657 0.39094555 0.013588756
## [3,] 0.0000000 0.0000000 0.75200159 0.247998414
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7252567 0.1956939 0.06754823 0.01150119
## [2,] 0.0000000 0.5814513 0.40598724 0.01256144
## [3,] 0.0000000 0.0000000 0.75332152 0.24667848
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7238138 0.1963194 0.07009517 0.00977163
## [2,] 0.0000000 0.5747454 0.41147804 0.01377654
## [3,] 0.0000000 0.0000000 0.74967428 0.25032572
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7196024 0.2009841 0.07100522 0.008408293
## [2,] 0.0000000 0.5678717 0.41476813 0.017360171
## [3,] 0.0000000 0.0000000 0.74894074 0.251059256
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7299229 0.1921373 0.0706289 0.007310938
## [2,] 0.0000000 0.5721555 0.4111389 0.016705675
## [3,] 0.0000000 0.0000000 0.7509793 0.249020719
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7235226 0.1999786 0.06674884 0.009749903
## [2,] 0.0000000 0.5943732 0.39295917 0.012667597
## [3,] 0.0000000 0.0000000 0.73673347 0.263266530
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7222535 0.1962096 0.07177668 0.00976022
## [2,] 0.0000000 0.6078545 0.38162069 0.01052485
## [3,] 0.0000000 0.0000000 0.76002853 0.23997147
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7197505 0.2018666 0.07171834 0.006664584
## [2,] 0.0000000 0.5815125 0.41106285 0.007424680
## [3,] 0.0000000 0.0000000 0.76436468 0.235635317
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7087836 0.2041905 0.0730886 0.013937360
## [2,] 0.0000000 0.5952457 0.3949981 0.009756202
## [3,] 0.0000000 0.0000000 0.7524369 0.247563057
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7447645 0.1894141 0.05619559 0.009625759
## [2,] 0.0000000 0.5797498 0.40251268 0.017737533
## [3,] 0.0000000 0.0000000 0.74146026 0.258539743
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.4563226 0.7122640 0.6208365 0.3275076 0.6119527 0.5293446 0.4466561
##  [8] 0.4703408 0.5187241 0.5305858</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8774373 0.08869768 0.03022638 0.003638650
## [2,] 0.0000000 0.81540187 0.17839728 0.006200856
## [3,] 0.0000000 0.00000000 0.88683273 0.113167272
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8043102 0.1393857 0.04811218 0.008191885
## [2,] 0.0000000 0.7018828 0.28917011 0.008947062
## [3,] 0.0000000 0.0000000 0.82429979 0.175700208
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8285335 0.1218822 0.04351764 0.006066585
## [2,] 0.0000000 0.7359864 0.25546058 0.008552979
## [3,] 0.0000000 0.0000000 0.84458866 0.155411339
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.9081677 0.06582381 0.02325475 0.002753780
## [2,] 0.0000000 0.85847471 0.13583970 0.005685587
## [3,] 0.0000000 0.00000000 0.91777619 0.082223809
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8347256 0.1175789 0.04322154 0.004473948
## [2,] 0.0000000 0.7381794 0.25159752 0.010223082
## [3,] 0.0000000 0.0000000 0.84761111 0.152388891
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8536482 0.1058576 0.03533314 0.005161058
## [2,] 0.0000000 0.7852837 0.20801080 0.006705524
## [3,] 0.0000000 0.0000000 0.86064129 0.139358706
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8759429 0.08763819 0.03205949 0.004359462
## [2,] 0.0000000 0.82484582 0.17045319 0.004700986
## [3,] 0.0000000 0.00000000 0.89281529 0.107184708
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8681872 0.09494609 0.03373206 0.003134626
## [2,] 0.0000000 0.80316823 0.19333964 0.003492130
## [3,] 0.0000000 0.00000000 0.88917109 0.110828908
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 9
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.848939 0.1059185 0.03791282 0.007229645
## [2,] 0.000000 0.7900442 0.20489506 0.005060777
## [3,] 0.000000 0.0000000 0.87158307 0.128416930
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8645757 0.1005004 0.02981658 0.005107291
## [2,] 0.0000000 0.7770212 0.21356751 0.009411283
## [3,] 0.0000000 0.0000000 0.86282248 0.137177517
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.731412110 0.194374967 0.06623907 0.007973856 0.99202614 5156.0896
##  [2,] 0.534963674 0.257911829 0.17424997 0.032874528 0.96712547 5370.3169
##  [3,] 0.391278910 0.257561193 0.26730123 0.083858668 0.91614133 5339.1336
##  [4,] 0.286186133 0.229423679 0.32762130 0.156768886 0.84323111 5038.2667
##  [5,] 0.209320003 0.192241351 0.35502061 0.243418039 0.75658196 4546.8947
##  [6,] 0.153099185 0.155159698 0.35599712 0.335743995 0.66425601 3958.4451
##  [7,] 0.111978598 0.122150926 0.33851054 0.427359934 0.57264007 3348.4669
##  [8,] 0.081902503 0.094502522 0.30973218 0.513862792 0.48613721 2767.7188
##  [9,] 0.059904482 0.072192806 0.27528958 0.592613133 0.40738687 2245.0648
## [10,] 0.043814864 0.054632271 0.23920967 0.662343192 0.33765681 1793.1370
## [11,] 0.032046722 0.041048156 0.20414655 0.722758569 0.27724143 1413.8470
## [12,] 0.023439360 0.030671849 0.17168887 0.774199920 0.22580008 1102.7669
## [13,] 0.017143832 0.022820059 0.14265393 0.817382182 0.18261782  852.2474
## [14,] 0.012539206 0.016920894 0.11733297 0.853206928 0.14679307  653.4613
## [15,] 0.009171327 0.012513120 0.09568031 0.882635239 0.11736476  497.6369
## [16,] 0.006708020 0.009233810 0.07745120 0.906606973 0.09339303  376.7278
## [17,] 0.004906327 0.006802288 0.06229767 0.925993712 0.07400629  283.7164
## [18,] 0.003588547 0.005004196 0.04983226 0.941574993 0.05842501  212.6917
## [19,] 0.002624707 0.003677351 0.03966801 0.954029931 0.04597007  158.8005
## [20,] 0.001919742 0.002699914 0.03144191 0.963938434 0.03606157  118.1355
## 
## , , 2
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.725256715 0.195693860 0.06754823 0.01150119 0.98849881 5147.4268
##  [2,] 0.525997303 0.255714739 0.17932456 0.03896340 0.96103660 5370.6903
##  [3,] 0.381483076 0.251620114 0.27443616 0.09246065 0.90753935 5338.7470
##  [4,] 0.276673162 0.220958743 0.33466173 0.16770636 0.83229364 5027.5297
##  [5,] 0.200659069 0.182619991 0.36050310 0.25621784 0.74378216 4522.2270
##  [6,] 0.145529337 0.145452382 0.35927030 0.34974798 0.65025202 3921.1465
##  [7,] 0.105546129 0.113052677 0.33952811 0.44187308 0.55812692 3302.3176
##  [8,] 0.076548039 0.086389358 0.30880123 0.52826137 0.47173863 2717.0846
##  [9,] 0.055516979 0.065211187 0.27287028 0.60640156 0.39359844 2193.8061
## [10,] 0.040264062 0.048781463 0.23578404 0.67517044 0.32482956 1744.1558
## [11,] 0.029201781 0.036243475 0.20014561 0.73440914 0.26559086 1369.0274
## [12,] 0.021178788 0.026788426 0.16746091 0.78457187 0.21542813 1063.1132
## [13,] 0.015360058 0.019720724 0.13845826 0.82646096 0.17353904  818.0938
## [14,] 0.011139985 0.014472510 0.11334749 0.86104001 0.13895999  624.6810
## [15,] 0.008079349 0.010595087 0.09201525 0.88931032 0.11068968  473.8192
## [16,] 0.005859602 0.007741606 0.07416428 0.91223451 0.08776549  357.3143
## [17,] 0.004249716 0.005648055 0.05940835 0.93069388 0.06930612  268.0956
## [18,] 0.003082135 0.004115713 0.04733369 0.94546846 0.05453154  200.2610
## [19,] 0.002235339 0.002996241 0.03753661 0.95723181 0.04276819  149.0030
## [20,] 0.001621195 0.002179611 0.02964456 0.96655463 0.03344537  110.4778
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.723813820 0.196319378 0.07009517 0.00977163 0.99022837 5170.8350
##  [2,] 0.523906446 0.254932343 0.18406551 0.03709570 0.96290430 5405.2276
##  [3,] 0.379210726 0.249374185 0.27961155 0.09180354 0.90819646 5368.1290
##  [4,] 0.274477964 0.217773085 0.33881043 0.16893852 0.83106148 5042.4115
##  [5,] 0.198670943 0.179049427 0.36284589 0.25943374 0.74056626 4520.2834
##  [6,] 0.143800774 0.141910795 0.35961701 0.35467142 0.64532858 3904.4632
##  [7,] 0.104084988 0.109793458 0.33806854 0.44805301 0.55194699 3274.9184
##  [8,] 0.075338153 0.083537188 0.30591474 0.53520992 0.46479008 2683.2879
##  [9,] 0.054530796 0.062802956 0.26899097 0.61367528 0.38632472 2157.3580
## [10,] 0.039470144 0.046801163 0.23132000 0.68240870 0.31759130 1707.9002
## [11,] 0.028569036 0.034647508 0.19543897 0.74134449 0.25865551 1334.8883
## [12,] 0.020678663 0.025522152 0.16277481 0.79102438 0.20897562 1032.2268
## [13,] 0.014967502 0.018728362 0.13397937 0.83232477 0.16767523  790.9904
## [14,] 0.010833685 0.013702451 0.10919635 0.86626752 0.13373248  601.4637
## [15,] 0.007841571 0.010002283 0.08825934 0.89389681 0.10610319  454.3154
## [16,] 0.005675837 0.007288219 0.07083113 0.91620481 0.08379519  341.1920
## [17,] 0.004108249 0.005303147 0.05649707 0.93409153 0.06590847  254.9477
## [18,] 0.002973608 0.003854489 0.04482450 0.94834741 0.05165259  189.6614
## [19,] 0.002152338 0.002799127 0.03539825 0.95965029 0.04034971  140.5419
## [20,] 0.001557892 0.002031331 0.02783980 0.96857097 0.03142903  103.7816
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.719602413 0.200984072 0.07100522 0.008408293 0.99159171 5183.9788
##  [2,] 0.517827633 0.258761791 0.18763602 0.035774557 0.96422544 5432.0195
##  [3,] 0.372630015 0.251018605 0.28462287 0.091728511 0.90827149 5395.1565
##  [4,] 0.268145458 0.217439060 0.34373886 0.170676625 0.82932337 5059.8051
##  [5,] 0.192958118 0.177370455 0.36666655 0.263004872 0.73699513 4524.3252
##  [6,] 0.138853128 0.139505171 0.36188017 0.359761534 0.64023847 3895.8706
##  [7,] 0.099919046 0.107128306 0.33874840 0.454204251 0.54579575 3256.6264
##  [8,] 0.071901986 0.080917270 0.30523066 0.541950086 0.45804991 2658.8303
##  [9,] 0.051740843 0.060401782 0.26726700 0.620590378 0.37940962 2129.9543
## [10,] 0.037232835 0.044699548 0.22889375 0.689173869 0.31082613 1680.0673
## [11,] 0.026792838 0.032866815 0.19261153 0.747728819 0.25227118 1308.3697
## [12,] 0.019280191 0.024049068 0.15978916 0.796881581 0.20311842 1008.0818
## [13,] 0.013874072 0.017531797 0.13101639 0.837577738 0.16242226  769.7430
## [14,] 0.009983816 0.012744279 0.10638028 0.870891629 0.12910837  583.2565
## [15,] 0.007184378 0.009243703 0.08566735 0.897904572 0.10209543  439.0426
## [16,] 0.005169896 0.006693183 0.06850389 0.919633033 0.08036697  328.6027
## [17,] 0.003720269 0.004839936 0.05444856 0.936991233 0.06300877  244.7205
## [18,] 0.002677115 0.003496178 0.04305036 0.950776352 0.04922365  181.4551
## [19,] 0.001926458 0.002523438 0.03388236 0.961667746 0.03833225  134.0264
## [20,] 0.001386284 0.001820176 0.02655931 0.970234231 0.02976577   98.6556
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.729922871 0.192137292 0.07062890 0.007310938 0.99268906 5184.5006
##  [2,] 0.532787398 0.250177805 0.18358960 0.033445201 0.96655480 5417.6825
##  [3,] 0.388893707 0.245508926 0.27835999 0.087237379 0.91276262 5379.8991
##  [4,] 0.283862411 0.215190258 0.33744798 0.163499353 0.83650065 5056.7480
##  [5,] 0.207197666 0.177662837 0.36193841 0.253201090 0.74679891 4539.1831
##  [6,] 0.151238315 0.141461162 0.35948648 0.347814039 0.65218596 3928.1294
##  [7,] 0.110392305 0.109996297 0.33880888 0.440802520 0.55919748 3302.3100
##  [8,] 0.080577868 0.084145461 0.30745909 0.527817584 0.47218242 2712.8057
##  [9,] 0.058815629 0.063626299 0.27118200 0.606376073 0.39362393 2187.3578
## [10,] 0.042930873 0.047704810 0.23396539 0.675398927 0.32460107 1736.9875
## [11,] 0.031336226 0.035543190 0.19834862 0.734771963 0.26522804 1362.0386
## [12,] 0.022873028 0.026357088 0.16578213 0.784987749 0.21501225 1056.7942
## [13,] 0.016695546 0.019475114 0.13695087 0.826878472 0.17312153  812.6566
## [14,] 0.012186461 0.014350630 0.11203343 0.861429481 0.13857052  620.1647
## [15,] 0.008895177 0.010552265 0.09089560 0.889656957 0.11034304  470.1654
## [16,] 0.006492793 0.007746631 0.07322742 0.912533160 0.08746684  354.4177
## [17,] 0.004739238 0.005679785 0.05863579 0.930945185 0.06905482  265.8358
## [18,] 0.003459278 0.004160304 0.04670417 0.945676245 0.05432376  198.5206
## [19,] 0.002525006 0.003044997 0.03702865 0.957401343 0.04259866  147.6762
## [20,] 0.001843060 0.002227360 0.02923801 0.966691574 0.03330843  109.4749
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.723522625 0.199978632 0.06674884 0.009749903 0.99025010 5152.22610
##  [2,] 0.523484989 0.263551010 0.17605384 0.036910162 0.96308984 5363.75747
##  [3,] 0.378753233 0.261333477 0.26821156 0.091701731 0.90829827 5311.69913
##  [4,] 0.274036534 0.231072176 0.32557516 0.169316132 0.83068387 4978.49107
##  [5,] 0.198271632 0.192144567 0.34895567 0.260628133 0.73937187 4453.80417
##  [6,] 0.143454012 0.153855677 0.34582669 0.356863620 0.64313638 3838.40614
##  [7,] 0.103792223 0.120135433 0.32481649 0.451255857 0.54874414 3211.13913
##  [8,] 0.075096022 0.092161512 0.29343951 0.539302958 0.46069704 2623.03487
##  [9,] 0.054333671 0.069795935 0.25741499 0.618455403 0.38154460 2101.50957
## [10,] 0.039311640 0.052350409 0.22069990 0.687638049 0.31236195 1657.04815
## [11,] 0.028442861 0.038977170 0.18579258 0.746787385 0.25321262 1289.36462
## [12,] 0.020579053 0.028854951 0.15409458 0.796471416 0.20352858  992.12438
## [13,] 0.014889411 0.021265981 0.12623908 0.837605528 0.16239447  756.19467
## [14,] 0.010772826 0.015617494 0.10235507 0.871254612 0.12874539  571.69549
## [15,] 0.007794383 0.011436955 0.08226452 0.898504146 0.10149585  429.17838
## [16,] 0.005639412 0.008356530 0.06562154 0.920382513 0.07961749  320.21875
## [17,] 0.004080243 0.006094660 0.05200579 0.937819310 0.06218069  237.63973
## [18,] 0.002952148 0.004438464 0.04098171 0.951627680 0.04837232  175.52108
## [19,] 0.002135946 0.003228471 0.03213378 0.962501800 0.03749820  129.09503
## [20,] 0.001545405 0.002346060 0.02508526 0.971023272 0.02897673   94.59259
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.722253531 0.196209565 0.07177668 0.00976022 0.99023978 5180.7747
##  [2,] 0.521650164 0.260979910 0.18127092 0.03609901 0.96390099 5395.7389
##  [3,] 0.376763673 0.260990554 0.27480873 0.08743705 0.91256295 5364.2642
##  [4,] 0.272118893 0.232568908 0.33550472 0.15980748 0.84019252 5065.9218
##  [5,] 0.196538832 0.194760377 0.36327806 0.24542273 0.75457727 4578.4823
##  [6,] 0.141950865 0.156948763 0.36453318 0.33656719 0.66343281 3993.5130
##  [7,] 0.102524514 0.123254123 0.34713928 0.42708208 0.57291792 3385.4863
##  [8,] 0.074048692 0.095036858 0.31823095 0.51268350 0.48731650 2804.8745
##  [9,] 0.053481929 0.072297640 0.28344760 0.59077283 0.40922717 2280.7509
## [10,] 0.038627512 0.054440109 0.24685730 0.66007508 0.33992492 1826.1750
## [11,] 0.027898857 0.040670750 0.21116662 0.72026378 0.27973622 1443.5207
## [12,] 0.020150048 0.030195920 0.17801594 0.77163809 0.22836191 1128.7613
## [13,] 0.014553443 0.022308357 0.14826689 0.81487131 0.18512869  874.5523
## [14,] 0.010511276 0.016415759 0.12224499 0.85082797 0.14917203  672.2729
## [15,] 0.007591806 0.012040805 0.09992874 0.88043865 0.11956135  513.2738
## [16,] 0.005483209 0.008808642 0.08108863 0.90461952 0.09538048  389.5672
## [17,] 0.003960267 0.006430230 0.06538480 0.92422470 0.07577530  294.1491
## [18,] 0.002860317 0.004685686 0.05243248 0.94002152 0.05997848  221.0929
## [19,] 0.002065874 0.003409437 0.04184364 0.95268105 0.04731895  165.5134
## [20,] 0.001492085 0.002477786 0.03325175 0.96277838 0.03722162  123.4634
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.719750503 0.201866569 0.07171834 0.006664584 0.99333542 5196.7117
##  [2,] 0.518040787 0.262681492 0.18941813 0.029859590 0.97014041 5469.4671
##  [3,] 0.372860117 0.257327680 0.28991616 0.079896044 0.92010396 5474.5177
##  [4,] 0.268366257 0.224907248 0.35412043 0.152606063 0.84739394 5185.0138
##  [5,] 0.193156748 0.184960545 0.38237495 0.239507757 0.76049224 4687.7688
##  [6,] 0.139024667 0.146548754 0.38215720 0.332269381 0.66773062 4084.2587
##  [7,] 0.100063074 0.113284361 0.36231883 0.424333733 0.57566627 3455.8304
##  [8,] 0.072020448 0.086075658 0.33068707 0.511216825 0.48878318 2856.6950
##  [9,] 0.051836753 0.064592589 0.29331321 0.590257448 0.40974255 2317.4389
## [10,] 0.037309529 0.048025504 0.25446752 0.660197448 0.33980255 1851.3345
## [11,] 0.026853553 0.035458976 0.21692326 0.720764209 0.27923579 1460.3373
## [12,] 0.019327858 0.026040671 0.18231024 0.772321230 0.22767877 1139.7815
## [13,] 0.013911235 0.019044624 0.15144202 0.815602117 0.18439788  881.6800
## [14,] 0.010012619 0.013882900 0.12458316 0.851521319 0.14847868  676.8622
## [15,] 0.007206587 0.010094292 0.10165180 0.881047318 0.11895268  516.2491
## [16,] 0.005186945 0.007324726 0.08236528 0.905123049 0.09487695  391.5379
## [17,] 0.003733306 0.005306490 0.06634003 0.924620170 0.07537983  295.5037
## [18,] 0.002687049 0.003839420 0.05315703 0.940316505 0.05968350  222.0716
## [19,] 0.001934005 0.002775096 0.04240231 0.952888592 0.04711141  166.2603
## [20,] 0.001392001 0.002004164 0.03369027 0.962913567 0.03708643  124.0622
## 
## , , 9
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.708783554 0.204190486 0.07308860 0.01393736 0.98606264 5170.9024
##  [2,] 0.502374127 0.266270359 0.18745342 0.04390209 0.95609791 5396.5684
##  [3,] 0.356074519 0.261076293 0.28294100 0.09990819 0.90009181 5354.2563
##  [4,] 0.252379763 0.228111560 0.34204489 0.17746378 0.82253622 5026.8569
##  [5,] 0.178882626 0.187315964 0.36591694 0.26788447 0.73211553 4504.6680
##  [6,] 0.126789063 0.148025145 0.36239316 0.36279263 0.63720737 3889.1524
##  [7,] 0.089866003 0.114000446 0.34041449 0.45571906 0.54428094 3259.8342
##  [8,] 0.063695545 0.086208054 0.30773858 0.54235782 0.45764218 2668.3611
##  [9,] 0.045146355 0.064320994 0.27026132 0.62027133 0.37972867 2142.6704
## [10,] 0.031998994 0.047505249 0.23206096 0.68843480 0.31156520 1693.6637
## [11,] 0.022680361 0.034811184 0.19571448 0.74679397 0.25320603 1321.3699
## [12,] 0.016075467 0.025352320 0.16267084 0.79590138 0.20409862 1019.6778
## [13,] 0.011394026 0.018373316 0.13358860 0.83664406 0.16335594  779.6018
## [14,] 0.008075898 0.013263188 0.10860720 0.87005372 0.12994628  591.3471
## [15,] 0.005724064 0.009543877 0.08754926 0.89718280 0.10281720  445.5044
## [16,] 0.004057122 0.006849751 0.07006347 0.91902965 0.08097035  333.6542
## [17,] 0.002875622 0.004905710 0.05572051 0.93649815 0.06350185  248.6022
## [18,] 0.002038193 0.003507277 0.04407409 0.95038044 0.04961956  184.3965
## [19,] 0.001444638 0.002503871 0.03469731 0.96135418 0.03864582  136.2299
## [20,] 0.001023936 0.001785400 0.02720215 0.96998851 0.03001149  100.2910
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.744764543 0.189414108 0.05619559 0.009625759 0.99037424 5087.6313
##  [2,] 0.554674224 0.250881700 0.15976086 0.034683216 0.96531678 5279.7533
##  [3,] 0.413101695 0.250511736 0.25060964 0.085776931 0.91422307 5241.6687
##  [4,] 0.307663495 0.223481415 0.30986573 0.158989360 0.84101064 4940.1050
##  [5,] 0.229136862 0.187839109 0.33699656 0.246027470 0.75397253 4451.9128
##  [6,] 0.170653010 0.152301438 0.33835366 0.338691892 0.66130811 3869.6377
##  [7,] 0.127096311 0.120620814 0.32176900 0.430513877 0.56948612 3268.0075
##  [8,] 0.094656826 0.094003726 0.29427258 0.517066865 0.48293314 2696.8746
##  [9,] 0.070497048 0.072427978 0.26134841 0.595726561 0.40427344 2184.2474
## [10,] 0.052503702 0.055343241 0.22689426 0.665258794 0.33474121 1742.0716
## [11,] 0.039102895 0.042030174 0.19345991 0.725407019 0.27459298 1371.7863
## [12,] 0.029122450 0.031773624 0.16255792 0.776546001 0.22345400 1068.6939
## [13,] 0.021689368 0.023936955 0.13495608 0.819417597 0.18058240  825.0384
## [14,] 0.016153472 0.017985717 0.11091834 0.854942466 0.14505753  632.0012
## [15,] 0.012030533 0.013486911 0.09038878 0.884093778 0.11590622  480.8914
## [16,] 0.008959915 0.010097787 0.07312440 0.907817897 0.09218210  363.7820
## [17,] 0.006673027 0.007551324 0.05878683 0.926988817 0.07301118  273.7884
## [18,] 0.004969834 0.005641844 0.04700260 0.942385724 0.05761428  205.1310
## [19,] 0.003701356 0.004212214 0.03740076 0.954685675 0.04531433  153.0775
## [20,] 0.002756639 0.003143119 0.02963464 0.964465599 0.03553440  113.8264</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.200856 8.023721 7.947216 7.874440 8.046125 7.884200 8.211928
##  [8] 8.246073 7.843502 8.160889</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 45233.57 44719.02 44478.82 44312.59 44843.35 43686.74 45702.15
##  [8] 46453.38 44267.61 44249.93</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.877437286 0.088697683 0.03022638 0.00363865 0.99636135 6896.4989
##  [2,] 0.769896190 0.150150911 0.06915092 0.01080198 0.98919802 6693.4730
##  [3,] 0.563111397 0.239058263 0.16169964 0.03613070 0.96386930 4982.0185
##  [4,] 0.411866495 0.251805753 0.25235712 0.08397063 0.91602937 4961.1287
##  [5,] 0.301244142 0.229998224 0.31549695 0.15326069 0.84673931 4709.7714
##  [6,] 0.220333613 0.195510372 0.34712512 0.23703090 0.76296910 4278.0789
##  [7,] 0.161154673 0.159247058 0.35206724 0.32753103 0.67246897 3746.3454
##  [8,] 0.117870479 0.126150594 0.33768679 0.41829214 0.58170786 3185.0828
##  [9,] 0.086211896 0.098029422 0.31106665 0.50469204 0.49530796 2643.9362
## [10,] 0.063056425 0.075130592 0.27795737 0.58385561 0.41614439 2152.4003
## [11,] 0.046120233 0.056994281 0.24257315 0.65431233 0.34568767 1724.3793
## [12,] 0.033732897 0.042902757 0.20775202 0.71561233 0.28438767 1363.1694
## [13,] 0.024672649 0.032103951 0.17523693 0.76798647 0.23201353 1065.6077
## [14,] 0.018045874 0.023912547 0.14596364 0.81207794 0.18792206  825.1109
## [15,] 0.013198971 0.017746767 0.12030873 0.84874553 0.15125447  633.7079
## [16,] 0.009653887 0.013133141 0.09828466 0.87892831 0.12107169  483.2952
## [17,] 0.007060970 0.009696809 0.07968403 0.90355819 0.09644181  366.3373
## [18,] 0.005164479 0.007146593 0.06418115 0.92350777 0.07649223  276.2018
## [19,] 0.003777362 0.005259396 0.05140035 0.93956289 0.06043711  207.2650
## [20,] 0.002762809 0.003866015 0.04095949 0.95241169 0.04758831  154.8864
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.804310237 0.139385700 0.04811218 0.008191885 0.99180812 6985.5406
##  [2,] 0.646914957 0.209941774 0.11866216 0.024481114 0.97551889 6897.9796
##  [3,] 0.469179417 0.248668206 0.21832240 0.063829977 0.93617002 5164.5142
##  [4,] 0.340275523 0.236403987 0.29711532 0.126205166 0.87379483 5010.7264
##  [5,] 0.246787108 0.204047241 0.34278538 0.206380269 0.79361973 4631.6789
##  [6,] 0.178984007 0.166938259 0.35773822 0.296339518 0.70366048 4108.4129
##  [7,] 0.129809353 0.132092542 0.34935676 0.388741350 0.61125865 3524.8057
##  [8,] 0.094145105 0.102208276 0.32557424 0.478072376 0.52192762 2944.3220
##  [9,] 0.068279370 0.077852756 0.29311668 0.560751198 0.43924880 2406.9523
## [10,] 0.049520071 0.058629441 0.25703048 0.634820010 0.36517999 1933.3682
## [11,] 0.035914764 0.043780940 0.22077439 0.699529906 0.30047009 1530.6266
## [12,] 0.026047424 0.032484784 0.18651458 0.754953210 0.24504679 1197.2408
## [13,] 0.018891069 0.023985641 0.15545331 0.801669975 0.19833003  927.0034
## [14,] 0.013700875 0.017643349 0.12812025 0.840535526 0.15946447  711.5943
## [15,] 0.009936651 0.012939926 0.10460419 0.872519236 0.12748076  542.2147
## [16,] 0.007206623 0.009468478 0.08472523 0.898599665 0.10140034  410.5217
## [17,] 0.005226652 0.006915751 0.06815622 0.919701379 0.08029862  309.0921
## [18,] 0.003790664 0.005043996 0.05450430 0.936661035 0.06333896  231.5940
## [19,] 0.002749205 0.003674648 0.04336312 0.950213031 0.04978697  172.7850
## [20,] 0.001993879 0.002674631 0.03434393 0.960987556 0.03901244  128.4212
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.828533542 0.121882233 0.04351764 0.006066585 0.99393342 6967.8356
##  [2,] 0.686467830 0.190687189 0.10394644 0.018898545 0.98110146 6846.4187
##  [3,] 0.496874902 0.244363527 0.20450764 0.054253931 0.94574607 5131.4127
##  [4,] 0.359644921 0.237992990 0.28869287 0.113669215 0.88633079 5019.3821
##  [5,] 0.260315964 0.207390649 0.33956388 0.192729503 0.80727050 4668.7205
##  [6,] 0.188420292 0.170301895 0.35814590 0.283131913 0.71686809 4157.7821
##  [7,] 0.136381211 0.134870789 0.35177561 0.376972387 0.62302761 3574.8097
##  [8,] 0.098714606 0.104290643 0.32877316 0.468221590 0.53177841 2988.3674
##  [9,] 0.071450996 0.079320160 0.29630551 0.552923334 0.44707667 2442.3320
## [10,] 0.051717218 0.059616114 0.25977949 0.628887174 0.37111283 1959.8037
## [11,] 0.037433637 0.044417181 0.22290585 0.695243328 0.30475667 1549.1120
## [12,] 0.027094984 0.032877520 0.18800740 0.752020098 0.24797990 1209.2740
## [13,] 0.019611724 0.024215474 0.15637192 0.799800886 0.20019911  934.1388
## [14,] 0.014195237 0.017767895 0.12856683 0.839470042 0.16052996  715.2176
## [15,] 0.010274709 0.012998816 0.10468936 0.872037116 0.12796288  543.4569
## [16,] 0.007436976 0.009488134 0.08455186 0.898523034 0.10147697  410.2492
## [17,] 0.005382986 0.006913284 0.06781181 0.919891923 0.08010808  307.9361
## [18,] 0.003896280 0.005030163 0.05405875 0.937014804 0.06298520  229.9929
## [19,] 0.002820181 0.003655978 0.04286937 0.950654472 0.04934553  171.0286
## [20,] 0.002041286 0.002654913 0.03384010 0.961463702 0.03853630  126.6900
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.908167666 0.065823806 0.02325475 0.002753780 0.99724622 6854.9430
##  [2,] 0.824768509 0.116287126 0.05140335 0.007541014 0.99245899 6606.4825
##  [3,] 0.593505410 0.231801502 0.14529313 0.029399961 0.97060004 4922.5545
##  [4,] 0.427087925 0.250918648 0.24710180 0.074891626 0.92510837 4971.1013
##  [5,] 0.307333502 0.228327470 0.31946314 0.144875891 0.85512411 4759.4695
##  [6,] 0.221157929 0.191429848 0.35578420 0.231628023 0.76837198 4334.5590
##  [7,] 0.159145780 0.153156815 0.36156365 0.326133755 0.67386625 3789.3035
##  [8,] 0.114521687 0.118959188 0.34561450 0.420904629 0.57909537 3206.5881
##  [9,] 0.082410082 0.090570592 0.31631690 0.510702431 0.48929757 2644.1464
## [10,] 0.059302494 0.067995590 0.28031995 0.592381964 0.40761804 2135.5004
## [11,] 0.042674218 0.050531628 0.24235622 0.664437930 0.33556207 1695.8057
## [12,] 0.030708470 0.037272320 0.20549945 0.726519759 0.27348024 1328.0558
## [13,] 0.022097889 0.027337809 0.17154674 0.779017558 0.22098244 1028.0966
## [14,] 0.015901694 0.019965692 0.14138626 0.822746350 0.17725365  788.1849
## [15,] 0.011442898 0.014533939 0.11530017 0.858722994 0.14127701  599.2894
## [16,] 0.008234337 0.010553253 0.09319371 0.888018696 0.11198130  452.4537
## [17,] 0.005925449 0.007647864 0.07475840 0.911668283 0.08833172  339.5164
## [18,] 0.004263967 0.005533926 0.05958244 0.930619664 0.06938034  253.4207
## [19,] 0.003068361 0.003999550 0.04722178 0.945710310 0.05428969  188.2805
## [20,] 0.002208000 0.002887923 0.03724307 0.957661007 0.04233899  139.3130
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.834725583 0.117578927 0.04322154 0.004473948 0.99552605 6975.5870
##  [2,] 0.696766798 0.184940480 0.10229575 0.015996968 0.98400303 6854.1107
##  [3,] 0.508586022 0.239689592 0.20207008 0.049654305 0.95034570 5136.8986
##  [4,] 0.371228569 0.234858051 0.28621702 0.107696359 0.89230364 5030.2044
##  [5,] 0.270968223 0.205702169 0.33772179 0.185607818 0.81439218 4686.5320
##  [6,] 0.197785903 0.169756721 0.35733241 0.275124967 0.72487503 4182.4983
##  [7,] 0.144368454 0.135129284 0.35211222 0.368390041 0.63160996 3604.9928
##  [8,] 0.105377837 0.105053522 0.33018247 0.459386174 0.54061383 3021.9420
##  [9,] 0.076917693 0.080353959 0.29859450 0.544133850 0.45586615 2477.1715
## [10,] 0.056143983 0.060753714 0.26270753 0.620394774 0.37960523 1994.0839
## [11,] 0.040980778 0.045547923 0.22623151 0.687239789 0.31276021 1581.4637
## [12,] 0.029912807 0.033934428 0.19151613 0.744636639 0.25536336 1238.8010
## [13,] 0.021834042 0.025163134 0.15988911 0.793113711 0.20688629  960.3608
## [14,] 0.015937167 0.018592359 0.13196107 0.833509407 0.16649059  737.9816
## [15,] 0.011632902 0.013699844 0.10786969 0.866797560 0.13320244  562.8445
## [16,] 0.008491121 0.010073555 0.08746206 0.893973262 0.10602674  426.4944
## [17,] 0.006197864 0.007395100 0.07042354 0.915983491 0.08401651  321.3586
## [18,] 0.004523963 0.005421988 0.05636478 0.933689265 0.06631074  240.9487
## [19,] 0.003302144 0.003971442 0.04487750 0.947848917 0.05215108  179.8762
## [20,] 0.002410310 0.002906747 0.03556811 0.959114831 0.04088517  133.7682
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.853648205 0.105857601 0.03533314 0.005161058 0.99483894 6921.1787
##  [2,] 0.728715258 0.173493397 0.08259075 0.015200597 0.98479940 6746.5160
##  [3,] 0.527241977 0.248847311 0.17766409 0.046246623 0.95375338 5025.4837
##  [4,] 0.381471499 0.253345309 0.26387070 0.101312487 0.89868751 4949.3489
##  [5,] 0.276003260 0.226867818 0.31941952 0.177709398 0.82229060 4635.4331
##  [6,] 0.199694603 0.190038913 0.34289974 0.267366743 0.73263326 4150.6622
##  [7,] 0.144483564 0.152888696 0.34063263 0.361995107 0.63800489 3582.1747
##  [8,] 0.104537127 0.119766574 0.32067859 0.455017712 0.54498229 3001.1980
##  [9,] 0.075634977 0.092091237 0.29029575 0.541978032 0.45802197 2454.9464
## [10,] 0.054723617 0.069861945 0.25510724 0.620307196 0.37969280 1969.3065
## [11,] 0.039593775 0.052467624 0.21905167 0.688886927 0.31111307 1554.5319
## [12,] 0.028646992 0.039103260 0.18464317 0.747606576 0.25239342 1210.7801
## [13,] 0.020726747 0.028970717 0.15331094 0.796991593 0.20300841  932.4582
## [14,] 0.014996270 0.021364325 0.12571710 0.837922306 0.16207769  711.2556
## [15,] 0.010850141 0.015697317 0.10201629 0.871436257 0.12856374  538.0800
## [16,] 0.007850322 0.011499861 0.08205145 0.898598365 0.10140163  404.1816
## [17,] 0.005679886 0.008405106 0.06549303 0.920421982 0.07957802  301.7264
## [18,] 0.004109526 0.006131626 0.05193289 0.937825954 0.06217405  224.0209
## [19,] 0.002973335 0.004466292 0.04094449 0.951615887 0.04838411  165.5314
## [20,] 0.002151275 0.003249248 0.03211871 0.962480767 0.03751923  121.7933
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.875942858 0.087638190 0.03205949 0.004359462 0.99564054 6902.1708
##  [2,] 0.767275891 0.149054041 0.07164369 0.012026374 0.98797363 6699.2924
##  [3,] 0.554167722 0.241150032 0.16640588 0.038276369 0.96172363 4998.1699
##  [4,] 0.400249594 0.255317130 0.25827738 0.086155897 0.91384410 4982.5519
##  [5,] 0.289081683 0.233728455 0.32246107 0.154728797 0.84527120 4737.6041
##  [6,] 0.208790266 0.198793475 0.35502455 0.237391709 0.76260829 4312.2940
##  [7,] 0.150799507 0.161804147 0.36067876 0.326717581 0.67328242 3785.3725
##  [8,] 0.108915477 0.127941678 0.34669785 0.416444993 0.58355501 3226.5904
##  [9,] 0.078664588 0.099140178 0.32014304 0.502052191 0.49794781 2685.5788
## [10,] 0.056815776 0.075697544 0.28679807 0.580688606 0.41931139 2192.2550
## [11,] 0.041035395 0.057160888 0.25094052 0.650863200 0.34913680 1761.1052
## [12,] 0.029637959 0.042797038 0.21548112 0.712083888 0.28791611 1395.9920
## [13,] 0.021406121 0.031829621 0.18223135 0.764532912 0.23546709 1094.2192
## [14,] 0.015460646 0.023547863 0.15218432 0.808807166 0.19119283  849.5448
## [15,] 0.011166506 0.017347200 0.12576049 0.845725799 0.15427420  654.2215
## [16,] 0.008065049 0.012735548 0.10300311 0.876196293 0.12380371  500.2733
## [17,] 0.005825010 0.009323799 0.08372433 0.901126857 0.09887314  380.2207
## [18,] 0.004207134 0.006810436 0.06760914 0.921373293 0.07862671  287.4387
## [19,] 0.003038617 0.004965234 0.05428585 0.937710298 0.06228970  216.2801
## [20,] 0.002194652 0.003614345 0.04337173 0.950819269 0.04918073  162.0644
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.868187222 0.094946088 0.03373206 0.003134626 0.99686537 6922.3033
##  [2,] 0.753749052 0.158688662 0.07763617 0.009926120 0.99007388 6748.4796
##  [3,] 0.542511259 0.244436171 0.17863099 0.034421579 0.96557842 5079.4424
##  [4,] 0.390472752 0.251657569 0.27592586 0.081943821 0.91805618 5085.8734
##  [5,] 0.281042960 0.225165410 0.34235912 0.151432513 0.84856749 4841.0557
##  [6,] 0.202280812 0.187669672 0.37440029 0.235649228 0.76435077 4401.5397
##  [7,] 0.145591716 0.149965988 0.37782963 0.326612663 0.67338734 3854.6942
##  [8,] 0.104789711 0.116597193 0.36088667 0.417726426 0.58227357 3276.0842
##  [9,] 0.075422447 0.088956261 0.33129314 0.504328147 0.49567185 2718.2680
## [10,] 0.054285344 0.066954446 0.29520457 0.583555643 0.41644436 2212.0938
## [11,] 0.039071904 0.049893242 0.25705969 0.653975169 0.34602483 1771.8696
## [12,] 0.028122022 0.036900853 0.21979878 0.715178349 0.28482165 1400.7961
## [13,] 0.020240840 0.027135203 0.18519186 0.767432102 0.23256790 1095.4016
## [14,] 0.014568355 0.019865408 0.15416003 0.811406210 0.18859379  848.7382
## [15,] 0.010485581 0.014492846 0.12704523 0.847976343 0.15202366  652.4927
## [16,] 0.007547002 0.010544459 0.10381837 0.878090173 0.12190983  498.2711
## [17,] 0.005431958 0.007655222 0.08423079 0.902682034 0.09731797  378.3057
## [18,] 0.003909655 0.005548138 0.06791939 0.922622821 0.07737718  285.7835
## [19,] 0.002813976 0.004015540 0.05447621 0.938694276 0.06130572  214.9433
## [20,] 0.002025361 0.002903134 0.04349214 0.951579363 0.04842064  161.0403
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.848939004 0.105918531 0.03791282 0.007229645 0.99277036 6922.5119
##  [2,] 0.720697433 0.173598689 0.08693203 0.018771851 0.98122815 6748.0624
##  [3,] 0.510818488 0.250493425 0.18665679 0.052031293 0.94796871 5048.6409
##  [4,] 0.362059744 0.253409400 0.27672691 0.107803945 0.89219605 4987.1358
##  [5,] 0.256621992 0.224770001 0.33477823 0.183829776 0.81617022 4683.6884
##  [6,] 0.181889448 0.186193138 0.35943938 0.272478033 0.72752197 4204.6063
##  [7,] 0.128920249 0.147970752 0.35729546 0.365813542 0.63418646 3637.6947
##  [8,] 0.091376552 0.114403237 0.33671307 0.457507138 0.54249286 3055.2259
##  [9,] 0.064766198 0.086756253 0.30522300 0.543254545 0.45674546 2505.4384
## [10,] 0.045905216 0.064865925 0.26866329 0.620565566 0.37943443 2015.0723
## [11,] 0.032536862 0.047984569 0.23112925 0.688349315 0.31165068 1595.0294
## [12,] 0.023061593 0.035206324 0.19524208 0.746490005 0.25350999 1245.9264
## [13,] 0.016345678 0.025665370 0.16249932 0.795489629 0.20451037  962.4728
## [14,] 0.011585547 0.018614832 0.13360295 0.836196670 0.16380333  736.5408
## [15,] 0.008211646 0.013446056 0.10872739 0.869614907 0.13038509  559.1325
## [16,] 0.005820279 0.009680447 0.08772185 0.896777424 0.10322258  421.5311
## [17,] 0.004125318 0.006950690 0.07025432 0.918669677 0.08133032  315.8952
## [18,] 0.002923958 0.004979719 0.05590897 0.936187358 0.06381264  235.4989
## [19,] 0.002072453 0.003561200 0.04424866 0.950117688 0.04988231  174.7621
## [20,] 0.001468921 0.002542964 0.03485247 0.961135650 0.03886435  129.1678
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.864575690 0.100500436 0.02981658 0.005107291 0.99489271 6887.5119
##  [2,] 0.747491124 0.164981204 0.07296874 0.014558934 0.98544107 6694.8094
##  [3,] 0.556704885 0.237233183 0.16251615 0.043545782 0.95645422 4954.5094
##  [4,] 0.414614059 0.242983646 0.24727299 0.095129304 0.90487070 4889.3928
##  [5,] 0.308789850 0.219403470 0.30444657 0.167360105 0.83263989 4602.7727
##  [6,] 0.229975732 0.185688269 0.33140034 0.252935658 0.74706434 4150.2925
##  [7,] 0.171277771 0.151213383 0.33338569 0.344123159 0.65587684 3611.5508
##  [8,] 0.127561611 0.120108353 0.31768260 0.434647440 0.56535256 3053.8486
##  [9,] 0.095003365 0.093794761 0.29106255 0.520139320 0.47986068 2523.1530
## [10,] 0.070755137 0.072372470 0.25890367 0.597968725 0.40203127 2045.7655
## [11,] 0.052695918 0.055359945 0.22507374 0.666870394 0.33312961 1633.1978
## [12,] 0.039246051 0.042076267 0.19212759 0.726550089 0.27344991 1287.1462
## [13,] 0.029229067 0.031827462 0.16159666 0.777346809 0.22265319 1003.5020
## [14,] 0.021768773 0.023988362 0.13427100 0.819971861 0.18002814  775.2166
## [15,] 0.016212610 0.018030561 0.11043554 0.855321287 0.14467871  594.1780
## [16,] 0.012074577 0.013524111 0.09005217 0.884349140 0.11565086  452.3412
## [17,] 0.008992717 0.010127696 0.07289227 0.907987317 0.09201268  342.3383
## [18,] 0.006697457 0.007574877 0.05862860 0.927099068 0.07290093  257.7524
## [19,] 0.004988028 0.005660126 0.04689613 0.942455718 0.05754428  193.1852
## [20,] 0.003714907 0.004226260 0.03733019 0.954728641 0.04527136  144.2091</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 9.244092 8.576817 8.678126 9.173664 8.793234 8.793918 9.271919
##  [8] 9.261632 8.771686 9.061804</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 51348.70 49769.39 49953.96 51037.06 50347.92 49600.61 51823.24
##  [8] 52447.48 50184.03 50096.67</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 5861.693 9131.102 7490.841 5175.763 7367.826 6500.769 5774.662
##  [8] 5902.259 6374.189 6489.786</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     8.200856      9.244092       45233.57        51348.70 5861.693
##  [2,]     8.023721      8.576817       44719.02        49769.39 9131.102
##  [3,]     7.947216      8.678126       44478.82        49953.96 7490.841
##  [4,]     7.874440      9.173664       44312.59        51037.06 5175.763
##  [5,]     8.046125      8.793234       44843.35        50347.92 7367.826
##  [6,]     7.884200      8.793918       43686.74        49600.61 6500.769
##  [7,]     8.211928      9.271919       45702.15        51823.24 5774.662
##  [8,]     8.246073      9.261632       46453.38        52447.48 5902.259
##  [9,]     7.843502      8.771686       44267.61        50184.03 6374.189
## [10,]     8.160889      9.061804       44249.93        50096.67 6489.786</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
