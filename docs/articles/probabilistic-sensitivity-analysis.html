<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (HESIM)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]      [,3]       [,4]
## [1,] 0.7273979 0.2045252 0.0557904 0.01228653
## [2,] 0.0000000 0.5914021 0.3978898 0.01070816
## [3,] 0.0000000 0.0000000 0.7496099 0.25039006
## [4,] 0.0000000 0.0000000 0.0000000 1.00000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7179068 0.1999497 0.07416283 0.007980609
## [2,] 0.0000000 0.5672024 0.42433386 0.008463769
## [3,] 0.0000000 0.0000000 0.76323358 0.236766416
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]      [,4]
## [1,] 0.7132762 0.2123993 0.06629278 0.0080317
## [2,] 0.0000000 0.5861796 0.40238865 0.0114318
## [3,] 0.0000000 0.0000000 0.75076719 0.2492328
## [4,] 0.0000000 0.0000000 0.00000000 1.0000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7268882 0.1935628 0.07292907 0.006619952
## [2,] 0.0000000 0.5922340 0.39879277 0.008973243
## [3,] 0.0000000 0.0000000 0.73869113 0.261308875
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7152639 0.2055065 0.07018802 0.009041531
## [2,] 0.0000000 0.5718185 0.41633605 0.011845464
## [3,] 0.0000000 0.0000000 0.75639895 0.243601053
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7291693 0.1935644 0.06526117 0.01200512
## [2,] 0.0000000 0.6064033 0.37844078 0.01515590
## [3,] 0.0000000 0.0000000 0.76411040 0.23588960
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 7
## 
##           [,1]     [,2]       [,3]       [,4]
## [1,] 0.7290717 0.196444 0.06124728 0.01323701
## [2,] 0.0000000 0.582911 0.40166239 0.01542657
## [3,] 0.0000000 0.000000 0.74987658 0.25012342
## [4,] 0.0000000 0.000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7268074 0.2025723 0.06476322 0.005857137
## [2,] 0.0000000 0.5812721 0.40409318 0.014634730
## [3,] 0.0000000 0.0000000 0.74758792 0.252412076
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7258468 0.1937403 0.07006739 0.01034552
## [2,] 0.0000000 0.5891226 0.39783119 0.01304625
## [3,] 0.0000000 0.0000000 0.74448982 0.25551018
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 10
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7288335 0.1970549 0.0658952 0.008216351
## [2,] 0.0000000 0.5961544 0.3937362 0.010109411
## [3,] 0.0000000 0.0000000 0.7425936 0.257406440
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.4416216 0.4765661 0.5002897 0.5884560 0.6086052 0.5329943 0.6544982
##  [8] 0.4075631 0.5306244 0.5735565</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##          [,1]       [,2]       [,3]        [,4]
## [1,] 0.879613 0.09032274 0.02463824 0.005425995
## [2,] 0.000000 0.81955435 0.17571670 0.004728953
## [3,] 0.000000 0.00000000 0.88942235 0.110577649
## [4,] 0.000000 0.00000000 0.00000000 1.000000000
## 
## , , 2
## 
##          [,1]       [,2]       [,3]        [,4]
## [1,] 0.865564 0.09528925 0.03534349 0.003803288
## [2,] 0.000000 0.79374334 0.20222311 0.004033545
## [3,] 0.000000 0.00000000 0.88716516 0.112834837
## [4,] 0.000000 0.00000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.8565551 0.1062612 0.0331656 0.004018177
## [2,] 0.0000000 0.7929699 0.2013109 0.005719213
## [3,] 0.0000000 0.0000000 0.8753114 0.124688604
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8392857 0.1139032 0.04291555 0.003895551
## [2,] 0.0000000 0.7600476 0.23467202 0.005280359
## [3,] 0.0000000 0.0000000 0.84623121 0.153768786
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8267082 0.1250723 0.04271679 0.005502722
## [2,] 0.0000000 0.7394065 0.25338427 0.007209210
## [3,] 0.0000000 0.0000000 0.85174314 0.148256857
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8556488 0.1031687 0.03478383 0.006398659
## [2,] 0.0000000 0.7902152 0.20170676 0.008078010
## [3,] 0.0000000 0.0000000 0.87427220 0.125727800
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8226779 0.1285723 0.04008624 0.008663603
## [2,] 0.0000000 0.7270160 0.26288733 0.010096665
## [3,] 0.0000000 0.0000000 0.83629466 0.163705336
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8886568 0.08256097 0.02639509 0.002387153
## [2,] 0.0000000 0.82934197 0.16469346 0.005964575
## [3,] 0.0000000 0.00000000 0.89712616 0.102873838
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8545276 0.1028033 0.03717947 0.005489585
## [2,] 0.0000000 0.7819784 0.21109896 0.006922658
## [3,] 0.0000000 0.0000000 0.86442005 0.135579950
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8444707 0.1130221 0.03779462 0.004712542
## [2,] 0.0000000 0.7683717 0.22582998 0.005798319
## [3,] 0.0000000 0.0000000 0.85236286 0.147637145
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.727397865 0.204525208 0.05579040 0.01228653 0.98771347 5076.8254
##  [2,] 0.529107655 0.269727834 0.16378134 0.03738317 0.96261683 5294.9891
##  [3,] 0.384871779 0.267733456 0.25961319 0.08778157 0.91221843 5284.7306
##  [4,] 0.279954910 0.237054104 0.32260918 0.16038180 0.83961820 5000.8327
##  [5,] 0.203638604 0.197452128 0.35177125 0.24713802 0.75286198 4518.8757
##  [6,] 0.148126286 0.158422828 0.35361648 0.33983441 0.66016559 3934.1193
##  [7,] 0.107746744 0.123987150 0.33637327 0.43189283 0.56810717 3324.7675
##  [8,] 0.078374752 0.095363184 0.30749320 0.51876886 0.48123114 2743.6022
##  [9,] 0.057009627 0.072427598 0.27281655 0.59774622 0.40225378 2220.6612
## [10,] 0.041468681 0.054493738 0.23650479 0.66753279 0.33246721 1769.0848
## [11,] 0.030164230 0.040709101 0.20128240 0.72784427 0.27215573 1390.8761
## [12,] 0.021941397 0.030244793 0.16876389 0.77904992 0.22095008 1081.4840
## [13,] 0.015960125 0.022374402 0.13976530 0.82190017 0.17809983  833.0568
## [14,] 0.011609361 0.016496516 0.11456243 0.85733170 0.14266830  636.5617
## [15,] 0.008444624 0.012130481 0.09308862 0.88633627 0.11366373  483.0556
## [16,] 0.006142602 0.008901130 0.07507788 0.90987839 0.09012161  364.3664
## [17,] 0.004468115 0.006520464 0.06016349 0.92884793 0.07115207  273.3953
## [18,] 0.003250098 0.004770058 0.04794285 0.94403699 0.05596301  204.1875
## [19,] 0.002364114 0.003485749 0.03801772 0.95613242 0.04386758  151.8740
## [20,] 0.001719652 0.002545000 0.03001730 0.96571805 0.03428195  112.5512
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.717906845 0.199949716 0.07416283 0.007980609 0.99201939 5204.3421
##  [2,] 0.515390238 0.256957223 0.19469100 0.032961539 0.96703846 5483.3966
##  [3,] 0.370002180 0.248798879 0.29585316 0.085345784 0.91465422 5480.5241
##  [4,] 0.265627098 0.215101145 0.35881926 0.160452495 0.83954751 5174.6935
##  [5,] 0.190695512 0.175117943 0.38483727 0.249349278 0.75065072 4660.0726
##  [6,] 0.136901613 0.137456826 0.38217172 0.343469843 0.65653016 4042.6776
##  [7,] 0.098282605 0.105339277 0.36016689 0.436211232 0.56378877 3405.5555
##  [8,] 0.070557755 0.079400267 0.32687940 0.523162577 0.47683742 2802.7924
##  [9,] 0.050653895 0.059144023 0.28841032 0.601791761 0.39820824 2263.9760
## [10,] 0.036364778 0.043674862 0.24897789 0.670982469 0.32901753 1801.1374
## [11,] 0.026106523 0.032043613 0.21125793 0.730591939 0.26940806 1415.0874
## [12,] 0.018742052 0.023395205 0.17677247 0.781090276 0.21890972 1100.2510
## [13,] 0.013455047 0.017017284 0.14623602 0.823291644 0.17670836  847.9931
## [14,] 0.009659470 0.012342577 0.11983112 0.858166834 0.14183317  648.7254
## [15,] 0.006934600 0.008932147 0.09741288 0.886720372 0.11327963  493.1328
## [16,] 0.004978397 0.006452906 0.07865328 0.909915412 0.09008459  372.8057
## [17,] 0.003574025 0.004655533 0.06313823 0.928632215 0.07136778  280.4992
## [18,] 0.002565817 0.003355255 0.05042978 0.943649153 0.05635085  210.1712
## [19,] 0.001842018 0.002416143 0.04010373 0.955638105 0.04436189  156.9016
## [20,] 0.001322397 0.001738753 0.03177038 0.965168473 0.03483153  116.7563
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.713276221 0.212399295 0.06629278 0.00803170 0.99196830 5161.1649
##  [2,] 0.508762967 0.276003490 0.18252258 0.03271096 0.96728904 5421.8393
##  [3,] 0.362888526 0.269848497 0.28181995 0.08544303 0.91455697 5411.6917
##  [4,] 0.258839757 0.235256938 0.34422203 0.16168128 0.83831872 5102.2432
##  [5,] 0.184624243 0.192880188 0.37025453 0.25224103 0.74775897 4585.0060
##  [6,] 0.131688083 0.152276481 0.36782701 0.34820843 0.65179157 3965.7409
##  [7,] 0.093929978 0.117231815 0.34615674 0.44268146 0.55731854 3327.9910
##  [8,] 0.066998020 0.088669554 0.31328276 0.53104967 0.46895033 2726.2778
##  [9,] 0.047788094 0.066206611 0.27532352 0.61068178 0.38931822 2190.3039
## [10,] 0.034086111 0.048959119 0.23651266 0.68044211 0.31955789 1731.9099
## [11,] 0.024312813 0.035938700 0.19952620 0.74022229 0.25977771 1351.5246
## [12,] 0.017341751 0.026230556 0.16587081 0.79055688 0.20944312 1043.1185
## [13,] 0.012369459 0.019059191 0.13623487 0.83233648 0.16766352  797.6189
## [14,] 0.008822841 0.013799372 0.11076988 0.86660791 0.13339209  605.0690
## [15,] 0.006293122 0.009962875 0.08929999 0.89444401 0.10555599  455.8755
## [16,] 0.004488735 0.007176688 0.07146964 0.91686494 0.08313506  341.4421
## [17,] 0.003201708 0.005160232 0.05684245 0.93479561 0.06520439  254.4175
## [18,] 0.002283702 0.003704863 0.04496411 0.94904732 0.05095268  188.7173
## [19,] 0.001628910 0.002656772 0.03539977 0.96031455 0.03968545  139.4259
## [20,] 0.001161863 0.001903325 0.02775403 0.96918079 0.03081921  102.6454
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.726888174 0.193562807 0.07292907 0.006619952 0.99338005 5201.74467
##  [2,] 0.528366418 0.255332988 0.18407478 0.032225816 0.96777418 5427.20296
##  [3,] 0.384063300 0.253488960 0.27633263 0.086115115 0.91388489 5375.98528
##  [4,] 0.279171071 0.224465148 0.33322340 0.163140381 0.83685962 5039.43651
##  [5,] 0.202926150 0.186973025 0.35602393 0.254076892 0.74592311 4510.32072
##  [6,] 0.147504619 0.150010735 0.35235442 0.350130221 0.64986978 3890.26493
##  [7,] 0.107219363 0.117392864 0.33086166 0.444526116 0.55547388 3258.26114
##  [8,] 0.077936487 0.090277724 0.29903940 0.532746385 0.46725361 2665.35580
##  [9,] 0.056651111 0.068551142 0.26258369 0.612214055 0.38778595 2139.01228
## [10,] 0.041179022 0.051563864 0.22543746 0.681819658 0.31818034 1689.80996
## [11,] 0.029932544 0.038508600 0.19009509 0.741463764 0.25853624 1317.57692
## [12,] 0.021757613 0.028599929 0.15796146 0.791680998 0.20831900 1016.08394
## [13,] 0.015815351 0.021149314 0.12967694 0.833358398 0.16664160  776.27766
## [14,] 0.011495992 0.015586607 0.10537879 0.867538607 0.13246139  588.32536
## [15,] 0.008356300 0.011456115 0.08489660 0.895290987 0.10470901  442.79535
## [16,] 0.006074096 0.008402169 0.06789040 0.917633338 0.08236666  331.25480
## [17,] 0.004415189 0.006151769 0.05394374 0.935489306 0.06451069  246.50058
## [18,] 0.003209348 0.004497903 0.04262304 0.949669713 0.05033029  182.57488
## [19,] 0.002332837 0.003285022 0.03351304 0.960869097 0.03913090  134.66666
## [20,] 0.001695712 0.002397052 0.02623596 0.969671273 0.03032873   98.96225
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.715263937 0.205506510 0.07018802 0.009041531 0.99095847 5177.4153
##  [2,] 0.511602499 0.264503816 0.18885288 0.035040807 0.96495919 5443.5894
##  [3,] 0.365930818 0.256385815 0.28887896 0.088804407 0.91119559 5431.1875
##  [4,] 0.261737117 0.221807313 0.35093436 0.165521209 0.83447879 5117.0137
##  [5,] 0.187211121 0.180622203 0.37616357 0.256003104 0.74399690 4595.7447
##  [6,] 0.133905363 0.141756218 0.37286924 0.351469175 0.64853083 3974.1937
##  [7,] 0.095777677 0.108577249 0.35045468 0.445190393 0.55480961 3335.7553
##  [8,] 0.068506319 0.081769414 0.31701062 0.532713646 0.46728635 2734.3614
##  [9,] 0.049000099 0.060835757 0.27863838 0.611525766 0.38847423 2199.1130
## [10,] 0.035048004 0.044856850 0.23952911 0.680566032 0.31943397 1741.4126
## [11,] 0.025068573 0.032852569 0.20231504 0.739763814 0.26023619 1361.4427
## [12,] 0.017930646 0.023937461 0.16846811 0.789663784 0.21033622 1053.0841
## [13,] 0.012825145 0.017372747 0.13865364 0.831148464 0.16885154  807.2775
## [14,] 0.009173363 0.012569709 0.11301054 0.865246385 0.13475362  614.1346
## [15,] 0.006561376 0.009072778 0.09135814 0.893007707 0.10699229  464.1508
## [16,] 0.004693116 0.006536387 0.07334105 0.915429442 0.08457056  348.8170
## [17,] 0.003356816 0.004702093 0.05852583 0.933415260 0.06658474  260.8554
## [18,] 0.002401010 0.003378591 0.04646214 0.947758263 0.05224174  194.2375
## [19,] 0.001717356 0.002425364 0.03671906 0.959138218 0.04086178  144.0861
## [20,] 0.001228363 0.001739796 0.02890456 0.968127277 0.03187272  106.5264
## 
## , , 6
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.729169332 0.193564382 0.06526117 0.01200512 0.98799488 5130.9517
##  [2,] 0.531687915 0.258519295 0.17070583 0.03908696 0.96091304 5322.9264
##  [3,] 0.387690522 0.259682801 0.26297092 0.08965576 0.91034424 5292.4312
##  [4,] 0.282692039 0.232515589 0.32451451 0.16027786 0.83972214 5009.6170
##  [5,] 0.206130366 0.195717335 0.35440711 0.24374519 0.75625481 4543.5672
##  [6,] 0.150303941 0.158583138 0.35832588 0.33278704 0.66721296 3979.9152
##  [7,] 0.109597024 0.125258831 0.34362387 0.42152027 0.57847973 3389.8868
##  [8,] 0.079914789 0.097171451 0.31712205 0.50579171 0.49420829 2822.6889
##  [9,] 0.058271413 0.074393747 0.28430523 0.58302961 0.41697039 2307.3632
## [10,] 0.042489728 0.056391885 0.24919707 0.65192131 0.34807869 1857.5846
## [11,] 0.030982206 0.042420724 0.21452799 0.71206908 0.28793092 1476.5935
## [12,] 0.022591275 0.031721120 0.18199874 0.76368887 0.23631113 1161.2454
## [13,] 0.016472865 0.023608658 0.15254603 0.80737245 0.19262755  904.9721
## [14,] 0.012011508 0.017504929 0.12657152 0.84391204 0.15608796  699.7762
## [15,] 0.008758423 0.012940047 0.10412308 0.87417845 0.12582155  537.4747
## [16,] 0.006386374 0.009542206 0.08503016 0.89904126 0.10095874  410.4055
## [17,] 0.004656748 0.007022600 0.06900037 0.91932028 0.08067972  311.7759
## [18,] 0.003395558 0.005159908 0.05568544 0.93575909 0.06424091  235.7834
## [19,] 0.002475936 0.003786245 0.04472414 0.94901368 0.05098632  177.6033
## [20,] 0.001805377 0.002775244 0.03576864 0.95965074 0.04034926  133.3057
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.729071696 0.196444011 0.06124728 0.01323701 0.98676299 5102.2349
##  [2,] 0.531545538 0.257731150 0.16948573 0.04123758 0.95876242 5306.2956
##  [3,] 0.387534807 0.254653270 0.26317001 0.09464192 0.90535808 5271.1514
##  [4,] 0.282540659 0.224569094 0.32336512 0.16952513 0.83047487 4965.1903
##  [5,] 0.205992397 0.186407224 0.34998974 0.25761064 0.74238936 4468.7163
##  [6,] 0.150183226 0.149124801 0.34993835 0.35075362 0.64924638 3877.2208
##  [7,] 0.109494340 0.116429088 0.33150671 0.44256986 0.55743014 3267.3024
##  [8,] 0.079829224 0.089377308 0.30206054 0.52873293 0.47126707 2689.7134
##  [9,] 0.058201228 0.067780992 0.26729695 0.60672083 0.39327917 2172.6839
## [10,] 0.042432868 0.050943571 0.23122947 0.67539410 0.32460590 1727.9866
## [11,] 0.030936603 0.038031253 0.19645458 0.73457757 0.26542243 1356.7051
## [12,] 0.022555001 0.028246147 0.16448719 0.78471166 0.21528834 1053.7400
## [13,] 0.016444213 0.020895786 0.13607194 0.82658806 0.17341194  810.9633
## [14,] 0.011989010 0.015410752 0.11143738 0.86116286 0.13883714  619.2491
## [15,] 0.008740848 0.011338266 0.09048849 0.88943239 0.11056761  469.6723
## [16,] 0.006372705 0.008326288 0.07294471 0.91235630 0.08764370  354.1401
## [17,] 0.004646159 0.006105365 0.05843420 0.93081428 0.06918572  265.6594
## [18,] 0.003387383 0.004471595 0.04655530 0.94558573 0.05441427  198.3864
## [19,] 0.002469645 0.003271973 0.03691427 0.95734412 0.04265588  147.5573
## [20,] 0.001800548 0.002392416 0.02914663 0.96666040 0.03333960  109.3609
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.726807386 0.202572261 0.06476322 0.005857137 0.99414286 5159.7278
##  [2,] 0.528248977 0.264980616 0.17734465 0.029425755 0.97057424 5404.8473
##  [3,] 0.383935258 0.261034425 0.27386868 0.081161633 0.91883837 5385.8652
##  [4,] 0.279046982 0.229506658 0.33508803 0.156358326 0.84364167 5076.8938
##  [5,] 0.202813407 0.189932991 0.36132182 0.245931777 0.75406822 4566.3619
##  [6,] 0.147406283 0.151487117 0.36000531 0.341101292 0.65889871 3956.3298
##  [7,] 0.107135975 0.117915656 0.33989704 0.435051331 0.56494867 3327.6472
##  [8,] 0.077867218 0.090243856 0.30869030 0.523198622 0.47680138 2733.3555
##  [9,] 0.056594469 0.068229973 0.27228300 0.602892556 0.39710744 2202.6175
## [10,] 0.041133278 0.051124648 0.23479199 0.672950082 0.32704992 1747.3216
## [11,] 0.029895970 0.038049792 0.19885070 0.733203535 0.26679647 1368.2420
## [12,] 0.021728612 0.028173376 0.16597020 0.784127807 0.21587219 1059.7970
## [13,] 0.015792516 0.020778011 0.13686921 0.826560268 0.17343973  813.3491
## [14,] 0.011478117 0.015276804 0.11174079 0.861504287 0.13849571  619.3103
## [15,] 0.008342380 0.011205128 0.09045268 0.889999813 0.11000019  468.3706
## [16,] 0.006063304 0.008203163 0.07268953 0.913044008 0.08695599  352.1350
## [17,] 0.004406854 0.005996527 0.05804933 0.931547287 0.06845271  263.3836
## [18,] 0.003202934 0.004378320 0.04610554 0.946313209 0.05368679  196.1088
## [19,] 0.002327916 0.003193821 0.03644462 0.958033639 0.04196636  145.4321
## [20,] 0.001691947 0.002328050 0.02868693 0.967293078 0.03270692  107.4659
## 
## , , 9
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.725846808 0.193740278 0.07006739 0.01034552 0.98965448 5167.2255
##  [2,] 0.526853589 0.254762531 0.18009858 0.03828530 0.96171470 5377.7837
##  [3,] 0.382414996 0.252159115 0.27234930 0.09307659 0.90692341 5325.3248
##  [4,] 0.277574704 0.222641810 0.32987286 0.16991062 0.83008938 4995.4236
##  [5,] 0.201476713 0.184940713 0.35360978 0.25997279 0.74002721 4476.4158
##  [6,] 0.146241229 0.147986900 0.35095101 0.35482086 0.64517914 3867.0122
##  [7,] 0.106148729 0.115515238 0.33040000 0.44793603 0.55206397 3244.5562
##  [8,] 0.077047716 0.088617917 0.29937257 0.53496180 0.46503820 2659.3571
##  [9,] 0.055924839 0.067134060 0.26353333 0.61340777 0.38659223 2138.7208
## [10,] 0.040592866 0.050385083 0.22682441 0.68219764 0.31780236 1693.3938
## [11,] 0.029464202 0.037547462 0.19175746 0.74123088 0.25876912 1323.5187
## [12,] 0.021386497 0.027828460 0.15976351 0.79102154 0.20897846 1023.2184
## [13,] 0.015523321 0.020537799 0.13151183 0.83242705 0.16757295  783.7684
## [14,] 0.011267553 0.015106773 0.10716747 0.86645820 0.13354180  595.6135
## [15,] 0.008178517 0.011082720 0.08658453 0.89415424 0.10584576  449.5396
## [16,] 0.005936351 0.008113588 0.06944340 0.91650666 0.08349334  337.2752
## [17,] 0.004308881 0.005930008 0.05534368 0.93441743 0.06558257  251.7299
## [18,] 0.003127588 0.004328305 0.04386386 0.94868024 0.05131976  187.0198
## [19,] 0.002270149 0.003155842 0.03459728 0.95997673 0.04002327  138.3788
## [20,] 0.001647781 0.002298997 0.02717188 0.96888135 0.03111865  102.0173
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.728833548 0.197054906 0.06589520 0.008216351 0.99178365 5153.6585
##  [2,] 0.531198340 0.261095369 0.17454763 0.033158660 0.96684134 5371.5386
##  [3,] 0.387155171 0.260328384 0.26742407 0.085092377 0.91490762 5335.2516
##  [4,] 0.282171676 0.231486729 0.32659977 0.159741824 0.84025818 5021.8381
##  [5,] 0.205656184 0.193605138 0.35226935 0.248469324 0.75153068 4515.3436
##  [6,] 0.149889126 0.155944108 0.35137406 0.342792702 0.65720730 3913.2221
##  [7,] 0.109244224 0.122503149 0.33220593 0.436046693 0.56395331 3293.2439
##  [8,] 0.079620855 0.094557898 0.30212658 0.523694663 0.47630534 2706.8474
##  [9,] 0.058030350 0.072060784 0.26683476 0.603074109 0.39692589 2182.5895
## [10,] 0.042294466 0.054394516 0.23034663 0.672964384 0.32703562 1732.3053
## [11,] 0.030825626 0.040761860 0.19525802 0.733154493 0.26684551 1356.9645
## [12,] 0.022466750 0.030374702 0.16307803 0.784080518 0.21591948 1051.2544
## [13,] 0.016374521 0.022535195 0.13454077 0.826549518 0.17345048  806.7944
## [14,] 0.011934300 0.016661134 0.10986103 0.861543534 0.13845647  614.2069
## [15,] 0.008698118 0.012284320 0.08892860 0.890088962 0.10991104  464.3413
## [16,] 0.006339481 0.009037358 0.07144775 0.913175410 0.08682459  348.9162
## [17,] 0.004620426 0.006636886 0.05703272 0.931709971 0.06829003  260.7899
## [18,] 0.003367522 0.004867086 0.04526977 0.946495617 0.05350438  194.0075
## [19,] 0.002454363 0.003565121 0.03575529 0.958225221 0.04177478  143.7255
## [20,] 0.001788822 0.002609007 0.02811710 0.967485071 0.03251493  106.0798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.122178 8.105428 7.992458 7.973720 7.981425 8.296173 8.010343
##  [8] 8.094445 7.941331 8.074241</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 44699.90 45961.49 44904.02 44332.41 45104.40 45705.87 44233.93
##  [8] 44954.56 44137.29 44572.92</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.879613020 0.090322741 0.02463824 0.005425995 0.99457401 6851.9912
##  [2,] 0.773719065 0.153473455 0.05945714 0.013350342 0.98664966 6624.2675
##  [3,] 0.562801597 0.249009573 0.14880127 0.039387555 0.96061244 4903.0296
##  [4,] 0.409380680 0.262371894 0.24202020 0.086227226 0.91377277 4903.4261
##  [5,] 0.297782633 0.238895954 0.30865535 0.154666064 0.84533394 4674.4950
##  [6,] 0.216606451 0.202187620 0.34303878 0.238167145 0.76183285 4257.4326
##  [7,] 0.157559070 0.163875659 0.34967823 0.328887045 0.67111296 3732.7850
##  [8,] 0.114608131 0.129141208 0.33611700 0.420133657 0.57986634 3173.6653
##  [9,] 0.083365710 0.099814631 0.30973464 0.507085014 0.49291499 2632.1905
## [10,] 0.060640040 0.076080970 0.27654639 0.586732596 0.41326740 2139.5452
## [11,] 0.044109435 0.057396861 0.24095690 0.657536807 0.34246319 1710.5690
## [12,] 0.032085109 0.042966115 0.20592219 0.719026585 0.28097341 1348.9526
## [13,] 0.023338640 0.031972463 0.17324714 0.771441758 0.22855824 1051.6031
## [14,] 0.016976477 0.023681922 0.14389137 0.815450236 0.18454976  811.8427
## [15,] 0.012348653 0.017477655 0.11823232 0.851941376 0.14805862  621.5458
## [16,] 0.008982384 0.012861933 0.09627124 0.881884448 0.11811555  472.4512
## [17,] 0.006533767 0.009443698 0.07778464 0.906237898 0.09376210  356.8907
## [18,] 0.004752648 0.006921343 0.06243021 0.925895800 0.07410420  268.1323
## [19,] 0.003457066 0.005065333 0.04981739 0.941660213 0.05833979  200.4860
## [20,] 0.002514662 0.003702705 0.03955192 0.954230707 0.04576929  149.2727
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.865563978 0.095289247 0.03534349 0.003803288 0.99619671 6927.4099
##  [2,] 0.749201001 0.158114145 0.08121725 0.011467606 0.98853239 6758.4816
##  [3,] 0.537856527 0.239485246 0.18464378 0.038014445 0.96198555 5094.5841
##  [4,] 0.386130882 0.243380860 0.28243700 0.088051262 0.91194874 5091.8191
##  [5,] 0.277206004 0.215252962 0.34747670 0.160064337 0.83993566 4830.2976
##  [6,] 0.199008087 0.177519252 0.37710339 0.246369273 0.75363073 4373.2904
##  [7,] 0.142869268 0.140480952 0.37790440 0.338745378 0.66125462 3812.5187
##  [8,] 0.102566826 0.108247799 0.35863574 0.430549631 0.56945037 3225.2049
##  [9,] 0.073633426 0.081906616 0.32726270 0.517197261 0.48280274 2663.7754
## [10,] 0.052861941 0.061180610 0.28999449 0.595962955 0.40403704 2158.0772
## [11,] 0.037949949 0.045271517 0.25121493 0.665563601 0.33443640 1721.1717
## [12,] 0.027244528 0.033266194 0.21376039 0.725728892 0.27427111 1355.1081
## [13,] 0.019559033 0.024316200 0.17928561 0.776839158 0.22316084 1055.4990
## [14,] 0.014041564 0.017703029 0.14860554 0.819649869 0.18035013  814.7431
## [15,] 0.010080535 0.012848807 0.12197409 0.855096564 0.14490344  624.1064
## [16,] 0.007236885 0.009303474 0.09929451 0.884165131 0.11583487  474.9565
## [17,] 0.005195409 0.006723966 0.08026939 0.907811234 0.09218877  359.4186
## [18,] 0.003729820 0.004852670 0.06450281 0.926914702 0.07308530  270.6598
## [19,] 0.002677663 0.003498222 0.05156648 0.942257639 0.05774236  202.9524
## [20,] 0.001922313 0.002519598 0.04104026 0.954517826 0.04548217  151.6137
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.856555054 0.106261174 0.03316560 0.004018177 0.99598182 6916.1868
##  [2,] 0.733686560 0.175280459 0.07882991 0.012203068 0.98779693 6745.0612
##  [3,] 0.523321177 0.258580329 0.17835190 0.039746591 0.96025341 5058.9859
##  [4,] 0.373272551 0.262727550 0.27264296 0.091356936 0.90864306 5034.6802
##  [5,] 0.266246435 0.233288344 0.33515525 0.165309972 0.83469003 4756.9995
##  [6,] 0.189907251 0.193299412 0.36314636 0.253646976 0.74635302 4289.2518
##  [7,] 0.135456326 0.153644328 0.36300934 0.347890005 0.65211000 3722.5720
##  [8,] 0.096617776 0.118833992 0.34334001 0.441208221 0.55879178 3133.5177
##  [9,] 0.068915162 0.090179603 0.31199092 0.528914310 0.47108569 2573.8076
## [10,] 0.049155547 0.067498971 0.27508837 0.608257108 0.39174289 2072.5329
## [11,] 0.035061482 0.050007120 0.23694680 0.677984595 0.32201541 1641.9873
## [12,] 0.025008522 0.036760185 0.20033850 0.737892788 0.26210721 1283.4953
## [13,] 0.017837984 0.026859861 0.16685734 0.788444814 0.21155519  992.0374
## [14,] 0.012723410 0.019533477 0.13726165 0.830481465 0.16951854  759.5019
## [15,] 0.009075306 0.014152568 0.11175506 0.865017065 0.13498293  576.7747
## [16,] 0.006473200 0.010223534 0.09019849 0.893104773 0.10689523  434.9664
## [17,] 0.004617179 0.007367730 0.07226103 0.915754062 0.08424594  326.0500
## [18,] 0.003293324 0.005299498 0.05752199 0.933885192 0.06611481  243.1248
## [19,] 0.002349050 0.003805957 0.04553640 0.948308592 0.05169141  180.4565
## [20,] 0.001675521 0.002729911 0.03587443 0.959720133 0.04027987  133.3988
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.839285696 0.113903203 0.04291555 0.003895551 0.99610445 6976.6417
##  [2,] 0.704400479 0.182169188 0.09906478 0.014365553 0.98563445 6845.7449
##  [3,] 0.512020378 0.244232518 0.19719730 0.046549805 0.95345020 5125.5747
##  [4,] 0.372181558 0.243750899 0.28040723 0.103660317 0.89633968 5019.6162
##  [5,] 0.270534373 0.216398074 0.33148328 0.181584274 0.81841573 4674.8924
##  [6,] 0.196648236 0.180523686 0.35089156 0.271936514 0.72806349 4167.6772
##  [7,] 0.142941277 0.144976047 0.34553340 0.366549278 0.63345072 3585.7440
##  [8,] 0.103902324 0.113527857 0.32348243 0.459087391 0.54091261 2998.1822
##  [9,] 0.075525371 0.087346681 0.29180519 0.545322762 0.45467724 2449.7340
## [10,] 0.054898499 0.066348576 0.25589512 0.622857804 0.37714220 1964.3063
## [11,] 0.039905070 0.049920189 0.21949048 0.690684258 0.30931574 1550.8134
## [12,] 0.029006523 0.037288570 0.18495372 0.748751185 0.25124882 1208.6144
## [13,] 0.021084499 0.027698142 0.15360950 0.797607855 0.20239214  931.7021
## [14,] 0.015326073 0.020484956 0.12605347 0.838135502 0.16186450  711.5958
## [15,] 0.011140341 0.015098445 0.10240155 0.871359667 0.12864033  539.1718
## [16,] 0.008097782 0.011098168 0.08247672 0.898327331 0.10167267  405.7183
## [17,] 0.005886182 0.008140142 0.06594125 0.920032423 0.07996758  303.4660
## [18,] 0.004278596 0.005960214 0.05238572 0.937375467 0.06262453  225.7893
## [19,] 0.003110061 0.004358019 0.04138579 0.951146128 0.04885387  167.2141
## [20,] 0.002260667 0.003182959 0.03253608 0.962020297 0.03797970  123.3234
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.826708164 0.125072322 0.04271679 0.005502722 0.99449728 6967.7917
##  [2,] 0.683446388 0.195877600 0.10338941 0.017286597 0.98271340 6854.9031
##  [3,] 0.488844554 0.252459114 0.20772430 0.050972030 0.94902797 5164.1786
##  [4,] 0.349652880 0.244821526 0.29654131 0.108984287 0.89101571 5078.5243
##  [5,] 0.250094096 0.211849417 0.35077300 0.187283483 0.81271652 4742.5520
##  [6,] 0.178883287 0.172535377 0.37107849 0.277502844 0.72249716 4235.2146
##  [7,] 0.127948764 0.135420598 0.36507154 0.371559096 0.62844090 3648.3159
##  [8,] 0.091517137 0.103730305 0.34150068 0.463251880 0.53674812 3053.8764
##  [9,] 0.065458908 0.078122273 0.30792083 0.548497994 0.45150201 2498.2841
## [10,] 0.046820396 0.058123991 0.27003054 0.625025074 0.37497493 2006.1948
## [11,] 0.033488941 0.042858269 0.23173616 0.691916631 0.30808337 1586.7686
## [12,] 0.023953432 0.031389346 0.19547895 0.749178271 0.25082173 1239.3754
## [13,] 0.017133026 0.022871594 0.16260983 0.797385547 0.20261445  957.9343
## [14,] 0.012254635 0.016599349 0.13372271 0.837423307 0.16257669  733.8769
## [15,] 0.008765299 0.012010222 0.10891875 0.870305727 0.12969427  558.0032
## [16,] 0.006269502 0.008668993 0.08800154 0.897059968 0.10294003  421.5415
## [17,] 0.004484349 0.006245514 0.07061353 0.918656609 0.08134339  316.6760
## [18,] 0.003207493 0.004492863 0.05632698 0.935972666 0.06402733  236.7425
## [19,] 0.002294204 0.003228263 0.04470134 0.949776198 0.05022380  176.2329
## [20,] 0.001640961 0.002317454 0.03531711 0.960724473 0.03927553  130.6980
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.855648811 0.103168703 0.03478383 0.006398659 0.99360134 6908.8743
##  [2,] 0.732134887 0.169801659 0.08098310 0.017080356 0.98291964 6724.6862
##  [3,] 0.533850307 0.244683527 0.17391988 0.047546291 0.95245371 4999.3043
##  [4,] 0.389267272 0.251711308 0.26033190 0.098689517 0.90131048 4941.9027
##  [5,] 0.283841757 0.227986851 0.31958417 0.168587217 0.83141278 4670.7647
##  [6,] 0.206968704 0.193193638 0.34900096 0.250836700 0.74916330 4236.8681
##  [7,] 0.150915232 0.157215032 0.35329463 0.338575104 0.66142490 3714.0735
##  [8,] 0.110042759 0.124547531 0.33930159 0.426108124 0.57389188 3166.4323
##  [9,] 0.080239805 0.096826395 0.31357925 0.509354545 0.49064545 2639.1295
## [10,] 0.058508405 0.074247416 0.28148877 0.585755409 0.41424459 2159.2405
## [11,] 0.042662535 0.056349022 0.24700507 0.653983369 0.34601663 1739.7452
## [12,] 0.031108212 0.042428181 0.21284812 0.713615486 0.28638451 1383.9265
## [13,] 0.022683154 0.031750032 0.18072618 0.764840639 0.23515936 1089.0706
## [14,] 0.016539860 0.023643975 0.15159059 0.808225578 0.19177442  849.2107
## [15,] 0.012060359 0.017539313 0.12585920 0.844541129 0.15545887  656.9911
## [16,] 0.008794044 0.012970354 0.10359499 0.874640615 0.12535938  504.8398
## [17,] 0.006412347 0.009567479 0.08464043 0.899379746 0.10062025  385.6403
## [18,] 0.004675687 0.007042953 0.06871383 0.919567527 0.08043247  293.0668
## [19,] 0.003409367 0.005175917 0.05547544 0.935939280 0.06406072  221.7050
## [20,] 0.002486006 0.003798625 0.04457063 0.949144734 0.05085527  167.0465
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.822677901 0.128572260 0.04008624 0.008663603 0.99133640 6932.0216
##  [2,] 0.676798930 0.199247648 0.10030198 0.023651439 0.97634856 6798.2762
##  [3,] 0.493434943 0.249096749 0.19669649 0.060771819 0.93922818 5064.0437
##  [4,] 0.359749451 0.242133584 0.27777243 0.120344531 0.87965547 4939.6645
##  [5,] 0.262283142 0.211812964 0.32758467 0.198319221 0.80168078 4592.7156
##  [6,] 0.191223215 0.174992067 0.34678950 0.286995212 0.71300479 4095.0065
##  [7,] 0.139415434 0.139569463 0.34204896 0.378966140 0.62103386 3528.6235
##  [8,] 0.101643847 0.108743908 0.32109313 0.468519118 0.53148088 2958.1339
##  [9,] 0.074105652 0.083355349 0.29068396 0.551855035 0.44814497 2425.4226
## [10,] 0.054028333 0.063146365 0.25599658 0.626828726 0.37317127 1952.9690
## [11,] 0.039390529 0.047422255 0.22063845 0.692548770 0.30745123 1549.2597
## [12,] 0.028718519 0.035380990 0.18691190 0.748988587 0.25101141 1213.8231
## [13,] 0.020937860 0.026265551 0.15613100 0.796665586 0.20333441  941.1170
## [14,] 0.015265201 0.019423596 0.12891125 0.836399948 0.16360005  723.2224
## [15,] 0.011129426 0.014320986 0.10540421 0.869145377 0.13085462  551.5589
## [16,] 0.008114149 0.010534170 0.08547400 0.895877682 0.10412232  417.8822
## [17,] 0.005915797 0.007734460 0.06882310 0.917526644 0.08247336  314.7958
## [18,] 0.004313040 0.005670625 0.05507780 0.934938536 0.06506146  235.9528
## [19,] 0.003144515 0.004152741 0.04384339 0.948859354 0.05114065  176.0763
## [20,] 0.002292577 0.003038400 0.03473772 0.959931299 0.04006870  130.8803
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.888656782 0.082560971 0.02639509 0.002387153 0.99761285 6880.5989
##  [2,] 0.789710876 0.141839644 0.06073316 0.007716318 0.99228368 6664.0082
##  [3,] 0.573967698 0.242420943 0.15386403 0.029747331 0.97025267 4968.7096
##  [4,] 0.417163963 0.257182461 0.25015953 0.075494042 0.92450596 4985.3078
##  [5,] 0.303197849 0.233998833 0.31795881 0.144844511 0.85515549 4753.8150
##  [6,] 0.220366436 0.197436463 0.35189557 0.230301535 0.76969847 4323.3837
##  [7,] 0.160163954 0.159404432 0.35712724 0.323304370 0.67669563 3781.5626
##  [8,] 0.116408345 0.125102121 0.34177099 0.416718542 0.58328146 3205.8762
##  [9,] 0.084606445 0.096299472 0.31359576 0.505498323 0.49450168 2650.5883
## [10,] 0.061492589 0.073115114 0.27883375 0.586558548 0.41344145 2147.5283
## [11,] 0.044693268 0.054956467 0.24198052 0.658369744 0.34163026 1711.3504
## [12,] 0.032483397 0.040998277 0.20600373 0.720514597 0.27948540 1345.1938
## [13,] 0.023609173 0.030411389 0.17267675 0.773302684 0.22669732 1045.3228
## [14,] 0.017159321 0.022459855 0.14290910 0.817471727 0.18252827  804.4659
## [15,] 0.012471521 0.016531289 0.11702428 0.853972907 0.14602709  614.0107
## [16,] 0.009064394 0.012135561 0.09497382 0.883826227 0.11617377  465.3262
## [17,] 0.006588068 0.008890258 0.07649222 0.908029458 0.09197054  350.4804
## [18,] 0.004788257 0.006502219 0.06120381 0.927505710 0.07249429  262.5637
## [19,] 0.003480140 0.004749526 0.04869284 0.943077496 0.05692250  195.7737
## [20,] 0.002529392 0.003465747 0.03854681 0.955458048 0.04454195  145.3653
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.854527615 0.102803327 0.03717947 0.005489585 0.99451041 6929.0069
##  [2,] 0.730217445 0.168238262 0.08561124 0.015933051 0.98406695 6757.2936
##  [3,] 0.530026002 0.240585486 0.18183156 0.047556952 0.95244305 5039.7649
##  [4,] 0.384717681 0.244421722 0.26822170 0.102638900 0.89736110 4963.5111
##  [5,] 0.279246101 0.218529661 0.32388307 0.178341166 0.82165883 4652.0621
##  [6,] 0.202689891 0.182841970 0.34763161 0.266836527 0.73316347 4171.8940
##  [7,] 0.147121811 0.146985525 0.34575039 0.360142278 0.63985772 3608.4916
##  [8,] 0.106787897 0.115095909 0.32619151 0.451924685 0.54807532 3031.7210
##  [9,] 0.077511654 0.088494713 0.29611735 0.537876284 0.46212372 2488.0776
## [10,] 0.056261587 0.067151361 0.26109335 0.615493705 0.38450630 2003.2837
## [11,] 0.040837293 0.050460517 0.22503835 0.683663843 0.31633616 1587.7836
## [12,] 0.029641619 0.037639257 0.19047489 0.742244236 0.25775576 1242.0965
## [13,] 0.021515274 0.027916911 0.15885760 0.791710219 0.20828978  961.0323
## [14,] 0.015616793 0.020614857 0.13088160 0.832886750 0.16711325  736.6483
## [15,] 0.011335400 0.015170279 0.10673548 0.866758842 0.13324116  560.1491
## [16,] 0.008227764 0.011133277 0.08629293 0.894346030 0.10565397  423.0023
## [17,] 0.005972096 0.008152914 0.06924987 0.916625120 0.08337488  317.5178
## [18,] 0.004334827 0.005960101 0.05521776 0.934487317 0.06551268  237.0851
## [19,] 0.003146420 0.004351061 0.04378390 0.948718619 0.05128138  176.2069
## [20,] 0.002283819 0.003172896 0.03454812 0.959995167 0.04000483  130.4229
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.844470710 0.113022128 0.03779462 0.004712542 0.99528746 6940.7082
##  [2,] 0.713130780 0.182286882 0.08965496 0.014927373 0.98507263 6789.8650
##  [3,] 0.519753636 0.249197040 0.18534204 0.045707284 0.95429272 5068.1477
##  [4,] 0.378813887 0.250979907 0.27000097 0.100205233 0.89979477 4983.5626
##  [5,] 0.276092269 0.224269903 0.32428288 0.175354949 0.82464505 4666.4325
##  [6,] 0.201225308 0.188104818 0.34730672 0.263363158 0.73663684 4183.8866
##  [7,] 0.146659755 0.151791943 0.34523119 0.356317110 0.64368289 3620.0856
##  [8,] 0.106890549 0.119391454 0.32579662 0.447921377 0.55207862 3043.6140
##  [9,] 0.077905418 0.092239044 0.29598679 0.533868752 0.46613125 2500.1915
## [10,] 0.056780082 0.070340354 0.26124933 0.611630238 0.38836976 2015.2153
## [11,] 0.041383229 0.053122503 0.22543915 0.680055121 0.31994488 1599.0882
## [12,] 0.030161486 0.039823980 0.19105287 0.738961666 0.26103833 1252.4256
## [13,] 0.021982703 0.029684709 0.15954227 0.788790319 0.21120968  970.1756
## [14,] 0.016021731 0.022028468 0.13161156 0.830338239 0.16966176  744.5259
## [15,] 0.011677175 0.016289528 0.10746306 0.864570237 0.13542976  566.7823
## [16,] 0.008510717 0.012012118 0.08698462 0.892492542 0.10750746  428.4797
## [17,] 0.006202896 0.008838155 0.06988464 0.915074307 0.08492569  321.9659
## [18,] 0.004520879 0.006491216 0.05578453 0.933203377 0.06679662  240.6458
## [19,] 0.003294968 0.004760628 0.04427896 0.947665442 0.05233456  179.0221
## [20,] 0.002401483 0.003487359 0.03497283 0.959138331 0.04086167  132.6246</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 9.194632 9.111230 8.956855 8.768751 8.735735 9.187190 8.674203
##  [8] 9.235901 8.846331 8.895702</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50884.57 51965.69 50875.39 49975.52 50607.68 51452.52 49541.45
##  [8] 51301.23 50017.05 50247.44</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 5766.847 5969.562 6191.810 7097.977 7295.795 6449.543 7994.928
##  [8] 5560.152 6496.971 6907.839</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     8.122178      9.194632       44699.90        50884.57 5766.847
##  [2,]     8.105428      9.111230       45961.49        51965.69 5969.562
##  [3,]     7.992458      8.956855       44904.02        50875.39 6191.810
##  [4,]     7.973720      8.768751       44332.41        49975.52 7097.977
##  [5,]     7.981425      8.735735       45104.40        50607.68 7295.795
##  [6,]     8.296173      9.187190       45705.87        51452.52 6449.543
##  [7,]     8.010343      8.674203       44233.93        49541.45 7994.928
##  [8,]     8.094445      9.235901       44954.56        51301.23 5560.152
##  [9,]     7.941331      8.846331       44137.29        50017.05 6496.971
## [10,]     8.074241      8.895702       44572.92        50247.44 6907.839</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
