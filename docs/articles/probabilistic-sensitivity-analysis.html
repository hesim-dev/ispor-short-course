<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-model-hesim.html">Simple Markov Cohort Model (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model-simple.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package). See Appendix for more detail.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7256022 0.1880658 0.0759393 0.010392690
## [2,] 0.0000000 0.5734406 0.4172704 0.009288903
## [3,] 0.0000000 0.0000000 0.7449681 0.255031878
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7159054 0.2142063 0.06171546 0.008172874
## [2,] 0.0000000 0.5720740 0.41529862 0.012627352
## [3,] 0.0000000 0.0000000 0.74629855 0.253701450
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##          [,1]      [,2]       [,3]       [,4]
## [1,] 0.745929 0.1884069 0.05389136 0.01177273
## [2,] 0.000000 0.6043866 0.38811003 0.00750340
## [3,] 0.000000 0.0000000 0.74473458 0.25526542
## [4,] 0.000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7193795 0.2152839 0.0570820 0.008254587
## [2,] 0.0000000 0.5851147 0.4050467 0.009838610
## [3,] 0.0000000 0.0000000 0.7583613 0.241638679
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7027302 0.2112204 0.07348486 0.012564549
## [2,] 0.0000000 0.5657967 0.42524574 0.008957532
## [3,] 0.0000000 0.0000000 0.75749019 0.242509813
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7231809 0.2041390 0.06532054 0.007359538
## [2,] 0.0000000 0.5732452 0.41370764 0.013047113
## [3,] 0.0000000 0.0000000 0.74835639 0.251643608
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7274075 0.1886173 0.07243455 0.01154065
## [2,] 0.0000000 0.5684599 0.41969037 0.01184971
## [3,] 0.0000000 0.0000000 0.76018060 0.23981940
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7228853 0.2020868 0.06590883 0.009119068
## [2,] 0.0000000 0.5947930 0.39307552 0.012131481
## [3,] 0.0000000 0.0000000 0.75229194 0.247708061
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7327262 0.1958148 0.06154985 0.009909134
## [2,] 0.0000000 0.5888950 0.39577487 0.015330126
## [3,] 0.0000000 0.0000000 0.75553699 0.244463015
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##          [,1]      [,2]       [,3]       [,4]
## [1,] 0.709384 0.2087037 0.07145296 0.01045934
## [2,] 0.000000 0.5954235 0.39400132 0.01057516
## [3,] 0.000000 0.0000000 0.76346074 0.23653926
## [4,] 0.000000 0.0000000 0.00000000 1.00000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to a normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.4381325 0.5485989 0.5591802 0.5853867 0.4610728 0.5038935 0.5908351
##  [8] 0.3336693 0.3948953 0.5877105</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8797774 0.08239774 0.03327147 0.004553375
## [2,] 0.0000000 0.81311050 0.18281973 0.004069770
## [3,] 0.0000000 0.00000000 0.88826226 0.111737745
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 2
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.844146 0.1175134 0.03385703 0.004483630
## [2,] 0.000000 0.7652403 0.22783238 0.006927352
## [3,] 0.000000 0.0000000 0.86081966 0.139180344
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8579285 0.1053534 0.03013498 0.006583078
## [2,] 0.0000000 0.7787808 0.21702343 0.004195752
## [3,] 0.0000000 0.0000000 0.85726064 0.142739359
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8357285 0.1260243 0.03341505 0.004832126
## [2,] 0.0000000 0.7571316 0.23710899 0.005759392
## [3,] 0.0000000 0.0000000 0.85854792 0.141452079
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##          [,1]       [,2]       [,3]        [,4]
## [1,] 0.862937 0.09738796 0.03388187 0.005793172
## [2,] 0.000000 0.79980068 0.19606924 0.004130074
## [3,] 0.000000 0.00000000 0.88818532 0.111814678
## [4,] 0.000000 0.00000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8605127 0.1028643 0.03291459 0.003708423
## [2,] 0.0000000 0.7849611 0.20846457 0.006574355
## [3,] 0.0000000 0.0000000 0.87319843 0.126801568
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8389428 0.1114417 0.04279687 0.006818620
## [2,] 0.0000000 0.7450310 0.24796779 0.007001225
## [3,] 0.0000000 0.0000000 0.85830629 0.141693712
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.9075353 0.06743015 0.02199175 0.003042752
## [2,] 0.0000000 0.86479488 0.13115722 0.004047902
## [3,] 0.0000000 0.00000000 0.91734744 0.082652563
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8944549 0.07732633 0.02430575 0.003913070
## [2,] 0.0000000 0.83765658 0.15628962 0.006053794
## [3,] 0.0000000 0.00000000 0.90346271 0.096537285
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8292019 0.1226573 0.04199366 0.006147063
## [2,] 0.0000000 0.7622261 0.23155872 0.006215136
## [3,] 0.0000000 0.0000000 0.86098339 0.139016612
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define an array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define a matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for the first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.725602188 0.188065818 0.07593930 0.01039269 0.98960731 5200.04460
##  [2,] 0.526498535 0.244305554 0.19014839 0.03904752 0.96095248 5427.52479
##  [3,] 0.382028488 0.239111113 0.28357791 0.09528249 0.90471751 5371.69139
##  [4,] 0.277200707 0.208962532 0.34004148 0.17379528 0.82620472 5027.07535
##  [5,] 0.201137439 0.171959587 0.36156438 0.26533859 0.73466141 4490.51688
##  [6,] 0.145945766 0.136435694 0.35638183 0.36123671 0.63876329 3865.76547
##  [7,] 0.105898567 0.105685183 0.33350671 0.45490954 0.54509046 3232.18994
##  [8,] 0.076840232 0.080520080 0.30059303 0.54204666 0.45795334 2640.26302
##  [9,] 0.055755440 0.060624508 0.26336607 0.62025398 0.37974602 2116.56239
## [10,] 0.040456269 0.045250250 0.22573017 0.68856331 0.31143669 1670.83202
## [11,] 0.029355158 0.033556774 0.19011560 0.74697247 0.25302753 1302.26405
## [12,] 0.021300167 0.024763520 0.15786152 0.79607480 0.20392520 1004.21696
## [13,] 0.015455447 0.018206242 0.12955240 0.83678591 0.16321409  767.41487
## [14,] 0.011214506 0.013346841 0.10528301 0.87015564 0.12984436  581.94037
## [15,] 0.008137270 0.009762686 0.08485335 0.89724669 0.10275331  438.36541
## [16,] 0.005904421 0.007128664 0.06790466 0.91906225 0.08093775  328.30995
## [17,] 0.004284261 0.005198285 0.05400977 0.93650769 0.06349231  244.64524
## [18,] 0.003108669 0.003786631 0.04272999 0.95037471 0.04962529  181.49200
## [19,] 0.002255657 0.002756043 0.03364860 0.96133970 0.03866030  134.11198
## [20,] 0.001636710 0.002004639 0.02638844 0.96997021 0.03002979   98.75401
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.715905364 0.214206306 0.06171546 0.008172874 0.99182713 5134.00579
##  [2,] 0.512520490 0.275893308 0.17920017 0.032386037 0.96761396 5404.78226
##  [3,] 0.366916168 0.267616517 0.27994537 0.085521945 0.91447805 5400.96482
##  [4,] 0.262677253 0.231692216 0.34270799 0.162922539 0.83707746 5088.96138
##  [5,] 0.188052054 0.188812224 0.36819518 0.254940540 0.74505946 4564.33199
##  [6,] 0.134627474 0.148296506 0.36480270 0.352273316 0.64772668 3937.15781
##  [7,] 0.096380531 0.113674633 0.34214766 0.447797176 0.55220282 3293.49698
##  [8,] 0.068999339 0.085675623 0.30850139 0.536823649 0.46317635 2688.73300
##  [9,] 0.049396997 0.063792892 0.27007343 0.616736678 0.38326332 2152.41467
## [10,] 0.035363575 0.047075405 0.23109707 0.686463950 0.31353605 1695.76820
## [11,] 0.025316973 0.034505718 0.19420024 0.745977071 0.25402293 1318.50219
## [12,] 0.018124557 0.025162880 0.16082398 0.795888581 0.20411142 1013.94463
## [13,] 0.012975467 0.018277425 0.13159138 0.837155729 0.16284427  772.52757
## [14,] 0.009289207 0.013235467 0.10659783 0.870877495 0.12912251  583.95379
## [15,] 0.006650193 0.009561474 0.08562377 0.898164568 0.10183543  438.42204
## [16,] 0.004760909 0.006894384 0.06828218 0.920062529 0.07993747  327.22944
## [17,] 0.003408360 0.004963915 0.05411594 0.937511784 0.06248822  242.98884
## [18,] 0.002440063 0.003569819 0.04265850 0.951331614 0.04866839  179.62533
## [19,] 0.001746854 0.002564878 0.03346911 0.962219158 0.03778084  132.25920
## [20,] 0.001250582 0.001841487 0.02615095 0.970756984 0.02924302   97.04111
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.745929019 0.188406892 0.05389136 0.01177273 0.98822727 5063.5655
##  [2,] 0.556410102 0.254408763 0.15345649 0.03572465 0.96427535 5240.9431
##  [3,] 0.415042442 0.258592737 0.24300864 0.08335618 0.91664382 5214.0151
##  [4,] 0.309592202 0.234486834 0.30370657 0.15221439 0.84778561 4939.2035
##  [5,] 0.230933807 0.200049997 0.33387182 0.23514437 0.76485563 4480.9566
##  [6,] 0.172260229 0.164417052 0.33873264 0.32459008 0.67540992 3923.8799
##  [7,] 0.128493903 0.131826472 0.32536115 0.41431847 0.58568153 3339.3675
##  [8,] 0.095847331 0.103883286 0.30039559 0.49987380 0.50012620 2777.0260
##  [9,] 0.071495306 0.080843961 0.26919847 0.57846226 0.42153774 2266.2078
## [10,] 0.053330423 0.062331212 0.23571074 0.64862763 0.35137237 1820.7503
## [11,] 0.039780710 0.047719967 0.20260736 0.70989197 0.29010803 1443.9391
## [12,] 0.029673586 0.036336267 0.17155314 0.76243701 0.23756299 1132.6062
## [13,] 0.022134389 0.027551860 0.14346317 0.80685058 0.19314942  880.1317
## [14,] 0.016510683 0.020822246 0.11872799 0.84393908 0.15606092  678.4643
## [15,] 0.012315798 0.015695412 0.09739195 0.87459684 0.12540316  519.3792
## [16,] 0.009186711 0.011806477 0.07928641 0.89972040 0.10027960  395.1900
## [17,] 0.006852634 0.008866516 0.06412463 0.92015622 0.07984378  299.0973
## [18,] 0.005111579 0.006649887 0.05156631 0.93667222 0.06332778  225.3066
## [19,] 0.003812875 0.004982159 0.04125957 0.94994539 0.05005461  169.0122
## [20,] 0.002844134 0.003729522 0.03286654 0.96055981 0.03944019  126.3104
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.719379525 0.215283889 0.05708200 0.008254587 0.99174541 5106.5944
##  [2,] 0.517506900 0.280836579 0.17155244 0.030104080 0.96989592 5373.7611
##  [3,] 0.372283868 0.275732495 0.27339100 0.078592633 0.92140737 5397.8693
##  [4,] 0.267813392 0.241481841 0.34026442 0.150440348 0.84955965 5128.9291
##  [5,] 0.192659471 0.198950472 0.37114213 0.237247927 0.76275207 4646.8942
##  [6,] 0.138595278 0.157885316 0.37304146 0.330477942 0.66952206 4052.8113
##  [7,] 0.099702605 0.122218342 0.35476245 0.423316607 0.57668339 3429.5804
##  [8,] 0.071724013 0.092976107 0.32423348 0.511066398 0.48893360 2833.1409
##  [9,] 0.051596786 0.069842707 0.28763995 0.590920556 0.40907944 2295.3921
## [10,] 0.037117672 0.051973948 0.24936982 0.661538559 0.33846144 1830.4236
## [11,] 0.026701693 0.038401555 0.21228306 0.722613696 0.27738630 1440.6116
## [12,] 0.019208651 0.028217757 0.17806587 0.774507723 0.22549228 1121.4463
## [13,] 0.013818310 0.020645936 0.14756425 0.817971507 0.18202849  864.9455
## [14,] 0.009940610 0.015055099 0.12105836 0.853945928 0.14605407  661.8717
## [15,] 0.007151071 0.010949012 0.09847143 0.883428488 0.11657151  503.0576
## [16,] 0.005144334 0.007945938 0.07951998 0.907389746 0.09261025  380.1172
## [17,] 0.003700729 0.005756777 0.06381700 0.926725491 0.07327451  285.7605
## [18,] 0.002662228 0.004165082 0.05093936 0.942233334 0.05776667  213.8681
## [19,] 0.001915153 0.003010185 0.04046946 0.954605207 0.04539479  159.4338
## [20,] 0.001377722 0.002173605 0.03201906 0.964429618 0.03557038  118.4408
## 
## , , 5
## 
##            State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.7027302239 0.211220364 0.07348486 0.01256455 0.98743545 5181.72186
##  [2,] 0.4938297676 0.267938725 0.19712466 0.04110685 0.95889315 5463.33590
##  [3,] 0.3470291031 0.255905757 0.29954881 0.09751633 0.90248367 5450.24625
##  [4,] 0.2438678394 0.218090254 0.36122950 0.17681240 0.82318760 5122.09481
##  [5,] 0.1713733014 0.174904606 0.38429035 0.26943174 0.73056826 4581.92658
##  [6,] 0.1204291984 0.135157985 0.37806695 0.36634587 0.63365413 3942.92762
##  [7,] 0.0846292376 0.101909045 0.35270709 0.46075463 0.53924537 3291.69902
##  [8,] 0.0594715231 0.075535222 0.31672751 0.54826574 0.45173426 2682.97363
##  [9,] 0.0417924367 0.055299178 0.27640927 0.62649911 0.37350089 2145.28056
## [10,] 0.0293688084 0.040115508 0.23596416 0.69455152 0.30544848 1688.87271
## [11,] 0.0206383493 0.028900514 0.19795765 0.75250349 0.24749651 1312.69407
## [12,] 0.0145031918 0.020711056 0.16375740 0.80102835 0.19897165 1009.54421
## [13,] 0.0101918312 0.014781617 0.13391768 0.84110887 0.15889113  769.53020
## [14,] 0.0071621079 0.010516113 0.10847609 0.87384569 0.12615431  582.18202
## [15,] 0.0050330297 0.007462765 0.08716781 0.90033639 0.09966361  437.62826
## [16,] 0.0035368621 0.005285487 0.06957212 0.92160553 0.07839447  327.15850
## [17,] 0.0024854599 0.003737568 0.05520774 0.93856923 0.06143077  243.41169
## [18,] 0.0017466078 0.002639684 0.04359135 0.95202236 0.04797764  180.35359
## [19,] 0.0012273941 0.001862443 0.03427088 0.96263928 0.03736072  133.14797
## [20,] 0.0008625269 0.001313015 0.02684205 0.97098241 0.02901759   97.98552
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.723180907 0.204139012 0.06532054 0.007359538 0.99264046 5156.3169
##  [2,] 0.522990624 0.264651155 0.18057548 0.031782737 0.96821726 5412.1750
##  [3,] 0.378216834 0.258472806 0.27878505 0.084525307 0.91547469 5396.8149
##  [4,] 0.273519193 0.225377119 0.34026808 0.160835608 0.83916439 5083.7212
##  [5,] 0.197803858 0.185032300 0.36574845 0.251415391 0.74858461 4565.3275
##  [6,] 0.143047973 0.146448371 0.36318012 0.347323533 0.65267647 3947.1876
##  [7,] 0.103449563 0.113152505 0.34171895 0.441678985 0.55832102 3312.0950
##  [8,] 0.074812749 0.085982227 0.30929700 0.529908028 0.47009197 2713.7525
##  [9,] 0.054103152 0.064561104 0.27192270 0.609413047 0.39058695 2181.2131
## [10,] 0.039126366 0.048053910 0.23373856 0.679081166 0.32091883 1725.9028
## [11,] 0.028295441 0.035533893 0.19735577 0.738814897 0.26118510 1348.0465
## [12,] 0.020462723 0.026145839 0.16424137 0.789150071 0.21084993 1041.5636
## [13,] 0.014798250 0.019165218 0.13506445 0.830972085 0.16902792  797.4236
## [14,] 0.010701812 0.014007270 0.10997177 0.865319149 0.13468085  605.7591
## [15,] 0.007739346 0.010214258 0.08879204 0.893254356 0.10674564  457.0805
## [16,] 0.005596947 0.007435178 0.07117935 0.915788530 0.08421147  342.8909
## [17,] 0.004047605 0.005404736 0.05670910 0.933838556 0.06616144  255.9240
## [18,] 0.002927151 0.003924513 0.04493899 0.948209344 0.05179066  190.1629
## [19,] 0.002116860 0.002847254 0.03544519 0.959590700 0.04040930  140.7427
## [20,] 0.001530873 0.002064309 0.02784184 0.968562982 0.03143702  103.8011
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.727407500 0.188617305 0.07243455 0.01154065 0.98845935 5174.0787
##  [2,] 0.529121671 0.244423020 0.18691363 0.03954167 0.96045833 5407.3456
##  [3,] 0.384887072 0.238746194 0.28299679 0.09336994 0.90663006 5376.6344
##  [4,] 0.279969743 0.208314004 0.34320727 0.16850898 0.83149102 5063.6769
##  [5,] 0.203652090 0.171225300 0.36860637 0.25651624 0.74348376 4556.4354
##  [6,] 0.148138058 0.135747029 0.36682047 0.34929445 0.65070555 3954.0021
##  [7,] 0.107756734 0.105108146 0.34655184 0.44058328 0.55941672 3334.2713
##  [8,] 0.078383057 0.080074553 0.31536017 0.52618222 0.47381778 2748.2024
##  [9,] 0.057016423 0.060303575 0.27901484 0.60366516 0.39633484 2223.8343
## [10,] 0.041474174 0.045034449 0.24154046 0.67195092 0.32804908 1772.6793
## [11,] 0.030168625 0.033423026 0.20551906 0.73088929 0.26911071 1395.6162
## [12,] 0.021944884 0.024689976 0.17244417 0.78092097 0.21907903 1087.4190
## [13,] 0.015962873 0.018174447 0.14304043 0.82282225 0.17717775  839.8961
## [14,] 0.011611514 0.013342319 0.11752046 0.85752571 0.14247429  643.8952
## [15,] 0.008446302 0.009774706 0.09577749 0.88600150 0.11399850  490.4812
## [16,] 0.006143904 0.007149647 0.07752234 0.90918410 0.09081590  371.5532
## [17,] 0.004469122 0.005223134 0.06237665 0.92793109 0.07206891  280.1044
## [18,] 0.003250873 0.003812096 0.04993334 0.94300369 0.05699631  210.2697
## [19,] 0.002364709 0.002780195 0.03979373 0.95506137 0.04493863  157.2563
## [20,] 0.001720107 0.002026454 0.03158853 0.96466491 0.03533509  117.2188
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.722885301 0.202086797 0.06590883 0.009119068 0.99088093 5150.8570
##  [2,] 0.522563159 0.266285386 0.17666259 0.034488869 0.96551113 5378.7125
##  [3,] 0.377753227 0.263987797 0.27201364 0.086245340 0.91375466 5355.3761
##  [4,] 0.273072255 0.233357032 0.33329808 0.160272631 0.83972737 5053.3259
##  [5,] 0.197399919 0.193983425 0.36046227 0.248154383 0.75184562 4554.8820
##  [6,] 0.142697500 0.155271900 0.36043340 0.341597203 0.65840280 3957.2462
##  [7,] 0.103153925 0.121191919 0.34158975 0.434064407 0.56593559 3338.6333
##  [8,] 0.074568456 0.092930151 0.31141155 0.521089847 0.47891015 2751.1873
##  [9,] 0.053904441 0.070343503 0.27571568 0.600036372 0.39996363 2224.1989
## [10,] 0.038966728 0.052733199 0.23862177 0.669678299 0.33032170 1770.1523
## [11,] 0.028168475 0.039239999 0.20280962 0.729781908 0.27021809 1390.5378
## [12,] 0.020362577 0.029032153 0.16985288 0.780752395 0.21924761 1080.4294
## [13,] 0.014719807 0.021383129 0.14053285 0.823364212 0.17663579  831.7133
## [14,] 0.010640732 0.015693214 0.11509708 0.858568972 0.14143103  635.1799
## [15,] 0.007692029 0.011484565 0.09345654 0.887366863 0.11263314  481.7707
## [16,] 0.005560455 0.008385397 0.07532788 0.910726271 0.08927373  363.2413
## [17,] 0.004019571 0.006111270 0.06033113 0.929538027 0.07046197  272.4494
## [18,] 0.002905689 0.004447243 0.04805374 0.944593328 0.05540667  203.4157
## [19,] 0.002100480 0.003232390 0.03809005 0.956577076 0.04342292  151.2589
## [20,] 0.001518406 0.002347082 0.03006385 0.966070657 0.03392934  112.0702
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.732726227 0.195814786 0.06154985 0.009909134 0.99009087 5119.6479
##  [2,] 0.536887723 0.258792978 0.16910095 0.035218344 0.96478166 5331.4023
##  [3,] 0.393391716 0.257532446 0.26323114 0.085844695 0.91415530 5309.3706
##  [4,] 0.288248428 0.228691484 0.32501894 0.158041150 0.84195885 5020.1367
##  [5,] 0.211207183 0.191118576 0.35381582 0.243858421 0.75614158 4539.3621
##  [6,] 0.154757042 0.153906263 0.35596064 0.335376056 0.66462394 3959.3285
##  [7,] 0.113394544 0.120938346 0.33937893 0.426288178 0.57371182 3355.4265
##  [8,] 0.083087156 0.093424315 0.31125711 0.512231417 0.48776858 2778.6518
##  [9,] 0.060880138 0.071286806 0.27725526 0.590577797 0.40942220 2258.2435
## [10,] 0.044608474 0.053901675 0.24143729 0.660052559 0.33994744 1807.2306
## [11,] 0.032685799 0.040477426 0.20649338 0.720343398 0.27965660 1427.8906
## [12,] 0.023949742 0.030237316 0.17404514 0.771767804 0.22823220 1116.1074
## [13,] 0.017548604 0.022496318 0.14493881 0.815016266 0.18498373  864.4827
## [14,] 0.012858322 0.016684245 0.11949022 0.850967208 0.14903279  664.3816
## [15,] 0.009421630 0.012343118 0.09767392 0.880561335 0.11943867  507.1721
## [16,] 0.006903475 0.009113695 0.07926125 0.904721577 0.09527842  384.9039
## [17,] 0.005058358 0.006718812 0.06391669 0.924306143 0.07569386  290.6205
## [18,] 0.003706391 0.004947176 0.05126190 0.940084533 0.05991547  218.4453
## [19,] 0.002715770 0.003639133 0.04091636 0.952728740 0.04727126  163.5408
## [20,] 0.001989916 0.002674855 0.03252125 0.962813975 0.03718603  122.0019
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.709384018 0.208703682 0.07145296 0.01045934 0.98954066 5179.0344
##  [2,] 0.503225686 0.272318135 0.18746865 0.03698753 0.96301247 5429.2252
##  [3,] 0.356980259 0.267169673 0.28637563 0.08947444 0.91052556 5417.8969
##  [4,] 0.253236091 0.233582199 0.34940905 0.16377266 0.83622734 5119.1942
##  [5,] 0.179641636 0.191931638 0.37688626 0.25154047 0.74845953 4618.4090
##  [6,] 0.127434905 0.151772480 0.37619511 0.34459751 0.65540249 4015.3258
##  [7,] 0.090400285 0.116965037 0.35611435 0.43652032 0.56347968 3389.9618
##  [8,] 0.064128518 0.088510605 0.32442308 0.52293780 0.47706220 2795.5606
##  [9,] 0.045491746 0.066085153 0.28713975 0.60128335 0.39871665 2262.0059
## [10,] 0.032271117 0.048842949 0.24850808 0.67037785 0.32962215 1802.0513
## [11,] 0.022892615 0.035817341 0.21127622 0.73001383 0.26998617 1417.2691
## [12,] 0.016239655 0.026104260 0.17704892 0.78060716 0.21939284 1102.7170
## [13,] 0.011520152 0.018932366 0.14661539 0.82293210 0.17706790  850.2192
## [14,] 0.008172212 0.013677074 0.12021762 0.85793310 0.14206690  650.4892
## [15,] 0.005797236 0.009849222 0.09775415 0.88659940 0.11340060  494.3903
## [16,] 0.004112467 0.007074363 0.07892629 0.90988688 0.09011312  373.6064
## [17,] 0.002917318 0.005070529 0.06333828 0.92867387 0.07132613  280.9313
## [18,] 0.002069499 0.003627967 0.05056254 0.94374000 0.05626000  210.3300
## [19,] 0.001468069 0.002592089 0.04017981 0.95576004 0.04423996  156.8731
## [20,] 0.001041425 0.001849782 0.03180189 0.96530690 0.03469310  116.6107</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7.864643 7.926016 8.351146 8.230190 7.791510 8.013176 8.060842
##  [8] 8.107914 8.219291 8.090595</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 44123.98 44467.11 44935.35 45844.95 44644.71 44777.90 45204.87
##  [8] 45056.64 45238.35 45682.10</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define an array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define a matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for the first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.879777411 0.082397740 0.03327147 0.004553375 0.99544663 6906.5520
##  [2,] 0.774008293 0.139490138 0.07388922 0.012612351 0.98738765 6705.5518
##  [3,] 0.561622111 0.225553818 0.17202788 0.040796195 0.95920380 5013.1502
##  [4,] 0.407514232 0.234963649 0.26492142 0.092600700 0.90739930 4984.9790
##  [5,] 0.295693218 0.211377205 0.32634775 0.166581830 0.83341817 4706.2279
##  [6,] 0.214555646 0.176822068 0.35377487 0.254847419 0.74515258 4240.2560
##  [7,] 0.155682046 0.141747545 0.35362683 0.348943581 0.65105642 3677.6971
##  [8,] 0.112963233 0.110562275 0.33441016 0.442064330 0.55793567 3094.2551
##  [9,] 0.081966369 0.084645426 0.30383763 0.529550576 0.47044942 2540.7753
## [10,] 0.059474977 0.063954200 0.26789385 0.608676971 0.39132303 2045.6542
## [11,] 0.043155173 0.047859148 0.23077507 0.678210613 0.32178939 1620.7298
## [12,] 0.031313488 0.035560394 0.19516745 0.737958669 0.26204133 1267.0898
## [13,] 0.022721135 0.026280772 0.16260975 0.788388338 0.21161166  979.6419
## [14,] 0.016486506 0.019343532 0.13383070 0.830339263 0.16966074  750.3077
## [15,] 0.011962645 0.014192916 0.10902306 0.864821377 0.13517862  570.0648
## [16,] 0.008680121 0.010388559 0.08804943 0.892881894 0.10711811  430.1391
## [17,] 0.006298315 0.007589656 0.07058802 0.915524013 0.08447599  322.6207
## [18,] 0.004570071 0.005536715 0.05623105 0.933662163 0.06633784  240.7156
## [19,] 0.003316054 0.004034452 0.04454770 0.948101799 0.05189820  178.7802
## [20,] 0.002406136 0.002937155 0.03512189 0.959534820 0.04046518  132.2420
## 
## , , 2
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.844145987 0.117513350 0.03385703 0.00448363 0.99551637 6920.2796
##  [2,] 0.712582447 0.189124371 0.08449842 0.01379476 0.98620524 6770.1566
##  [3,] 0.510141596 0.260832795 0.18558149 0.04344412 0.95655588 5081.8618
##  [4,] 0.365213105 0.258491215 0.27830632 0.09798936 0.90201064 5035.2822
##  [5,] 0.261458021 0.226107061 0.33758994 0.17484498 0.82515502 4730.9160
##  [6,] 0.187179199 0.185355934 0.36198083 0.26548403 0.73451597 4240.4511
##  [7,] 0.134002593 0.146132281 0.35867569 0.36118944 0.63881056 3658.5518
##  [8,] 0.095933175 0.112302683 0.33663771 0.45512643 0.54487357 3062.0594
##  [9,] 0.068679075 0.084794940 0.30379194 0.54273404 0.45726596 2501.3508
## [10,] 0.049167718 0.063220474 0.26617327 0.62143854 0.37856146 2003.6549
## [11,] 0.035199433 0.046698826 0.22793451 0.69016723 0.30983277 1579.4879
## [12,] 0.025199463 0.034255126 0.19167350 0.74887191 0.25112809 1228.7415
## [13,] 0.018040431 0.024994352 0.15882696 0.79813826 0.20186174  945.3659
## [14,] 0.012915241 0.018162994 0.13002582 0.83889594 0.16110406  720.5815
## [15,] 0.009246090 0.013157103 0.10537822 0.87221859 0.12778141  544.8920
## [16,] 0.006619326 0.009507408 0.08467837 0.89919490 0.10080510  409.2313
## [17,] 0.004738811 0.006856842 0.06755227 0.92085208 0.07914792  305.5325
## [18,] 0.003392540 0.004937705 0.05355426 0.93811550 0.06188450  226.9372
## [19,] 0.002428738 0.003551436 0.04222746 0.95179237 0.04820763  167.7989
## [20,] 0.001738746 0.002551935 0.03313909 0.96257023 0.03742977  123.5773
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.857928550 0.105353395 0.03013498 0.006583078 0.99341692 6880.8304
##  [2,] 0.736041396 0.172432889 0.07455134 0.016974373 0.98302563 6690.2688
##  [3,] 0.549034637 0.242891394 0.16211017 0.045963804 0.95403620 4943.5647
##  [4,] 0.409540869 0.250242206 0.24458585 0.095631072 0.90436893 4875.7888
##  [5,] 0.305488419 0.228403350 0.30134377 0.164764466 0.83523553 4600.0338
##  [6,] 0.227872676 0.195600040 0.32952994 0.246997345 0.75300266 4165.1921
##  [7,] 0.169976842 0.161150820 0.33360705 0.335265293 0.66473471 3644.0826
##  [8,] 0.126790659 0.129422200 0.32015323 0.423633907 0.57636609 3100.0532
##  [9,] 0.094576832 0.102109273 0.29549216 0.507821737 0.49217826 2577.7008
## [10,] 0.070547604 0.079532400 0.26478973 0.585130262 0.41486974 2103.5828
## [11,] 0.052623505 0.061359969 0.23186730 0.654149227 0.34585077 1690.2388
## [12,] 0.039253399 0.046999772 0.19932997 0.714416862 0.28558314 1340.5992
## [13,] 0.029280250 0.035801642 0.16880442 0.766113688 0.23388631 1051.6891
## [14,] 0.021840988 0.027154632 0.14118742 0.809816962 0.19018304  817.3641
## [15,] 0.016291827 0.020526888 0.11686318 0.846318108 0.15368189  630.1630
## [16,] 0.012152546 0.015475668 0.09587673 0.876495057 0.12350494  482.4647
## [17,] 0.009064937 0.011642909 0.07806389 0.901228260 0.09877174  367.1460
## [18,] 0.006761800 0.008744715 0.06314413 0.921349353 0.07865065  277.9031
## [19,] 0.005043823 0.006559158 0.05078393 0.937613087 0.06238691  209.3627
## [20,] 0.003762334 0.004914558 0.04063804 0.950685065 0.04931494  157.0668
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.835728494 0.126024334 0.03341505 0.004832126 0.99516787 6917.7086
##  [2,] 0.698442117 0.200739135 0.08649583 0.014322922 0.98567708 6780.9814
##  [3,] 0.502444958 0.267818744 0.18677229 0.042964004 0.95703600 5091.8772
##  [4,] 0.361448615 0.264872975 0.27880056 0.094877854 0.90512215 5051.6324
##  [5,] 0.260018733 0.232795122 0.33934970 0.167836443 0.83216356 4766.9793
##  [6,] 0.187052152 0.192189680 0.36648498 0.254273185 0.74572682 4301.5103
##  [7,] 0.134561488 0.152722312 0.36645115 0.346265049 0.65373495 3742.1392
##  [8,] 0.096800780 0.118328983 0.34744309 0.437427146 0.56257285 3161.4581
##  [9,] 0.069636499 0.090075670 0.31694175 0.523346079 0.47665392 2608.6984
## [10,] 0.050095071 0.067696210 0.28081621 0.601392505 0.39860749 2111.8548
## [11,] 0.036037369 0.050394706 0.24323981 0.670328115 0.32967189 1683.0741
## [12,] 0.025924545 0.037244946 0.20693296 0.729897549 0.27010245 1324.0547
## [13,] 0.018649587 0.027373700 0.17349572 0.780480991 0.21951901 1030.3596
## [14,] 0.013416131 0.020031709 0.14372463 0.822827532 0.17717247  794.4779
## [15,] 0.009651290 0.014609123 0.11787480 0.857864790 0.14213521  607.8168
## [16,] 0.006942940 0.010625779 0.09585998 0.886571301 0.11342870  461.8912
## [17,] 0.004994609 0.007712002 0.07739675 0.909896634 0.09010337  348.9601
## [18,] 0.003593020 0.005587664 0.06210353 0.928715787 0.07128421  262.3051
## [19,] 0.002584745 0.004042944 0.04956528 0.943807036 0.05619296  196.2932
## [20,] 0.001859412 0.002922039 0.03937351 0.955845036 0.04415496  146.3190
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.862936992 0.097387965 0.03388187 0.005793172 0.99420683 6906.0087
##  [2,] 0.744660253 0.161930638 0.07842609 0.014983024 0.98501698 6721.6793
##  [3,] 0.523295266 0.248907235 0.18298856 0.044808938 0.95519106 5059.5205
##  [4,] 0.367735399 0.251361516 0.28291306 0.097990023 0.90200998 5056.4177
##  [5,] 0.258418780 0.219892728 0.34821727 0.173471225 0.82652878 4784.3505
##  [6,] 0.181598687 0.178997895 0.37626948 0.263133940 0.73686606 4310.4302
##  [7,] 0.127614886 0.139633764 0.37448328 0.358268066 0.64173193 3732.7695
##  [8,] 0.089678837 0.105959189 0.35242384 0.451938134 0.54806187 3132.8637
##  [9,] 0.063020029 0.078893359 0.31860633 0.539480280 0.46051972 2564.8244
## [10,] 0.044286079 0.057948718 0.27952125 0.618243950 0.38175605 2058.3549
## [11,] 0.031121166 0.042141317 0.23963141 0.687106109 0.31289389 1625.4122
## [12,] 0.021869784 0.030416843 0.20172579 0.745987582 0.25401242 1266.6208
## [13,] 0.015368558 0.021829094 0.16734704 0.795455309 0.20454469  976.2287
## [14,] 0.010799950 0.015596983 0.13717582 0.836427242 0.16357276  745.5107
## [15,] 0.007589452 0.011105891 0.11133552 0.869969133 0.13003087  564.9022
## [16,] 0.005333337 0.007886724 0.08961601 0.897163929 0.10283607  425.2171
## [17,] 0.003747897 0.005588792 0.07162896 0.919034348 0.08096565  318.2549
## [18,] 0.002633761 0.003953752 0.05691026 0.936502226 0.06349777  237.0300
## [19,] 0.001850823 0.002793324 0.04498382 0.950372031 0.04962797  175.7826
## [20,] 0.001300629 0.001971385 0.03539866 0.961329325 0.03867067  129.8756
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.860512669 0.102864313 0.03291459 0.003708423 0.99629158 6915.8389
##  [2,] 0.740482054 0.169260526 0.07850796 0.011749457 0.98825054 6744.5590
##  [3,] 0.535502483 0.248189067 0.17714500 0.039163451 0.96083655 5052.5337
##  [4,] 0.387265172 0.251590152 0.27022462 0.090920059 0.90907994 5021.8367
##  [5,] 0.280062778 0.223278788 0.33160546 0.165052975 0.83494703 4739.1708
##  [6,] 0.202536054 0.185165243 0.35882506 0.253473645 0.74652635 4269.1268
##  [7,] 0.146470207 0.147490606 0.35836307 0.347676121 0.65232388 3702.7608
##  [8,] 0.105924457 0.114448572 0.33876880 0.440858175 0.55914182 3115.8807
##  [9,] 0.076602545 0.087230414 0.30778708 0.528379956 0.47162004 2559.3290
## [10,] 0.055397498 0.065641988 0.27142604 0.607534473 0.39246553 2061.4738
## [11,] 0.040062413 0.048937748 0.23389860 0.677101239 0.32289876 1634.1255
## [12,] 0.028972372 0.036231633 0.19790233 0.736893664 0.26310634 1278.3490
## [13,] 0.020952266 0.026684003 0.16498327 0.787380462 0.21261954  989.0326
## [14,] 0.015152279 0.019573653 0.13587427 0.829399795 0.17060020  758.0797
## [15,] 0.010957839 0.014313675 0.11076991 0.863958581 0.13604142  576.4484
## [16,] 0.007924500 0.010442168 0.08953282 0.892100516 0.10789948  435.3439
## [17,] 0.005730847 0.007603623 0.07184009 0.914825438 0.08517456  326.8348
## [18,] 0.004144439 0.005528630 0.05728201 0.933044920 0.06695508  244.1049
## [19,] 0.002997179 0.004015303 0.04542531 0.947562205 0.05243779  181.4893
## [20,] 0.002167503 0.002913594 0.03585126 0.959067641 0.04093236  134.3947
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.838942793 0.111441717 0.04279687 0.00681862 0.99318138 6955.6175
##  [2,] 0.703825010 0.176520759 0.10027090 0.01938333 0.98061667 6819.1660
##  [3,] 0.511967591 0.233098553 0.20128930 0.05364455 0.94635545 5114.2973
##  [4,] 0.372409065 0.229073132 0.28792958 0.11058822 0.88941178 5025.7965
##  [5,] 0.270893147 0.200461688 0.34199355 0.18665162 0.81334838 4701.4003
##  [6,] 0.197049707 0.165049570 0.36373072 0.27417000 0.72583000 4213.1005
##  [7,] 0.143335435 0.130991050 0.36004396 0.36562956 0.63437044 3646.3944
##  [8,] 0.104263270 0.101498705 0.33905655 0.45518147 0.54481853 3069.3657
##  [9,] 0.075841885 0.077363803 0.30789450 0.53889981 0.46110019 2526.6527
## [10,] 0.055167956 0.058283313 0.27201784 0.61453089 0.38546911 2042.6566
## [11,] 0.040129585 0.043537359 0.23523970 0.68109336 0.31890664 1627.1131
## [12,] 0.029190561 0.032318377 0.20000363 0.73848743 0.26151257 1280.3140
## [13,] 0.021233433 0.023877547 0.16771700 0.78717202 0.21282798  997.1469
## [14,] 0.015445358 0.017578421 0.13905442 0.82792180 0.17207820  769.9018
## [15,] 0.011235070 0.012905890 0.11420274 0.86165630 0.13834370  590.0644
## [16,] 0.008172474 0.009455610 0.09304499 0.88932692 0.11067308  449.3675
## [17,] 0.005944719 0.006916605 0.07529140 0.91184728 0.08815272  340.3386
## [18,] 0.004324233 0.005053090 0.06056849 0.93005418 0.06994582  256.5275
## [19,] 0.003145480 0.003688104 0.04847695 0.94468947 0.05531053  192.5418
## [20,] 0.002288045 0.002689831 0.03862694 0.95639518 0.04360482  143.9789
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.907535346 0.067430150 0.02199175 0.003042752 0.99695725 6846.0022
##  [2,] 0.823620404 0.119508493 0.04897632 0.007894783 0.99210522 6591.5866
##  [3,] 0.595383084 0.237525624 0.13810421 0.028987077 0.97101292 4887.9915
##  [4,] 0.430393680 0.261597638 0.23650120 0.071507481 0.92849252 4934.6114
##  [5,] 0.311125265 0.242573323 0.30911232 0.137189090 0.86281091 4743.1861
##  [6,] 0.224907881 0.207155221 0.34839825 0.219538650 0.78046135 4348.1951
##  [7,] 0.162582601 0.168665388 0.35834826 0.310403754 0.68959625 3831.6517
##  [8,] 0.117528573 0.133176788 0.34659637 0.402698269 0.59730173 3270.5822
##  [9,] 0.084959678 0.102963594 0.32083636 0.491240366 0.50875963 2721.0290
## [10,] 0.061416102 0.078411253 0.28743467 0.572737974 0.42726203 2217.2745
## [11,] 0.044396798 0.059049848 0.25110419 0.645449161 0.35455084 1776.2959
## [12,] 0.032093792 0.044094442 0.21504085 0.708770913 0.29122909 1403.1033
## [13,] 0.023200131 0.032712797 0.18122121 0.762865862 0.23713414 1095.3158
## [14,] 0.016771034 0.024145783 0.15071895 0.808364235 0.19163576  846.5577
## [15,] 0.012123534 0.017750947 0.12398113 0.846144394 0.15385561  648.7510
## [16,] 0.008763924 0.013008145 0.10104651 0.877181419 0.12281858  493.5383
## [17,] 0.006335312 0.009508227 0.08170728 0.902449181 0.09755082  373.0866
## [18,] 0.004579704 0.006935710 0.06562273 0.922861854 0.07713815  280.4762
## [19,] 0.003310601 0.005050809 0.05239555 0.939243037 0.06075696  209.8329
## [20,] 0.002393185 0.003673215 0.04162030 0.952313301 0.04768670  156.3110
## 
## , , 9
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.894454854 0.077326331 0.02430575 0.00391307 0.99608693 6856.5649
##  [2,] 0.800049486 0.133937822 0.05578503 0.01022766 0.98977234 6618.4822
##  [3,] 0.586217241 0.235536833 0.14439981 0.03384612 0.96615388 4900.0019
##  [4,] 0.429536747 0.253496467 0.23840054 0.07856625 0.92143375 4913.9703
##  [5,] 0.314732840 0.233392448 0.30688588 0.14498883 0.85501117 4701.4152
##  [6,] 0.230613006 0.199072990 0.34360626 0.22670774 0.77329226 4299.9502
##  [7,] 0.168976198 0.162390525 0.35258952 0.31604376 0.68395624 3787.5937
##  [8,] 0.123813292 0.128719006 0.34106497 0.40640273 0.59359727 3236.3603
##  [9,] 0.090721246 0.100046452 0.31625164 0.49298066 0.50701934 2698.3693
## [10,] 0.066473836 0.076681417 0.28411956 0.57272518 0.42727482 2205.4530
## [11,] 0.048707123 0.058173863 0.24910287 0.64401614 0.35598386 1773.3692
## [12,] 0.035688987 0.043795872 0.21422810 0.70628704 0.29371296 1406.7486
## [13,] 0.026150257 0.032779601 0.18138721 0.75968293 0.24031707 1103.3237
## [14,] 0.019160979 0.024424350 0.15162763 0.80478704 0.19521296  857.0713
## [15,] 0.014039752 0.018135381 0.12540618 0.84241868 0.15758132  660.3414
## [16,] 0.010287294 0.013429026 0.10279068 0.87349300 0.12650700  505.1882
## [17,] 0.007537770 0.009922691 0.08361022 0.89892932 0.10107068  384.1298
## [18,] 0.005523122 0.007319430 0.06756171 0.91959574 0.08040426  290.5225
## [19,] 0.004046936 0.005391885 0.05428216 0.93627901 0.06372099  218.6956
## [20,] 0.002965296 0.003967704 0.04339524 0.94967176 0.05032824  163.9440
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.829201929 0.122657350 0.04199366 0.006147063 0.99385294 6958.5242
##  [2,] 0.687575840 0.195200350 0.09937944 0.017844367 0.98215563 6828.8808
##  [3,] 0.487755312 0.259726487 0.20191083 0.050607370 0.94939263 5137.0142
##  [4,] 0.346005823 0.256443586 0.29133513 0.106215457 0.89378454 5066.5120
##  [5,] 0.245451001 0.224905229 0.34818519 0.181458578 0.81854142 4755.2634
##  [6,] 0.174119018 0.185140389 0.37197688 0.268763710 0.73123629 4272.8170
##  [7,] 0.123517248 0.146576220 0.36937662 0.360529907 0.63947009 3705.3340
##  [8,] 0.087621162 0.113053432 0.34858145 0.450743956 0.54925604 3122.8832
##  [9,] 0.062157052 0.085601531 0.31693224 0.535309172 0.46469083 2572.2340
## [10,] 0.044093219 0.063941570 0.28013375 0.611831463 0.38816854 2079.5086
## [11,] 0.031279025 0.047274731 0.24221477 0.679231471 0.32076853 1655.6019
## [12,] 0.022188841 0.034676534 0.20578276 0.737351870 0.26264813 1301.4549
## [13,] 0.015740409 0.025278116 0.17235511 0.786626361 0.21337364 1012.2221
## [14,] 0.011165995 0.018336266 0.14267067 0.827827067 0.17217293  780.2103
## [15,] 0.007920978 0.013248228 0.11694581 0.861884980 0.13811502  596.7812
## [16,] 0.005619015 0.009541444 0.09506933 0.889770207 0.11022979  453.4803
## [17,] 0.003986040 0.006853909 0.07674254 0.912417510 0.08758249  342.6344
## [18,] 0.002827633 0.004912880 0.06157518 0.930684307 0.06931569  257.6063
## [19,] 0.002005878 0.003515381 0.04914796 0.945330784 0.05466922  192.8442
## [20,] 0.001422937 0.002511775 0.03905093 0.957014361 0.04298564  143.8170</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.949350 8.798654 9.193049 9.026228 8.832542 8.970149 8.845858
##  [8] 9.389116 9.378437 8.882410</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50407.43 50256.71 50605.10 51390.39 50792.05 50740.71 50761.74
##  [8] 51675.38 51581.50 51235.62</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 5792.764 6634.595 6734.437 6966.300 5905.041 6230.910 7078.669
##  [8] 5166.038 5472.260 7013.665</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     7.864643      8.949350       44123.98        50407.43 5792.764
##  [2,]     7.926016      8.798654       44467.11        50256.71 6634.595
##  [3,]     8.351146      9.193049       44935.35        50605.10 6734.437
##  [4,]     8.230190      9.026228       45844.95        51390.39 6966.300
##  [5,]     7.791510      8.832542       44644.71        50792.05 5905.041
##  [6,]     8.013176      8.970149       44777.90        50740.71 6230.910
##  [7,]     8.060842      8.845858       45204.87        50761.74 7078.669
##  [8,]     8.107914      9.389116       45056.64        51675.38 5166.038
##  [9,]     8.219291      9.378437       45238.35        51581.50 5472.260
## [10,]     8.090595      8.882410       45682.10        51235.62 7013.665</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
