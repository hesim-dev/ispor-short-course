<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model-simple.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7198586 0.2035767 0.06069571 0.01586896
## [2,] 0.0000000 0.5983387 0.39050410 0.01115724
## [3,] 0.0000000 0.0000000 0.75369264 0.24630736
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 2
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7206141 0.2044853 0.0670121 0.007888461
## [2,] 0.0000000 0.5917851 0.3963161 0.011898714
## [3,] 0.0000000 0.0000000 0.7423358 0.257664161
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7238047 0.1997647 0.06498511 0.01144545
## [2,] 0.0000000 0.5709165 0.40928520 0.01979835
## [3,] 0.0000000 0.0000000 0.75069368 0.24930632
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7169932 0.2008687 0.0725703 0.009567852
## [2,] 0.0000000 0.5975214 0.3918300 0.010648630
## [3,] 0.0000000 0.0000000 0.7523978 0.247602240
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7442515 0.1893803 0.05888376 0.007484418
## [2,] 0.0000000 0.5885096 0.39764107 0.013849366
## [3,] 0.0000000 0.0000000 0.74654662 0.253453380
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7028651 0.2050302 0.07902081 0.013083877
## [2,] 0.0000000 0.5544265 0.43677481 0.008798723
## [3,] 0.0000000 0.0000000 0.75383874 0.246161258
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7167173 0.2086092 0.05731497 0.017358548
## [2,] 0.0000000 0.5790689 0.41181639 0.009114673
## [3,] 0.0000000 0.0000000 0.74299518 0.257004825
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##          [,1]      [,2]      [,3]        [,4]
## [1,] 0.718198 0.2029916 0.0709109 0.007899474
## [2,] 0.000000 0.5738694 0.4163444 0.009786291
## [3,] 0.000000 0.0000000 0.7469398 0.253060200
## [4,] 0.000000 0.0000000 0.0000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7314287 0.1869757 0.07294275 0.008652777
## [2,] 0.0000000 0.5793784 0.40587720 0.014744363
## [3,] 0.0000000 0.0000000 0.74723956 0.252760439
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7235941 0.1974551 0.06567897 0.01327182
## [2,] 0.0000000 0.5797390 0.40984957 0.01041146
## [3,] 0.0000000 0.0000000 0.73921360 0.26078640
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.5504962 0.6186801 0.6522283 0.6624641 0.3627257 0.5359893 0.5473556
##  [8] 0.4180409 0.5865750 0.4914648</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8457832 0.1120682 0.03341276 0.008735801
## [2,] 0.0000000 0.7788869 0.21497103 0.006142020
## [3,] 0.0000000 0.0000000 0.86440873 0.135591270
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8271495 0.1265110 0.04145905 0.004880434
## [2,] 0.0000000 0.7474456 0.24519291 0.007361498
## [3,] 0.0000000 0.0000000 0.84058831 0.159411688
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8198576 0.1302922 0.04238513 0.007465046
## [2,] 0.0000000 0.7201396 0.26694740 0.012913046
## [3,] 0.0000000 0.0000000 0.83739536 0.162604640
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8125181 0.1330683 0.04807522 0.006338359
## [2,] 0.0000000 0.7333724 0.25957331 0.007054335
## [3,] 0.0000000 0.0000000 0.83597240 0.164027599
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.9072335 0.0686931 0.02135865 0.00271479
## [2,] 0.0000000 0.8507419 0.14423462 0.00502352
## [3,] 0.0000000 0.0000000 0.90806596 0.09193404
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8407388 0.1098940 0.04235431 0.007012819
## [2,] 0.0000000 0.7611773 0.23410665 0.004716022
## [3,] 0.0000000 0.0000000 0.86806019 0.131939812
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8449436 0.1141834 0.03137167 0.009501298
## [2,] 0.0000000 0.7696010 0.22541001 0.004988967
## [3,] 0.0000000 0.0000000 0.85932697 0.140673028
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8821953 0.08485879 0.02964366 0.003302303
## [2,] 0.0000000 0.82185997 0.17404896 0.004091070
## [3,] 0.0000000 0.00000000 0.89421049 0.105789509
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8424628 0.1096753 0.04278639 0.005075502
## [2,] 0.0000000 0.7532739 0.23807741 0.008648674
## [3,] 0.0000000 0.0000000 0.85173706 0.148262944
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]       [,2]      [,3]        [,4]
## [1,] 0.8641562 0.09704222 0.0322789 0.006522630
## [2,] 0.0000000 0.79345651 0.2014266 0.005116866
## [3,] 0.0000000 0.00000000 0.8718327 0.128167331
## [4,] 0.0000000 0.00000000 0.0000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.719858618 0.203576717 0.06069571 0.01586896 0.98413104 5088.4748
##  [2,] 0.518196430 0.268354274 0.16893578 0.04451352 0.95548648 5291.3576
##  [3,] 0.373028166 0.266059464 0.26357140 0.09734097 0.90265903 5264.6849
##  [4,] 0.268527540 0.235133511 0.32519034 0.17114861 0.82885139 4970.2311
##  [5,] 0.193301864 0.195355424 0.35321264 0.25813008 0.74186992 4483.7961
##  [6,] 0.139150013 0.156240461 0.35423345 0.35037607 0.64962393 3898.9727
##  [7,] 0.100168336 0.121812410 0.33644149 0.44157776 0.55842224 3292.1989
##  [8,] 0.072107040 0.093277015 0.30722151 0.52739443 0.47260557 2714.9062
##  [9,] 0.051906874 0.070490558 0.27235224 0.60525033 0.39474967 2196.2445
## [10,] 0.037365611 0.052744257 0.23594725 0.67394288 0.32605712 1748.8311
## [11,] 0.026897957 0.039165696 0.20069649 0.73323986 0.26676014 1374.3978
## [12,] 0.019362726 0.028910148 0.16819042 0.78353670 0.21646330 1068.2813
## [13,] 0.013938425 0.021239859 0.13922865 0.82559307 0.17440693  822.6108
## [14,] 0.010033695 0.015546168 0.11407586 0.86034427 0.13965573  628.3844
## [15,] 0.007222842 0.011344500 0.09265798 0.88877468 0.11122532  476.7134
## [16,] 0.005199425 0.008258255 0.07470411 0.91183821 0.08816179  359.4881
## [17,] 0.003742851 0.005999715 0.05984440 0.93041303 0.06958697  269.6715
## [18,] 0.002694324 0.004351819 0.04767437 0.94527948 0.05472052  201.3649
## [19,] 0.001939532 0.003152363 0.03779476 0.95711334 0.04288666  149.7487
## [20,] 0.001396189 0.002281024 0.02983437 0.96648842 0.03351158  110.9610
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.720614115 0.204485322 0.06701210 0.007888461 0.99211154 5163.87716
##  [2,] 0.519284703 0.268366385 0.17907618 0.033272727 0.96672727 5398.13703
##  [3,] 0.374203887 0.265001341 0.27409096 0.086703814 0.91329619 5364.59290
##  [4,] 0.269656603 0.233343060 0.33356804 0.163432299 0.83656770 5042.06046
##  [5,] 0.194318354 0.193229775 0.35816739 0.254284486 0.74571551 4520.93604
##  [6,] 0.140028549 0.154085762 0.35548225 0.350403443 0.64959656 3903.92905
##  [7,] 0.100906549 0.119819448 0.33433749 0.444936510 0.55506349 3271.81487
##  [8,] 0.072714684 0.091541278 0.30243904 0.533304994 0.46669501 2677.15939
##  [9,] 0.052399227 0.069041854 0.26566339 0.612895527 0.38710447 2148.46249
## [10,] 0.037759623 0.051572817 0.22808524 0.682582320 0.31741768 1696.90979
## [11,] 0.027210117 0.038241316 0.19228534 0.742263228 0.25773677 1322.62756
## [12,] 0.019607995 0.028194712 0.15971936 0.792477937 0.20752206 1019.49160
## [13,] 0.014129798 0.020694759 0.13105339 0.834122048 0.16587795  778.44626
## [14,] 0.010182132 0.015136187 0.10643417 0.868247515 0.13175249  589.60589
## [15,] 0.007337388 0.011039467 0.08569094 0.895932207 0.10406779  443.46889
## [16,] 0.005287425 0.008033381 0.06847827 0.918200927 0.08179907  331.53365
## [17,] 0.003810193 0.005835236 0.05437195 0.935982619 0.06401738  246.53762
## [18,] 0.002745679 0.004232335 0.04293018 0.950091810 0.04990819  182.47556
## [19,] 0.001978575 0.003066084 0.03372994 0.961225397 0.03877460  134.50055
## [20,] 0.001425789 0.002219052 0.02638667 0.969968485 0.03003152   98.77306
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.723804695 0.199764747 0.06498511 0.01144545 0.98855455 5133.7131
##  [2,] 0.523893236 0.258639643 0.17758119 0.03988593 0.96011407 5357.6287
##  [3,] 0.379196384 0.252317027 0.27321171 0.09527488 0.90472512 5320.5990
##  [4,] 0.274464123 0.219802012 0.33301005 0.17272382 0.82727618 4999.0738
##  [5,] 0.198658420 0.180316841 0.35778633 0.26323841 0.73676159 4482.6180
##  [6,] 0.143789897 0.142630800 0.35529879 0.35828051 0.64171949 3872.7764
##  [7,] 0.104075803 0.110154423 0.33444144 0.45132834 0.54867166 3248.9452
##  [8,] 0.075330555 0.083679649 0.30291102 0.53807877 0.46192123 2662.4730
##  [9,] 0.054524609 0.062822477 0.26653760 0.61611532 0.38388468 2141.0136
## [10,] 0.039465168 0.046758481 0.22934369 0.68443266 0.31556734 1695.3055
## [11,] 0.028565074 0.034578935 0.19386906 0.74298693 0.25701307 1325.3525
## [12,] 0.020675535 0.025447978 0.16154523 0.79233126 0.20766874 1025.1267
## [13,] 0.014965049 0.018658912 0.13303007 0.83334597 0.16665403  785.7884
## [14,] 0.010831773 0.013642169 0.10847415 0.86705191 0.13294809  597.7126
## [15,] 0.007840088 0.009952345 0.08771830 0.89448926 0.10551074  451.6536
## [16,] 0.005674692 0.007248131 0.07043241 0.91664476 0.08335524  339.3344
## [17,] 0.004107369 0.005271681 0.05620849 0.93441246 0.06558754  253.6743
## [18,] 0.002972933 0.003830197 0.04461990 0.94857697 0.05142303  188.8060
## [19,] 0.002151823 0.002780610 0.03525671 0.95981085 0.04018915  139.9805
## [20,] 0.001557499 0.002017354 0.02774489 0.96868026 0.03131974  103.4238
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.716993171 0.200868677 0.07257030 0.009567852 0.99043215 5187.6693
##  [2,] 0.514079207 0.264044797 0.18534051 0.036535482 0.96346452 5417.2314
##  [3,] 0.368591280 0.261034819 0.28021734 0.090156558 0.90984344 5381.1677
##  [4,] 0.264277431 0.230012326 0.33986495 0.165845290 0.83415471 5062.8364
##  [5,] 0.189485113 0.190522338 0.36501805 0.254974497 0.74502550 4549.7418
##  [6,] 0.135859532 0.151902793 0.36304212 0.349195552 0.65080445 3941.0742
##  [7,] 0.097410357 0.118055089 0.34253152 0.442003036 0.55799696 3315.3533
##  [8,] 0.069842560 0.090107128 0.31104657 0.529003740 0.47099626 2724.2364
##  [9,] 0.050076639 0.067870118 0.27440592 0.607647329 0.39235267 2196.2418
## [10,] 0.035904608 0.050612674 0.23669002 0.676792697 0.32320730 1743.0607
## [11,] 0.025743359 0.037454265 0.20052221 0.736280162 0.26371984 1365.4946
## [12,] 0.018457812 0.027550758 0.16741637 0.786575057 0.21342494 1058.0756
## [13,] 0.013234125 0.020169763 0.13809841 0.828497705 0.17150229  812.2945
## [14,] 0.009488778 0.014710186 0.11276845 0.863032582 0.13696742  618.6746
## [15,] 0.006803389 0.010695649 0.09129923 0.891201735 0.10879827  467.9911
## [16,] 0.004877983 0.007757466 0.07337793 0.913986616 0.08601338  351.9092
## [17,] 0.003497481 0.005615086 0.05860300 0.932284435 0.06771556  263.2489
## [18,] 0.002507670 0.004057668 0.04654674 0.946887925 0.05311207  196.0282
## [19,] 0.001797982 0.002928256 0.03679356 0.958480203 0.04151980  145.3841
## [20,] 0.001289141 0.002110854 0.02896125 0.967638755 0.03236124  107.4380
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.744251508 0.189380311 0.05888376 0.007484418 0.99251558 5113.6438
##  [2,] 0.553910307 0.252398705 0.16308919 0.030601793 0.96939821 5316.9555
##  [3,] 0.412248581 0.253438758 0.25473410 0.079578559 0.92042144 5290.2415
##  [4,] 0.306816628 0.227222897 0.31522329 0.150737185 0.84926282 5000.4142
##  [5,] 0.228348738 0.191827876 0.34374856 0.236074830 0.76392517 4521.7732
##  [6,] 0.169948893 0.156137294 0.34634900 0.327564815 0.67243518 3945.1586
##  [7,] 0.126484720 0.124073265 0.33065951 0.418782510 0.58121749 3344.9228
##  [8,] 0.094136443 0.096972018 0.30363726 0.505254280 0.49474572 2771.4625
##  [9,] 0.070061190 0.074896549 0.27078253 0.584259727 0.41574027 2253.7526
## [10,] 0.052143146 0.057345545 0.23605920 0.654452112 0.34554789 1804.7701
## [11,] 0.038807615 0.043623287 0.20210252 0.715466574 0.28453343 1426.8549
## [12,] 0.028882626 0.033022120 0.17051050 0.767584749 0.23241525 1116.0014
## [13,] 0.021495938 0.024903634 0.14212571 0.811474718 0.18852528  864.9309
## [14,] 0.015998384 0.018726934 0.11727194 0.848002744 0.15199726  665.1164
## [15,] 0.011906822 0.014050759 0.09593761 0.878104808 0.12189519  508.0141
## [16,] 0.008861670 0.010523923 0.07791018 0.902704229 0.09729577  385.7413
## [17,] 0.006595311 0.007871655 0.06287013 0.922662901 0.07733710  291.3897
## [18,] 0.004908570 0.005881567 0.05045393 0.938755928 0.06124407  219.1159
## [19,] 0.003653211 0.004390945 0.04029400 0.951661842 0.04833816  164.1036
## [20,] 0.002718908 0.003275959 0.03204249 0.961962647 0.03803735  122.4605
## 
## , , 6
## 
##            State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.7028650752 0.205030235 0.07902081 0.01308388 0.98691612 5210.17341
##  [2,] 0.4940193139 0.257782780 0.20466196 0.04353594 0.95646406 5491.71030
##  [3,] 0.3472289222 0.244210492 0.30591295 0.10264764 0.89735236 5459.05340
##  [4,] 0.2440550825 0.206589188 0.36471234 0.18464339 0.81535661 5105.41782
##  [5,] 0.1715377939 0.164577185 0.38445267 0.27943235 0.72056765 4542.78125
##  [6,] 0.1205679244 0.126416381 0.37525354 0.37776215 0.62223785 3888.19188
##  [7,] 0.0847429833 0.094808658 0.34762353 0.47282483 0.52717517 3228.75772
##  [8,] 0.0595628833 0.069939303 0.31015857 0.56033924 0.43966076 2618.03846
##  [9,] 0.0418646704 0.050988393 0.26906398 0.63808295 0.36191705 2082.83265
## [10,] 0.0294252147 0.036852838 0.22840948 0.70531247 0.29468753 1631.71505
## [11,] 0.0206819558 0.026465247 0.19060551 0.76224729 0.23775271 1262.26505
## [12,] 0.0145366244 0.018913460 0.15687948 0.80967044 0.19032956  966.29282
## [13,] 0.0102172856 0.013466570 0.12767145 0.84864470 0.15135530  733.25622
## [14,] 0.0071813732 0.009561075 0.10293292 0.88032463 0.11967537  552.30544
## [15,] 0.0050475364 0.006773312 0.08233834 0.90584081 0.09415919  413.38416
## [16,] 0.0035477371 0.004790201 0.06542710 0.92623496 0.07376504  307.72744
## [17,] 0.0024935805 0.003383208 0.05169407 0.94242914 0.05757086  228.00020
## [18,] 0.0017526506 0.002386999 0.04064374 0.95521661 0.04478339  168.23863
## [19,] 0.0012318769 0.001682762 0.03181990 0.96526546 0.03473454  123.69712
## [20,] 0.0008658433 0.001185540 0.02481941 0.97312921 0.02687079   90.66177
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.716717305 0.208609172 0.05731497 0.01735855 0.98264145 5062.86914
##  [2,] 0.513683695 0.270312895 0.16957206 0.04643135 0.95356865 5286.82107
##  [3,] 0.368165993 0.263688931 0.26675227 0.10139280 0.89860720 5263.66481
##  [4,] 0.263870939 0.229496872 0.32788850 0.17874369 0.82125631 4951.98451
##  [5,] 0.189120868 0.187940408 0.35325390 0.26968482 0.73031518 4438.88327
##  [6,] 0.135546199 0.148282800 0.35070234 0.36546866 0.63453134 3828.19152
##  [7,] 0.097148306 0.114142143 0.32940426 0.45930529 0.54069471 3202.08328
##  [8,] 0.069627872 0.086362197 0.29731944 0.54669049 0.45330951 2613.84202
##  [9,] 0.049903501 0.064534678 0.26046300 0.62509882 0.37490118 2092.07043
## [10,] 0.035766703 0.047780356 0.22295941 0.69349354 0.30650646 1647.72011
## [11,] 0.025634615 0.035129382 0.18738446 0.75185154 0.24814846 1280.57724
## [12,] 0.018372772 0.025689950 0.15516186 0.80077542 0.19922458  984.20683
## [13,] 0.013168084 0.018708981 0.12691709 0.84120585 0.15879415  749.32962
## [14,] 0.009437793 0.013580772 0.10275818 0.87422326 0.12577674  565.93355
## [15,] 0.006764230 0.009833014 0.08248254 0.90092022 0.09907978  424.47397
## [16,] 0.004848041 0.007105073 0.06572122 0.92232567 0.07767433  316.46761
## [17,] 0.003474675 0.005125673 0.05203440 0.93936525 0.06063475  234.70957
## [18,] 0.002490359 0.003692967 0.04097129 0.95284538 0.04715462  173.27340
## [19,] 0.001784884 0.002657994 0.03210503 0.96345209 0.03654791  127.39872
## [20,] 0.001279257 0.001911505 0.02505079 0.97175845 0.02824155   93.33135
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.718198019 0.202991606 0.07091090 0.007899474 0.99210053 5186.39963
##  [2,] 0.515808394 0.262278830 0.18840865 0.033504123 0.96649588 5447.41658
##  [3,] 0.370452567 0.255218556 0.28650467 0.087824206 0.91217579 5422.57899
##  [4,] 0.266058299 0.221660868 0.34652967 0.165751159 0.83424884 5094.25318
##  [5,] 0.191082544 0.181211980 0.36999049 0.257714986 0.74228501 4560.60037
##  [6,] 0.137235104 0.142780154 0.36535704 0.354627698 0.64537230 3930.09437
##  [7,] 0.098561980 0.109794728 0.34207689 0.449566398 0.55043360 3286.51584
##  [8,] 0.070787019 0.083015084 0.30821238 0.537985516 0.46201448 2683.43579
##  [9,] 0.050839097 0.062008983 0.26979853 0.617353393 0.38264661 2149.24741
## [10,] 0.036512538 0.045904965 0.23094539 0.686637102 0.31336290 1694.55860
## [11,] 0.026223233 0.033755191 0.19420372 0.745817859 0.25418214 1318.81882
## [12,] 0.018833474 0.024694166 0.16097178 0.795500579 0.20449942 1015.30551
## [13,] 0.013526164 0.017994262 0.13185301 0.836626569 0.16337343  774.50392
## [14,] 0.009714464 0.013072053 0.10693722 0.870276263 0.12972374  586.20941
## [15,] 0.006976909 0.009473605 0.08600700 0.897542484 0.10245752  440.71748
## [16,] 0.005010802 0.006852866 0.06868107 0.919455258 0.08054474  329.40954
## [17,] 0.003598748 0.004949800 0.05450910 0.936942351 0.06305765  244.96450
## [18,] 0.002584614 0.003571054 0.04303103 0.950813304 0.04918670  181.35540
## [19,] 0.001856264 0.002573974 0.03381165 0.961758109 0.03824189  133.73489
## [20,] 0.001333165 0.001853931 0.02645856 0.970354346 0.02964565   98.27381
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.731428729 0.186975740 0.07294275 0.008652777 0.99134722 5190.3320
##  [2,] 0.534987986 0.245089139 0.18374733 0.036175547 0.96382445 5404.9869
##  [3,] 0.391305583 0.242029135 0.27580286 0.090862417 0.90913758 5350.2916
##  [4,] 0.286212145 0.213391112 0.33286783 0.167528916 0.83247108 5017.5807
##  [5,] 0.209343786 0.177148935 0.35621970 0.257287580 0.74271242 4496.9846
##  [6,] 0.153120059 0.141778482 0.35335228 0.351749180 0.64825082 3887.1991
##  [7,] 0.111996410 0.110773131 0.33275245 0.444478005 0.55552200 3264.9796
##  [8,] 0.081917392 0.085120174 0.30177541 0.531187020 0.46881298 2680.0536
##  [9,] 0.059916734 0.064633358 0.26602215 0.609427762 0.39057224 2159.3501
## [10,] 0.043824821 0.048650149 0.22938597 0.678139060 0.32186094 1713.4568
## [11,] 0.032054733 0.036381025 0.19434896 0.737215280 0.26278472 1342.5193
## [12,] 0.023445752 0.027071839 0.16232962 0.787152786 0.21284721 1040.7575
## [13,] 0.017148897 0.020068626 0.13399716 0.828785321 0.17121468  799.5821
## [14,] 0.012543196 0.014833757 0.10952426 0.863098785 0.13690121  609.5737
## [15,] 0.009174454 0.010939632 0.08877648 0.891109434 0.10889057  461.6349
## [16,] 0.006710459 0.008053587 0.07144666 0.913789298 0.08621070  347.5824
## [17,] 0.004908223 0.005920768 0.05714601 0.932024995 0.06797500  260.3853
## [18,] 0.003590015 0.004348084 0.04546289 0.946599015 0.05340099  194.1942
## [19,] 0.002625840 0.003190432 0.03599832 0.958185407 0.04181459  144.2572
## [20,] 0.001920615 0.002339436 0.02838583 0.967354120 0.03264588  106.7843
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.723594128 0.197455081 0.06567897 0.01327182 0.98672818 5128.48646
##  [2,] 0.523588461 0.257349742 0.17700259 0.04205920 0.95794080 5344.33312
##  [3,] 0.378865536 0.252580876 0.27070616 0.09784743 0.90215257 5296.64099
##  [4,] 0.274144877 0.221239901 0.32851334 0.17610189 0.82389811 4963.67632
##  [5,] 0.198369623 0.182392690 0.35152216 0.26771553 0.73228447 4436.97489
##  [6,] 0.143539094 0.144909240 0.34763224 0.36391943 0.63608057 3819.45638
##  [7,] 0.103864046 0.112352056 0.32579297 0.45799093 0.54200907 3191.11809
##  [8,] 0.075155414 0.085643349 0.29369972 0.54550152 0.45449848 2603.26740
##  [9,] 0.054382016 0.064490605 0.25714385 0.62398353 0.37601647 2083.10514
## [10,] 0.039350507 0.048125722 0.22008743 0.69243634 0.30756366 1640.72422
## [11,] 0.028473796 0.035670314 0.18500043 0.75085546 0.24914454 1275.45253
## [12,] 0.020603472 0.026301767 0.15324442 0.79985034 0.20014966  980.65455
## [13,] 0.014908551 0.019316419 0.12541335 0.84036168 0.15963832  746.99923
## [14,] 0.010787740 0.014142250 0.10160325 0.87346676 0.12653324  564.49828
## [15,] 0.007805945 0.010328907 0.08161123 0.90025392 0.09974608  423.66213
## [16,] 0.005648336 0.007529394 0.06507412 0.92174815 0.07825185  316.06915
## [17,] 0.004087103 0.005480376 0.05156057 0.93887195 0.06112805  234.57080
## [18,] 0.002957404 0.003984207 0.04062884 0.95242955 0.04757045  173.28699
## [19,] 0.002139960 0.002893754 0.03186055 0.96310573 0.03689427  127.49296
## [20,] 0.001548462 0.002100168 0.02487831 0.97147306 0.02852694   93.46053</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.011835 7.961783 7.910865 8.013413 8.306829 7.653332 7.777609
##  [8] 7.916049 7.999197 7.806756</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 44411.32 44335.34 44125.00 44905.15 45126.82 44104.50 43337.83
##  [8] 44578.39 44472.49 43443.93</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.845783228 0.112068213 0.03341276 0.008735801 0.99126420 6887.5733
##  [2,] 0.715349269 0.182073884 0.08123365 0.021343199 0.97865680 6702.2966
##  [3,] 0.514950336 0.254570299 0.17574443 0.054734934 0.94526507 4980.9537
##  [4,] 0.370691438 0.257151150 0.26312330 0.109034109 0.89096589 4915.7513
##  [5,] 0.266845426 0.229327619 0.32123206 0.182594900 0.81740510 4626.0660
##  [6,] 0.192090980 0.191539095 0.34785998 0.268509942 0.73149006 4168.7766
##  [7,] 0.138278347 0.153710496 0.34863541 0.359375748 0.64062425 3624.3755
##  [8,] 0.099540860 0.120121183 0.33118142 0.449156534 0.55084347 3060.9674
##  [9,] 0.071655346 0.092137349 0.30255852 0.533648787 0.46635121 2525.1442
## [10,] 0.051581718 0.069716698 0.26836531 0.610336271 0.38966373 2043.5880
## [11,] 0.037131544 0.052215032 0.23262041 0.678033017 0.32196698 1627.9566
## [12,] 0.026729462 0.038801390 0.19796820 0.736500950 0.26349905 1279.9141
## [13,] 0.019241434 0.028657868 0.16598164 0.786119059 0.21388094  995.2096
## [14,] 0.013851112 0.021064218 0.13745803 0.827626643 0.17237336  766.6016
## [15,] 0.009970842 0.015423300 0.11266747 0.861938388 0.13806161  585.7783
## [16,] 0.007177597 0.011258188 0.09154469 0.890019524 0.10998048  444.5133
## [17,] 0.005166855 0.008197401 0.07382858 0.912807166 0.08719283  335.2892
## [18,] 0.003719405 0.005956673 0.05915878 0.931165142 0.06883486  251.5747
## [19,] 0.002677446 0.004321292 0.04713939 0.945861868 0.05413813  187.8896
## [20,] 0.001927382 0.003130662 0.03737861 0.957563350 0.04243665  139.7529
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.827149514 0.126510999 0.04145905 0.004880434 0.99511957 6964.9568
##  [2,] 0.684176318 0.199203600 0.10016243 0.016457651 0.98354235 6843.0800
##  [3,] 0.493027112 0.257789746 0.19914986 0.050033285 0.94996672 5124.4685
##  [4,] 0.355282296 0.253372951 0.28304110 0.108303657 0.89169634 5016.3986
##  [5,] 0.256021438 0.222592364 0.33433555 0.187050647 0.81294935 4669.0229
##  [6,] 0.184492662 0.184079481 0.35356274 0.277865114 0.72213489 4159.1510
##  [7,] 0.132948016 0.146661544 0.34777921 0.372611234 0.62738877 3575.1174
##  [8,] 0.095804217 0.113978042 0.32520243 0.465015310 0.53498469 2986.2889
##  [9,] 0.069037871 0.087041068 0.29300080 0.550920262 0.44907974 2437.4258
## [10,] 0.049749664 0.065626843 0.25662715 0.627996346 0.37200365 1952.2979
## [11,] 0.035850310 0.049010067 0.21984633 0.695293288 0.30470671 1539.6208
## [12,] 0.025834240 0.036334292 0.18502570 0.752805770 0.24719423 1198.5541
## [13,] 0.018616518 0.026784817 0.15348228 0.801116385 0.19888362  922.9219
## [14,] 0.013415326 0.019657662 0.12579818 0.841128828 0.15887117  704.1169
## [15,] 0.009667273 0.014376349 0.10207414 0.873882239 0.12611776  532.9300
## [16,] 0.006966373 0.010484525 0.08211869 0.900430406 0.09956959  400.5984
## [17,] 0.005020067 0.007629108 0.06558167 0.921769157 0.07823084  299.3284
## [18,] 0.003617531 0.005541323 0.05204357 0.938797580 0.06120242  222.4885
## [19,] 0.002606844 0.004019004 0.04107234 0.952301813 0.04769819  164.6105
## [20,] 0.001878529 0.002911448 0.03225696 0.962953068 0.03704693  121.2903
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.819857600 0.130292226 0.04238513 0.007465046 0.99253495 6954.1107
##  [2,] 0.672166484 0.200649657 0.10502405 0.022159809 0.97784019 6834.3696
##  [3,] 0.486517257 0.248829358 0.20464464 0.060008748 0.93999125 5108.9180
##  [4,] 0.352143474 0.239249771 0.28708399 0.121522769 0.87847723 4980.3953
##  [5,] 0.254883100 0.206937483 0.33631761 0.201861811 0.79813819 4619.1035
##  [6,] 0.184485584 0.169060671 0.35373156 0.292722188 0.70727781 4104.0367
##  [7,] 0.133531532 0.133373235 0.34672689 0.386368342 0.61363166 3522.0693
##  [8,] 0.096650750 0.102819867 0.32355094 0.476978445 0.52302155 2939.9553
##  [9,] 0.069956266 0.078008966 0.29125115 0.560783613 0.43921639 2399.9807
## [10,] 0.050634674 0.058511398 0.25511443 0.635739496 0.36426050 1924.0760
## [11,] 0.036649615 0.043520143 0.21875114 0.701079101 0.29892090 1519.8153
## [12,] 0.026527163 0.032167666 0.18440893 0.756896241 0.24310376 1185.7918
## [13,] 0.019200485 0.023664242 0.15332424 0.803811034 0.19618897  915.6659
## [14,] 0.013897401 0.017345885 0.12603271 0.842724006 0.15727599  700.9109
## [15,] 0.010059004 0.012679262 0.10261450 0.874647238 0.12535276  532.5229
## [16,] 0.007280755 0.009248234 0.08287517 0.900595839 0.09940416  401.9879
## [17,] 0.005269844 0.006734407 0.06647217 0.921523574 0.07847643  301.7563
## [18,] 0.003814338 0.004897513 0.05299900 0.938289153 0.06171085  225.4108
## [19,] 0.002760836 0.003558041 0.04203837 0.951642757 0.04835724  167.6578
## [20,] 0.001998306 0.002582862 0.03319360 0.962225230 0.03777477  124.2280
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.812518131 0.133068291 0.04807522 0.006338359 0.99366164 6996.0103
##  [2,] 0.660185713 0.205709004 0.11379252 0.020312761 0.97968724 6896.1906
##  [3,] 0.473348648 0.255526157 0.21413007 0.056995123 0.94300488 5173.1038
##  [4,] 0.339387748 0.247763256 0.29558485 0.117264142 0.88273586 5041.4632
##  [5,] 0.243338697 0.216216208 0.34410793 0.196337165 0.80366283 4678.3274
##  [6,] 0.174472184 0.178072928 0.36128519 0.286169695 0.71383031 4162.4572
##  [7,] 0.125095365 0.141448377 0.35426598 0.379190275 0.62080973 3579.0325
##  [8,] 0.089692522 0.109646168 0.33105086 0.469610451 0.53038955 2993.9084
##  [9,] 0.064308926 0.083532347 0.29855360 0.553605132 0.44639487 2449.3563
## [10,] 0.046109061 0.062830011 0.26202845 0.629032474 0.37096753 1967.7765
## [11,] 0.033059882 0.046804141 0.22511445 0.695021525 0.30497848 1557.3452
## [12,] 0.023703709 0.034607169 0.19011404 0.751575080 0.24842492 1217.1861
## [13,] 0.016995398 0.025439856 0.15832169 0.799243055 0.20075695  941.3395
## [14,] 0.012185584 0.018614701 0.13032235 0.838877370 0.16112263  721.5018
## [15,] 0.008736981 0.013570384 0.10623235 0.871460285 0.12853971  548.7637
## [16,] 0.006264355 0.009863580 0.08588031 0.897991753 0.10200825  414.6146
## [17,] 0.004491500 0.007152013 0.06893561 0.919420881 0.08057912  311.4517
## [18,] 0.003220375 0.005175682 0.05499532 0.936608625 0.06339138  232.7754
## [19,] 0.002308987 0.003739453 0.04364005 0.950311515 0.04968849  173.1996
## [20,] 0.001655528 0.002698206 0.03446747 0.961178800 0.03882120  128.3640
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.907233460 0.068693097 0.02135865 0.002714790 0.99728521 6844.8246
##  [2,] 0.823072552 0.120760770 0.04868027 0.007486407 0.99251359 6592.8577
##  [3,] 0.612572988 0.226942603 0.13282714 0.027657265 0.97234273 4863.2855
##  [4,] 0.455908370 0.249567155 0.22547396 0.069050517 0.93094948 4886.9876
##  [5,] 0.339310492 0.233212726 0.29441057 0.133066210 0.86693379 4687.9512
##  [6,] 0.252532345 0.201506646 0.33250606 0.213454954 0.78654505 4298.5738
##  [7,] 0.187947579 0.166413242 0.34322864 0.302410535 0.69758947 3795.1125
##  [8,] 0.139880269 0.133529355 0.33347599 0.393114391 0.60688561 3249.4598
##  [9,] 0.104106101 0.105073871 0.31028880 0.480531226 0.51946877 2714.2824
## [10,] 0.077481123 0.081552624 0.27955690 0.561409352 0.43859065 2222.1404
## [11,] 0.057665442 0.062667898 0.24569331 0.633973347 0.36602665 1789.4745
## [12,] 0.042917592 0.047801357 0.21173640 0.697544650 0.30245535 1421.4684
## [13,] 0.031941483 0.036259302 0.17960603 0.752193188 0.24780681 1116.2633
## [14,] 0.023772497 0.027388034 0.15038329 0.798456175 0.20154383  868.1149
## [15,] 0.017692717 0.020620163 0.12455856 0.837128559 0.16287144  669.5493
## [16,] 0.013167831 0.015485815 0.10223001 0.869116343 0.13088366  512.7211
## [17,] 0.009800178 0.011607278 0.08325264 0.895339907 0.10466009  390.1952
## [18,] 0.007293797 0.008686955 0.06734458 0.916674671 0.08332533  295.3405
## [19,] 0.005428420 0.006493658 0.05415964 0.933918281 0.06608172  222.4780
## [20,] 0.004040110 0.004849615 0.04333449 0.947775787 0.05222421  166.8829
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.840738845 0.109894022 0.04235431 0.007012819 0.99298718 6951.2709
##  [2,] 0.706841805 0.176041012 0.09810193 0.019015250 0.98098475 6809.3056
##  [3,] 0.496814419 0.242525738 0.20669853 0.053961313 0.94603869 5143.6915
##  [4,] 0.349193504 0.236324665 0.30100517 0.113476658 0.88652334 5080.7216
##  [5,] 0.245435918 0.202619875 0.35772358 0.194220630 0.80577937 4746.8820
##  [6,] 0.172508335 0.162659606 0.37755969 0.287272365 0.71272763 4227.0448
##  [7,] 0.121250084 0.125552215 0.36929649 0.383901209 0.61609879 3622.6174
##  [8,] 0.085222449 0.094469404 0.34280933 0.477498818 0.52250118 3012.2915
##  [9,] 0.059899883 0.069849517 0.30641916 0.563831443 0.43616856 2445.5908
## [10,] 0.042101536 0.051007708 0.26623248 0.640658278 0.35934172 1947.8171
## [11,] 0.029591699 0.036912111 0.22630214 0.707194053 0.29280595 1527.4340
## [12,] 0.020798972 0.026532244 0.18905596 0.763612825 0.23638717 1182.5959
## [13,] 0.014618871 0.018974597 0.15574987 0.810656659 0.18934334  905.9673
## [14,] 0.010275094 0.013517329 0.12685311 0.849354467 0.15064553  687.9149
## [15,] 0.007222005 0.009601070 0.10234276 0.880834162 0.11916584  518.4382
## [16,] 0.005076095 0.006803817 0.08191413 0.906205954 0.09379405  388.2212
## [17,] 0.003567810 0.004812969 0.06512290 0.926496320 0.07350368  289.1166
## [18,] 0.002507689 0.003399946 0.05147628 0.942616084 0.05738392  214.2896
## [19,] 0.001762567 0.002399172 0.04048799 0.955350276 0.04464972  158.1727
## [20,] 0.001238847 0.001691544 0.03170859 0.965361020 0.03463898  116.3293
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.844943633 0.114183397 0.03137167 0.009501298 0.99049870 6870.9848
##  [2,] 0.713929742 0.184354194 0.07920390 0.022512165 0.97748783 6684.1966
##  [3,] 0.511685801 0.255686080 0.17568706 0.056941061 0.94305894 4971.6054
##  [4,] 0.366734068 0.254802218 0.26515761 0.113306100 0.88669390 4908.2391
##  [5,] 0.262844653 0.224052139 0.32296191 0.190141296 0.80985870 4604.5922
##  [6,] 0.188385311 0.184573439 0.34729242 0.279748829 0.72025117 4124.9378
##  [7,] 0.135019013 0.146179649 0.34484426 0.373957078 0.62604292 3558.3154
##  [8,] 0.096770463 0.112814298 0.32415541 0.466259831 0.53374017 2978.0357
##  [9,] 0.069357065 0.085514462 0.29285108 0.552277395 0.44772261 2432.5606
## [10,] 0.049709409 0.063987288 0.25677839 0.629524909 0.37047509 1948.2581
## [11,] 0.035627594 0.047422890 0.21998522 0.696964301 0.30303570 1535.3994
## [12,] 0.025534913 0.034893365 0.18501947 0.754552250 0.24544775 1193.9536
## [13,] 0.018301314 0.025532481 0.15330177 0.802864438 0.19713556  918.0934
## [14,] 0.013116868 0.018602888 0.12546611 0.842814136 0.15718586  699.3082
## [15,] 0.009401087 0.013508654 0.10163348 0.875456780 0.12454322  528.3661
## [16,] 0.006737921 0.009783595 0.08161509 0.901863391 0.09813661  396.4379
## [17,] 0.004829185 0.007070968 0.06505485 0.923044998 0.07695500  295.6589
## [18,] 0.003461160 0.005101990 0.05152416 0.939912685 0.06008731  219.3388
## [19,] 0.002480674 0.003676434 0.04058166 0.953261228 0.04673877  161.9670
## [20,] 0.001777942 0.002646400 0.03180818 0.963767482 0.03623252  119.1128
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.882195251 0.084858790 0.02964366 0.003302303 0.99669770 6894.2500
##  [2,] 0.778268461 0.144604064 0.06742874 0.009698730 0.99030127 6689.4226
##  [3,] 0.558950867 0.240965805 0.16575802 0.034325311 0.96567469 5011.4235
##  [4,] 0.401437405 0.251745224 0.26377172 0.083045647 0.91695435 5021.3208
##  [5,] 0.288311549 0.225957291 0.33030059 0.155430569 0.84456943 4769.8646
##  [6,] 0.207064783 0.188194788 0.36123513 0.243505296 0.75649470 4315.7549
##  [7,] 0.148713517 0.150031634 0.36285789 0.338396963 0.66160304 3753.0129
##  [8,] 0.106805753 0.116286152 0.34404323 0.432864864 0.56713514 3162.1541
##  [9,] 0.076707680 0.088413730 0.31296836 0.521910232 0.47808977 2597.9842
## [10,] 0.055091304 0.066308945 0.27601849 0.602581260 0.39741874 2091.5374
## [11,] 0.039566465 0.049235743 0.23768313 0.673514665 0.32648533 1656.1453
## [12,] 0.028416557 0.036286544 0.20083970 0.734457194 0.26554281 1293.5776
## [13,] 0.020408715 0.026592058 0.16713791 0.785861316 0.21413868  998.9199
## [14,] 0.014657499 0.019403165 0.13736061 0.828578725 0.17142127  763.9950
## [15,] 0.010526987 0.014110231 0.11171788 0.863644900 0.13635510  579.5547
## [16,] 0.007560461 0.010234319 0.09006773 0.892137495 0.10786251  436.5626
## [17,] 0.005429908 0.007407872 0.07207229 0.915089931 0.08491007  326.8578
## [18,] 0.003899749 0.005353376 0.05730293 0.933443948 0.06655605  243.4288
## [19,] 0.002800792 0.003863755 0.04530722 0.948028233 0.05197177  180.4551
## [20,] 0.002011523 0.002785828 0.03564902 0.959553624 0.04044638  133.2260
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.842462817 0.109675287 0.04278639 0.005075502 0.99492450 6966.7726
##  [2,] 0.709743599 0.175012885 0.09859991 0.016643607 0.98335639 6826.8358
##  [3,] 0.519126859 0.234103525 0.19648215 0.050287469 0.94971253 5103.5061
##  [4,] 0.379704299 0.232698662 0.27970306 0.107893979 0.89210602 4996.6570
##  [5,] 0.277726633 0.205816078 0.33114895 0.185308338 0.81469166 4656.9813
##  [6,] 0.203137238 0.171173539 0.35124180 0.274447425 0.72555257 4158.3588
##  [7,] 0.148580412 0.137155992 0.34675459 0.367509002 0.63249100 3586.0683
##  [8,] 0.108675982 0.107246156 0.32561511 0.458462756 0.54153724 3007.3527
##  [9,] 0.079488735 0.082455882 0.29476838 0.543286999 0.45671300 2465.9066
## [10,] 0.058140345 0.062635625 0.25952769 0.619696343 0.38030366 1985.2589
## [11,] 0.042525518 0.047160564 0.22359265 0.686721273 0.31327873 1574.4005
## [12,] 0.031104386 0.035275054 0.18932060 0.744299964 0.25570004 1233.0200
## [13,] 0.022750641 0.026253371 0.15805402 0.792941969 0.20705803  955.5393
## [14,] 0.016640473 0.019464455 0.13041936 0.833475717 0.16652428  733.9083
## [15,] 0.012171320 0.014388650 0.10656848 0.866871548 0.13312845  559.3802
## [16,] 0.008902453 0.010612215 0.08636002 0.894125311 0.10587469  423.5441
## [17,] 0.006511510 0.007813031 0.06948825 0.916187209 0.08381279  318.8525
## [18,] 0.004762705 0.005744196 0.05557047 0.933922631 0.06607737  238.8310
## [19,] 0.003483580 0.004218574 0.04420330 0.948094552 0.05190545  178.0988
## [20,] 0.002547990 0.003095496 0.03499678 0.959359739 0.04064026  132.2876
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.864156250 0.097042217 0.03227890 0.00652263 0.99347737 6891.5587
##  [2,] 0.746766024 0.160858417 0.07558270 0.01679286 0.98320714 6694.1079
##  [3,] 0.540355510 0.240708638 0.17084634 0.04808951 0.95191049 4979.8892
##  [4,] 0.390998074 0.246244118 0.26043627 0.10232154 0.89767846 4926.6552
##  [5,] 0.282923910 0.219961867 0.31912143 0.17799279 0.82200721 4631.4472
##  [6,] 0.204722080 0.183385229 0.34463233 0.26726036 0.73273964 4157.2863
##  [7,] 0.148135695 0.146738978 0.34336320 0.36176213 0.63823787 3593.0958
##  [8,] 0.107190119 0.114320449 0.32368905 0.45480038 0.54519962 3012.6799
##  [9,] 0.077562140 0.087441253 0.29316967 0.54182693 0.45817307 2465.2153
## [10,] 0.056123509 0.066008140 0.25764697 0.62022138 0.37977862 1977.7758
## [11,] 0.040610642 0.049349363 0.22119569 0.68884431 0.31115569 1561.2188
## [12,] 0.029385622 0.036628526 0.18640394 0.74758191 0.25241809 1215.9477
## [13,] 0.021263263 0.027037324 0.15473453 0.79696488 0.20303512  936.4250
## [14,] 0.015385973 0.019873130 0.12685965 0.83788124 0.16211876  714.3107
## [15,] 0.011133199 0.014559266 0.10293191 0.87137562 0.12862438  540.4551
## [16,] 0.008055918 0.010638881 0.08278699 0.89851821 0.10148179  406.0501
## [17,] 0.005829215 0.007758456 0.06608672 0.92032561 0.07967439  303.2136
## [18,] 0.004217986 0.005648887 0.05241486 0.93771827 0.06228173  225.2162
## [19,] 0.003052110 0.004107743 0.04133800 0.95150215 0.04849785  166.4986
## [20,] 0.002208489 0.002984073 0.03244163 0.96236581 0.03763419  122.5787</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.874895 8.698388 8.580956 8.663456 9.526983 8.551469 8.651328
##  [8] 9.040629 8.795389 8.789331</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50149.97 49834.67 49462.76 50184.17 51607.96 49975.71 49149.36
##  [8] 50919.45 50101.56 49521.63</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 6649.198 7465.783 7965.738 8121.029 5311.736 6537.097 6651.482
##  [8] 5638.598 7070.002 6185.473</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     8.011835      8.874895       44411.32        50149.97 6649.198
##  [2,]     7.961783      8.698388       44335.34        49834.67 7465.783
##  [3,]     7.910865      8.580956       44125.00        49462.76 7965.738
##  [4,]     8.013413      8.663456       44905.15        50184.17 8121.029
##  [5,]     8.306829      9.526983       45126.82        51607.96 5311.736
##  [6,]     7.653332      8.551469       44104.50        49975.71 6537.097
##  [7,]     7.777609      8.651328       43337.83        49149.36 6651.482
##  [8,]     7.916049      9.040629       44578.39        50919.45 5638.598
##  [9,]     7.999197      8.795389       44472.49        50101.56 7070.002
## [10,]     7.806756      8.789331       43443.93        49521.63 6185.473</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
