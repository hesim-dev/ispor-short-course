<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (HESIM)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-input" class="section level1">
<h1 class="hasAnchor">
<a href="#model-input" class="anchor"></a><span class="header-section-number">3</span> Model input</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7208799 0.2066731 0.06124298 0.01120406
## [2,] 0.0000000 0.5669661 0.42135314 0.01168076
## [3,] 0.0000000 0.0000000 0.73522231 0.26477769
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7185221 0.2030098 0.07101816 0.007449952
## [2,] 0.0000000 0.5910479 0.40064485 0.008307282
## [3,] 0.0000000 0.0000000 0.76810369 0.231896306
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7159982 0.1917880 0.07673893 0.01547492
## [2,] 0.0000000 0.5828439 0.40366546 0.01349066
## [3,] 0.0000000 0.0000000 0.75498720 0.24501280
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7321725 0.2054210 0.05314211 0.009264389
## [2,] 0.0000000 0.5789687 0.41212330 0.008907994
## [3,] 0.0000000 0.0000000 0.75494182 0.245058177
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7187216 0.2054421 0.06806672 0.007769581
## [2,] 0.0000000 0.5549079 0.43380272 0.011289414
## [3,] 0.0000000 0.0000000 0.75106770 0.248932298
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7195844 0.2006132 0.07052572 0.009276698
## [2,] 0.0000000 0.5727779 0.41590621 0.011315925
## [3,] 0.0000000 0.0000000 0.76923188 0.230768120
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7294864 0.1865905 0.07459966 0.009323418
## [2,] 0.0000000 0.5867704 0.40204445 0.011185191
## [3,] 0.0000000 0.0000000 0.75211235 0.247887647
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7182265 0.2178763 0.05601174 0.007885464
## [2,] 0.0000000 0.5915186 0.39708212 0.011399288
## [3,] 0.0000000 0.0000000 0.75525351 0.244746494
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.723612 0.2040740 0.06601361 0.006300309
## [2,] 0.000000 0.5661687 0.42454679 0.009284511
## [3,] 0.000000 0.0000000 0.75261486 0.247385144
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]      [,4]
## [1,] 0.7018346 0.2170892 0.07123098 0.0098453
## [2,] 0.0000000 0.5864167 0.40280380 0.0107795
## [3,] 0.0000000 0.0000000 0.75078211 0.2492179
## [4,] 0.0000000 0.0000000 0.00000000 1.0000000</code></pre>
</div>
<div id="relative-treatment-effect-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.4598697 0.5268389 0.6127015 0.4318094 0.7651462 0.4318497 0.6036141
##  [8] 0.5512164 0.4710289 0.5064782</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8716411 0.09504269 0.02816379 0.005152409
## [2,] 0.0000000 0.80086084 0.19376753 0.005371625
## [3,] 0.0000000 0.00000000 0.87823677 0.121763233
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8517065 0.1069535 0.03741513 0.003924925
## [2,] 0.0000000 0.7845481 0.21107529 0.004376600
## [3,] 0.0000000 0.0000000 0.87782800 0.122171995
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8259916 0.1175088 0.04701806 0.009481508
## [2,] 0.0000000 0.7444078 0.24732642 0.008265750
## [3,] 0.0000000 0.0000000 0.84988030 0.150119703
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8843496 0.08870273 0.02294726 0.004000450
## [2,] 0.0000000 0.81819474 0.17795870 0.003846555
## [3,] 0.0000000 0.00000000 0.89418158 0.105818418
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7847809 0.1571932 0.0520810 0.005944865
## [2,] 0.0000000 0.6594394 0.3319225 0.008638052
## [3,] 0.0000000 0.0000000 0.8095304 0.190469603
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 6
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8789026 0.08663474 0.03045651 0.004006139
## [2,] 0.0000000 0.81550426 0.17960896 0.004886779
## [3,] 0.0000000 0.00000000 0.90034286 0.099657136
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8367142 0.1126286 0.04502941 0.005627746
## [2,] 0.0000000 0.7505688 0.24267969 0.006751539
## [3,] 0.0000000 0.0000000 0.85037153 0.149628473
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8446818 0.1200970 0.03087459 0.004346597
## [2,] 0.0000000 0.7748383 0.21887819 0.006283475
## [3,] 0.0000000 0.0000000 0.86509171 0.134908290
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8698133 0.09612477 0.03109432 0.002967628
## [2,] 0.0000000 0.79565291 0.19997381 0.004373273
## [3,] 0.0000000 0.00000000 0.88347444 0.116525556
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8489857 0.1099509 0.03607694 0.004986430
## [2,] 0.0000000 0.7905291 0.20401136 0.005459585
## [3,] 0.0000000 0.0000000 0.87377656 0.126223438
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.720879869 0.206673093 0.06124298 0.01120406 0.98879594 5114.7206
##  [2,] 0.519667785 0.266163111 0.17625839 0.03791072 0.96208928 5361.1008
##  [3,] 0.374618044 0.258306810 0.27356376 0.09351138 0.90648862 5331.3890
##  [4,] 0.270054607 0.223874676 0.33291129 0.17315943 0.82684057 4997.8027
##  [5,] 0.194676929 0.182742374 0.35563305 0.26694765 0.73305235 4459.1432
##  [6,] 0.140338679 0.143843215 0.35039102 0.36542709 0.63457291 3826.0407
##  [7,] 0.101167329 0.110558456 0.32681884 0.46145537 0.53854463 3183.4312
##  [8,] 0.072929491 0.083591462 0.29306444 0.55041460 0.44958540 2584.8774
##  [9,] 0.052573402 0.062466089 0.25515546 0.62980505 0.37019495 2058.0476
## [10,] 0.037899107 0.046281663 0.21713602 0.69868321 0.30131679 1612.5578
## [11,] 0.027320703 0.034072860 0.18146522 0.75714121 0.24285879 1246.8933
## [12,] 0.019694945 0.024964611 0.14944719 0.80589326 0.19410674  953.5437
## [13,] 0.014197689 0.018224503 0.12160200 0.84597581 0.15402419  722.4276
## [14,] 0.010234828 0.013266956 0.09795296 0.87854525 0.12145475  542.9838
## [15,] 0.007378082 0.009637178 0.07823409 0.90475065 0.09524935  405.3226
## [16,] 0.005318711 0.006988804 0.06203196 0.92566053 0.07433947  300.7676
## [17,] 0.003834151 0.005061649 0.04887777 0.94222643 0.05777357  222.0259
## [18,] 0.002763963 0.003662200 0.03830358 0.95527026 0.04472974  163.1513
## [19,] 0.001992485 0.002647580 0.02987400 0.96548593 0.03451407  119.4044
## [20,] 0.001436342 0.001912881 0.02320162 0.97344915 0.02655085   87.0735
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.718522098 0.203009790 0.07101816 0.007449952 0.99255005 5189.1720
##  [2,] 0.516274005 0.265855525 0.18691225 0.030958216 0.96904178 5451.4401
##  [3,] 0.370954281 0.261942020 0.28674647 0.080357231 0.91964277 5457.0793
##  [4,] 0.266538848 0.230127625 0.35154123 0.151792295 0.84820770 5176.7120
##  [5,] 0.191514053 0.190126439 0.38114866 0.237210845 0.76278915 4691.8236
##  [6,] 0.137607079 0.151253055 0.38253585 0.328604017 0.67139598 4099.9165
##  [7,] 0.098873727 0.117333380 0.36419856 0.419594335 0.58040566 3480.3090
##  [8,] 0.071042958 0.089421979 0.33377310 0.505761961 0.49423804 2886.6483
##  [9,] 0.051045935 0.067275087 0.29724415 0.584434831 0.41556517 2349.8024
## [10,] 0.036677632 0.050125621 0.25889293 0.654303814 0.34569619 1883.6954
## [11,] 0.026353689 0.037072560 0.22154397 0.715029783 0.28497022 1491.0115
## [12,] 0.018935708 0.027261715 0.18689326 0.766909316 0.23309068 1167.7377
## [13,] 0.013605725 0.019957113 0.15582045 0.810616714 0.18938329  906.4048
## [14,] 0.009776014 0.014557704 0.12864823 0.847018052 0.15298195  698.2164
## [15,] 0.007024282 0.010588927 0.10534192 0.877044867 0.12295513  534.3425
## [16,] 0.005047102 0.007684561 0.08565477 0.901613566 0.09838643  406.6287
## [17,] 0.003626454 0.005566554 0.06922896 0.921578029 0.07842197  307.9258
## [18,] 0.002605687 0.004026306 0.05566278 0.937705230 0.06229477  232.1839
## [19,] 0.001872244 0.002908720 0.04455295 0.950666082 0.04933392  174.4145
## [20,] 0.001345249 0.002099276 0.03551962 0.961035859 0.03896414  130.5838
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.715998151 0.191787997 0.07673893 0.01547492 0.98452508 5181.6637
##  [2,] 0.512653352 0.249102310 0.19030003 0.04794431 0.95205569 5389.7723
##  [3,] 0.367058852 0.243508514 0.28356856 0.10586408 0.89413592 5328.0105
##  [4,] 0.262813459 0.212324927 0.34055431 0.18430730 0.81569270 4988.4873
##  [5,] 0.188173951 0.174156749 0.36299041 0.27467889 0.72532111 4462.5286
##  [6,] 0.134732201 0.137595699 0.35879445 0.36887765 0.63112235 3849.5232
##  [7,] 0.096468006 0.106036829 0.33676705 0.46072811 0.53927189 3226.3333
##  [8,] 0.069070914 0.080304322 0.30446107 0.54616369 0.45383631 2642.3900
##  [9,] 0.049454647 0.060051854 0.26758072 0.62291278 0.37708722 2124.1339
## [10,] 0.035409436 0.044485663 0.23005598 0.69004893 0.30995107 1681.6290
## [11,] 0.025353090 0.032719301 0.19436392 0.74756368 0.25243632 1314.5552
## [12,] 0.018152766 0.023932662 0.16189550 0.79601908 0.20398092 1016.7659
## [13,] 0.012997347 0.017430488 0.13328284 0.83628932 0.16371068  779.4121
## [14,] 0.009306076 0.012651988 0.10866033 0.86938161 0.13061839  592.9105
## [15,] 0.006663133 0.009158928 0.08785847 0.89631947 0.10368053  448.0768
## [16,] 0.004770791 0.006616134 0.07054048 0.91807259 0.08192741  336.6973
## [17,] 0.003415878 0.004771154 0.05629397 0.93551900 0.06448100  251.7491
## [18,] 0.002445762 0.003435962 0.04468931 0.94942897 0.05057103  187.4145
## [19,] 0.001751161 0.002471697 0.03531452 0.96046262 0.03953738  138.9853
## [20,] 0.001253828 0.001776465 0.02779413 0.96917558 0.03082442  102.7200
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.732172462 0.205421040 0.05314211 0.009264389 0.99073561 5075.8104
##  [2,] 0.536076514 0.269335983 0.16368719 0.030900317 0.96909968 5323.4068
##  [3,] 0.392500461 0.266058502 0.26306217 0.078378865 0.92162113 5342.1581
##  [4,] 0.287378029 0.234667400 0.32910384 0.148850726 0.85114927 5078.4096
##  [5,] 0.210410279 0.194898576 0.36043803 0.234253112 0.76574689 4607.2636
##  [6,] 0.154056612 0.156062875 0.36361364 0.326266877 0.67373312 4025.8294
##  [7,] 0.112796009 0.122001991 0.34701118 0.418190819 0.58180918 3414.4743
##  [8,] 0.082586131 0.093806009 0.31824733 0.505360526 0.49463947 2827.8390
##  [9,] 0.060467291 0.071275673 0.28330667 0.584950370 0.41504963 2297.3991
## [10,] 0.044272485 0.053687638 0.24646778 0.655572101 0.34442790 1837.3487
## [11,] 0.032415095 0.040177963 0.21054749 0.716859451 0.28314055 1450.4328
## [12,] 0.023733440 0.029920526 0.17723199 0.769114047 0.23088595 1132.5999
## [13,] 0.017376971 0.022198396 0.14739203 0.813032602 0.18696740  876.3127
## [14,] 0.012722940 0.016421772 0.12134433 0.849510955 0.15048905  672.7159
## [15,] 0.009315386 0.012121252 0.09905183 0.879511531 0.12048847  512.9439
## [16,] 0.006820469 0.008931402 0.08026886 0.903979270 0.09602073  388.8330
## [17,] 0.004993760 0.006572070 0.06464161 0.923792558 0.07620744  293.2473
## [18,] 0.003656293 0.004830846 0.05177454 0.939738322 0.06026168  220.1665
## [19,] 0.002677037 0.003547988 0.04127197 0.952503002 0.04749700  164.6421
## [20,] 0.001960053 0.002604094 0.03276241 0.962673443 0.03732656  122.6860
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.718721605 0.205442090 0.06806672 0.007769581 0.99223042 5170.9282
##  [2,] 0.516560745 0.261657100 0.18916508 0.032617073 0.96738293 5455.4353
##  [3,] 0.371263368 0.251318902 0.29074394 0.086673788 0.91332621 5448.7219
##  [4,] 0.266835003 0.215731957 0.35266189 0.164771149 0.83522885 5127.1337
##  [5,] 0.191780082 0.174530500 0.37662065 0.257068768 0.74293123 4592.5236
##  [6,] 0.137836488 0.136248048 0.37163325 0.354282209 0.64571779 3957.6148
##  [7,] 0.099066062 0.103922529 0.34760859 0.449402822 0.55059718 3308.9042
##  [8,] 0.071200919 0.078019767 0.31290256 0.537876752 0.46212325 2701.2463
##  [9,] 0.051173639 0.057921448 0.27370261 0.617202305 0.38279770 2163.4264
## [10,] 0.036779600 0.042654286 0.23417889 0.686387221 0.31361278 1706.0103
## [11,] 0.026434293 0.031225277 0.19689122 0.745449215 0.25455079 1328.2517
## [12,] 0.018998897 0.022757868 0.16322354 0.795019696 0.20498030 1023.2189
## [13,] 0.013654918 0.016531693 0.13375755 0.836055843 0.16394416  781.2296
## [14,] 0.009814085 0.011978861 0.10856191 0.869645142 0.13035486  591.9635
## [15,] 0.007053595 0.008663390 0.08740182 0.896881194 0.10311881  445.6446
## [16,] 0.005069571 0.006256489 0.06988300 0.918790938 0.08120906  333.6140
## [17,] 0.003643610 0.004513278 0.05554602 0.936297095 0.06370290  248.5299
## [18,] 0.002618741 0.003253004 0.04392470 0.950203554 0.04979645  184.3549
## [19,] 0.001882146 0.002343117 0.03457983 0.961194902 0.03880510  136.2365
## [20,] 0.001352739 0.001686886 0.02711636 0.969844015 0.03015598  100.3415
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.719584400 0.200613183 0.07052572 0.009276698 0.99072330 5176.9235
##  [2,] 0.517801709 0.259264908 0.18843611 0.034497277 0.96550272 5442.3258
##  [3,] 0.372602032 0.252379050 0.28929928 0.085719636 0.91428036 5445.4360
##  [4,] 0.268118610 0.219306014 0.35378227 0.158793106 0.84120689 5157.3559
##  [5,] 0.192933969 0.179401759 0.38226059 0.245403682 0.75459632 4663.8264
##  [6,] 0.138832274 0.141462455 0.38226814 0.337437127 0.66256287 4065.3471
##  [7,] 0.099901539 0.108878148 0.36267920 0.428541111 0.57145889 3442.3753
##  [8,] 0.071887589 0.082404559 0.33131313 0.514394722 0.48560528 2848.4315
##  [9,] 0.051729188 0.061621106 0.29419911 0.592450594 0.40754941 2313.6614
## [10,] 0.037223516 0.045672762 0.25558418 0.661519546 0.33848045 1851.1269
## [11,] 0.026785462 0.033627876 0.21822430 0.721362366 0.27863763 1462.7498
## [12,] 0.019274400 0.024634820 0.18374019 0.772350588 0.22764941 1143.9435
## [13,] 0.013869558 0.017976978 0.15294393 0.815209535 0.18479046  886.8601
## [14,] 0.009980317 0.013079231 0.12610424 0.850836208 0.14916379  682.4879
## [15,] 0.007181681 0.009493678 0.10314701 0.880177635 0.11982236  521.9017
## [16,] 0.005167825 0.006878508 0.08379894 0.904154728 0.09584527  396.9326
## [17,] 0.003718687 0.004976591 0.06768609 0.923618629 0.07638137  300.4645
## [18,] 0.002675909 0.003596499 0.05439836 0.939329233 0.06067077  226.5061
## [19,] 0.001925542 0.002596818 0.04352948 0.951948161 0.04805184  170.1363
## [20,] 0.001385590 0.001873689 0.03470010 0.962040625 0.03795937  127.3886
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.729486442 0.186590479 0.07459966 0.009323418 0.99067658 5196.8105
##  [2,] 0.532150470 0.245600986 0.18554443 0.036704109 0.96329589 5412.7516
##  [3,] 0.388196553 0.243405589 0.27799102 0.090406837 0.90959316 5364.0437
##  [4,] 0.283184122 0.215256965 0.33589968 0.165659234 0.83434077 5040.4851
##  [5,] 0.206578978 0.179145867 0.36030261 0.253972549 0.74602745 4528.9681
##  [6,] 0.150696564 0.143663155 0.35842336 0.347216917 0.65278308 3926.0231
##  [7,] 0.109931100 0.112415825 0.33857553 0.439077548 0.56092245 3307.5913
##  [8,] 0.080193247 0.086474370 0.30804382 0.525288565 0.47471143 2723.5191
##  [9,] 0.058499887 0.065703893 0.27243249 0.603363730 0.39663627 2201.3241
## [10,] 0.042674874 0.049468619 0.23567980 0.672176708 0.32782329 1752.3208
## [11,] 0.031130742 0.036989444 0.20032980 0.731550011 0.26844999 1377.3322
## [12,] 0.022709454 0.027513010 0.16786426 0.781913273 0.21808673 1071.1240
## [13,] 0.016566239 0.020381186 0.13900836 0.824044218 0.17595578  825.5015
## [14,] 0.012084847 0.015050178 0.11397988 0.858885094 0.14111491  631.3030
## [15,] 0.008815732 0.011085916 0.09267804 0.887420310 0.11257969  479.5786
## [16,] 0.006430957 0.008149818 0.07481898 0.910600242 0.08939976  362.2113
## [17,] 0.004691296 0.005982027 0.06002862 0.929298060 0.07070194  272.1816
## [18,] 0.003422237 0.004385427 0.04790327 0.944289061 0.05571094  203.6164
## [19,] 0.002496475 0.003211796 0.03804708 0.956244650 0.04375535  151.7211
## [20,] 0.001821145 0.002350405 0.03009320 0.965735251 0.03426475  112.6541
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.718226511 0.217876285 0.05601174 0.007885464 0.99211454 5102.7598
##  [2,] 0.515849321 0.285362398 0.16904696 0.029741324 0.97025868 5362.6397
##  [3,] 0.370496658 0.281188498 0.26987923 0.078435613 0.92156439 5381.4575
##  [4,] 0.266100522 0.247050660 0.33623432 0.150614495 0.84938550 5109.5858
##  [5,] 0.191120450 0.204112052 0.36694630 0.237821194 0.76217881 4626.2803
##  [6,] 0.137267774 0.162376687 0.36889172 0.331463821 0.66853618 4031.9631
##  [7,] 0.098589354 0.125956222 0.35077225 0.424682174 0.57531783 3409.1561
##  [8,] 0.070809488 0.095985730 0.32045910 0.512745686 0.48725431 2813.5930
##  [9,] 0.050857252 0.072205052 0.28410824 0.592829461 0.40717054 2277.0510
## [10,] 0.036527026 0.053791220 0.24609368 0.663588074 0.33641193 1813.5274
## [11,] 0.026234679 0.039776879 0.20926859 0.724719854 0.27528015 1425.3143
## [12,] 0.018842442 0.029244678 0.17531497 0.776597908 0.22340209 1107.8225
## [13,] 0.013533141 0.021404092 0.14507518 0.819987582 0.18001242  852.9978
## [14,] 0.009719861 0.015609469 0.11882574 0.855844932 0.14415507  651.5432
## [15,] 0.006981062 0.011351018 0.09648622 0.885181697 0.11481830  494.2466
## [16,] 0.005013984 0.008235346 0.07776987 0.908980804 0.09101920  372.6916
## [17,] 0.003601176 0.005963788 0.06228691 0.928148121 0.07185188  279.5717
## [18,] 0.002586460 0.004312303 0.04961223 0.943489005 0.05651100  208.7625
## [19,] 0.001857664 0.003114335 0.03932702 0.955700977 0.04429902  155.2606
## [20,] 0.001334224 0.002246928 0.03104257 0.965376278 0.03462372  115.0584
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.723612039 0.204074037 0.06601361 0.006300309 0.99369969 5165.4163
##  [2,] 0.523614384 0.263210763 0.18409005 0.029084804 0.97091520 5443.4357
##  [3,] 0.378893672 0.255877797 0.28485987 0.080368663 0.91963134 5445.6221
##  [4,] 0.274172023 0.222192362 0.34803401 0.155601610 0.84439839 5142.2966
##  [5,] 0.198394176 0.181749753 0.37436570 0.245490368 0.75450963 4627.1417
##  [6,] 0.143560415 0.143388122 0.37201118 0.341040283 0.65895972 4007.7627
##  [7,] 0.103882044 0.110478821 0.35033305 0.435306086 0.56469391 3368.7156
##  [8,] 0.075170298 0.083749279 0.31742691 0.523653508 0.47634649 2764.9773
##  [9,] 0.054394133 0.062756527 0.27941796 0.603431378 0.39656862 2226.4521
## [10,] 0.039360249 0.046631212 0.24052794 0.673480595 0.32651941 1765.1092
## [11,] 0.028481550 0.034433538 0.20342035 0.733664564 0.26633544 1381.5032
## [12,] 0.020609593 0.025307536 0.16959599 0.784486877 0.21551312 1069.7408
## [13,] 0.014913349 0.018534218 0.13974521 0.826807222 0.17319278  820.8836
## [14,] 0.010791479 0.013536921 0.11402745 0.861644151 0.13835585  625.0933
## [15,] 0.007808844 0.009866442 0.09227819 0.890046521 0.10995348  472.8687
## [16,] 0.005650574 0.007179653 0.07415420 0.913015578 0.08698442  355.6762
## [17,] 0.004088823 0.005218030 0.05923066 0.931462484 0.06853752  266.1989
## [18,] 0.002958722 0.003788708 0.04706309 0.946189478 0.05381052  198.3629
## [19,] 0.002140967 0.002748846 0.03722418 0.957886005 0.04211400  147.2448
## [20,] 0.001549229 0.001993226 0.02932382 0.967133725 0.03286628  108.9265
## 
## , , 10
## 
##            State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.7018345611 0.217089157 0.07123098 0.00984530 0.99015470 5182.98303
##  [2,] 0.4925717512 0.279665378 0.19091565 0.03684722 0.96315278 5450.96633
##  [3,] 0.3457038788 0.270932432 0.29107270 0.09229099 0.90770901 5431.57995
##  [4,] 0.2426269301 0.233927864 0.35228962 0.17115559 0.82884441 5104.09935
##  [5,] 0.1702839650 0.189850880 0.37600233 0.26386282 0.73613718 4567.46687
##  [6,] 0.1195111718 0.148298527 0.37089798 0.36129233 0.63870767 3932.01191
##  [7,] 0.0838770708 0.112909311 0.34671167 0.45650194 0.54349806 3283.17751
##  [8,] 0.0588678272 0.084420708 0.31175987 0.54495160 0.45504840 2675.60830
##  [9,] 0.0413154757 0.062285279 0.27226193 0.62413732 0.37586268 2138.19680
## [10,] 0.0289966287 0.045494269 0.23244107 0.69306803 0.30693197 1681.63436
## [11,] 0.0203508362 0.032973452 0.19490332 0.75177239 0.24822761 1305.21019
## [12,] 0.0142829202 0.023754129 0.16106137 0.80090158 0.19909842 1001.93362
## [13,] 0.0100242470 0.017030485 0.13150764 0.84143763 0.15856237  762.00323
## [14,] 0.0070353630 0.012163116 0.10630756 0.87449396 0.12550604  574.95864
## [15,] 0.0049376609 0.008659955 0.08521430 0.90118808 0.09881192  430.89174
## [16,] 0.0034654211 0.006150255 0.06781735 0.92256697 0.07743303  321.03610
## [17,] 0.0024321523 0.004358917 0.05364025 0.93956869 0.06043131  237.97279
## [18,] 0.0017069685 0.003084136 0.04220117 0.95300773 0.04699227  175.61737
## [19,] 0.0011980095 0.002179153 0.03304777 0.96357506 0.03642494  129.09501
## [20,] 0.0008408045 0.001537967 0.02577478 0.97184644 0.02815356   94.56988</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7.757083 8.310315 7.804767 8.297297 7.926567 8.210939 8.066830
##  [8] 8.206166 8.093906 7.825688</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 43292.70 46716.05 44043.76 45664.52 44805.33 46326.18 44941.06
##  [8] 45591.28 45403.43 44481.01</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.871641115 0.095042689 0.02816379 0.005152409 0.99484759 6875.9379
##  [2,] 0.759758233 0.158959083 0.06769938 0.013583308 0.98641669 6670.0907
##  [3,] 0.547694415 0.247145996 0.16328185 0.041877734 0.95812227 4968.0421
##  [4,] 0.394821878 0.253317101 0.25772664 0.094134382 0.90586562 4947.5427
##  [5,] 0.284619143 0.225221269 0.32040240 0.169757191 0.83024281 4669.5739
##  [6,] 0.205176211 0.186515944 0.34789560 0.260412244 0.73958776 4196.6223
##  [7,] 0.147907400 0.148152621 0.34693529 0.357004693 0.64299531 3624.1516
##  [8,] 0.106623467 0.114565994 0.32655742 0.452253116 0.54774688 3032.0204
##  [9,] 0.076862711 0.086991237 0.29489498 0.541251071 0.45874893 2473.2359
## [10,] 0.055408781 0.065206537 0.25817470 0.621209982 0.37879002 1976.7064
## [11,] 0.039943075 0.048421400 0.22068418 0.690951348 0.30904865 1553.8022
## [12,] 0.028794158 0.035708452 0.18510067 0.750396719 0.24960328 1204.7218
## [13,] 0.020757129 0.026196459 0.15289945 0.800146961 0.19985304  923.4201
## [14,] 0.014963397 0.019142445 0.12472428 0.841169883 0.15883012  700.9888
## [15,] 0.010786811 0.013945649 0.10068220 0.874585338 0.12541466  527.7693
## [16,] 0.007775995 0.010136054 0.08056046 0.901527491 0.09847251  394.5494
## [17,] 0.005605558 0.007353888 0.06397693 0.923063623 0.07693638  293.1529
## [18,] 0.004040934 0.005327923 0.05047915 0.940151991 0.05984801  216.6516
## [19,] 0.002913028 0.003855904 0.03960581 0.953625254 0.04637475  159.3627
## [20,] 0.002099943 0.002788212 0.03092218 0.964189667 0.03581033  116.7363
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.851706491 0.106953455 0.03741513 0.003924925 0.99607508 6942.0668
##  [2,] 0.725403947 0.175003083 0.08728599 0.012306982 0.98769302 6791.3738
##  [3,] 0.521218766 0.250699303 0.18867563 0.039406305 0.96059370 5112.6492
##  [4,] 0.374507201 0.253987802 0.28237983 0.089125171 0.91087483 5089.7409
##  [5,] 0.269091700 0.226147578 0.34525270 0.159508018 0.84049198 4824.4116
##  [6,] 0.193348333 0.188292295 0.37490514 0.243454237 0.75654576 4376.1962
##  [7,] 0.138925050 0.150541365 0.37713560 0.333397986 0.66660201 3829.2056
##  [8,] 0.099820718 0.117180298 0.35985907 0.423139913 0.57686009 3255.0644
##  [9,] 0.071723392 0.089523749 0.33044585 0.508307012 0.49169299 2703.3770
## [10,] 0.051534842 0.067473372 0.29477757 0.586214218 0.41378578 2203.2160
## [11,] 0.037028923 0.050342071 0.25711251 0.655516500 0.34448350 1768.0261
## [12,] 0.026606099 0.037271808 0.22028808 0.715834010 0.28416599 1400.7304
## [13,] 0.019117070 0.027430721 0.18602636 0.767425844 0.23257416 1097.9031
## [14,] 0.013736037 0.020093822 0.15523517 0.810934967 0.18906503  852.7900
## [15,] 0.009869646 0.014664961 0.12826270 0.847202688 0.15279731  657.3146
## [16,] 0.007091559 0.010671329 0.10509542 0.877141690 0.12285831  503.3078
## [17,] 0.005095442 0.007746922 0.08550322 0.901654412 0.09834559  383.1907
## [18,] 0.003661188 0.005613226 0.06914098 0.921584610 0.07841539  290.2966
## [19,] 0.002630644 0.004060942 0.05561636 0.937692053 0.06230795  218.9709
## [20,] 0.001890176 0.002934258 0.04453295 0.950642615 0.04935738  164.5422
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.825991648 0.117508788 0.04701806 0.009481508 0.99051849 6964.3157
##  [2,] 0.682262203 0.184535739 0.10785927 0.025342790 0.97465721 6825.7252
##  [3,] 0.488498476 0.238405226 0.20827914 0.064817156 0.93518284 5105.0795
##  [4,] 0.349764005 0.232641169 0.29097089 0.126623933 0.87337607 4977.7510
##  [5,] 0.250430381 0.202674018 0.34042902 0.206466581 0.79353342 4620.0436
##  [6,] 0.179307689 0.166156850 0.35804981 0.296485646 0.70351435 4109.1044
##  [7,] 0.128383974 0.131232564 0.35115469 0.389228772 0.61077123 3530.4791
##  [8,] 0.091922688 0.101110601 0.32794340 0.479023312 0.52097669 2950.4064
##  [9,] 0.065816475 0.076561362 0.29546198 0.562160188 0.43783981 2411.2053
## [10,] 0.047124474 0.057246131 0.25902587 0.636603522 0.36339648 1935.0911
## [11,] 0.033741036 0.042403465 0.22228579 0.701569712 0.29843029 1529.9795
## [12,] 0.024158520 0.031185725 0.18752899 0.757126766 0.24287323 1194.7633
## [13,] 0.017297455 0.022809723 0.15602449 0.803868336 0.19613166  923.3257
## [14,] 0.012384946 0.016611952 0.12833138 0.842671727 0.15732827  707.2866
## [15,] 0.008867598 0.012057458 0.10454462 0.874530319 0.12546968  537.7261
## [16,] 0.006349184 0.008728315 0.08447752 0.900444978 0.09955502  406.1692
## [17,] 0.004546004 0.006304942 0.06779000 0.921359057 0.07864094  305.0759
## [18,] 0.003254931 0.004546666 0.05407452 0.938123880 0.06187612  228.0213
## [19,] 0.002330524 0.003274253 0.04291068 0.951484538 0.04851546  169.6955
## [20,] 0.001668651 0.002355345 0.03389756 0.962078442 0.03792156  125.8095
## 
## , , 4
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.884349558 0.088702731 0.02294726 0.00400045 0.99599955 6851.1435
##  [2,] 0.782074141 0.151020329 0.05659784 0.01030769 0.98969231 6626.9972
##  [3,] 0.572613149 0.248090528 0.14652814 0.03276818 0.96723182 4918.8484
##  [4,] 0.419251579 0.261263442 0.24329398 0.07619100 0.92380900 4949.4916
##  [5,] 0.306964461 0.237386453 0.31362546 0.14202362 0.85797638 4744.9342
##  [6,] 0.224750925 0.200496287 0.35091421 0.22383858 0.77616142 4342.6332
##  [7,] 0.164556438 0.162249646 0.35949274 0.31370118 0.68629882 3824.1072
##  [8,] 0.120483692 0.127740823 0.34700784 0.40476765 0.59523235 3264.6505
##  [9,] 0.088214842 0.098707825 0.32101846 0.49205888 0.50794112 2718.5183
## [10,] 0.064588478 0.075269926 0.28771798 0.57242362 0.42757638 2218.6278
## [11,] 0.047289905 0.056846765 0.25166319 0.64420014 0.35579986 1781.1054
## [12,] 0.034624366 0.042626839 0.21593203 0.70681676 0.29318324 1410.5447
## [13,] 0.025351007 0.031792179 0.18242365 0.76043317 0.23956683 1104.4535
## [14,] 0.018561309 0.023614307 0.15216874 0.80565564 0.19434436  856.5274
## [15,] 0.013590080 0.017484829 0.12559694 0.84332815 0.15667185  658.8482
## [16,] 0.009950282 0.012914857 0.10274650 0.87438837 0.12561163  503.2453
## [17,] 0.007285322 0.009521295 0.08341892 0.89977446 0.10022554  382.0617
## [18,] 0.005334113 0.007009091 0.06728754 0.92036926 0.07963074  288.5257
## [19,] 0.003905490 0.005153783 0.05397025 0.93697048 0.06302952  216.8774
## [20,] 0.002859492 0.003786149 0.04307594 0.95027842 0.04972158  162.3526
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.784780903 0.157193236 0.05208100 0.005944865 0.99405513 7029.0133
##  [2,] 0.615881066 0.227021669 0.13520929 0.021887972 0.97811203 7010.9714
##  [3,] 0.442647028 0.252504003 0.24195496 0.062894011 0.93710599 5293.4580
##  [4,] 0.318139982 0.231054787 0.32139101 0.129414219 0.87058578 5116.8746
##  [5,] 0.228654079 0.193573461 0.36327335 0.214499109 0.78550089 4694.5231
##  [6,] 0.164338626 0.154390608 0.37237931 0.308891457 0.69110854 4125.7696
##  [7,] 0.118113721 0.119434633 0.35784313 0.404608515 0.59539148 3504.4724
##  [8,] 0.084890883 0.090540747 0.32861510 0.495953269 0.50404673 2897.6063
##  [9,] 0.061012912 0.067681933 0.29186726 0.579437900 0.42056210 2344.8683
## [10,] 0.043851298 0.050091857 0.25272562 0.653331221 0.34666878 1864.8966
## [11,] 0.031516875 0.036805268 0.21452885 0.717149005 0.28285100 1462.2495
## [12,] 0.022651859 0.026898425 0.17923717 0.771212548 0.22878745 1133.1346
## [13,] 0.016280381 0.019579793 0.14782970 0.816310131 0.18368987  869.4966
## [14,] 0.011701061 0.014209656 0.12063203 0.853457253 0.14654275  661.6703
## [15,] 0.008409805 0.010288941 0.09756346 0.883737792 0.11626221  499.9581
## [16,] 0.006044309 0.007437142 0.07831256 0.908205986 0.09179401  375.4694
## [17,] 0.004344175 0.005368684 0.06245571 0.927831435 0.07216857  280.4902
## [18,] 0.003122253 0.003871601 0.04953311 0.943473039 0.05652696  208.5716
## [19,] 0.002244030 0.002789824 0.03909475 0.955871396 0.04412860  154.4654
## [20,] 0.001612833 0.002009114 0.03072578 0.965652272 0.03434773  113.9858
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.878902617 0.086634736 0.03045651 0.004006139 0.99599386 6894.8111
##  [2,] 0.772469810 0.146794493 0.06974998 0.010985718 0.98901428 6694.7570
##  [3,] 0.555857225 0.239048264 0.16918564 0.035908875 0.96409113 5022.2435
##  [4,] 0.399986188 0.248433842 0.26876687 0.082813098 0.91718690 5046.2046
##  [5,] 0.287823821 0.222539909 0.33827854 0.151357734 0.84864227 4821.6954
##  [6,] 0.207113532 0.185207187 0.37306935 0.234609936 0.76539006 4398.8490
##  [7,] 0.149035666 0.147632283 0.37861248 0.324719568 0.67528043 3863.8272
##  [8,] 0.107243741 0.114459024 0.36315282 0.415144413 0.58485559 3292.7299
##  [9,] 0.077170923 0.087074104 0.33451639 0.501238585 0.49876141 2739.0698
## [10,] 0.055530992 0.065355624 0.29897787 0.580135519 0.41986448 2234.6142
## [11,] 0.039959236 0.048574504 0.26108148 0.650384782 0.34961522 1794.4287
## [12,] 0.028754043 0.035838750 0.22385279 0.711554419 0.28844558 1422.3000
## [13,] 0.020690961 0.026296083 0.18912816 0.763884798 0.23611520 1115.1935
## [14,] 0.014888892 0.019212694 0.15787936 0.808019056 0.19198094  866.4777
## [15,] 0.010713815 0.013991514 0.13048656 0.844808107 0.15519189  668.0618
## [16,] 0.007709494 0.010163362 0.10694918 0.875177962 0.12482204  511.7015
## [17,] 0.005547632 0.007367975 0.08703944 0.900044950 0.09995505  389.7240
## [18,] 0.003991989 0.005333141 0.07040915 0.920265718 0.07973428  295.3709
## [19,] 0.002872573 0.003855551 0.05666059 0.936611288 0.06338871  222.9064
## [20,] 0.002067059 0.002784650 0.04539127 0.949757022 0.05024298  167.5914
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.836714209 0.112628639 0.04502941 0.005627746 0.99437225 6977.1148
##  [2,] 0.700090667 0.178773522 0.10330115 0.017834659 0.98216534 6846.4328
##  [3,] 0.510706650 0.235529256 0.20179550 0.051968592 0.94803141 5124.6419
##  [4,] 0.372553578 0.233494584 0.28456466 0.109387175 0.89061282 5014.9613
##  [5,] 0.271772784 0.206522651 0.33569217 0.186012394 0.81398761 4675.7110
##  [6,] 0.198254561 0.171891583 0.35578367 0.274070183 0.72592982 4179.8621
##  [7,] 0.144624015 0.137853299 0.35148708 0.366035611 0.63396439 3610.8126
##  [8,] 0.105501258 0.107873694 0.33056983 0.456055220 0.54394478 3034.5054
##  [9,] 0.076961737 0.082982616 0.29986603 0.540189618 0.45981038 2494.0890
## [10,] 0.056142544 0.063052067 0.26463696 0.616168425 0.38383158 2013.0786
## [11,] 0.040955225 0.047472748 0.22857468 0.682997349 0.31700265 1600.7301
## [12,] 0.029876281 0.035497456 0.19405524 0.740571023 0.25942898 1257.0900
## [13,] 0.021794342 0.026403485 0.16245166 0.789350515 0.21064949  976.9247
## [14,] 0.015898677 0.019559399 0.13442312 0.830118800 0.16988120  752.4647
## [15,] 0.011597869 0.014443417 0.11015108 0.863807637 0.13619236  575.1673
## [16,] 0.008460488 0.010639021 0.08951808 0.891382413 0.10861759  436.7535
## [17,] 0.006171812 0.007821309 0.07223616 0.913770719 0.08622928  329.7499
## [18,] 0.004502253 0.005740913 0.05793464 0.931822196 0.06817780  247.7126
## [19,] 0.003284332 0.004208675 0.04621733 0.946289666 0.05371033  185.2618
## [20,] 0.002395876 0.003082351 0.03669771 0.957824067 0.04217593  138.0121
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.844681822 0.120096990 0.03087459 0.004346597 0.99565340 6904.3336
##  [2,] 0.713487380 0.194499495 0.07907517 0.012937954 0.98706205 6746.8312
##  [3,] 0.512445552 0.270502048 0.17691774 0.040134659 0.95986534 5052.7814
##  [4,] 0.368051981 0.271656724 0.26973224 0.090559057 0.90944094 5025.5431
##  [5,] 0.264344690 0.240879801 0.33220148 0.162574031 0.83742597 4755.1730
##  [6,] 0.189859364 0.200079320 0.36135180 0.248709516 0.75129048 4300.2804
##  [7,] 0.136362029 0.159716491 0.36299449 0.340926993 0.65907301 3747.0170
##  [8,] 0.097938824 0.124185326 0.34521130 0.432664553 0.56733545 3168.8348
##  [9,] 0.070342260 0.094796477 0.31551954 0.519341725 0.48065828 2616.1949
## [10,] 0.050521676 0.071399789 0.27987922 0.598199319 0.40180068 2118.1723
## [11,] 0.036286007 0.053241778 0.24256115 0.667911069 0.33208893 1687.6929
## [12,] 0.026061572 0.039399362 0.20636896 0.728170110 0.27182989 1326.9411
## [13,] 0.018718112 0.028983654 0.17296541 0.779332820 0.22066718 1031.7387
## [14,] 0.013443844 0.021222603 0.14319006 0.822143493 0.17785651  794.6789
## [15,] 0.009655725 0.015482659 0.11732492 0.857536691 0.14246331  607.1796
## [16,] 0.006934998 0.011262034 0.09529878 0.886504186 0.11349581  460.7174
## [17,] 0.004980899 0.008172674 0.07683513 0.910011294 0.08998871  347.4926
## [18,] 0.003577414 0.005919509 0.06155421 0.928948862 0.07105114  260.7255
## [19,] 0.002569394 0.004280933 0.04903994 0.944109728 0.05589027  194.7275
## [20,] 0.001845407 0.003092061 0.03888139 0.956181143 0.04381886  144.8479
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.869813278 0.096124772 0.03109432 0.002967628 0.99703237 6908.1991
##  [2,] 0.756575139 0.160092559 0.07373973 0.009592573 0.99040743 6729.2860
##  [3,] 0.547466880 0.245036739 0.17340866 0.034087725 0.96591228 5053.5936
##  [4,] 0.396153625 0.250455909 0.27067976 0.082710707 0.91728929 5056.5584
##  [5,] 0.286661533 0.222644967 0.33619939 0.154494109 0.84550589 4800.2086
##  [6,] 0.207431736 0.184554788 0.36647543 0.241538049 0.75846195 4345.0691
##  [7,] 0.150100102 0.146820577 0.36786031 0.335219010 0.66478099 3783.8166
##  [8,] 0.108614241 0.113756749 0.34909799 0.428531020 0.57146898 3195.1969
##  [9,] 0.078594572 0.086570858 0.31820141 0.516633156 0.48336684 2632.7470
## [10,] 0.056871979 0.065052822 0.28142480 0.596650396 0.40334960 2126.8721
## [11,] 0.041153248 0.048436966 0.24317678 0.667233006 0.33276699 1690.7690
## [12,] 0.029778986 0.035821804 0.20629889 0.728100320 0.27189968 1326.3718
## [13,] 0.021548433 0.026358302 0.17243746 0.779655806 0.22034419 1029.0648
## [14,] 0.015592705 0.019320721 0.14239182 0.822694757 0.17730524  790.9955
## [15,] 0.011283069 0.014120854 0.11639808 0.858197999 0.14180200  603.2048
## [16,] 0.008164565 0.010297367 0.09434272 0.887195346 0.11280465  456.8828
## [17,] 0.005907977 0.007496223 0.07591442 0.910681379 0.08931862  344.0282
## [18,] 0.004275084 0.005449792 0.06070682 0.929568300 0.07043170  257.7285
## [19,] 0.003093502 0.003957935 0.04828476 0.944663800 0.05533620  192.2138
## [20,] 0.002238495 0.002872162 0.03822437 0.956664970 0.04333503  142.7876
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.848985692 0.109950935 0.03607694 0.00498643 0.99501357 6927.8812
##  [2,] 0.720776705 0.180266179 0.08458323 0.01437388 0.98562612 6764.6246
##  [3,] 0.505866003 0.262183904 0.18745711 0.04449298 0.95550702 5087.6086
##  [4,] 0.355034244 0.263567041 0.28238145 0.09901726 0.90098274 5052.5512
##  [5,] 0.249175303 0.231634197 0.34346219 0.17572831 0.82427169 4756.2456
##  [6,] 0.174879839 0.189927416 0.36891740 0.26627534 0.73372466 4269.1643
##  [7,] 0.122736715 0.149341124 0.36593694 0.36198522 0.63801478 3686.7063
##  [8,] 0.086140869 0.114220938 0.34363674 0.45600146 0.54399854 3087.1018
##  [9,] 0.060456639 0.085681313 0.31014084 0.54372121 0.45627879 2522.0554
## [10,] 0.042430559 0.063369433 0.27166734 0.62253267 0.37746733 2019.7812
## [11,] 0.029779232 0.046372107 0.23251080 0.69133786 0.30866214 1591.4021
## [12,] 0.020900095 0.033658126 0.19536501 0.75007677 0.24992323 1237.1074
## [13,] 0.014668409 0.024274871 0.16172291 0.79933381 0.20066619  950.9316
## [14,] 0.010294796 0.017419542 0.13224153 0.84004414 0.15995586  724.0537
## [15,] 0.007225244 0.012449999 0.10703454 0.87329022 0.12670978  546.8739
## [16,] 0.005070926 0.008869409 0.08588918 0.90017048 0.09982952  410.2032
## [17,] 0.003558951 0.006302013 0.06841790 0.92172113 0.07827887  305.8563
## [18,] 0.002497795 0.004468215 0.05415892 0.93887507 0.06112493  226.8731
## [19,] 0.001753039 0.003162480 0.04263928 0.95244520 0.04755480  167.5255
## [20,] 0.001230343 0.002235097 0.03341154 0.96312302 0.03687698  123.2115</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.803556 9.215586 8.550509 9.385704 8.380237 9.298572 8.828716
##  [8] 9.068756 9.112920 8.780468</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 49525.08 52464.37 49557.05 51824.49 49641.95 52462.56 50471.08
##  [8] 51291.90 51465.59 50457.76</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1]  5955.602  6349.841  7393.039  5659.621 10661.090  5641.953  7258.325
##  [8]  6608.721  5949.050  6259.819</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi      ICER
##  [1,]     7.757083      8.803556       43292.70        49525.08  5955.602
##  [2,]     8.310315      9.215586       46716.05        52464.37  6349.841
##  [3,]     7.804767      8.550509       44043.76        49557.05  7393.039
##  [4,]     8.297297      9.385704       45664.52        51824.49  5659.621
##  [5,]     7.926567      8.380237       44805.33        49641.95 10661.090
##  [6,]     8.210939      9.298572       46326.18        52462.56  5641.953
##  [7,]     8.066830      8.828716       44941.06        50471.08  7258.325
##  [8,]     8.206166      9.068756       45591.28        51291.90  6608.721
##  [9,]     8.093906      9.112920       45403.43        51465.59  5949.050
## [10,]     7.825688      8.780468       44481.01        50457.76  6259.819</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-input"><span class="toc-section-number">3</span> Model input</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
