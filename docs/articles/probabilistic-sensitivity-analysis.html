<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (HESIM)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7099058 0.2138494 0.06926299 0.006981841
## [2,] 0.0000000 0.5787541 0.40942157 0.011824306
## [3,] 0.0000000 0.0000000 0.74408485 0.255915145
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7236311 0.2038741 0.06437816 0.008116549
## [2,] 0.0000000 0.6003230 0.38786419 0.011812832
## [3,] 0.0000000 0.0000000 0.76114842 0.238851580
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7270002 0.2017787 0.06247499 0.008746159
## [2,] 0.0000000 0.5731132 0.41307277 0.013814049
## [3,] 0.0000000 0.0000000 0.74797800 0.252021995
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7331952 0.1904132 0.06559107 0.010800548
## [2,] 0.0000000 0.5890804 0.40397764 0.006942004
## [3,] 0.0000000 0.0000000 0.73368175 0.266318247
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7022883 0.2199647 0.06567249 0.01207444
## [2,] 0.0000000 0.5779618 0.41055229 0.01148590
## [3,] 0.0000000 0.0000000 0.74778798 0.25221202
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7243055 0.2010569 0.06291758 0.01171998
## [2,] 0.0000000 0.5710693 0.41421802 0.01471270
## [3,] 0.0000000 0.0000000 0.75499753 0.24500247
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7259781 0.1876468 0.07576116 0.01061390
## [2,] 0.0000000 0.5694635 0.41801060 0.01252586
## [3,] 0.0000000 0.0000000 0.74392918 0.25607082
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7289002 0.1926627 0.0710295 0.007407674
## [2,] 0.0000000 0.5812810 0.4065216 0.012197479
## [3,] 0.0000000 0.0000000 0.7369583 0.263041670
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7105168 0.2217596 0.05721244 0.01051114
## [2,] 0.0000000 0.5778718 0.40556244 0.01656572
## [3,] 0.0000000 0.0000000 0.74992039 0.25007961
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7335202 0.1872889 0.06962614 0.009564767
## [2,] 0.0000000 0.5878758 0.40312762 0.008996562
## [3,] 0.0000000 0.0000000 0.73359006 0.266409943
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.3971977 0.6674390 0.4740674 0.4992242 0.6259820 0.4902361 0.7106577
##  [8] 0.5477213 0.4956196 0.5287052</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.8847752 0.0849405 0.0275111 0.002773171
## [2,] 0.0000000 0.8326821 0.1626213 0.004696587
## [3,] 0.0000000 0.0000000 0.8983511 0.101648916
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.8155406 0.1360736 0.0429685 0.005417302
## [2,] 0.0000000 0.7332400 0.2588757 0.007884345
## [3,] 0.0000000 0.0000000 0.8405811 0.159418869
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 3
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8705797 0.09565671 0.02961736 0.004146269
## [2,] 0.0000000 0.79762687 0.19582434 0.006548791
## [3,] 0.0000000 0.00000000 0.88052458 0.119475415
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8668046 0.09505886 0.03274464 0.005391895
## [2,] 0.0000000 0.79485899 0.20167539 0.003465616
## [3,] 0.0000000 0.00000000 0.86704750 0.132952501
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8136379 0.1376940 0.04110979 0.007558381
## [2,] 0.0000000 0.7358117 0.25699835 0.007189964
## [3,] 0.0000000 0.0000000 0.84211981 0.157880185
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8648446 0.09856538 0.03084447 0.005745559
## [2,] 0.0000000 0.78972266 0.20306464 0.007212698
## [3,] 0.0000000 0.00000000 0.87989094 0.120109064
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8052642 0.1333527 0.05384025 0.007542852
## [2,] 0.0000000 0.6940360 0.29706244 0.008901597
## [3,] 0.0000000 0.0000000 0.81802131 0.181978692
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8515129 0.1055254 0.03890437 0.004057341
## [2,] 0.0000000 0.7706587 0.22266051 0.006680819
## [3,] 0.0000000 0.0000000 0.85592648 0.144073521
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8565265 0.1099084 0.02835561 0.005209527
## [2,] 0.0000000 0.7907850 0.20100468 0.008210297
## [3,] 0.0000000 0.0000000 0.87605565 0.123944348
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]       [,2]      [,3]        [,4]
## [1,] 0.8591107 0.09902064 0.0368117 0.005056942
## [2,] 0.0000000 0.78210781 0.2131357 0.004756529
## [3,] 0.0000000 0.00000000 0.8591477 0.140852318
## [4,] 0.0000000 0.00000000 0.0000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.709905761 0.213849409 0.06926299 0.006981841 0.99301816 5184.07150
##  [2,] 0.503966189 0.275579156 0.18826230 0.032192358 0.96780764 5455.98319
##  [3,] 0.357768501 0.267265446 0.28781738 0.087148675 0.91285132 5435.31789
##  [4,] 0.253981920 0.231189563 0.34836491 0.166463613 0.83353639 5102.73337
##  [5,] 0.180303228 0.188115797 0.37145859 0.260122385 0.73987761 4559.92916
##  [6,] 0.127998300 0.147430533 0.36590372 0.358667451 0.64133255 3919.13762
##  [7,] 0.090866731 0.112698391 0.34149020 0.454944681 0.54505532 3266.64244
##  [8,] 0.064506816 0.084656456 0.30653254 0.544304192 0.45569581 2657.19548
##  [9,] 0.045793760 0.062790018 0.26721433 0.624201891 0.37579811 2119.41693
## [10,] 0.032509254 0.046132950 0.22770954 0.693648258 0.30635174 1663.59336
## [11,] 0.023078507 0.033651720 0.19057473 0.752695042 0.24730496 1288.61537
## [12,] 0.016383565 0.024411397 0.15718000 0.802025041 0.19797496  987.16199
## [13,] 0.011630787 0.017631813 0.12808458 0.842652818 0.15734718  749.18669
## [14,] 0.008256763 0.012691721 0.10333023 0.875721291 0.12427871  564.06333
## [15,] 0.005861523 0.009111090 0.08265461 0.902372779 0.09762722  421.78249
## [16,] 0.004161129 0.006526564 0.06563831 0.923674001 0.07632600  313.52430
## [17,] 0.002954010 0.004667131 0.05180080 0.940578062 0.05942194  231.84960
## [18,] 0.002097068 0.003332835 0.04065962 0.953910481 0.04608952  170.67503
## [19,] 0.001488721 0.002377349 0.03176399 0.964369942 0.03563006  125.13953
## [20,] 0.001056852 0.001694262 0.02471155 0.972537332 0.02746267   91.42754
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.723631141 0.203874149 0.06437816 0.008116549 0.99188345 5147.0905
##  [2,] 0.523642028 0.269920020 0.17466286 0.031775094 0.96822491 5380.7031
##  [3,] 0.378923678 0.268796264 0.27134778 0.080932280 0.91906772 5375.5328
##  [4,] 0.274200974 0.238617318 0.33518679 0.151994923 0.84800508 5096.9175
##  [5,] 0.198420364 0.199149950 0.36533056 0.237099128 0.76290087 4620.3516
##  [6,] 0.143583154 0.160007075 0.36808785 0.328321923 0.67167808 4039.0761
##  [7,] 0.103901242 0.125328818 0.35147412 0.419295823 0.58070418 3429.9834
##  [8,] 0.075186174 0.096420547 0.32282350 0.505569780 0.49443022 2845.6112
##  [9,] 0.054407057 0.073211987 0.28795502 0.584425934 0.41557407 2316.4997
## [10,] 0.039370641 0.055043031 0.25107544 0.654510885 0.34548912 1856.6389
## [11,] 0.028489822 0.041070252 0.21498951 0.715450419 0.28454958 1468.9358
## [12,] 0.020616122 0.030463755 0.18140273 0.767517397 0.23248260 1149.6308
## [13,] 0.014918468 0.022491186 0.15121743 0.811372920 0.18862708  891.4816
## [14,] 0.010795468 0.016543466 0.12478285 0.847878212 0.15212179  685.8741
## [15,] 0.007811937 0.012132340 0.10208988 0.877965841 0.12203416  524.1162
## [16,] 0.005652961 0.008875974 0.08291417 0.902556894 0.09744311  398.1545
## [17,] 0.004090658 0.006480944 0.06691659 0.922511808 0.07748819  300.9127
## [18,] 0.002960128 0.004724639 0.05371053 0.938604701 0.06139530  226.3946
## [19,] 0.002142041 0.003439803 0.04290477 0.951513384 0.04848662  169.6515
## [20,] 0.001550047 0.002501700 0.03412898 0.961819276 0.03818072  126.6808
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.727000151 0.201778702 0.06247499 0.008746159 0.99125384 5132.2920
##  [2,] 0.528529219 0.262335181 0.17549853 0.033637070 0.96636293 5375.0120
##  [3,] 0.384240822 0.256993691 0.27265242 0.086113071 0.91388693 5357.5495
##  [4,] 0.279343136 0.224818087 0.33410055 0.161738232 0.83826177 5049.4533
##  [5,] 0.203082502 0.185211705 0.36021805 0.251487746 0.74851225 4539.2619
##  [6,] 0.147641009 0.147124993 0.35862866 0.346605332 0.65339467 3929.8205
##  [7,] 0.107335036 0.114110085 0.33824355 0.440311328 0.55968867 3302.4141
##  [8,] 0.078032588 0.087055918 0.30684026 0.528071234 0.47192877 2710.1180
##  [9,] 0.056729703 0.065638209 0.27034528 0.607286809 0.39271319 2181.9008
## [10,] 0.041242503 0.049064969 0.23286987 0.676822662 0.32317734 1729.3863
## [11,] 0.029983306 0.036441639 0.19702557 0.736549490 0.26345051 1353.1082
## [12,] 0.021797868 0.026935176 0.16429704 0.786969911 0.21303009 1047.3068
## [13,] 0.015847053 0.019835250 0.13537858 0.828939112 0.17106089  803.2353
## [14,] 0.011520810 0.014565441 0.11044365 0.863470099 0.13652990  611.2538
## [15,] 0.008375631 0.010672300 0.08934577 0.891606298 0.10839370  462.0432
## [16,] 0.006089085 0.007806460 0.07176038 0.914344080 0.08565592  347.2262
## [17,] 0.004426766 0.005702633 0.05728023 0.932590368 0.06740963  259.6160
## [18,] 0.003218259 0.004161481 0.04547652 0.947143740 0.05285626  193.2440
## [19,] 0.002339675 0.003034376 0.03593549 0.958690458 0.04130954  143.2718
## [20,] 0.001700944 0.002211137 0.02827855 0.967809372 0.03219063  105.8488
## 
## , , 4
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.733195210 0.190413177 0.06559107 0.01080055 0.98919945 5137.7378
##  [2,] 0.537575215 0.251778691 0.17313669 0.03750941 0.96249059 5341.7422
##  [3,] 0.394147573 0.250679285 0.26400032 0.09117282 0.90882718 5289.1843
##  [4,] 0.288987112 0.222721134 0.32081360 0.16747815 0.83252185 4960.2856
##  [5,] 0.211883966 0.186227599 0.34430442 0.25758402 0.74241598 4442.2199
##  [6,] 0.155352309 0.150048519 0.34173935 0.35285982 0.64714018 3833.8085
##  [7,] 0.113903569 0.117971762 0.32153390 0.44659077 0.55340923 3212.6848
##  [8,] 0.083513551 0.091183588 0.29103256 0.53427030 0.46572970 2629.3084
##  [9,] 0.061231736 0.069616541 0.25583915 0.61331257 0.38668743 2110.9713
## [10,] 0.044894815 0.052669066 0.21984430 0.68259182 0.31740818 1668.2991
## [11,] 0.032916663 0.039574877 0.18551757 0.74199089 0.25800911 1301.2718
## [12,] 0.024134340 0.029580549 0.15425726 0.79202785 0.20797215 1003.8532
## [13,] 0.017695182 0.022020817 0.12670862 0.83357538 0.16642462  767.1872
## [14,] 0.012974023 0.016341426 0.10302036 0.86766419 0.13233581  581.6239
## [15,] 0.009512492 0.012096838 0.08303671 0.89535396 0.10464604  437.8910
## [16,] 0.006974513 0.008937313 0.06643331 0.91765487 0.08234513  327.6891
## [17,] 0.005113680 0.006592835 0.05280885 0.93548464 0.06451536  243.9233
## [18,] 0.003749325 0.004857422 0.04174366 0.94964960 0.05035040  180.7218
## [19,] 0.002748987 0.003575333 0.03283477 0.96084091 0.03915909  133.3406
## [20,] 0.002015544 0.002629602 0.02571494 0.96963992 0.03036008   98.0174
## 
## , , 5
## 
##            State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.7022883445 0.219964732 0.06567249 0.01207444 0.98792556 5140.42033
##  [2,] 0.4932089188 0.281609884 0.18553714 0.03964406 0.96035594 5409.02546
##  [3,] 0.3463748751 0.271248328 0.28674828 0.09562852 0.90437148 5394.85537
##  [4,] 0.2432550376 0.232961433 0.34853584 0.17524769 0.82475231 5068.96954
##  [5,] 0.1708351776 0.188150343 0.37224892 0.26876555 0.73123445 4531.11555
##  [6,] 0.1199755541 0.146321428 0.36682800 0.36687502 0.63312498 3893.85243
##  [7,] 0.0842574333 0.110958589 0.34226126 0.46252272 0.53747728 3244.13496
##  [8,] 0.0591730133 0.082663492 0.30702655 0.55113694 0.44886306 2637.18235
##  [9,] 0.0415565176 0.060792318 0.26741449 0.63023667 0.36976333 2101.82618
## [10,] 0.0291846579 0.044276607 0.22765689 0.69888185 0.30111815 1648.39136
## [11,] 0.0204960451 0.032009784 0.19033358 0.75716059 0.24283941 1275.72327
## [12,] 0.0143941336 0.023008840 0.15681688 0.80578015 0.19421985  976.43330
## [13,] 0.0101088322 0.016464433 0.12765741 0.84576933 0.15423067  740.41737
## [14,] 0.0070993151 0.011739400 0.10288406 0.87827723 0.12172277  557.01417
## [15,] 0.0049857662 0.008346524 0.08222133 0.90444638 0.09555362  416.20229
## [16,] 0.0035014455 0.005920665 0.06523823 0.92533966 0.07466034  309.16857
## [17,] 0.0024590244 0.004192113 0.05144506 0.94190380 0.05809620  228.49316
## [18,] 0.0017269442 0.002963780 0.04035257 0.95495671 0.04504329  168.11917
## [19,] 0.0012128127 0.002092818 0.03150536 0.96518900 0.03481100  123.21461
## [20,] 0.0008517443 0.001476345 0.02449819 0.97317372 0.02682628   89.99268
## 
## , , 6
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.724305501 0.201056937 0.06291758 0.01171998 0.98828002 5120.5776
##  [2,] 0.524618458 0.260444087 0.17635557 0.03858188 0.96141812 5357.1279
##  [3,] 0.379984035 0.254209798 0.27403638 0.09176979 0.90823021 5340.2124
##  [4,] 0.275224527 0.221569833 0.33610274 0.16710290 0.83289710 5037.2142
##  [5,] 0.199346639 0.181867526 0.36285142 0.25593442 0.74406558 4534.0959
##  [6,] 0.144387867 0.143938982 0.36182714 0.34984601 0.65015399 3931.7500
##  [7,] 0.104580926 0.111229313 0.34188525 0.44230451 0.55769549 3310.3136
##  [8,] 0.075748540 0.084546365 0.31077568 0.52892941 0.47107059 2722.3761
##  [9,] 0.054865084 0.063511601 0.27442141 0.60720190 0.39279810 2196.8627
## [10,] 0.039739082 0.047300530 0.23694712 0.67601327 0.32398673 1745.6016
## [11,] 0.028783236 0.035001698 0.20098751 0.73522756 0.26477244 1369.4357
## [12,] 0.020847856 0.025775464 0.16805438 0.78532230 0.21467770 1062.9305
## [13,] 0.015100217 0.018911182 0.13886900 0.82711960 0.17288040  817.6307
## [14,] 0.010937170 0.013835598 0.11362917 0.86159806 0.13840194  624.1338
## [15,] 0.007921852 0.010100079 0.09220884 0.88976923 0.11023077  473.2991
## [16,] 0.005737841 0.007360588 0.07429950 0.91260207 0.08739793  356.8743
## [17,] 0.004155950 0.005357039 0.05950584 0.93098117 0.06901883  267.7528
## [18,] 0.003010177 0.003894823 0.04740723 0.94568777 0.05431223  200.0124
## [19,] 0.002180288 0.002829431 0.03759504 0.95739524 0.04260476  148.8354
## [20,] 0.001579195 0.002054163 0.02969334 0.96667330 0.03332670  110.3750
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.725978100 0.187646832 0.07576116 0.01061390 0.98938610 5197.82651
##  [2,] 0.527044202 0.243085519 0.18980025 0.04007003 0.95992997 5420.68545
##  [3,] 0.382622548 0.237326515 0.28273975 0.09731119 0.90268881 5358.27422
##  [4,] 0.277775591 0.206946706 0.33853128 0.17674642 0.82325358 5007.35772
##  [5,] 0.201658996 0.169972313 0.35939382 0.26897488 0.73102512 4466.25974
##  [6,] 0.146400015 0.134633706 0.35369169 0.36527458 0.63472542 3839.20531
##  [7,] 0.106283204 0.104140486 0.33049132 0.45908499 0.54091501 3205.37113
##  [8,] 0.077159279 0.079247916 0.29744610 0.54614670 0.45385330 2614.73509
##  [9,] 0.056015947 0.059607493 0.26025098 0.62412558 0.37587442 2093.32263
## [10,] 0.040666351 0.044455509 0.22276870 0.69210944 0.30789056 1650.39551
## [11,] 0.029522880 0.032946703 0.18738794 0.75014248 0.24985752 1284.78050
## [12,] 0.021432964 0.024301821 0.15541211 0.79885310 0.20114690  989.58922
## [13,] 0.015559863 0.017860829 0.12739781 0.83918150 0.16081850  755.39852
## [14,] 0.011296120 0.013090850 0.10341980 0.87219323 0.12780677  572.21860
## [15,] 0.008200735 0.009574443 0.08326493 0.89895990 0.10104010  430.60042
## [16,] 0.005953554 0.006991138 0.06656672 0.92048858 0.07951142  322.17525
## [17,] 0.004322150 0.005098364 0.05289435 0.93768514 0.06231486  239.84373
## [18,] 0.003137786 0.003714370 0.04180827 0.95133958 0.04866042  177.76427
## [19,] 0.002277964 0.002703994 0.03289276 0.96212528 0.03787472  131.23824
## [20,] 0.001653752 0.001967279 0.02577276 0.97060621 0.02939379   96.55227
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.728900167 0.192662661 0.07102950 0.007407674 0.99259233 5186.55030
##  [2,] 0.531295454 0.252422982 0.18244072 0.033840845 0.96615916 5410.10976
##  [3,] 0.387261345 0.249089470 0.27480424 0.088844943 0.91115506 5355.33221
##  [4,] 0.282274859 0.219401768 0.33128649 0.167036879 0.83296312 5013.12210
##  [5,] 0.205750192 0.181917896 0.35338573 0.258946180 0.74105382 4478.56246
##  [6,] 0.149971350 0.145385789 0.34899844 0.355644423 0.64435558 3854.94236
##  [7,] 0.109314142 0.113403871 0.32695215 0.450329834 0.54967017 3221.79276
##  [8,] 0.079679096 0.086980265 0.29481576 0.538524879 0.46147512 2629.92772
##  [9,] 0.058078107 0.065911159 0.25828585 0.617724885 0.38227511 2106.22776
## [10,] 0.042333142 0.049502384 0.22126547 0.686899000 0.31310100 1660.62900
## [11,] 0.030856634 0.036930809 0.18619412 0.746018434 0.25398157 1292.40691
## [12,] 0.022491406 0.027412098 0.15442221 0.795674286 0.20432571  994.92415
## [13,] 0.016393989 0.020267385 0.12654390 0.836794729 0.16320527  758.86302
## [14,] 0.011949582 0.014939554 0.10266116 0.870449700 0.12955030  574.24521
## [15,] 0.008710052 0.010986317 0.08257902 0.897724607 0.10227539  431.58049
## [16,] 0.006348758 0.008064239 0.06594214 0.919644858 0.08035514  322.43534
## [17,] 0.004627611 0.005910757 0.05232585 0.937135783 0.06286422  239.64032
## [18,] 0.003373066 0.004327378 0.04129352 0.951006038 0.04899396  177.28877
## [19,] 0.002458629 0.003165287 0.03243036 0.961945723 0.03805428  130.62679
## [20,] 0.001792095 0.002313607 0.02536122 0.970533081 0.02946692   95.89687
## 
## , , 9
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.710516803 0.221759615 0.05721244 0.01051114 0.98948886 5098.45541
##  [2,] 0.504834127 0.285712568 0.17349255 0.03596076 0.96403924 5359.59985
##  [3,] 0.358693130 0.277057067 0.27486268 0.08938712 0.91061288 5360.29804
##  [4,] 0.254857496 0.239647126 0.33901078 0.16648460 0.83351540 5058.31683
##  [5,] 0.181080533 0.195002425 0.36600399 0.25791305 0.74208695 4544.28420
##  [6,] 0.128660761 0.152842758 0.36391957 0.35457691 0.64542309 3926.03985
##  [7,] 0.091415633 0.116855286 0.34225899 0.44947009 0.55052991 3288.98519
##  [8,] 0.064952343 0.087799674 0.30928922 0.53795876 0.46204124 2688.63218
##  [9,] 0.046149731 0.065140765 0.27126663 0.61744288 0.38255712 2154.96138
## [10,] 0.032790159 0.047877160 0.23248736 0.68684532 0.31315468 1699.68156
## [11,] 0.023297959 0.034938396 0.19564020 0.74612345 0.25387655 1322.92319
## [12,] 0.016553592 0.025356461 0.16221721 0.79587274 0.20412726 1018.34086
## [13,] 0.011761605 0.018323703 0.13288069 0.83703400 0.16296600  776.59989
## [14,] 0.008356818 0.013197001 0.10775426 0.87069193 0.12930807  587.55924
## [15,] 0.005937660 0.009479380 0.08663744 0.89794553 0.10205447  441.51598
## [16,] 0.004218807 0.006794600 0.06915537 0.91983123 0.08016877  329.82481
## [17,] 0.002997533 0.004861969 0.05485802 0.93728247 0.06271753  245.12899
## [18,] 0.002129798 0.003474327 0.04328248 0.95111340 0.04888660  181.36679
## [19,] 0.001513257 0.002480019 0.03398932 0.96201740 0.03798260  133.66135
## [20,] 0.001075195 0.001768712 0.02658166 0.97057443 0.02942557   98.16044
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.733520153 0.187288944 0.06962614 0.009564767 0.99043523 5166.5297
##  [2,] 0.538051814 0.247482855 0.17765056 0.036814768 0.96318523 5368.8350
##  [3,] 0.394671849 0.246260341 0.26755233 0.091515479 0.90848452 5305.2803
##  [4,] 0.289499755 0.218688172 0.32302755 0.168784521 0.83121548 4965.0931
##  [5,] 0.212353904 0.182781591 0.34528579 0.259578713 0.74042129 4438.5384
##  [6,] 0.155765868 0.147224415 0.34176791 0.355241802 0.64475820 3824.8920
##  [7,] 0.114257403 0.115722898 0.32091315 0.449106551 0.55089345 3201.2389
##  [8,] 0.083810108 0.089429841 0.29002509 0.536734958 0.46326504 2617.2471
##  [9,] 0.061476403 0.068270348 0.25464654 0.615606712 0.38439329 2099.4871
## [10,] 0.045094181 0.051648337 0.21860820 0.684649287 0.31535071 1658.0322
## [11,] 0.033077490 0.038808450 0.18432940 0.743784657 0.25621534 1292.4829
## [12,] 0.024263006 0.029009597 0.15317003 0.793557364 0.20644264  996.5652
## [13,] 0.017797404 0.021598233 0.12574792 0.834856441 0.16514356  761.2896
## [14,] 0.013054754 0.016030336 0.10219343 0.868721475 0.13127852  576.9428
## [15,] 0.009575925 0.011868858 0.08233931 0.896215906 0.10378409  434.2333
## [16,] 0.007024134 0.008770879 0.06585470 0.918350288 0.08164971  324.8678
## [17,] 0.005152344 0.006471731 0.05233520 0.936040726 0.06395927  241.7708
## [18,] 0.003779348 0.004769551 0.04136025 0.950090848 0.04990915  179.0948
## [19,] 0.002772228 0.003511734 0.03252735 0.961188689 0.03881131  132.1206
## [20,] 0.002033485 0.002583671 0.02547044 0.969912407 0.03008759   97.1089</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7.840788 8.300767 8.031067 7.941948 7.746990 8.018220 7.817967
##  [8] 7.907873 7.904963 7.919684</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 44307.45 46050.24 44633.36 43701.76 43954.55 44727.41 43853.59
##  [8] 43935.10 44314.34 43681.65</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.884775225 0.084940501 0.02751110 0.002773171 0.99722683 6885.2515
##  [2,] 0.782827200 0.145881685 0.06286891 0.008422209 0.99157779 6672.4813
##  [3,] 0.555733539 0.251836761 0.16072786 0.031701839 0.96829816 4998.8132
##  [4,] 0.394518440 0.264594854 0.26119433 0.079692371 0.92030763 5024.9428
##  [5,] 0.280070914 0.237502899 0.33000711 0.152419072 0.84758093 4782.3759
##  [6,] 0.198823955 0.197348783 0.36219065 0.241636608 0.75836339 4328.5073
##  [7,] 0.141146271 0.156734808 0.36407057 0.338048352 0.66195165 3760.5410
##  [8,] 0.100200551 0.120894964 0.34484622 0.434058265 0.56594173 3162.3901
##  [9,] 0.071132948 0.091396288 0.31303204 0.524438719 0.47556128 2591.2084
## [10,] 0.050497690 0.068107718 0.27526890 0.606125697 0.39387430 2079.2550
## [11,] 0.035848601 0.050216524 0.23620581 0.677729069 0.32227093 1640.2575
## [12,] 0.025449128 0.036729223 0.19879987 0.739021777 0.26097822 1275.8865
## [13,] 0.018066483 0.026699470 0.16472439 0.790509655 0.20949035  980.8908
## [14,] 0.012825500 0.019315935 0.13475160 0.833106961 0.16689304  746.6878
## [15,] 0.009104896 0.013921903 0.10906332 0.867909881 0.13209012  563.6489
## [16,] 0.006463618 0.010004436 0.08748292 0.896049022 0.10395098  422.4243
## [17,] 0.004588560 0.007172349 0.06963844 0.918600650 0.08139935  314.6189
## [18,] 0.003257445 0.005132288 0.05507124 0.936539027 0.06346097  233.0599
## [19,] 0.002312479 0.003666935 0.04330457 0.950716020 0.04928398  171.8264
## [20,] 0.001641642 0.002616776 0.03388376 0.961857818 0.03814218  126.1530
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.815540634 0.136073566 0.04296850 0.005417302 0.99458270 6972.9219
##  [2,] 0.665106526 0.210748098 0.10638720 0.017758172 0.98224183 6872.5097
##  [3,] 0.481291794 0.262114954 0.20553643 0.051056826 0.94894317 5154.7369
##  [4,] 0.348277730 0.255476586 0.28909341 0.107152274 0.89284773 5051.4501
##  [5,] 0.252024611 0.224373292 0.34155469 0.182047407 0.81795259 4721.9589
##  [6,] 0.182372857 0.186077747 0.36322506 0.268324339 0.73167566 4236.0051
##  [7,] 0.131970679 0.148887859 0.36038190 0.358759561 0.64124044 3674.3225
##  [8,] 0.095498093 0.116286213 0.34054841 0.447667281 0.55233272 3101.6957
##  [9,] 0.069105394 0.089278879 0.31045914 0.531156592 0.46884341 2561.3011
## [10,] 0.050006815 0.067684966 0.27538244 0.606925781 0.39307422 2077.3324
## [11,] 0.036186489 0.050827938 0.23907883 0.673906745 0.32609325 1659.9498
## [12,] 0.026185670 0.037890669 0.20401843 0.731905232 0.26809477 1310.0728
## [13,] 0.018948766 0.028085220 0.17167052 0.781295490 0.21870451 1023.1869
## [14,] 0.013711917 0.020723367 0.14277989 0.822784830 0.17721517  792.0515
## [15,] 0.009922370 0.015236219 0.11759728 0.857244127 0.14275587  608.4741
## [16,] 0.007180136 0.011169567 0.09605735 0.885592942 0.11440706  464.3789
## [17,] 0.005195770 0.008169192 0.07790842 0.908726615 0.09127339  352.3854
## [18,] 0.003759821 0.005963437 0.06280290 0.927473838 0.07252616  266.0661
## [19,] 0.002720724 0.004346519 0.05035739 0.942575373 0.05742463  200.0087
## [20,] 0.001968800 0.003164000 0.04019046 0.954676741 0.04532326  149.7674
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.870579668 0.095656707 0.02961736 0.004146269 0.99585373 6891.4405
##  [2,] 0.757908958 0.159575144 0.07059499 0.011920908 0.98807909 6696.8981
##  [3,] 0.550999927 0.244384505 0.16607000 0.038545569 0.96145443 4996.0731
##  [4,] 0.400577030 0.251240031 0.25958900 0.088593935 0.91140607 4978.3689
##  [5,] 0.291219561 0.224816887 0.32297333 0.160990226 0.83900977 4714.4722
##  [6,] 0.211716665 0.187607427 0.35263662 0.248039292 0.75196071 4261.6511
##  [7,] 0.153918047 0.150240204 0.35448695 0.341354801 0.65864520 3708.3511
##  [8,] 0.111898444 0.117162025 0.33682460 0.434114926 0.56588507 3130.0574
##  [9,] 0.081350185 0.089725824 0.30732469 0.521599299 0.47840070 2578.2592
## [10,] 0.059141597 0.067837788 0.27201776 0.601002859 0.39899714 2082.2623
## [11,] 0.042995950 0.050812245 0.23518011 0.671011693 0.32898831 1654.7863
## [12,] 0.031258062 0.037796835 0.19958488 0.731360227 0.26863977 1297.6494
## [13,] 0.022724616 0.027969075 0.16685079 0.782455521 0.21754448 1006.3077
## [14,] 0.016520799 0.020614789 0.13777370 0.825090709 0.17490929  773.0619
## [15,] 0.012010623 0.015148153 0.11259924 0.860241979 0.13975802  589.1297
## [16,] 0.008731725 0.011105094 0.09122941 0.888933770 0.11106623  445.8712
## [17,] 0.006347965 0.008126352 0.07337032 0.912155363 0.08784464  335.4361
## [18,] 0.004614972 0.005938204 0.05863275 0.930814076 0.06918592  251.0399
## [19,] 0.003355085 0.004334466 0.04659724 0.945713212 0.05428679  187.0182
## [20,] 0.002439147 0.003161124 0.03685377 0.957545961 0.04245404  138.7600
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.866804605 0.095058856 0.03274464 0.005391895 0.99460811 6901.3477
##  [2,] 0.751350223 0.157955841 0.07594540 0.014748533 0.98525147 6708.3173
##  [3,] 0.550886384 0.236115666 0.16881225 0.044185704 0.95581430 4984.5718
##  [4,] 0.403907258 0.243987127 0.25537314 0.096732477 0.90326752 4923.3424
##  [5,] 0.296142867 0.220637288 0.31242066 0.170799183 0.82920082 4627.3567
##  [6,] 0.217130531 0.186362596 0.33777420 0.258732676 0.74126732 4157.9486
##  [7,] 0.159199065 0.151127059 0.33734691 0.352326967 0.64767303 3600.5362
##  [8,] 0.116723992 0.119339581 0.31899926 0.444937166 0.55506283 3026.3708
##  [9,] 0.085581472 0.092526389 0.28991051 0.531981629 0.46801837 2483.3827
## [10,] 0.062747925 0.070801318 0.25569402 0.610756733 0.38924327 1998.3559
## [11,] 0.046006478 0.053655697 0.22031589 0.680021932 0.31997807 1582.3888
## [12,] 0.033731729 0.040367757 0.18633507 0.739565448 0.26043455 1236.3390
## [13,] 0.024731942 0.030202818 0.15523081 0.789834430 0.21016557  955.1476
## [14,] 0.018133342 0.022501175 0.12771347 0.831652014 0.16834799  730.8851
## [15,] 0.013295279 0.016707827 0.10398040 0.866016494 0.13398351  554.7122
## [16,] 0.009748035 0.012373849 0.08391016 0.893967954 0.10603205  418.0328
## [17,] 0.007147213 0.009145346 0.06720150 0.916505945 0.08349406  313.0946
## [18,] 0.005240302 0.006748267 0.05346782 0.934543610 0.06545639  233.2352
## [19,] 0.003842164 0.004973094 0.04229823 0.948886511 0.05111349  172.9190
## [20,] 0.002817057 0.003661151 0.03329447 0.960227323 0.03977268  127.6601
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.813637859 0.137693965 0.04110979 0.007558381 0.99244162 6948.0297
##  [2,] 0.662006566 0.213349853 0.10345498 0.021188602 0.97881140 6835.1411
##  [3,] 0.464919495 0.268926165 0.20842928 0.057725062 0.94227494 5143.4285
##  [4,] 0.326507543 0.257694948 0.29680158 0.118995930 0.88100407 5042.9109
##  [5,] 0.229302442 0.220757984 0.34918447 0.200755107 0.79924489 4686.4261
##  [6,] 0.161036432 0.178028136 0.36680750 0.294127927 0.70587207 4158.5411
##  [7,] 0.113094009 0.138315801 0.35795977 0.390630424 0.60936958 3555.4714
##  [8,] 0.079424605 0.104817945 0.33189104 0.483866406 0.51613359 2951.2810
##  [9,] 0.055778974 0.078051382 0.29643339 0.569736251 0.43026375 2392.4868
## [10,] 0.039172923 0.057380126 0.25737665 0.646070305 0.35392970 1902.7458
## [11,] 0.027510687 0.041780183 0.21859329 0.712115841 0.28788416 1489.7564
## [12,] 0.019320435 0.030198732 0.18242108 0.768059754 0.23194025 1151.3986
## [13,] 0.013568516 0.021703528 0.15007927 0.814648685 0.18535132  880.3054
## [14,] 0.009529011 0.015528406 0.12202899 0.852913597 0.14708640  666.9158
## [15,] 0.006692113 0.011070872 0.09825283 0.883984189 0.11601581  501.3352
## [16,] 0.004699793 0.007870570 0.07845694 0.908972695 0.09102731  374.3558
## [17,] 0.003300610 0.005582678 0.06220909 0.928907626 0.07109237  277.9293
## [18,] 0.002317980 0.003952592 0.04902795 0.944701480 0.05529852  205.3072
## [19,] 0.001627890 0.002794321 0.03843748 0.957140305 0.04285969  150.9967
## [20,] 0.001143248 0.001973089 0.02999721 0.966886451 0.03311355  110.6253
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.864844595 0.098565375 0.03084447 0.005745559 0.99425444 6888.7453
##  [2,] 0.747956174 0.163083043 0.07383059 0.015130197 0.98486980 6695.4837
##  [3,] 0.541748771 0.243513494 0.17035344 0.044384298 0.95561570 4993.6598
##  [4,] 0.392391615 0.247985425 0.26356962 0.096053338 0.90394666 4967.5718
##  [5,] 0.284211405 0.220509914 0.32640278 0.168875905 0.83112409 4699.8753
##  [6,] 0.205855884 0.183069113 0.35565436 0.255420641 0.74457936 4247.8077
##  [7,] 0.149102549 0.145933900 0.35730064 0.347662907 0.65233709 3698.0818
##  [8,] 0.107995797 0.113316469 0.33959072 0.439097009 0.56090299 3124.4565
##  [9,] 0.078221949 0.086424859 0.31012272 0.525230477 0.47476952 2577.2139
## [10,] 0.056656588 0.065081648 0.27486215 0.603399611 0.39660039 2084.9980
## [11,] 0.041036679 0.048557330 0.23804293 0.672363059 0.32763694 1660.2782
## [12,] 0.029723092 0.035980308 0.20241707 0.731879525 0.26812048 1304.8814
## [13,] 0.021528599 0.026523283 0.16959819 0.782349930 0.21765007 1014.4081
## [14,] 0.015593283 0.019475106 0.14038716 0.824544450 0.17545555  781.3547
## [15,] 0.011294300 0.014256773 0.11503999 0.859408936 0.14059106  597.1357
## [16,] 0.008180524 0.010412402 0.09347093 0.887936143 0.11206386  453.2830
## [17,] 0.005925198 0.007590954 0.07539803 0.911085822 0.08891418  342.0838
## [18,] 0.004291654 0.005526263 0.06044243 0.929739651 0.07026035  256.8553
## [19,] 0.003108468 0.004018746 0.04819298 0.944679801 0.05532020  192.0035
## [20,] 0.002251481 0.002919961 0.03824580 0.956582759 0.04341724  142.9628
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.805264239 0.133352658 0.05384025 0.007542852 0.99245715 7021.9954
##  [2,] 0.648450494 0.199935667 0.12701217 0.024601672 0.97539833 6941.0337
##  [3,] 0.470760858 0.235535753 0.22719065 0.066512739 0.93348726 5196.4560
##  [4,] 0.341762073 0.222465807 0.30313559 0.132636534 0.86736347 5011.6226
##  [5,] 0.248111781 0.190816736 0.34439677 0.216674718 0.78332528 4597.5548
##  [6,] 0.180123719 0.155220563 0.35476746 0.309888259 0.69011174 4044.7951
##  [7,] 0.130765875 0.122192096 0.34245209 0.404589941 0.59541006 3441.0927
##  [8,] 0.094933162 0.094121746 0.31574467 0.495200427 0.50479957 2850.1719
##  [9,] 0.068919396 0.071412809 0.28142780 0.578239990 0.42176001 2310.4658
## [10,] 0.050033972 0.053599497 0.24443508 0.651931450 0.34806855 1840.4727
## [11,] 0.036323568 0.039911676 0.20803818 0.715726578 0.28427342 1445.1325
## [12,] 0.026370115 0.029544247 0.17420109 0.769884548 0.23011545 1121.2013
## [13,] 0.019144126 0.021772640 0.14394091 0.815142322 0.18485768  861.1602
## [14,] 0.013898216 0.015991059 0.11763342 0.852477305 0.14752270  655.7948
## [15,] 0.010089801 0.011714281 0.09524831 0.882947607 0.11705239  495.7553
## [16,] 0.007324974 0.008564175 0.07651911 0.907591744 0.09240826  372.4048
## [17,] 0.005317771 0.006251494 0.06105966 0.927371075 0.07262892  278.2071
## [18,] 0.003860585 0.004557861 0.04844013 0.943141420 0.05685858  206.8340
## [19,] 0.002802700 0.003319962 0.03823375 0.955643592 0.04435641  153.1174
## [20,] 0.002034699 0.002416515 0.03004331 0.965505472 0.03449453  112.9237
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.851512851 0.105525440 0.03890437 0.004057341 0.99594266 6949.5608
##  [2,] 0.725074136 0.171180364 0.08992320 0.013822304 0.98617770 6795.4349
##  [3,] 0.528506659 0.239198599 0.18735981 0.044934933 0.95506507 5079.5174
##  [4,] 0.385228592 0.240865091 0.27285532 0.101050995 0.89894901 4991.9517
##  [5,] 0.280793185 0.214229457 0.32636245 0.178614909 0.82138509 4661.6626
##  [6,] 0.204670200 0.178625867 0.34754902 0.269154916 0.73084508 4162.4228
##  [7,] 0.149184143 0.143264121 0.34328203 0.364269705 0.63573030 3583.6792
##  [8,] 0.108740347 0.112018920 0.32182098 0.457419752 0.54258025 2996.6529
##  [9,] 0.079260857 0.086064670 0.29043053 0.544243942 0.45575606 2447.6377
## [10,] 0.057773252 0.065298362 0.25465220 0.622276184 0.37772382 1961.4292
## [11,] 0.042110933 0.049087443 0.21831686 0.690484765 0.30951523 1547.3479
## [12,] 0.030694666 0.036646801 0.18383665 0.748821883 0.25117812 1204.8729
## [13,] 0.022373347 0.027215804 0.15255789 0.797852957 0.20214704  927.9747
## [14,] 0.016307937 0.020130537 0.12508179 0.838479739 0.16152026  708.0964
## [15,] 0.011886858 0.014843428 0.10152191 0.871747807 0.12825219  536.0306
## [16,] 0.008664333 0.010918356 0.08169591 0.898721405 0.10127860  402.9951
## [17,] 0.006315433 0.008015926 0.06526045 0.920408192 0.07959181  301.1695
## [18,] 0.004603320 0.005876253 0.05180146 0.937718966 0.06228103  223.8953
## [19,] 0.003355361 0.004302642 0.04089131 0.951450684 0.04854932  165.6804
## [20,] 0.002445723 0.003147497 0.03212264 0.962284140 0.03771586  122.1002
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.856526462 0.109908405 0.02835561 0.005209527 0.99479047 6880.8365
##  [2,] 0.733637580 0.181053378 0.07122052 0.014088523 0.98591148 6692.2988
##  [3,] 0.521261828 0.267316835 0.16881137 0.042609970 0.95739003 4998.9816
##  [4,] 0.370365287 0.270069692 0.26483142 0.094733604 0.90526640 4984.2596
##  [5,] 0.263150760 0.238197732 0.32932211 0.169329402 0.83067060 4715.7183
##  [6,] 0.186973036 0.196003971 0.35862491 0.258398078 0.74160192 4253.0309
##  [7,] 0.132847484 0.154728243 0.35912917 0.353295104 0.64670490 3688.5587
##  [8,] 0.094390370 0.118873301 0.33967078 0.447065549 0.55293445 3100.6347
##  [9,] 0.067065944 0.089625504 0.30833689 0.534971658 0.46502834 2542.1422
## [10,] 0.047651480 0.066664573 0.27141387 0.614270078 0.38572992 2042.6669
## [11,] 0.033857177 0.049090753 0.23330170 0.683750371 0.31624963 1614.5513
## [12,] 0.024056093 0.035876318 0.19680412 0.743263470 0.25673653 1258.9494
## [13,] 0.017092258 0.026066584 0.16351382 0.793327341 0.20667266  970.6050
## [14,] 0.012144337 0.018853517 0.13417186 0.834830283 0.16516972  741.1873
## [15,] 0.008628755 0.013588040 0.10895930 0.868823903 0.13117610  561.4164
## [16,] 0.006130876 0.009765655 0.08771527 0.896388196 0.10361180  422.2961
## [17,] 0.004356090 0.007002878 0.07009082 0.918550215 0.08144978  315.7447
## [18,] 0.003095075 0.005012771 0.05565186 0.936240294 0.06375971  234.8459
## [19,] 0.002199103 0.003583102 0.04394453 0.950273263 0.04972674  173.8770
## [20,] 0.001562500 0.002558246 0.03453389 0.961345366 0.03865463  128.2191
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.859110724 0.099020635 0.03681170 0.005056942 0.99494306 6928.6883
##  [2,] 0.738071235 0.162514501 0.08435684 0.015057422 0.98494258 6754.3565
##  [3,] 0.541390125 0.233770927 0.17878647 0.046052475 0.95394753 5028.4482
##  [4,] 0.397120567 0.238824659 0.26309040 0.100964374 0.89903563 4943.4689
##  [5,] 0.291295939 0.214775533 0.31692729 0.177001239 0.82299876 4623.7809
##  [6,] 0.213671442 0.180817850 0.33935847 0.266152239 0.73384776 4137.4427
##  [7,] 0.156732309 0.146316740 0.33671979 0.360231166 0.63976883 3570.5197
##  [8,] 0.114966307 0.115370301 0.31691127 0.452752121 0.54724788 2992.7619
##  [9,] 0.084330103 0.089355328 0.28699657 0.539317997 0.46068200 2450.1862
## [10,] 0.061857830 0.068323932 0.25243101 0.617387226 0.38261277 1967.9188
## [11,] 0.045373965 0.051751275 0.21703107 0.685843694 0.31415631 1555.8366
## [12,] 0.033282718 0.038921365 0.18323341 0.744562503 0.25543750 1213.9894
## [13,] 0.024413544 0.029114414 0.15242584 0.794046206 0.20595379  936.8356
## [14,] 0.017907827 0.021688047 0.12525472 0.835149404 0.16485060  716.1936
## [15,] 0.013135752 0.016103816 0.10187552 0.868884910 0.13111509  543.1222
## [16,] 0.009635339 0.011927225 0.08214136 0.896296081 0.10370392  409.0149
## [17,] 0.007067715 0.008816320 0.06573715 0.918378819 0.08162118  306.1579
## [18,] 0.005184311 0.006506606 0.05227032 0.936038766 0.06396123  227.9507
## [19,] 0.003802797 0.004796040 0.04132894 0.950072222 0.04992778  168.9263
## [20,] 0.002789428 0.003531698 0.03251669 0.961162183 0.03883782  124.6648</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 9.008644 8.937553 9.044369 8.908185 8.471015 8.998430 8.376750
##  [8] 8.782184 8.879236 8.829592</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50761.22 51250.58 50716.89 49735.94 49425.39 50723.14 48958.19
##  [8] 49770.11 50320.82 49600.26</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 5526.172 8166.544 6003.671 6245.029 7556.142 6116.777 9135.214
##  [8] 6673.834 6165.094 6504.625</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     7.840788      9.008644       44307.45        50761.22 5526.172
##  [2,]     8.300767      8.937553       46050.24        51250.58 8166.544
##  [3,]     8.031067      9.044369       44633.36        50716.89 6003.671
##  [4,]     7.941948      8.908185       43701.76        49735.94 6245.029
##  [5,]     7.746990      8.471015       43954.55        49425.39 7556.142
##  [6,]     8.018220      8.998430       44727.41        50723.14 6116.777
##  [7,]     7.817967      8.376750       43853.59        48958.19 9135.214
##  [8,]     7.907873      8.782184       43935.10        49770.11 6673.834
##  [9,]     7.904963      8.879236       44314.34        50320.82 6165.094
## [10,]     7.919684      8.829592       43681.65        49600.26 6504.625</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
