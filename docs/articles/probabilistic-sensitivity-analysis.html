<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model-simple.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7202518 0.2007887 0.06928153 0.009677958
## [2,] 0.0000000 0.5829761 0.40351095 0.013512930
## [3,] 0.0000000 0.0000000 0.76112174 0.238878264
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7307841 0.1915576 0.06787893 0.009779371
## [2,] 0.0000000 0.5687681 0.41245000 0.018781865
## [3,] 0.0000000 0.0000000 0.74440939 0.255590612
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7270509 0.2048398 0.05939079 0.008718531
## [2,] 0.0000000 0.5864066 0.40201209 0.011581278
## [3,] 0.0000000 0.0000000 0.76178251 0.238217489
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7253833 0.2113533 0.05341507 0.009848267
## [2,] 0.0000000 0.5766699 0.40947189 0.013858169
## [3,] 0.0000000 0.0000000 0.75540961 0.244590386
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7236778 0.2013586 0.06270153 0.012262077
## [2,] 0.0000000 0.5918409 0.40060599 0.007553075
## [3,] 0.0000000 0.0000000 0.74167479 0.258325208
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.709429 0.2036574 0.07778874 0.009124901
## [2,] 0.000000 0.5701563 0.41006535 0.019778320
## [3,] 0.000000 0.0000000 0.74859062 0.251409376
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7311396 0.1900639 0.06909429 0.009702157
## [2,] 0.0000000 0.5730077 0.41548353 0.011508743
## [3,] 0.0000000 0.0000000 0.76826714 0.231732861
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7222027 0.2017914 0.06455903 0.01144688
## [2,] 0.0000000 0.5735270 0.41177916 0.01469386
## [3,] 0.0000000 0.0000000 0.75353516 0.24646484
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7221668 0.1947171 0.07234775 0.010768378
## [2,] 0.0000000 0.5890122 0.40211252 0.008875286
## [3,] 0.0000000 0.0000000 0.74895408 0.251045922
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7247906 0.1977327 0.06698424 0.01049252
## [2,] 0.0000000 0.5652470 0.41736360 0.01738941
## [3,] 0.0000000 0.0000000 0.76015276 0.23984724
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.5005059 0.4021589 0.4904845 0.5733784 0.5137447 0.3465920 0.4172979
##  [8] 0.4265457 0.3867802 0.4540211</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8599844 0.1004959 0.03467581 0.004843875
## [2,] 0.0000000 0.7912771 0.20195960 0.006763301
## [3,] 0.0000000 0.0000000 0.88044002 0.119559976
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8917325 0.07703657 0.02729812 0.003932861
## [2,] 0.0000000 0.82657628 0.16587043 0.007553294
## [3,] 0.0000000 0.00000000 0.89721196 0.102788035
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8661227 0.1004707 0.02913026 0.004276304
## [2,] 0.0000000 0.7971389 0.19718069 0.005680437
## [3,] 0.0000000 0.0000000 0.88315802 0.116841978
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8425407 0.1211854 0.03062705 0.005646784
## [2,] 0.0000000 0.7572717 0.23478233 0.007945975
## [3,] 0.0000000 0.0000000 0.85975716 0.140242843
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8580409 0.1034469 0.03221258 0.006299578
## [2,] 0.0000000 0.7903104 0.20580922 0.003880353
## [3,] 0.0000000 0.0000000 0.86728678 0.132713219
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8992904 0.0705860 0.02696095 0.003162618
## [2,] 0.0000000 0.8510196 0.14212536 0.006855007
## [3,] 0.0000000 0.0000000 0.91286353 0.087136473
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]       [,2]      [,3]        [,4]
## [1,] 0.8878051 0.07931327 0.0288329 0.004048689
## [2,] 0.0000000 0.82181703 0.1733804 0.004802574
## [3,] 0.0000000 0.00000000 0.9032984 0.096701632
## [4,] 0.0000000 0.00000000 0.0000000 1.000000000
## 
## , , 8
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8815068 0.08607325 0.02753737 0.004882618
## [2,] 0.0000000 0.81808977 0.17564262 0.006267604
## [3,] 0.0000000 0.00000000 0.89487149 0.105128514
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8925396 0.07531271 0.02798267 0.004164995
## [2,] 0.0000000 0.84103807 0.15552915 0.003432785
## [3,] 0.0000000 0.00000000 0.90290042 0.097099585
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8750491 0.0897748 0.03041226 0.004763823
## [2,] 0.0000000 0.8026130 0.18949187 0.007895160
## [3,] 0.0000000 0.0000000 0.89110430 0.108895704
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.720251765 0.200788745 0.06928153 0.009677958 0.99032204 5167.7297
##  [2,] 0.518762604 0.261673491 0.18365228 0.035911621 0.96408838 5410.0095
##  [3,] 0.373639681 0.256711088 0.28131053 0.088338698 0.91166130 5393.5141
##  [4,] 0.269114640 0.224679076 0.34358363 0.162622658 0.83737734 5092.8484
##  [5,] 0.193830294 0.185017726 0.37081411 0.250337871 0.74966213 4593.0398
##  [6,] 0.139606611 0.146779857 0.37032022 0.343293314 0.65670669 3993.0234
##  [7,] 0.100551908 0.113600588 0.35075821 0.435089297 0.56491070 3371.8235
##  [8,] 0.072422689 0.086416121 0.31977517 0.521386023 0.47861398 2781.8439
##  [9,] 0.052162570 0.064920196 0.28327524 0.599641998 0.40035800 2252.3939
## [10,] 0.037570183 0.048320581 0.24541685 0.668692384 0.33130762 1795.9127
## [11,] 0.027059991 0.035713414 0.20889290 0.728333691 0.27166631 1413.8603
## [12,] 0.019490006 0.026253409 0.17527844 0.778978143 0.22102186 1101.3142
## [13,] 0.014037711 0.019218484 0.14535207 0.821391737 0.17860826  850.1920
## [14,] 0.010110686 0.014022532 0.11935804 0.856508741 0.14349126  651.3292
## [15,] 0.007282240 0.010204913 0.09720473 0.885308119 0.11469188  495.7135
## [16,] 0.005245046 0.007411412 0.07860695 0.908736591 0.09126341  375.1393
## [17,] 0.003777754 0.005373823 0.06318343 0.927664994 0.07233501  282.4912
## [18,] 0.002720934 0.003891341 0.05052041 0.942867319 0.05713268  211.8041
## [19,] 0.001959757 0.002814892 0.04021089 0.955014463 0.04498554  158.1996
## [20,] 0.001411519 0.002034512 0.03187700 0.964676974 0.03532303  117.7629
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.730784145 0.191557551 0.06787893 0.009779371 0.99022063 5156.3990
##  [2,] 0.534045467 0.248939052 0.17914247 0.037873007 0.96212699 5372.7775
##  [3,] 0.390271960 0.243889042 0.27228069 0.093558310 0.90644169 5320.8733
##  [4,] 0.285204560 0.213475857 0.32977158 0.171548003 0.82845200 4986.2441
##  [5,] 0.208422971 0.176051352 0.35289256 0.262633119 0.73736688 4461.0920
##  [6,] 0.152312202 0.140057393 0.34945644 0.358173963 0.64182604 3846.8720
##  [7,] 0.111307343 0.108836735 0.32824412 0.451611805 0.54838819 3221.9728
##  [8,] 0.081341641 0.083224629 0.29679314 0.538640593 0.46135941 2636.6200
##  [9,] 0.059443182 0.062917122 0.26078298 0.616856717 0.38314328 2117.5293
## [10,] 0.043440135 0.047172045 0.22411440 0.685273416 0.31472658 1674.7575
## [11,] 0.031745362 0.035151242 0.18923765 0.743865750 0.25613425 1307.8602
## [12,] 0.023199007 0.026073970 0.15752325 0.793203772 0.20679623 1010.5415
## [13,] 0.016953467 0.019273988 0.12959072 0.834181825 0.16581817  773.8213
## [14,] 0.012389325 0.014209995 0.10556889 0.867831792 0.13216821  588.0179
## [15,] 0.009053922 0.010455461 0.08528836 0.895202259 0.10479774  443.8800
## [16,] 0.006616463 0.007681080 0.06841638 0.917286078 0.08271392  333.1532
## [17,] 0.004835206 0.005636187 0.05454698 0.934981632 0.06501837  248.7933
## [18,] 0.003533492 0.004131904 0.04325813 0.949076470 0.05092353  184.9741
## [19,] 0.002582220 0.003026962 0.03414581 0.960245003 0.03975500  136.9871
## [20,] 0.001887045 0.002216283 0.02684221 0.969054457 0.03094554  101.0954
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.727050893 0.204839788 0.05939079 0.008718531 0.99128147 5115.0899
##  [2,] 0.528603001 0.269048360 0.17077106 0.031577578 0.96842242 5359.7069
##  [3,] 0.384321284 0.266050669 0.26964525 0.079982797 0.92001720 5369.9279
##  [4,] 0.279421133 0.234738167 0.33519177 0.150648935 0.84935106 5101.3996
##  [5,] 0.203153384 0.194888583 0.36630585 0.235652186 0.76434781 4629.4077
##  [6,] 0.147702850 0.155897853 0.36945839 0.326940903 0.67305910 4049.1592
##  [7,] 0.107387489 0.121674955 0.35289195 0.418045602 0.58195440 3439.3441
##  [8,] 0.078076170 0.093348231 0.32411955 0.504456050 0.49554395 2853.6413
##  [9,] 0.056765349 0.070733127 0.28907273 0.583428797 0.41657120 2323.1719
## [10,] 0.041271298 0.053106177 0.25201746 0.653605066 0.34639493 1862.1531
## [11,] 0.030006334 0.039595818 0.21578295 0.714614895 0.28538510 1473.5344
## [12,] 0.021816132 0.029365741 0.18207978 0.766738350 0.23326165 1153.5216
## [13,] 0.015861438 0.021689077 0.15180625 0.810643234 0.18935677  894.8181
## [14,] 0.011532073 0.015967672 0.12530464 0.847195614 0.15280439  688.7612
## [15,] 0.008384404 0.011725776 0.10255898 0.877330840 0.12266916  526.6234
## [16,] 0.006095888 0.008593532 0.08333950 0.901971082 0.09802892  400.3290
## [17,] 0.004432021 0.006287985 0.06730332 0.921976679 0.07802332  302.7896
## [18,] 0.003222305 0.004595170 0.05406156 0.938120969 0.06187903  228.0030
## [19,] 0.002342780 0.003354695 0.04322184 0.951080689 0.04891931  171.0182
## [20,] 0.001703320 0.002447110 0.03441341 0.961436164 0.03856384  127.8315
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.725383318 0.211353348 0.05341507 0.009848267 0.99015173 5076.3038
##  [2,] 0.526180958 0.275193315 0.16563991 0.032985818 0.96701418 5326.4700
##  [3,] 0.381682889 0.269905820 0.26591590 0.082495394 0.91750461 5340.6928
##  [4,] 0.276866400 0.236316530 0.33178189 0.155035181 0.84496482 5067.3964
##  [5,] 0.200834268 0.194793281 0.36218504 0.242187410 0.75781259 4585.5543
##  [6,] 0.145681827 0.154778425 0.36408801 0.335451737 0.66454826 3995.0569
##  [7,] 0.105675167 0.120046407 0.34619460 0.428083823 0.57191618 3377.5738
##  [8,] 0.076655003 0.091561955 0.31631901 0.515464035 0.48453597 2787.9486
##  [9,] 0.055604261 0.069002319 0.28053700 0.594856423 0.40514358 2257.2369
## [10,] 0.040334403 0.051543710 0.24314496 0.664976926 0.33502307 1798.9594
## [11,] 0.029257903 0.038248520 0.20693421 0.725559371 0.27444063 1415.1627
## [12,] 0.021223195 0.028240527 0.17354460 0.776991683 0.22300832 1101.1898
## [13,] 0.015394951 0.020771057 0.14379460 0.820039396 0.17996060  849.0346
## [14,] 0.011167241 0.015231819 0.11795131 0.855649634 0.14435037  649.5110
## [15,] 0.008100530 0.011143966 0.09593505 0.884820453 0.11517955  493.5421
## [16,] 0.005875990 0.008138464 0.07746609 0.908519455 0.09148055  372.8470
## [17,] 0.004262345 0.005935118 0.06216497 0.927637569 0.07236243  280.2399
## [18,] 0.003091834 0.004323465 0.04961795 0.942966749 0.05703325  209.6972
## [19,] 0.002242765 0.003146682 0.03941737 0.955193188 0.04480681  156.2953
## [20,] 0.001626864 0.002288613 0.03118453 0.964899991 0.03510001  116.0866
## 
## , , 5
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.723677817 0.201358575 0.06270153 0.01226208 0.98773792 5116.8133
##  [2,] 0.523709583 0.264890981 0.17254530 0.03885413 0.96114587 5335.8817
##  [3,] 0.378997008 0.262226742 0.26692681 0.09184944 0.90815056 5304.5538
##  [4,] 0.274271728 0.231510818 0.32678618 0.16743127 0.83256873 4992.1058
##  [5,] 0.198484365 0.192244543 0.35231095 0.25696014 0.74303986 4483.2970
##  [6,] 0.143638732 0.153744720 0.35075974 0.35185681 0.64814319 3877.8895
##  [7,] 0.103948164 0.119915309 0.33074708 0.44538945 0.55461055 3255.3910
##  [8,] 0.075224981 0.091901643 0.29986327 0.53301010 0.46698990 2668.0556
##  [9,] 0.054438650 0.069538349 0.26393410 0.61208890 0.38791110 2144.5546
## [10,] 0.039396043 0.052117331 0.22702413 0.68146249 0.31853751 1696.4438
## [11,] 0.028510043 0.038777901 0.19172678 0.74098527 0.25901473 1324.2609
## [12,] 0.020632085 0.028691091 0.15952121 0.79115562 0.20884438 1022.2572
## [13,] 0.014930983 0.021135009 0.13110034 0.83283367 0.16716633  781.6857
## [14,] 0.010805221 0.015515045 0.10663683 0.86704291 0.13295709  592.8979
## [15,] 0.007819499 0.011358163 0.08598277 0.89483957 0.10516043  446.5645
## [16,] 0.005658798 0.008296749 0.06881170 0.91723276 0.08276724  334.3033
## [17,] 0.004095146 0.006049803 0.05471444 0.93514061 0.06485939  248.9304
## [18,] 0.002963567 0.004405114 0.04326068 0.94937064 0.05062936  184.4892
## [19,] 0.002144667 0.003203866 0.03403589 0.96061557 0.03938443  136.1608
## [20,] 0.001552048 0.002328026 0.02666153 0.96945840 0.03054160  100.1195
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.709429006 0.203657350 0.07778874 0.009124901 0.99087510 5221.32571
##  [2,] 0.503289514 0.260596959 0.19693034 0.039183190 0.96081681 5468.93917
##  [3,] 0.357048179 0.251079614 0.29343225 0.098439961 0.90156004 5413.04044
##  [4,] 0.253300335 0.215870117 0.35039401 0.180435541 0.81956446 5053.47676
##  [5,] 0.179698605 0.174666188 0.37052644 0.275108768 0.72489123 4496.22584
##  [6,] 0.127483402 0.136183974 0.36297570 0.373356925 0.62664308 3851.75832
##  [7,] 0.090440423 0.103609087 0.33748131 0.468469182 0.53153082 3202.90846
##  [8,] 0.064161060 0.077492234 0.30215709 0.556189621 0.44381038 2601.16580
##  [9,] 0.045517717 0.057249559 0.26295985 0.634272875 0.36572713 2072.69716
## [10,] 0.032291589 0.041911216 0.22386610 0.701931091 0.29806891 1626.19726
## [11,] 0.022908590 0.030472364 0.18728233 0.759336720 0.24066328 1259.66518
## [12,] 0.016252018 0.022039514 0.15447548 0.807232983 0.19276702  965.38243
## [13,] 0.011529653 0.015875811 0.12594076 0.846653771 0.15334623  733.21729
## [14,] 0.008179470 0.011399793 0.10168507 0.878735664 0.12126434  552.63400
## [15,] 0.005802753 0.008165473 0.08143142 0.904600350 0.09539965  413.79619
## [16,] 0.004116642 0.005837370 0.06475857 0.925287423 0.07471258  308.08206
## [17,] 0.002920465 0.004166598 0.05119159 0.941721351 0.05827865  228.24304
## [18,] 0.002071863 0.002970386 0.04025730 0.954700453 0.04529955  168.36315
## [19,] 0.001469839 0.002115534 0.03151546 0.964899170 0.03510083  123.71991
## [20,] 0.001042747 0.001505529 0.02457402 0.972877705 0.02712230   90.60779
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.731139631 0.190063925 0.06909429 0.009702157 0.99029784 5163.5157
##  [2,] 0.534565160 0.247871365 0.18256887 0.034994602 0.96500540 5404.4545
##  [3,] 0.390841774 0.243633759 0.28018354 0.085340932 0.91465907 5397.0195
##  [4,] 0.285759910 0.213888947 0.34348655 0.156864591 0.84313541 5112.7976
##  [5,] 0.208930395 0.176872669 0.37250114 0.241695793 0.75830421 4631.6275
##  [6,] 0.152757292 0.141059536 0.37410397 0.332079207 0.66792079 4048.2999
##  [7,] 0.111686910 0.109861854 0.35657435 0.421876882 0.57812312 3439.5006
##  [8,] 0.081658726 0.084179343 0.32730708 0.506854853 0.49314515 2856.8634
##  [9,] 0.059703931 0.063755792 0.29207655 0.584463723 0.41553628 2329.9798
## [10,] 0.043651910 0.047880125 0.25500750 0.653460464 0.34653954 1872.1326
## [11,] 0.031915641 0.035732335 0.21882338 0.713528640 0.28647136 1485.8245
## [12,] 0.023334790 0.026540916 0.18516620 0.764958094 0.23504191 1167.1479
## [13,] 0.017060990 0.019643252 0.15489672 0.808399038 0.19160096  908.8881
## [14,] 0.012473966 0.014498414 0.12834233 0.844685295 0.15531470  702.5569
## [15,] 0.009120211 0.010678554 0.10548692 0.874714313 0.12528569  539.6271
## [16,] 0.006668148 0.007852317 0.08610905 0.899370481 0.10062952  412.2110
## [17,] 0.004875347 0.005766813 0.06987800 0.919479845 0.08052016  313.3769
## [18,] 0.003564559 0.004231056 0.05641784 0.935786543 0.06421346  237.2426
## [19,] 0.002606191 0.003101922 0.04534820 0.948943689 0.05105631  178.9421
## [20,] 0.001905489 0.002272768 0.03630840 0.959513342 0.04048666  134.5270
## 
## , , 8
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.722202692 0.201791397 0.06455903 0.01144688 0.98855312 5131.7596
##  [2,] 0.521576729 0.261467100 0.17836569 0.03859048 0.96140952 5368.5420
##  [3,] 0.376684118 0.255208133 0.27574401 0.09236374 0.90763626 5346.9125
##  [4,] 0.272042284 0.222380363 0.33719056 0.16838680 0.83161320 5037.6710
##  [5,] 0.196469670 0.182436930 0.36321932 0.25787408 0.74212592 4528.6440
##  [6,] 0.141890925 0.144278390 0.36150615 0.35232454 0.64767546 3921.6106
##  [7,] 0.102474008 0.111379917 0.34097876 0.44516731 0.55483269 3296.9904
##  [8,] 0.074007004 0.084557760 0.30941904 0.53201620 0.46798380 2707.3082
##  [9,] 0.053448058 0.063430134 0.27275507 0.61036674 0.38963326 2181.2530
## [10,] 0.038600331 0.047164251 0.23510029 0.67913512 0.32086488 1730.3573
## [11,] 0.027877263 0.034839185 0.19906959 0.73821396 0.26178604 1355.1753
## [12,] 0.020133035 0.025606604 0.16615171 0.78810865 0.21189135 1050.0242
## [13,] 0.014540132 0.018748752 0.13704519 0.82966592 0.17033408  806.2535
## [14,] 0.010500922 0.013686988 0.11192741 0.86388468 0.13611532  614.3181
## [15,] 0.007583794 0.009968853 0.09065519 0.89179217 0.10820783  464.9812
## [16,] 0.005477037 0.007247750 0.07290644 0.91436877 0.08563123  349.9323
## [17,] 0.003955531 0.005261999 0.05827563 0.93250684 0.06749316  262.0344
## [18,] 0.002856695 0.003816091 0.04633488 0.94699233 0.05300767  195.3550
## [19,] 0.002063113 0.002765087 0.03667077 0.95850103 0.04149897  145.0798
## [20,] 0.001489986 0.002002171 0.02890452 0.96760333 0.03239667  107.3730
## 
## , , 9
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.722166782 0.194717092 0.07234775 0.01076838 0.98923162 5178.9377
##  [2,] 0.521524861 0.255308958 0.18473046 0.03843572 0.96156428 5403.0226
##  [3,] 0.376627931 0.251929895 0.27874871 0.09269347 0.90730653 5360.4742
##  [4,] 0.271988181 0.221725676 0.33732233 0.16896381 0.83103619 5035.8692
##  [5,] 0.196420829 0.183559875 0.36147534 0.25854396 0.74145604 4518.2261
##  [6,] 0.141848598 0.146365498 0.35875076 0.35303515 0.64696485 3907.3821
##  [7,] 0.102438346 0.113831410 0.33780567 0.44592458 0.55407542 3281.7463
##  [8,] 0.073977571 0.086994586 0.30618515 0.53284269 0.46715731 2692.4672
##  [9,] 0.053424144 0.065645569 0.26965234 0.61127795 0.38872205 2167.4462
## [10,] 0.038581142 0.049068635 0.23221924 0.68013098 0.31986902 1717.8163
## [11,] 0.027862019 0.036414432 0.19644392 0.73927963 0.26072037 1343.9487
## [12,] 0.020121025 0.026873756 0.16378593 0.78921929 0.21078071 1040.0826
## [13,] 0.014530736 0.019746878 0.13493012 0.83079226 0.16920774  797.5350
## [14,] 0.010493615 0.014460534 0.11004820 0.86499765 0.13500235  606.7456
## [15,] 0.007578140 0.010560717 0.08899500 0.89286614 0.10713386  458.4681
## [16,] 0.005472681 0.007695985 0.07144802 0.91538331 0.08461669  344.3854
## [17,] 0.003952188 0.005598653 0.05700188 0.93344728 0.06655272  257.3564
## [18,] 0.002854139 0.004067234 0.04522901 0.94784962 0.05215038  191.4473
## [19,] 0.002061165 0.002951400 0.03571643 0.95927101 0.04072899  141.8452
## [20,] 0.001488505 0.002139755 0.02808588 0.96828586 0.03171414  104.7187
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.724790590 0.197732659 0.06698424 0.01049252 0.98950748 5149.4604
##  [2,] 0.525321399 0.255082561 0.18199421 0.03760183 0.96239817 5391.4762
##  [3,] 0.380748007 0.248057847 0.27999383 0.09120032 0.90879968 5372.3578
##  [4,] 0.275962572 0.215500267 0.34187251 0.16666465 0.83333535 5066.1070
##  [5,] 0.200015076 0.176377691 0.36830244 0.25530479 0.74469521 4560.7125
##  [6,] 0.144969045 0.139246472 0.36697760 0.34880688 0.65119312 3957.1551
##  [7,] 0.105072199 0.107373764 0.34678609 0.44076795 0.55923205 3335.0730
##  [8,] 0.076155341 0.081468902 0.31546248 0.52691327 0.47308673 2746.5537
##  [9,] 0.055196675 0.061108450 0.27890304 0.60479184 0.39520816 2220.2046
## [10,] 0.040006031 0.045455553 0.24121067 0.67332775 0.32667225 1767.7276
## [11,] 0.028995994 0.033604113 0.20500822 0.73239167 0.26760833 1389.9782
## [12,] 0.021016024 0.024728079 0.17180497 0.78245092 0.21754908 1081.6113
## [13,] 0.015232216 0.018133026 0.14232637 0.82430839 0.17569161  834.2902
## [14,] 0.011040167 0.013261545 0.11677816 0.85892012 0.14107988  638.7276
## [15,] 0.008001809 0.009679050 0.09504365 0.88727549 0.11272451  485.8793
## [16,] 0.005799636 0.007053273 0.07682337 0.91032372 0.08967628  367.5637
## [17,] 0.004203522 0.005133619 0.06172976 0.92893310 0.07106690  276.7196
## [18,] 0.003046673 0.003732936 0.04934820 0.94387219 0.05612781  207.4484
## [19,] 0.002208200 0.002712458 0.03927424 0.95580510 0.04419490  154.9390
## [20,] 0.001600482 0.001969842 0.03113442 0.96529526 0.03470474  115.3391</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.115527 7.909123 8.315835 8.176337 7.950160 7.707442 8.303288
##  [8] 7.980690 7.965991 8.054552</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 45509.95 43924.26 46070.23 45256.80 44046.66 43851.45 46336.54
##  [8] 44601.58 44549.92 45119.32</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.859984363 0.100495948 0.03467581 0.004843875 0.99515613 6917.9359
##  [2,] 0.739573104 0.165945085 0.08064675 0.013835056 0.98616494 6742.3667
##  [3,] 0.532678833 0.245239977 0.17958142 0.042499774 0.95750023 5050.4868
##  [4,] 0.383662870 0.249924964 0.27254514 0.093867025 0.90613298 5021.1854
##  [5,] 0.276333859 0.222735472 0.33486824 0.166062427 0.83393757 4750.4942
##  [6,] 0.199029949 0.185334189 0.36389653 0.251739327 0.74826067 4297.6653
##  [7,] 0.143351672 0.148008380 0.36554304 0.343096911 0.65690309 3748.0425
##  [8,] 0.103249295 0.115068753 0.34787738 0.433804575 0.56619542 3173.9974
##  [9,] 0.074365487 0.087813631 0.31836180 0.519459077 0.48054092 2625.1380
## [10,] 0.053561873 0.066125003 0.28289801 0.597415118 0.40258488 2130.0420
## [11,] 0.038578034 0.049303919 0.24571283 0.666405214 0.33359479 1701.4505
## [12,] 0.027785897 0.036489042 0.20958479 0.726140266 0.27385973 1341.5813
## [13,] 0.020012841 0.026851335 0.17616832 0.776967503 0.22303250 1046.4120
## [14,] 0.014414284 0.019672041 0.14630687 0.819606809 0.18039319  808.7413
## [15,] 0.010381914 0.014362556 0.12029386 0.854961667 0.14503833  620.1941
## [16,] 0.007477592 0.010457598 0.09807300 0.883991812 0.11600819  472.4287
## [17,] 0.005385749 0.007597946 0.07938330 0.907633000 0.09236700  357.7909
## [18,] 0.003879095 0.005510819 0.06385935 0.926750740 0.07324926  269.6080
## [19,] 0.002793925 0.003991554 0.05109716 0.942117359 0.05788264  202.2644
## [20,] 0.002012329 0.002887970 0.04069536 0.954404337 0.04559566  151.1536
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.891732453 0.077036571 0.02729812 0.003932861 0.99606714 6873.9976
##  [2,] 0.795186767 0.132372612 0.06161290 0.010827720 0.98917228 6646.6895
##  [3,] 0.581109882 0.227613353 0.15443873 0.036838031 0.96316197 4938.0759
##  [4,] 0.424665888 0.240775208 0.24828989 0.086269014 0.91373099 4929.2395
##  [5,] 0.310339098 0.218293224 0.31296293 0.158404752 0.84159525 4675.9953
##  [6,] 0.226790892 0.183606027 0.34407307 0.245530013 0.75446999 4231.9839
##  [7,] 0.165735188 0.147872766 0.34725385 0.339138195 0.66086181 3685.2361
##  [8,] 0.121116648 0.115853144 0.33073908 0.432291132 0.56770887 3111.7075
##  [9,] 0.088510126 0.089094385 0.30221017 0.520185318 0.47981468 2563.4382
## [10,] 0.064681797 0.067628830 0.26772304 0.599966332 0.40003367 2070.1505
## [11,] 0.047268432 0.050855410 0.23157959 0.670296571 0.32970343 1644.8331
## [12,] 0.034543020 0.037979562 0.19657386 0.730903555 0.26909645 1289.4649
## [13,] 0.025243492 0.028218541 0.16434084 0.782197125 0.21780288  999.5962
## [14,] 0.018447543 0.020885388 0.13568910 0.824977964 0.17502204  767.5848
## [15,] 0.013481172 0.015412710 0.11087462 0.860231497 0.13976850  584.6860
## [16,] 0.009851827 0.011348678 0.08980817 0.888991326 0.11100867  442.2883
## [17,] 0.007199559 0.008341959 0.07220354 0.912254945 0.08774506  332.5651
## [18,] 0.005261324 0.006123770 0.05767833 0.930936576 0.06906342  248.7529
## [19,] 0.003844892 0.004490852 0.04581917 0.945845084 0.05415492  185.2065
## [20,] 0.002809786 0.003290771 0.03622146 0.957677982 0.04232202  137.3324
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.866122703 0.100470734 0.02913026 0.004276304 0.99572370 6889.0387
##  [2,] 0.750168536 0.167109112 0.07076789 0.011954463 0.98804554 6699.6321
##  [3,] 0.545410704 0.251658255 0.16564272 0.037288317 0.96271168 5000.9522
##  [4,] 0.396541340 0.259295882 0.25974576 0.084417015 0.91558299 4997.6889
##  [5,] 0.288305735 0.233280268 0.32566076 0.152753234 0.84724677 4759.8826
##  [6,] 0.209612942 0.195853582 0.35898687 0.235546609 0.76445339 4335.6892
##  [7,] 0.152399277 0.157786909 0.36465450 0.325159311 0.67484069 3806.3269
##  [8,] 0.110802030 0.123744725 0.35027078 0.415182463 0.58481754 3243.8114
##  [9,] 0.080558715 0.095261392 0.32315765 0.501022242 0.49897776 2699.1220
## [10,] 0.058570286 0.072363542 0.28925652 0.579809649 0.42019035 2202.7559
## [11,] 0.042583579 0.054431986 0.25292012 0.650064320 0.34993568 1769.3169
## [12,] 0.030960429 0.040642088 0.21708151 0.711315973 0.28868403 1402.5678
## [13,] 0.022509807 0.030174718 0.18354627 0.763769202 0.23623080 1099.6457
## [14,] 0.016365776 0.022305559 0.15328982 0.808038849 0.19196115  854.1493
## [15,] 0.011898752 0.016432490 0.12671258 0.844956176 0.15504382  658.2085
## [16,] 0.008650998 0.012073459 0.10384016 0.875435378 0.12456462  503.7637
## [17,] 0.006289716 0.008852025 0.08447109 0.900387172 0.09961283  383.2852
## [18,] 0.004572944 0.006479270 0.06828077 0.920667017 0.07933298  290.1208
## [19,] 0.003324763 0.004736208 0.05489143 0.937047598 0.06295240  218.6114
## [20,] 0.002417272 0.003458387 0.04391681 0.950207535 0.04979246  164.0726
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.842540728 0.121185443 0.03062705 0.005646784 0.99435322 6894.4432
##  [2,] 0.709874878 0.193873977 0.08058856 0.015662589 0.98433741 6737.8181
##  [3,] 0.514931394 0.261835727 0.17818133 0.045051551 0.95494845 5036.4776
##  [4,] 0.373522643 0.259825268 0.26931935 0.097332737 0.90266726 4993.7153
##  [5,] 0.270947094 0.228778683 0.32978931 0.170484914 0.82951509 4711.4706
##  [6,] 0.196540502 0.189195366 0.35727711 0.256987021 0.74301298 4250.6783
##  [7,] 0.142567201 0.150642774 0.35785897 0.348931053 0.65106895 3697.0843
##  [8,] 0.103415869 0.117003215 0.33962933 0.439951590 0.56004841 3122.5935
##  [9,] 0.075016146 0.089329528 0.30999275 0.525661575 0.47433843 2575.9574
## [10,] 0.054415461 0.067368567 0.27475643 0.603459544 0.39654046 2084.8385
## [11,] 0.039472068 0.050350318 0.23804579 0.672131828 0.32786817 1661.1804
## [12,] 0.028632379 0.037378069 0.20254752 0.731442033 0.26855797 1306.5868
## [13,] 0.020769450 0.027606358 0.16984101 0.781783180 0.21821682 1016.6076
## [14,] 0.015065813 0.020309450 0.14071296 0.823911775 0.17608822  783.7734
## [15,] 0.010928489 0.014896059 0.11541681 0.858758637 0.14124136  599.5635
## [16,] 0.007927344 0.010899882 0.09387024 0.887302539 0.11269746  455.5780
## [17,] 0.005750363 0.007961105 0.07579711 0.910491419 0.08950858  344.1621
## [18,] 0.004171217 0.005806289 0.06082487 0.929197621 0.07080238  258.6778
## [19,] 0.003025731 0.004229913 0.04854801 0.944196344 0.05580366  193.5621
## [20,] 0.002194815 0.003078762 0.03856728 0.956159138 0.04384086  144.2690
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.858040930 0.103446910 0.03221258 0.006299578 0.99370042 6894.4546
##  [2,] 0.736234237 0.170516855 0.07686759 0.016381319 0.98361868 6706.4088
##  [3,] 0.532796386 0.249165932 0.17148384 0.046553843 0.95344616 4991.8276
##  [4,] 0.385572925 0.254749719 0.26040975 0.099267601 0.90073240 4940.6955
##  [5,] 0.279030573 0.228409727 0.31936963 0.173190074 0.82680993 4652.5415
##  [6,] 0.201928236 0.191367425 0.34586635 0.260837989 0.73916201 4187.1814
##  [7,] 0.146130985 0.153919058 0.34584450 0.354105458 0.64589454 3630.4584
##  [8,] 0.105751752 0.120520326 0.32732768 0.446400242 0.55359976 3054.6327
##  [9,] 0.076530197 0.092622885 0.29768265 0.533164268 0.46683573 2508.6324
## [10,] 0.055383206 0.070228026 0.26268756 0.611701207 0.38829879 2020.0174
## [11,] 0.040079598 0.052715704 0.22643512 0.680769577 0.31923042 1600.4099
## [12,] 0.029004716 0.039269683 0.19157250 0.740153101 0.25984690 1250.9777
## [13,] 0.020990069 0.029081754 0.15963480 0.790293372 0.20970663  966.8157
## [14,] 0.015190048 0.021438303 0.13136354 0.832008105 0.16799190  740.0449
## [15,] 0.010992701 0.015746712 0.10696978 0.866290806 0.13370919  561.8145
## [16,] 0.007955174 0.011533023 0.08633428 0.894177527 0.10582247  423.4845
## [17,] 0.005756983 0.008427558 0.06915096 0.916664504 0.08333550  317.2448
## [18,] 0.004166201 0.006146991 0.05502462 0.934662185 0.06533781  236.3731
## [19,] 0.003014987 0.004476941 0.04353412 0.948973947 0.05102605  175.2784
## [20,] 0.002181879 0.003256731 0.03427070 0.960290694 0.03970931  129.4260
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.899290425 0.070586004 0.02696095 0.003162618 0.99683738 6875.3824
##  [2,] 0.808723268 0.123547392 0.05888946 0.008839879 0.99116012 6641.8114
##  [3,] 0.573731744 0.235143765 0.15765617 0.033468322 0.96653168 4971.0766
##  [4,] 0.407021940 0.250913393 0.25907411 0.082990555 0.91700944 4998.0858
##  [5,] 0.288753170 0.225952869 0.32849306 0.156800896 0.84319910 4756.2658
##  [6,] 0.204849874 0.187635164 0.36102402 0.246490945 0.75350905 4304.1124
##  [7,] 0.145326443 0.148700559 0.36313689 0.342836111 0.65716389 3739.0489
##  [8,] 0.103098794 0.114379363 0.34412258 0.438399266 0.56160073 3144.6313
##  [9,] 0.073141275 0.086210945 0.31252987 0.528117906 0.47188209 2577.4794
## [10,] 0.051888542 0.064049474 0.27499862 0.609063362 0.39093664 2069.3832
## [11,] 0.036811237 0.047085696 0.23616221 0.679940863 0.32005914 1633.7604
## [12,] 0.026114959 0.034343086 0.19896052 0.740581430 0.25941857 1272.1327
## [13,] 0.018526709 0.024899431 0.16505434 0.791519516 0.20848048  979.2245
## [14,] 0.013143385 0.017969669 0.13520970 0.833677249 0.16632275  746.5083
## [15,] 0.009324299 0.012922267 0.10960786 0.868145576 0.13185442  564.4507
## [16,] 0.006614928 0.009266674 0.08807571 0.896042684 0.10395732  423.8096
## [17,] 0.004692822 0.006630632 0.07024716 0.918429384 0.08157062  316.2926
## [18,] 0.003329224 0.004736224 0.05567041 0.936264143 0.06373586  234.8158
## [19,] 0.002361848 0.003378409 0.04387548 0.950384259 0.04961574  173.5297
## [20,] 0.001675563 0.002407229 0.03441387 0.961503338 0.03849666  127.7233
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.887805138 0.079313273 0.02883290 0.004048689 0.99595131 6882.9061
##  [2,] 0.788197962 0.135595730 0.06539407 0.010812233 0.98918777 6668.6728
##  [3,] 0.576282767 0.227505399 0.16103789 0.035173946 0.96482605 4979.7180
##  [4,] 0.421343170 0.239892915 0.25806271 0.080701204 0.91929880 4999.6227
##  [5,] 0.308060690 0.217542630 0.32704506 0.147351618 0.85264838 4783.1871
##  [6,] 0.225235379 0.183204831 0.36292859 0.228631201 0.77136880 4374.9610
##  [7,] 0.164678512 0.147786903 0.37050718 0.317027408 0.68297259 3855.9142
##  [8,] 0.120402986 0.115982481 0.35742986 0.406184675 0.59381533 3298.8660
##  [9,] 0.088031395 0.089343122 0.33110958 0.491515900 0.50848410 2755.8322
## [10,] 0.064363242 0.067925891 0.29758367 0.570127192 0.42987281 2258.3056
## [11,] 0.047058517 0.051155191 0.26129298 0.640493313 0.35950669 1821.7582
## [12,] 0.034406347 0.038256446 0.22524842 0.702088784 0.29791122 1450.6719
## [13,] 0.025155844 0.028460644 0.19132317 0.755060345 0.24493966 1142.7537
## [14,] 0.018392434 0.021089387 0.16055036 0.799967822 0.20003218  892.0347
## [15,] 0.013447438 0.015580120 0.13337867 0.837593774 0.16240623  690.9554
## [16,] 0.009831955 0.011483402 0.10987287 0.868811771 0.13118823  531.6650
## [17,] 0.007188532 0.008448778 0.08986221 0.894500477 0.10549952  406.7607
## [18,] 0.005255820 0.006207495 0.07304520 0.915491484 0.08450852  309.6545
## [19,] 0.003842739 0.004555885 0.05906049 0.932540891 0.06745911  234.7055
## [20,] 0.002809578 0.003340923 0.04753264 0.946316861 0.05368314  177.2162
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.881506759 0.086073249 0.02753737 0.004882618 0.99511738 6871.5516
##  [2,] 0.777054166 0.146289795 0.06403492 0.012621116 0.98737888 6652.4645
##  [3,] 0.561190611 0.240703990 0.15865752 0.039447883 0.96055212 4952.4405
##  [4,] 0.405293370 0.251293669 0.25490082 0.088512138 0.91148786 4955.4947
##  [5,] 0.292703963 0.225908414 0.32171957 0.159668050 0.84033195 4713.8308
##  [6,] 0.211391590 0.188629711 0.35434807 0.245630630 0.75436937 4277.9540
##  [7,] 0.152667576 0.150841233 0.35833475 0.338156445 0.66184355 3735.1735
##  [8,] 0.110256934 0.117318520 0.34198718 0.430437371 0.56956263 3161.9490
##  [9,] 0.079627855 0.089534237 0.31312676 0.517711147 0.48228885 2611.2782
## [10,] 0.057507451 0.067418516 0.27796105 0.597112980 0.40288702 2113.8725
## [11,] 0.041532036 0.050270847 0.24092759 0.667269527 0.33273047 1683.5517
## [12,] 0.029994548 0.037212494 0.20492916 0.727863793 0.27213621 1322.9129
## [13,] 0.021662143 0.027395011 0.17168108 0.779261767 0.22073823 1027.9219
## [14,] 0.015644458 0.020083012 0.14204691 0.822225620 0.17777438  791.1862
## [15,] 0.011298470 0.014675066 0.11631710 0.857709367 0.14229063  604.0884
## [16,] 0.008159785 0.010696480 0.09442133 0.886722408 0.11327759  458.0599
## [17,] 0.005893019 0.007781295 0.07608116 0.910244522 0.08975548  345.2633
## [18,] 0.004255954 0.005651943 0.06091445 0.929177648 0.07082235  258.8932
## [19,] 0.003073662 0.004100357 0.04850330 0.944322686 0.05567731  193.2468
## [20,] 0.002219807 0.002971904 0.03843581 0.956372477 0.04362752  143.6680
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.892539621 0.075312710 0.02798267 0.004164995 0.99583500 6875.9937
##  [2,] 0.796626974 0.130560434 0.06195454 0.010858056 0.98914194 6647.9205
##  [3,] 0.575297539 0.232018576 0.15653525 0.036148631 0.96385137 4953.0881
##  [4,] 0.415460772 0.248682035 0.25215677 0.083700421 0.91629958 4960.4818
##  [5,] 0.300031969 0.227374065 0.31890965 0.153684313 0.84631569 4723.5386
##  [6,] 0.216673122 0.192347450 0.35198528 0.238994148 0.76100585 4291.8691
##  [7,] 0.156474131 0.155484954 0.35664194 0.331398974 0.66860103 3751.6736
##  [8,] 0.113000420 0.122050722 0.34095143 0.423997425 0.57600258 3179.1056
##  [9,] 0.081605149 0.093892477 0.31261042 0.511891958 0.48810804 2627.4703
## [10,] 0.058932528 0.071193732 0.27779013 0.592083606 0.40791639 2128.0372
## [11,] 0.042559114 0.053409147 0.24094358 0.663088159 0.33691184 1695.1820
## [12,] 0.030734779 0.039745626 0.20501122 0.724508376 0.27549162 1331.9349
## [13,] 0.022195636 0.029395245 0.17174979 0.776659324 0.22334068 1034.5430
## [14,] 0.016028951 0.021636028 0.14205871 0.820276312 0.17972369  795.7624
## [15,] 0.011575576 0.015864995 0.11625523 0.856304203 0.14369580  607.0256
## [16,] 0.008359497 0.011598638 0.09428681 0.885755060 0.11424494  459.7509
## [17,] 0.006036951 0.008459476 0.07588524 0.909618338 0.09038166  346.0537
## [18,] 0.004359685 0.006158232 0.06067298 0.928809105 0.07119090  259.0668
## [19,] 0.003148420 0.004476179 0.04823299 0.944142411 0.05585759  193.0250
## [20,] 0.002273684 0.003249575 0.03815200 0.956324737 0.04367526  143.2154
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.875049125 0.089774797 0.03041226 0.004763823 0.99523618 6890.3369
##  [2,] 0.765710971 0.150611773 0.07072430 0.012952953 0.98704705 6688.7155
##  [3,] 0.554980106 0.236538917 0.16791171 0.040569266 0.95943073 4995.2359
##  [4,] 0.402244358 0.243440603 0.26353620 0.090778836 0.90922116 4987.3723
##  [5,] 0.291542926 0.217140915 0.32887505 0.162441110 0.83755889 4734.8842
##  [6,] 0.211307569 0.180385807 0.36015077 0.248155854 0.75184415 4292.8432
##  [7,] 0.153153738 0.143744942 0.36321035 0.339890972 0.66010903 3748.2388
##  [8,] 0.111004388 0.111534892 0.34634814 0.431112579 0.56888742 3175.8459
##  [9,] 0.080454936 0.084993955 0.31726364 0.517287466 0.48271253 2627.0514
## [10,] 0.058312980 0.063951145 0.28203143 0.595704444 0.40429556 2131.4665
## [11,] 0.042264699 0.047678573 0.24498390 0.665072826 0.33492717 1702.3300
## [12,] 0.030633056 0.035307281 0.20895556 0.725104104 0.27489590 1342.0449
## [13,] 0.022202551 0.026014490 0.17562605 0.776156908 0.22384309 1046.6198
## [14,] 0.016092200 0.019094782 0.14584735 0.818965668 0.18103433  808.8228
## [15,] 0.011663475 0.013975221 0.11991366 0.854447647 0.14555235  620.2343
## [16,] 0.008453577 0.010205702 0.09776671 0.883574006 0.11642599  472.4736
## [17,] 0.006127073 0.007440291 0.07914338 0.907289253 0.09271075  357.8592
## [18,] 0.004440845 0.005417124 0.06367678 0.926465246 0.07353475  269.7020
## [19,] 0.003218683 0.003940113 0.05096246 0.941878743 0.05812126  202.3781
## [20,] 0.002332871 0.002863576 0.04059932 0.954204237 0.04579576  151.2782</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 9.074398 9.062304 9.290701 8.995456 8.887815 8.973342 9.415560
##  [8] 9.084650 9.147591 9.103184</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 51428.98 50358.82 51978.64 50869.04 49988.72 50549.52 52516.16
##  [8] 50874.80 51004.74 51245.73</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 6172.922 5579.836 6060.740 6851.557 6337.158 5291.162 5555.854
##  [8] 5682.480 5462.776 5842.288</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     8.115527      9.074398       45509.95        51428.98 6172.922
##  [2,]     7.909123      9.062304       43924.26        50358.82 5579.836
##  [3,]     8.315835      9.290701       46070.23        51978.64 6060.740
##  [4,]     8.176337      8.995456       45256.80        50869.04 6851.557
##  [5,]     7.950160      8.887815       44046.66        49988.72 6337.158
##  [6,]     7.707442      8.973342       43851.45        50549.52 5291.162
##  [7,]     8.303288      9.415560       46336.54        52516.16 5555.854
##  [8,]     7.980690      9.084650       44601.58        50874.80 5682.480
##  [9,]     7.965991      9.147591       44549.92        51004.74 5462.776
## [10,]     8.054552      9.103184       45119.32        51245.73 5842.288</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
