<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7244262 0.1998024 0.0681311 0.007640282
## [2,] 0.0000000 0.5487060 0.4401835 0.011110495
## [3,] 0.0000000 0.0000000 0.7496825 0.250317489
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7173549 0.2017366 0.07382721 0.007081251
## [2,] 0.0000000 0.5987266 0.38870020 0.012573245
## [3,] 0.0000000 0.0000000 0.76682362 0.233176384
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7173805 0.2064262 0.06474619 0.01144714
## [2,] 0.0000000 0.5794912 0.41042718 0.01008162
## [3,] 0.0000000 0.0000000 0.74807952 0.25192048
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7256362 0.1975963 0.06802408 0.008743371
## [2,] 0.0000000 0.6031035 0.38623410 0.010662363
## [3,] 0.0000000 0.0000000 0.75162315 0.248376852
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7411746 0.1788206 0.07197365 0.008031182
## [2,] 0.0000000 0.5988090 0.38541990 0.015771066
## [3,] 0.0000000 0.0000000 0.75671199 0.243288006
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7166368 0.2138779 0.06145416 0.00803116
## [2,] 0.0000000 0.5814748 0.40399413 0.01453110
## [3,] 0.0000000 0.0000000 0.76498061 0.23501939
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7168325 0.2095178 0.06479548 0.00885428
## [2,] 0.0000000 0.5852223 0.40138341 0.01339432
## [3,] 0.0000000 0.0000000 0.75606204 0.24393796
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7385047 0.1837468 0.07025733 0.007491207
## [2,] 0.0000000 0.5850985 0.40040232 0.014499164
## [3,] 0.0000000 0.0000000 0.75351946 0.246480545
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7276028 0.1967155 0.06897191 0.006709822
## [2,] 0.0000000 0.5628440 0.42232296 0.014833070
## [3,] 0.0000000 0.0000000 0.73072264 0.269277362
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7314231 0.2052035 0.05742551 0.00594796
## [2,] 0.0000000 0.5565423 0.43005285 0.01340485
## [3,] 0.0000000 0.0000000 0.76104813 0.23895187
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.5856223 0.5596294 0.4510649 0.4383559 0.4406390 0.5681444 0.4272787
##  [8] 0.5207135 0.5647912 0.4839455</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8386178 0.1170088 0.03989909 0.004474320
## [2,] 0.0000000 0.7357121 0.25778131 0.006506554
## [3,] 0.0000000 0.0000000 0.85340849 0.146591511
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8418235 0.1128978 0.04131588 0.003962877
## [2,] 0.0000000 0.7754356 0.21752807 0.007036358
## [3,] 0.0000000 0.0000000 0.86950763 0.130492370
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8725203 0.0931116 0.02920473 0.005163401
## [2,] 0.0000000 0.8103233 0.18512928 0.004547463
## [3,] 0.0000000 0.0000000 0.88636752 0.113632476
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##          [,1]       [,2]       [,3]        [,4]
## [1,] 0.879731 0.08661751 0.02981876 0.003832708
## [2,] 0.000000 0.82601808 0.16930801 0.004673910
## [3,] 0.000000 0.00000000 0.89112253 0.108877467
## [4,] 0.000000 0.00000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.8859515 0.0787953 0.0317144 0.003538852
## [2,] 0.0000000 0.8232196 0.1698310 0.006949346
## [3,] 0.0000000 0.0000000 0.8927978 0.107202173
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8390088 0.1215135 0.03491484 0.004562859
## [2,] 0.0000000 0.7622172 0.22952702 0.008255766
## [3,] 0.0000000 0.0000000 0.86647504 0.133524958
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8790085 0.08952248 0.02768573 0.003783245
## [2,] 0.0000000 0.82277432 0.17150257 0.005723107
## [3,] 0.0000000 0.00000000 0.89577051 0.104229490
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8638358 0.09567945 0.03658394 0.003900773
## [2,] 0.0000000 0.78395518 0.20849490 0.007549911
## [3,] 0.0000000 0.00000000 0.87165424 0.128345755
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8461524 0.1111032 0.03895473 0.003789649
## [2,] 0.0000000 0.7530981 0.23852431 0.008377588
## [3,] 0.0000000 0.0000000 0.84791450 0.152085498
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8700234 0.09930729 0.02779082 0.002878488
## [2,] 0.0000000 0.78539066 0.20812213 0.006487215
## [3,] 0.0000000 0.00000000 0.88436032 0.115639677
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.724426206 0.199802415 0.06813110 0.007640282 0.99235972 5170.3470
##  [2,] 0.524793328 0.254374881 0.18838238 0.032449411 0.96755059 5449.9136
##  [3,] 0.380174040 0.244431987 0.28895336 0.086440615 0.91355938 5438.5980
##  [4,] 0.275408038 0.210080979 0.35011989 0.164391092 0.83560891 5114.7378
##  [5,] 0.199512800 0.170299876 0.37371680 0.256470523 0.74352948 4580.2740
##  [6,] 0.144532301 0.133307696 0.36872518 0.353434824 0.64656518 3947.1934
##  [7,] 0.104702986 0.102024629 0.34495382 0.448318567 0.55168143 3301.1240
##  [8,] 0.075849587 0.076901432 0.31064894 0.536600045 0.46339995 2696.2323
##  [9,] 0.054947429 0.057351204 0.27190653 0.615794832 0.38420517 2160.8748
## [10,] 0.039805357 0.042447576 0.23283226 0.684914808 0.31508519 1705.4146
## [11,] 0.028836044 0.031244445 0.19594698 0.743972532 0.25602747 1329.0613
## [12,] 0.020889586 0.022905524 0.16261595 0.793588945 0.20641106 1024.9325
## [13,] 0.015132963 0.016742187 0.13341620 0.834708654 0.16529135  783.4380
## [14,] 0.010962715 0.012210141 0.10842045 0.868406695 0.13159331  594.3601
## [15,] 0.007941678 0.008890154 0.08740252 0.895765649 0.10423435  448.0176
## [16,] 0.005753160 0.006464847 0.06997851 0.917803478 0.08219652  335.8301
## [17,] 0.004167740 0.004696795 0.05569936 0.935436108 0.06456389  250.5156
## [18,] 0.003019220 0.003409884 0.04410824 0.949462658 0.05053734  186.0798
## [19,] 0.002187202 0.002474271 0.03477385 0.960564674 0.03943533  137.6987
## [20,] 0.001584466 0.001794656 0.02730750 0.969313379 0.03068662  101.5569
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.717354922 0.201736616 0.07382721 0.007081251 0.99291875 5207.1329
##  [2,] 0.514598084 0.265501825 0.18798782 0.031912267 0.96808773 5453.0563
##  [3,] 0.369149468 0.262776270 0.28534546 0.082728806 0.91727119 5439.9096
##  [4,] 0.264811188 0.231802097 0.34820410 0.155182618 0.84481738 5147.0626
##  [5,] 0.189963609 0.192208185 0.37666292 0.241165289 0.75883471 4656.4552
##  [6,] 0.136271330 0.153402761 0.37756986 0.332756047 0.66724395 4063.7468
##  [7,] 0.097754909 0.119337224 0.35921770 0.423690164 0.57630984 3446.2843
##  [8,] 0.070124965 0.091171110 0.32905999 0.509643932 0.49035607 2856.2278
##  [9,] 0.050304489 0.068733338 0.29294633 0.588015841 0.41198416 2323.4861
## [10,] 0.036086173 0.051300733 0.25506867 0.657544427 0.34245557 1861.4317
## [11,] 0.025886594 0.037995014 0.21819742 0.717920969 0.28207903 1472.4683
## [12,] 0.018569875 0.027970898 0.18399874 0.769460485 0.23053951 1152.4677
## [13,] 0.013321191 0.020493143 0.15333784 0.812847829 0.18715217  893.9376
## [14,] 0.009556022 0.014957161 0.12653223 0.848954588 0.15104541  688.1066
## [15,] 0.006855060 0.010883049 0.10354725 0.878714644 0.12128536  526.1903
## [16,] 0.004917511 0.007898887 0.08413881 0.903044794 0.09695521  400.0872
## [17,] 0.003527601 0.005721316 0.06795297 0.922798114 0.07720189  302.6998
## [18,] 0.002530542 0.004137150 0.05459225 0.938740057 0.06125994  228.0259
## [19,] 0.001815296 0.002987524 0.04365756 0.951539618 0.04846038  171.1189
## [20,] 0.001302212 0.002154922 0.03477292 0.961769948 0.03823005  127.9813
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.717380497 0.206426181 0.06474619 0.01144714 0.98855286 5134.15630
##  [2,] 0.514634777 0.267708272 0.17960586 0.03805109 0.96194891 5379.50225
##  [3,] 0.369188952 0.261368679 0.27755486 0.09188751 0.90811249 5359.96059
##  [4,] 0.264848954 0.227671115 0.33880949 0.16867044 0.83132956 5045.79647
##  [5,] 0.189997474 0.186605166 0.36404682 0.25935055 0.74064945 4527.87723
##  [6,] 0.136300482 0.147356504 0.36122541 0.35511760 0.64488240 3911.10384
##  [7,] 0.097779308 0.113527785 0.33952938 0.44916353 0.55083647 3278.00879
##  [8,] 0.070144968 0.085972562 0.30692070 0.53696177 0.46303823 2682.15253
##  [9,] 0.050320632 0.064300101 0.26942819 0.61595108 0.38404892 2152.45692
## [10,] 0.036099040 0.047648838 0.23120229 0.68504984 0.31495016 1700.20526
## [11,] 0.025896747 0.035063870 0.19485135 0.74418804 0.25581196 1325.47754
## [12,] 0.018577821 0.025664970 0.16183218 0.79392503 0.20607497 1022.06283
## [13,] 0.013327367 0.018707573 0.13279979 0.83516527 0.16483473  780.82650
## [14,] 0.009560793 0.013591992 0.10788579 0.86896142 0.13103858  591.82767
## [15,] 0.006858726 0.009850037 0.08690470 0.89638654 0.10361346  445.53354
## [16,] 0.004920317 0.007123831 0.06949842 0.91845743 0.08154257  333.42967
## [17,] 0.003529739 0.005143879 0.05523273 0.93609365 0.06390635  248.25228
## [18,] 0.002532166 0.003709463 0.04365820 0.95010017 0.04989983  184.00097
## [19,] 0.001816527 0.002672307 0.03434622 0.96116495 0.03883505  135.83585
## [20,] 0.001303141 0.001923557 0.02690810 0.96986520 0.03013480   99.92422
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.725636244 0.197596304 0.06802408 0.008743371 0.99125663 5163.8612
##  [2,] 0.526547958 0.262554070 0.17680764 0.034090328 0.96590967 5380.3221
##  [3,] 0.382082283 0.262391219 0.27011799 0.085408504 0.91459150 5348.5671
##  [4,] 0.277252752 0.233747119 0.33036217 0.158637959 0.84136204 5045.3987
##  [5,] 0.201184646 0.195757833 0.35744883 0.245608694 0.75439131 4550.7744
##  [6,] 0.145986871 0.157815584 0.35796056 0.338236982 0.66176302 3958.8046
##  [7,] 0.105933364 0.124025603 0.33993583 0.430105204 0.56989480 3345.5704
##  [8,] 0.076869089 0.095732321 0.31061257 0.516786015 0.48321398 2762.1674
##  [9,] 0.055778997 0.072925549 0.27566764 0.595627817 0.40437218 2237.6094
## [10,] 0.040475262 0.055003380 0.23915883 0.665362532 0.33463747 1784.5336
## [11,] 0.029370317 0.041170495 0.20375478 0.725704404 0.27429560 1404.7641
## [12,] 0.021312166 0.030633537 0.17104615 0.777008146 0.22299185 1093.7391
## [13,] 0.015464880 0.022686400 0.14184370 0.820005017 0.17999498  843.6641
## [14,] 0.011221878 0.016738051 0.11642726 0.855612815 0.14438719  645.5764
## [15,] 0.008143001 0.012312179 0.09473758 0.884807234 0.11519277  490.5908
## [16,] 0.005908857 0.009034546 0.07651627 0.908540332 0.09145967  370.5729
## [17,] 0.004287681 0.006616335 0.06140279 0.927693194 0.07230681  278.4415
## [18,] 0.003111296 0.004837565 0.04899888 0.943052260 0.05694774  208.2439
## [19,] 0.002257669 0.003532333 0.03890877 0.955301230 0.04469877  155.1024
## [20,] 0.001638247 0.002576470 0.03076261 0.965022670 0.03497733  115.0982
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.741174613 0.178820552 0.07197365 0.008031182 0.99196882 5185.2917
##  [2,] 0.549339807 0.239616615 0.17672937 0.034314207 0.96568579 5372.8410
##  [3,] 0.407156719 0.241717841 0.26562424 0.085501200 0.91449880 5319.4521
##  [4,] 0.301774223 0.217550815 0.32346847 0.157206490 0.84279351 5013.1758
##  [5,] 0.223667393 0.184234826 0.35034068 0.241757101 0.75824290 4529.5113
##  [6,] 0.165776594 0.150317804 0.35221292 0.331692679 0.66830732 3955.1361
##  [7,] 0.122869403 0.119655921 0.33639076 0.421083913 0.57891609 3360.1747
##  [8,] 0.091067682 0.093622620 0.30951206 0.505797639 0.49420236 2792.1650
##  [9,] 0.067497054 0.072346844 0.27684998 0.583306120 0.41669388 2278.5965
## [10,] 0.050027103 0.055391804 0.24223763 0.652343468 0.34765653 1831.9405
## [11,] 0.037078819 0.042114987 0.20825385 0.712552341 0.28744766 1454.6038
## [12,] 0.027481879 0.031849289 0.17648884 0.764179991 0.23582001 1142.9187
## [13,] 0.020368871 0.023985967 0.14780454 0.807840618 0.19215938  890.0235
## [14,] 0.015096890 0.018005386 0.12255616 0.844341562 0.15565844  687.7836
## [15,] 0.011189432 0.013481422 0.10076593 0.874563216 0.12543678  527.9768
## [16,] 0.008293323 0.010073698 0.08225214 0.899380839 0.10061916  402.9587
## [17,] 0.006146800 0.007515238 0.06672069 0.919617276 0.08038272  305.9828
## [18,] 0.004555852 0.005599366 0.05382727 0.936017508 0.06398249  231.3038
## [19,] 0.003376682 0.004167631 0.04321775 0.949237935 0.05076206  174.1552
## [20,] 0.002502711 0.003099435 0.03455271 0.959845142 0.04015486  130.6605
## 
## , , 6
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.716636826 0.213877856 0.06145416 0.00803116 0.99196884 5133.0462
##  [2,] 0.513568340 0.277637323 0.17745695 0.03133738 0.96866262 5400.2418
##  [3,] 0.368041985 0.271279992 0.27947589 0.08120214 0.91879786 5417.6695
##  [4,] 0.263752440 0.236458499 0.34600687 0.15378219 0.84621781 5142.8591
##  [5,] 0.189014711 0.193905456 0.37642508 0.24065475 0.75934525 4657.6401
##  [6,] 0.135454903 0.153177190 0.37791030 0.33345761 0.66654239 4062.7102
##  [7,] 0.097071971 0.118039474 0.35930100 0.42558755 0.57441245 3440.0229
##  [8,] 0.069565349 0.089398520 0.32851103 0.51252510 0.48747490 2844.6457
##  [9,] 0.049853091 0.066861471 0.29169613 0.59158931 0.40841069 2307.8849
## [10,] 0.035726561 0.049540730 0.25321721 0.66151550 0.33848450 1843.5157
## [11,] 0.025602969 0.036447805 0.21591596 0.72203326 0.27796674 1453.8091
## [12,] 0.018348031 0.026669387 0.18146963 0.77351295 0.22648705 1134.2812
## [13,] 0.013148874 0.019431813 0.15072259 0.81669672 0.18330328  877.0419
## [14,] 0.009422968 0.014111362 0.12395825 0.85250742 0.14749258  672.9687
## [15,] 0.006752846 0.010220765 0.10110565 0.88192074 0.11807926  513.0056
## [16,] 0.004839338 0.007387401 0.08188798 0.90588528 0.09411472  388.8603
## [17,] 0.003468048 0.005330614 0.06592458 0.92527676 0.07472324  293.3145
## [18,] 0.002485331 0.003841356 0.05279769 0.94087562 0.05912438  220.2988
## [19,] 0.001781080 0.002765209 0.04209383 0.95335988 0.04664012  164.8379
## [20,] 0.001276387 0.001988833 0.03342755 0.96330723 0.03669277  122.9308
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.716832464 0.209517776 0.06479548 0.00885428 0.99114572 5147.6239
##  [2,] 0.513848782 0.272803612 0.17953387 0.03381374 0.96618626 5399.4283
##  [3,] 0.368343488 0.267311203 0.27853266 0.08581265 0.91418735 5392.2457
##  [4,] 0.264040571 0.233610978 0.34174925 0.16059920 0.83940080 5093.9282
##  [5,] 0.189272853 0.192035540 0.36925984 0.24943177 0.75056823 4590.7404
##  [6,] 0.135676926 0.152039502 0.36852725 0.34375632 0.65624368 3984.5767
##  [7,] 0.097257625 0.117403630 0.34844685 0.43689189 0.56310811 3356.9283
##  [8,] 0.069717423 0.089084420 0.31687316 0.52432500 0.47567500 2761.6754
##  [9,] 0.049975712 0.066741226 0.27985015 0.60343291 0.39656709 2228.7448
## [10,] 0.035824213 0.049529252 0.24161109 0.67303544 0.32696456 1770.6203
## [11,] 0.025679959 0.036491431 0.20487444 0.73295417 0.26704583 1388.4962
## [12,] 0.018408228 0.026736006 0.17120879 0.78364698 0.21635302 1077.0624
## [13,] 0.013195616 0.019503357 0.14136863 0.82593240 0.17406760  827.8406
## [14,] 0.009459046 0.014178515 0.11556679 0.86079565 0.13920435  631.3225
## [15,] 0.006780551 0.010279421 0.09367959 0.88926044 0.11073956  478.2261
## [16,] 0.004860519 0.007436392 0.07539292 0.91231017 0.08768983  360.1521
## [17,] 0.003484178 0.005370307 0.06030151 0.93084401 0.06915599  269.8577
## [18,] 0.002497572 0.003872821 0.04797299 0.94565662 0.05434338  201.3041
## [19,] 0.001790341 0.002789747 0.03798688 0.95743304 0.04256696  149.5782
## [20,] 0.001283374 0.002007730 0.02995620 0.96675270 0.03324730  110.7585
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.738504651 0.183746811 0.07025733 0.007491207 0.99250879 5179.1103
##  [2,] 0.545389120 0.243207862 0.17839828 0.033004738 0.96699526 5388.9385
##  [3,] 0.402772402 0.242514071 0.27012515 0.084588377 0.91541162 5347.1310
##  [4,] 0.297449292 0.215902769 0.32894547 0.157702474 0.84229753 5037.9304
##  [5,] 0.219667686 0.180979749 0.35521277 0.244139795 0.75586020 4542.5864
##  [6,] 0.162225608 0.146254220 0.35555771 0.335962463 0.66403754 3953.8751
##  [7,] 0.119804366 0.115381566 0.33787772 0.426936351 0.57306365 3345.9216
##  [8,] 0.088476081 0.089523253 0.30921362 0.512787050 0.48721295 2768.1579
##  [9,] 0.065339998 0.068637121 0.27505989 0.590962995 0.40903700 2248.5087
## [10,] 0.048253892 0.052165494 0.23933605 0.660244562 0.33975544 1799.0695
## [11,] 0.035635724 0.039388452 0.20462175 0.720354079 0.27964592 1421.5293
## [12,] 0.026317148 0.029594076 0.17246136 0.771627412 0.22837259 1111.4439
## [13,] 0.019435336 0.022151142 0.14365150 0.814762020 0.18523798  861.2621
## [14,] 0.014353086 0.016531781 0.11847905 0.850636087 0.14936391  662.3032
## [15,] 0.010599821 0.012310055 0.09690404 0.880186086 0.11981391  505.9481
## [16,] 0.007828017 0.009150278 0.07869277 0.904328937 0.09567106  384.2874
## [17,] 0.005781027 0.006792187 0.06351030 0.923916486 0.07608351  290.4136
## [18,] 0.004269315 0.005036344 0.05098201 0.939712327 0.06028767  218.4980
## [19,] 0.003152909 0.003731230 0.04073245 0.952383407 0.04761659  163.7444
## [20,] 0.002328438 0.002762474 0.03240820 0.962500883 0.03749912  122.2811
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.727602792 0.196715472 0.06897191 0.006709822 0.99329018 5178.8622
##  [2,] 0.529405823 0.253850844 0.18366096 0.033082377 0.96691762 5420.6727
##  [3,] 0.385197155 0.247020734 0.27792639 0.089855721 0.91014428 5366.9324
##  [4,] 0.280270526 0.214808371 0.33397742 0.170943686 0.82905631 5009.7909
##  [5,] 0.203925617 0.176037145 0.35409416 0.265943077 0.73405692 4454.2506
##  [6,] 0.148376848 0.139196770 0.34715429 0.365272094 0.63472791 3811.3579
##  [7,] 0.107959409 0.107534085 0.32269332 0.461813183 0.53818682 3164.4871
##  [8,] 0.078551567 0.081762198 0.28865960 0.551026638 0.44897336 2565.3290
##  [9,] 0.057154340 0.061471669 0.25087801 0.630495985 0.36950402 2039.9883
## [10,] 0.041585657 0.045842101 0.21322518 0.699347061 0.30065294 1596.9682
## [11,] 0.030257840 0.033982492 0.17803688 0.757722787 0.24227721 1234.0476
## [12,] 0.022015689 0.025079026 0.14653411 0.806371178 0.19362882  943.3152
## [13,] 0.016018677 0.018446406 0.11918570 0.846349216 0.15365078  714.4957
## [14,] 0.011655234 0.013533570 0.09598687 0.878824326 0.12117567  536.9614
## [15,] 0.008480381 0.009910053 0.07665920 0.904950366 0.09504963  400.8289
## [16,] 0.006170349 0.007246036 0.06078676 0.925796852 0.07420315  297.4634
## [17,] 0.004489563 0.005292191 0.04790401 0.942314234 0.05768577  219.6266
## [18,] 0.003266619 0.003861844 0.03754921 0.955322324 0.04467768  161.4281
## [19,] 0.002376801 0.002816210 0.02929431 0.965512678 0.03448732  118.1787
## [20,] 0.001729367 0.002052640 0.02275930 0.973458694 0.02654131   86.2093
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.731423052 0.205203474 0.05742551 0.00594796 0.99405204 5116.7595
##  [2,] 0.534979681 0.264294965 0.17395426 0.02677109 0.97322891 5397.6982
##  [3,] 0.391296471 0.256871018 0.27676985 0.07506266 0.92493734 5425.8354
##  [4,] 0.286203259 0.223254984 0.34357369 0.14696806 0.85303194 5154.8865
##  [5,] 0.209335661 0.182980746 0.37392293 0.23376067 0.76623933 4669.4694
##  [6,] 0.153112928 0.144792931 0.37528594 0.32680820 0.67319180 4072.9932
##  [7,] 0.111990325 0.112002696 0.35667187 0.41933511 0.58066489 3448.8370
##  [8,] 0.081912306 0.085315043 0.32604264 0.50673002 0.49326998 2852.5096
##  [9,] 0.059912549 0.064290120 0.28952797 0.58626936 0.41373064 2315.2637
## [10,] 0.043821419 0.048074435 0.25143338 0.65667077 0.34332923 1850.6652
## [11,] 0.032051996 0.035747764 0.21454392 0.71765632 0.28234368 1460.7889
## [12,] 0.023443569 0.026472324 0.18049228 0.76959183 0.23040817 1141.0256
## [13,] 0.017147167 0.019543670 0.15009407 0.81321510 0.18678490  883.4325
## [14,] 0.012541833 0.014395537 0.12361830 0.84944432 0.15055568  678.8861
## [15,] 0.009173386 0.010585353 0.10099054 0.87925072 0.12074928  518.3588
## [16,] 0.006709626 0.007773607 0.08193771 0.90357906 0.09642094  393.5977
## [17,] 0.004907575 0.005703180 0.06608691 0.92330234 0.07669766  297.4233
## [18,] 0.003589513 0.004181112 0.05302981 0.93919957 0.06080043  223.7983
## [19,] 0.002625453 0.003063547 0.04236246 0.95194854 0.04805146  167.7703
## [20,] 0.001920317 0.002243745 0.03370813 0.96212781 0.03787219  125.3524</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7.944522 8.264488 7.914042 8.158645 8.311390 8.224941 8.074461
##  [8] 8.225772 7.768888 8.306361</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 44756.20 46417.88 44338.39 45183.40 45586.65 46091.58 45221.11
##  [8] 45352.94 43321.19 46195.35</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.838617834 0.117008755 0.03989909 0.00447432 0.99552568 6955.8322
##  [2,] 0.703279871 0.184210389 0.09767298 0.01483676 0.98516324 6835.5532
##  [3,] 0.509474369 0.241594355 0.20222534 0.04670594 0.95329406 5150.6486
##  [4,] 0.369076584 0.234358471 0.29266171 0.10390324 0.89609676 5077.1220
##  [5,] 0.267368750 0.202336282 0.34770970 0.18258527 0.81741473 4743.8121
##  [6,] 0.193688929 0.164444045 0.36795311 0.27391392 0.72608608 4232.4898
##  [7,] 0.140313336 0.128930943 0.36142981 0.36932591 0.63067409 3639.3752
##  [8,] 0.101646658 0.098780120 0.33727059 0.46230263 0.53769737 3039.3649
##  [9,] 0.073635503 0.074510488 0.30325255 0.54860146 0.45139854 2480.0705
## [10,] 0.053343488 0.055596900 0.26515829 0.62590132 0.37409868 1986.3073
## [11,] 0.038643421 0.041164508 0.22689172 0.69330035 0.30669965 1566.8826
## [12,] 0.027994307 0.030308260 0.19084951 0.75084792 0.24915208 1220.6577
## [13,] 0.020279809 0.022223653 0.15832502 0.79917152 0.20082848  941.0717
## [14,] 0.014691225 0.016246205 0.12985767 0.83920490 0.16079510  719.1777
## [15,] 0.010642709 0.011849732 0.10550427 0.87200329 0.12799671  545.5115
## [16,] 0.007709857 0.008628457 0.08503586 0.89862582 0.10137418  411.1363
## [17,] 0.005585222 0.006274934 0.06807328 0.92006656 0.07993344  308.1465
## [18,] 0.004046082 0.004559035 0.05417600 0.93721888 0.06278112  229.8409
## [19,] 0.002931087 0.003309986 0.04289728 0.95086165 0.04913835  170.7077
## [20,] 0.002123357 0.002401848 0.03381604 0.96165876 0.03834124  126.3136
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.841823492 0.112897750 0.04131588 0.003962877 0.99603712 6966.4752
##  [2,] 0.708666792 0.182584910 0.09526358 0.013484715 0.98651528 6830.2894
##  [3,] 0.508365611 0.252282476 0.19634005 0.043011865 0.95698813 5138.0296
##  [4,] 0.364678573 0.253604177 0.28615165 0.095565602 0.90443440 5082.6461
##  [5,] 0.261603970 0.225408578 0.34492704 0.168060416 0.83193958 4790.5554
##  [6,] 0.187662895 0.187733202 0.37142805 0.253175856 0.74682414 4326.2572
##  [7,] 0.134620901 0.150259332 0.37164636 0.343473409 0.65652659 3772.5983
##  [8,] 0.096570966 0.117122218 0.35333172 0.432975094 0.56702491 3198.3903
##  [9,] 0.069275658 0.089606082 0.32359810 0.517520157 0.48247984 2650.6034
## [10,] 0.049695234 0.067624978 0.28808700 0.594592790 0.40540721 2156.3356
## [11,] 0.035649121 0.050514219 0.25086662 0.662970045 0.33702996 1727.7199
## [12,] 0.025573072 0.037435938 0.21463721 0.722353783 0.27764622 1366.8890
## [13,] 0.018344969 0.027572915 0.18102822 0.773053891 0.22694611 1069.9918
## [14,] 0.013159854 0.020209489 0.15088867 0.815741984 0.18425802  830.0848
## [15,] 0.009440286 0.014754782 0.12453199 0.851272947 0.14872705  639.0451
## [16,] 0.006772036 0.010738531 0.10192620 0.880563229 0.11943677  488.7371
## [17,] 0.004857953 0.007795611 0.08283345 0.904512986 0.09548701  371.6545
## [18,] 0.003484877 0.005647467 0.06690745 0.923960206 0.07603979  281.2190
## [19,] 0.002499893 0.004084315 0.05375866 0.939657128 0.06034287  211.8656
## [20,] 0.001793311 0.002949708 0.04299555 0.952261434 0.04773857  159.0061
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.872520275 0.093111595 0.02920473 0.005163401 0.99483660 6881.4634
##  [2,] 0.761291630 0.156692246 0.06860552 0.013410600 0.98658940 6675.6294
##  [3,] 0.546135767 0.247952302 0.16492387 0.040988056 0.95901194 4980.6209
##  [4,] 0.391787148 0.256422898 0.26050275 0.091287209 0.90871279 4973.3692
##  [5,] 0.281060459 0.229469937 0.32548642 0.163983185 0.83601682 4715.9817
##  [6,] 0.201627292 0.190994046 0.35586802 0.251510646 0.74848935 4264.2785
##  [7,] 0.144643487 0.152300521 0.35766132 0.345394672 0.65460533 3708.4284
##  [8,] 0.103764416 0.118115014 0.33943250 0.438688074 0.56131193 3126.0187
##  [9,] 0.074438568 0.089866303 0.30911846 0.526576668 0.47342333 2570.0900
## [10,] 0.053400777 0.067442801 0.27294838 0.606208046 0.39379195 2070.8138
## [11,] 0.038308676 0.050105828 0.23532494 0.676260551 0.32373945 1641.2339
## [12,] 0.027481897 0.036943800 0.19908691 0.736487397 0.26351260 1283.1501
## [13,] 0.019714977 0.027081590 0.16587492 0.787328509 0.21267149  991.8236
## [14,] 0.014143140 0.019763231 0.13647912 0.829614506 0.17038549  759.2987
## [15,] 0.010146013 0.014372133 0.11112432 0.864357537 0.13564246  576.5420
## [16,] 0.007278552 0.010422927 0.08968546 0.892613066 0.10738693  434.7015
## [17,] 0.005221491 0.007542478 0.07184096 0.915395067 0.08460493  325.7652
## [18,] 0.003745796 0.005448652 0.05717646 0.933629089 0.06637091  242.8352
## [19,] 0.002687161 0.003930676 0.04525134 0.948130821 0.05186918  180.1756
## [20,] 0.001927717 0.002832493 0.03563884 0.959600949 0.04039905  133.1361
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.879731020 0.086617512 0.02981876 0.003832708 0.99616729 6892.2105
##  [2,] 0.773926667 0.147747744 0.06746970 0.010855894 0.98914411 6683.1449
##  [3,] 0.561589240 0.242032236 0.16042265 0.035955872 0.96404413 4976.7943
##  [4,] 0.407509506 0.256938456 0.25226007 0.083291964 0.91670804 4964.5577
##  [5,] 0.295703667 0.235482864 0.31656336 0.152250104 0.84774990 4719.7674
##  [6,] 0.214573299 0.200450500 0.34900284 0.235973367 0.76402663 4291.1372
##  [7,] 0.155702162 0.163291296 0.35433558 0.326670962 0.67332904 3759.4510
##  [8,] 0.112983132 0.129247730 0.33998699 0.417782150 0.58221785 3196.2900
##  [9,] 0.081984656 0.100274812 0.31314754 0.504592987 0.49540701 2652.3240
## [10,] 0.059491038 0.076675959 0.27967543 0.584157577 0.41584242 2157.8038
## [11,] 0.043168853 0.057998751 0.24387222 0.654960178 0.34503982 1727.0957
## [12,] 0.031324884 0.043509258 0.20863762 0.716528237 0.28347176 1363.7184
## [13,] 0.022730471 0.032430269 0.17575247 0.769086789 0.23091321 1064.5671
## [14,] 0.016494054 0.024050267 0.14617152 0.813284159 0.18671584  823.0180
## [15,] 0.011968683 0.017763965 0.12027692 0.849990427 0.15000957  631.0122
## [16,] 0.008684910 0.013078478 0.09807813 0.880158483 0.11984152  480.3429
## [17,] 0.006302086 0.009603782 0.07935993 0.904734203 0.09526580  363.3762
## [18,] 0.004573022 0.007037344 0.06378676 0.924602873 0.07539713  273.3954
## [19,] 0.003318350 0.005147859 0.05097274 0.940561046 0.05943895  204.7099
## [20,] 0.002407915 0.003760386 0.04052630 0.953305398 0.04669460  152.6295
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.885951451 0.078795302 0.03171440 0.003538852 0.99646115 6903.1792
##  [2,] 0.784909974 0.134674651 0.06979384 0.010621530 0.98937847 6694.1163
##  [3,] 0.581755346 0.221002433 0.16121297 0.036029253 0.96397075 4975.4056
##  [4,] 0.431182293 0.236368065 0.24904158 0.083408061 0.91659194 4943.3359
##  [5,] 0.319581369 0.218643588 0.31058747 0.151187571 0.84881243 4692.1257
##  [6,] 0.236865598 0.188073472 0.34229629 0.232764636 0.76723536 4270.3878
##  [7,] 0.175558768 0.154976530 0.34855505 0.320909649 0.67909035 3753.0713
##  [8,] 0.130119702 0.124194862 0.33612243 0.409563002 0.59043700 3206.1543
##  [9,] 0.096441420 0.097637082 0.31158024 0.494341259 0.50565874 2676.6091
## [10,] 0.071479932 0.075711674 0.28034902 0.572459374 0.42754063 2192.8788
## [11,] 0.052979111 0.058118915 0.24646892 0.642433050 0.35756695 1768.8853
## [12,] 0.039266772 0.044275885 0.21271928 0.703738065 0.29626193 1408.5088
## [13,] 0.029103534 0.033534506 0.18085821 0.756503751 0.24349625 1109.3814
## [14,] 0.021570801 0.025285075 0.15187713 0.801266994 0.19873301  865.7114
## [15,] 0.015987730 0.018998234 0.12622515 0.838788890 0.16121111  670.2085
## [16,] 0.011849700 0.014235249 0.10398907 0.869925977 0.13007402  515.2995
## [17,] 0.008782697 0.010643165 0.08502919 0.895544944 0.10445506  393.8300
## [18,] 0.006509512 0.007943750 0.06907682 0.916469916 0.08353008  299.4182
## [19,] 0.004824685 0.005920824 0.05580145 0.933453039 0.06654696  226.5881
## [20,] 0.003575934 0.004408196 0.04485488 0.947160989 0.05283901  170.7705
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.839008788 0.121513515 0.03491484 0.004562859 0.99543714 6927.1024
##  [2,] 0.703935746 0.194570600 0.08743733 0.014056327 0.98594367 6786.2838
##  [3,] 0.504466278 0.263694161 0.18875302 0.043086540 0.95691346 5100.7299
##  [4,] 0.361519112 0.261225666 0.28192485 0.095330376 0.90466962 5064.4424
##  [5,] 0.259077909 0.229217065 0.34341753 0.168287495 0.83171250 4783.4925
##  [6,] 0.185664770 0.188694966 0.37123152 0.254408746 0.74559125 4321.2166
##  [7,] 0.133054212 0.149430943 0.37162645 0.345888399 0.65411160 3764.2673
##  [8,] 0.095351548 0.115347672 0.35283299 0.436467794 0.56353221 3185.0734
##  [9,] 0.068332431 0.087465345 0.32236993 0.521832299 0.47816770 2632.8356
## [10,] 0.048969536 0.065473684 0.28614154 0.599415238 0.40058476 2135.6337
## [11,] 0.035093373 0.048544794 0.24835310 0.668008734 0.33199127 1705.7741
## [12,] 0.025149203 0.035733268 0.21175375 0.727363777 0.27263622 1345.1472
## [13,] 0.018022845 0.026156851 0.17796907 0.777851235 0.22214877 1049.5074
## [14,] 0.012915835 0.019064236 0.14781768 0.820202248 0.17979775  811.5131
## [15,] 0.009255963 0.013847783 0.12157323 0.855323022 0.14467698  622.7085
## [16,] 0.006633164 0.010031782 0.09916441 0.884170648 0.11582935  474.7103
## [17,] 0.004753569 0.007251915 0.08031926 0.907675251 0.09232475  359.8466
## [18,] 0.003406583 0.005233489 0.06466454 0.926695390 0.07330461  271.4403
## [19,] 0.002441283 0.003771734 0.05179077 0.941996218 0.05800378  203.8775
## [20,] 0.001749513 0.002715305 0.04129272 0.954242465 0.04575753  152.5561
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.879008549 0.089522479 0.02768573 0.003783245 0.99621675 6880.7751
##  [2,] 0.772656030 0.152347820 0.06448938 0.010506766 0.98949323 6669.9888
##  [3,] 0.553864926 0.251042510 0.15997248 0.035120083 0.96487992 4980.2035
##  [4,] 0.397028360 0.262960215 0.25760136 0.082410062 0.91758994 4995.9328
##  [5,] 0.284602818 0.237074673 0.32603612 0.152286387 0.84771361 4764.2313
##  [6,] 0.204012539 0.198370728 0.36010235 0.237514381 0.76248562 4334.1469
##  [7,] 0.146242811 0.158835221 0.36510153 0.329820440 0.67017956 3792.7867
##  [8,] 0.104831595 0.123594377 0.34926910 0.422304927 0.57769507 3217.3594
##  [9,] 0.075146690 0.094294264 0.32047045 0.510088591 0.48991141 2661.9958
## [10,] 0.053867587 0.070927671 0.28501286 0.590191878 0.40980812 2158.5220
## [11,] 0.038614035 0.052794670 0.24744697 0.661144322 0.33885568 1721.6563
## [12,] 0.027679794 0.038986943 0.21077818 0.722555080 0.27744492 1354.6253
## [13,] 0.019841775 0.028615436 0.17680362 0.774739169 0.22526083 1053.7779
## [14,] 0.014223228 0.020903595 0.14644592 0.818427253 0.18157275  811.9134
## [15,] 0.010195672 0.015213269 0.12003416 0.854556899 0.14544310  620.4720
## [16,] 0.007308589 0.011039318 0.09752026 0.884131834 0.11586817  470.8589
## [17,] 0.005239034 0.007991734 0.07863593 0.908133304 0.09186670  355.1639
## [18,] 0.003755509 0.005774611 0.06300086 0.927469024 0.07253098  266.4885
## [19,] 0.002692071 0.004166277 0.05019373 0.942947923 0.05705208  199.0331
## [20,] 0.001929764 0.003002235 0.03979628 0.955271720 0.04472828  148.0503
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.863835833 0.095679451 0.03658394 0.003900773 0.99609923 6934.1792
##  [2,] 0.746212347 0.157659740 0.08343975 0.012688165 0.98731183 6762.9910
##  [3,] 0.551081289 0.229360620 0.17842769 0.041130405 0.95886959 5046.2729
##  [4,] 0.406976095 0.235457988 0.26500276 0.092563160 0.90743684 4985.6473
##  [5,] 0.300553739 0.212546680 0.32255571 0.164343870 0.83565613 4697.1920
##  [6,] 0.221960334 0.179586539 0.34927229 0.249180837 0.75081916 4241.1007
##  [7,] 0.163918739 0.145860322 0.35068467 0.339536266 0.66046373 3697.7701
##  [8,] 0.121054751 0.115462204 0.33416703 0.429316017 0.57068398 3134.4757
##  [9,] 0.089399497 0.089800189 0.30653767 0.514262640 0.48573736 2597.2207
## [10,] 0.066021944 0.068968830 0.27321928 0.591789951 0.40821005 2112.5403
## [11,] 0.048757513 0.052484882 0.23812984 0.660627761 0.33937224 1692.2970
## [12,] 0.036007650 0.039667864 0.20387611 0.720448374 0.27955163 1338.5543
## [13,] 0.026591817 0.029825900 0.17203752 0.771544761 0.22845524 1047.5170
## [14,] 0.019638181 0.022337251 0.14344425 0.814580318 0.18541968  812.3673
## [15,] 0.014502888 0.016677946 0.11841165 0.850407520 0.14959248  625.1367
## [16,] 0.010710450 0.012423101 0.09692230 0.879944148 0.12005585  477.8471
## [17,] 0.007909717 0.009236749 0.07875957 0.904093968 0.09590603  363.1391
## [18,] 0.005841363 0.006857793 0.06360100 0.923699847 0.07630015  274.5626
## [19,] 0.004313874 0.005085817 0.05108086 0.939519447 0.06048055  206.6602
## [20,] 0.003185816 0.003768364 0.04082988 0.952215942 0.04778406  154.9320
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.846152441 0.111103177 0.03895473 0.003789649 0.99621035 6953.2137
##  [2,] 0.715973953 0.177681816 0.09249274 0.013851496 0.98614850 6811.2579
##  [3,] 0.520944647 0.240850293 0.19200774 0.046197320 0.95380268 5098.9867
##  [4,] 0.379040780 0.238039008 0.27795156 0.104968653 0.89503135 5000.9012
##  [5,] 0.275791130 0.208542006 0.32977800 0.185888861 0.81411114 4648.9966
##  [6,] 0.200666396 0.171628994 0.34807017 0.279634439 0.72036556 4126.0699
##  [7,] 0.146005430 0.136074529 0.34066596 0.377254077 0.62274592 3527.9178
##  [8,] 0.106233959 0.105310256 0.31647000 0.471985783 0.52801422 2928.4155
##  [9,] 0.077296125 0.080171106 0.28305389 0.559478876 0.44052112 2373.9176
## [10,] 0.056240876 0.060329167 0.24602325 0.637406708 0.36259329 1887.9570
## [11,] 0.040921019 0.045019359 0.20913219 0.704927432 0.29507257 1478.1691
## [12,] 0.029774247 0.033388672 0.17465274 0.762184345 0.23781566 1142.4338
## [13,] 0.021663826 0.024649668 0.14377710 0.809909409 0.19009059  873.4297
## [14,] 0.015762660 0.018135527 0.11696550 0.849136317 0.15086368  661.6677
## [15,] 0.011468955 0.013308231 0.09421557 0.881007248 0.11899275  497.3342
## [16,] 0.008344844 0.009746579 0.07525685 0.906651723 0.09334828  371.2993
## [17,] 0.006071732 0.007127363 0.05968365 0.927117255 0.07288275  275.5836
## [18,] 0.004417809 0.005205997 0.04704102 0.943335172 0.05666483  203.4955
## [19,] 0.003214410 0.003799215 0.03687726 0.956109118 0.04389088  149.5872
## [20,] 0.002338814 0.002770690 0.02877325 0.966117250 0.03388275  109.5206
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.870023401 0.099307292 0.02779082 0.002878488 0.99712151 6890.2053
##  [2,] 0.756940719 0.164394688 0.06942380 0.009240789 0.99075921 6708.6377
##  [3,] 0.553643891 0.246819463 0.16700097 0.032535675 0.96746432 5026.9661
##  [4,] 0.404947905 0.250975123 0.26503447 0.079042498 0.92095750 5043.3548
##  [5,] 0.296188232 0.222774990 0.33289090 0.148145879 0.85185412 4808.6632
##  [6,] 0.216638901 0.184762560 0.36615978 0.232438762 0.76756124 4376.0128
##  [7,] 0.158454686 0.147283236 0.37056348 0.323698600 0.67630140 3833.7147
##  [8,] 0.115897410 0.114484804 0.35445556 0.415162227 0.58483777 3258.5681
##  [9,] 0.084770037 0.087498188 0.32564772 0.502084051 0.49791595 2703.8113
## [10,] 0.062002759 0.066091549 0.29033040 0.581575293 0.41842471 2200.5045
## [11,] 0.045350248 0.049505925 0.25293881 0.652205022 0.34779498 1762.9335
## [12,] 0.033170216 0.036858170 0.21639303 0.713578583 0.28642142 1394.2119
## [13,] 0.024261461 0.027319774 0.18244129 0.765977476 0.23402252 1090.7992
## [14,] 0.017745392 0.020183146 0.15198877 0.810082687 0.18991731  845.7236
## [15,] 0.012979389 0.014874191 0.12536963 0.846776790 0.15322321  650.6890
## [16,] 0.009493424 0.010941532 0.10255436 0.877010685 0.12298931  497.3462
## [17,] 0.006943709 0.008037509 0.08329940 0.901719377 0.09828062  377.9852
## [18,] 0.005078789 0.005898087 0.06725016 0.921772968 0.07822703  285.8530
## [19,] 0.003714743 0.004324720 0.05400875 0.937951790 0.06204821  215.2431
## [20,] 0.002717049 0.003169168 0.04317643 0.950937349 0.04906265  161.4573</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.744490 9.107830 8.973372 9.237425 9.379891 9.053135 9.176597
##  [8] 9.144206 8.613049 9.295185</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50380.02 52058.39 50535.36 51377.35 51735.87 51698.16 51457.98
##  [8] 51202.40 49120.15 52132.68</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7030.064 6688.296 5849.890 5741.623 5754.987 6769.642 5658.894
##  [8] 6368.956 6869.495 6004.431</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     7.944522      8.744490       44756.20        50380.02 7030.064
##  [2,]     8.264488      9.107830       46417.88        52058.39 6688.296
##  [3,]     7.914042      8.973372       44338.39        50535.36 5849.890
##  [4,]     8.158645      9.237425       45183.40        51377.35 5741.623
##  [5,]     8.311390      9.379891       45586.65        51735.87 5754.987
##  [6,]     8.224941      9.053135       46091.58        51698.16 6769.642
##  [7,]     8.074461      9.176597       45221.11        51457.98 5658.894
##  [8,]     8.225772      9.144206       45352.94        51202.40 6368.956
##  [9,]     7.768888      8.613049       43321.19        49120.15 6869.495
## [10,]     8.306361      9.295185       46195.35        52132.68 6004.431</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
