<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7128237 0.2107103 0.06636593 0.01010016
## [2,] 0.0000000 0.5755210 0.41428706 0.01019193
## [3,] 0.0000000 0.0000000 0.76712371 0.23287629
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7263932 0.2042298 0.06035929 0.009017688
## [2,] 0.0000000 0.6248569 0.36652496 0.008618166
## [3,] 0.0000000 0.0000000 0.75677813 0.243221870
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7244744 0.1965105 0.06615423 0.01286081
## [2,] 0.0000000 0.5493841 0.43737060 0.01324531
## [3,] 0.0000000 0.0000000 0.74583708 0.25416292
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7119378 0.2107092 0.06867433 0.008678617
## [2,] 0.0000000 0.5665849 0.42086251 0.012552598
## [3,] 0.0000000 0.0000000 0.75619215 0.243807847
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7435719 0.1899440 0.05633218 0.01015195
## [2,] 0.0000000 0.5981055 0.38991229 0.01198223
## [3,] 0.0000000 0.0000000 0.75000406 0.24999594
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7341412 0.1826194 0.07446022 0.008779196
## [2,] 0.0000000 0.5822602 0.40517353 0.012566248
## [3,] 0.0000000 0.0000000 0.74571565 0.254284354
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7260512 0.2069377 0.05943926 0.007571810
## [2,] 0.0000000 0.5927348 0.39736811 0.009897098
## [3,] 0.0000000 0.0000000 0.74322145 0.256778552
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.729825 0.1993192 0.06253329 0.008322516
## [2,] 0.000000 0.5732811 0.41178197 0.014936980
## [3,] 0.000000 0.0000000 0.75919197 0.240808034
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7295358 0.1953655 0.06327691 0.01182171
## [2,] 0.0000000 0.5908570 0.39638463 0.01275839
## [3,] 0.0000000 0.0000000 0.75470055 0.24529945
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7255081 0.1943398 0.07077904 0.009373081
## [2,] 0.0000000 0.5809434 0.40979204 0.009264558
## [3,] 0.0000000 0.0000000 0.74107567 0.258924329
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.4946763 0.6223926 0.5075450 0.5153326 0.6740503 0.4930020 0.5949833
##  [8] 0.5181775 0.6743337 0.5101494</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8579407 0.1042334 0.03282965 0.004996310
## [2,] 0.0000000 0.7900203 0.20493798 0.005041708
## [3,] 0.0000000 0.0000000 0.88480162 0.115198378
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8297092 0.1271111 0.03756718 0.005612542
## [2,] 0.0000000 0.7665137 0.22812242 0.005363883
## [3,] 0.0000000 0.0000000 0.84862051 0.151379491
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8601584 0.09973794 0.03357625 0.006527440
## [2,] 0.0000000 0.77129215 0.22198526 0.006722593
## [3,] 0.0000000 0.00000000 0.87100088 0.128999116
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8515522 0.1085853 0.03539012 0.004472374
## [2,] 0.0000000 0.7766471 0.21688417 0.006468763
## [3,] 0.0000000 0.0000000 0.87435787 0.125642129
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8271546 0.1280318 0.03797072 0.006842925
## [2,] 0.0000000 0.7291029 0.26282048 0.008076627
## [3,] 0.0000000 0.0000000 0.83149017 0.168509833
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8689311 0.09003174 0.03670904 0.004328162
## [2,] 0.0000000 0.79405343 0.19975138 0.006195186
## [3,] 0.0000000 0.00000000 0.87463729 0.125362708
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 7
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.837005 0.1231245 0.03536537 0.004505101
## [2,] 0.000000 0.7576840 0.23642739 0.005888608
## [3,] 0.000000 0.0000000 0.84722105 0.152778950
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8600014 0.1032827 0.03240335 0.004312541
## [2,] 0.0000000 0.7788838 0.21337616 0.007740007
## [3,] 0.0000000 0.0000000 0.87521869 0.124781309
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8176169 0.1317416 0.04266975 0.007971777
## [2,] 0.0000000 0.7241011 0.26729553 0.008603414
## [3,] 0.0000000 0.0000000 0.83458630 0.165413697
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8599681 0.09914231 0.03610789 0.004781672
## [2,] 0.0000000 0.78621853 0.20905516 0.004726308
## [3,] 0.0000000 0.00000000 0.86790991 0.132090088
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.712823658 0.210710255 0.06636593 0.01010016 0.98989984 5151.3014
##  [2,] 0.508117568 0.271467433 0.18551261 0.03490239 0.96509761 5427.4609
##  [3,] 0.362198224 0.263300794 0.28849826 0.08600272 0.91399728 5442.7497
##  [4,] 0.258183463 0.227854019 0.35443359 0.15952893 0.84047107 5159.6510
##  [5,] 0.184039281 0.185536679 0.38342597 0.24699807 0.75300193 4664.6293
##  [6,] 0.131187553 0.145559221 0.38321453 0.34003869 0.65996131 4061.1401
##  [7,] 0.093513592 0.111414953 0.36298264 0.43208882 0.56791118 3432.2588
##  [8,] 0.066658701 0.083825919 0.33081648 0.51869890 0.48130110 2833.1534
##  [9,] 0.047515899 0.062289249 0.29292903 0.59726583 0.40273417 2294.7316
## [10,] 0.033870457 0.045860859 0.25367187 0.66659682 0.33340318 1830.2111
## [11,] 0.024143663 0.033530741 0.21584511 0.72648049 0.27351951 1441.3276
## [12,] 0.017210174 0.024384963 0.18107357 0.77733129 0.22266871 1123.1622
## [13,] 0.012267819 0.017660419 0.15015037 0.81992139 0.18007861  867.5084
## [14,] 0.008744792 0.012748897 0.12331456 0.85519175 0.14480825  665.0339
## [15,] 0.006233495 0.009179876 0.10045958 0.88412705 0.11587295  506.5575
## [16,] 0.004443382 0.006596673 0.08128172 0.90767822 0.09232178  383.7234
## [17,] 0.003167348 0.004732790 0.06538094 0.92671892 0.07328108  289.2907
## [18,] 0.002257761 0.003391213 0.05232621 0.94202482 0.05797518  217.1928
## [19,] 0.001609385 0.002427448 0.04169545 0.95426772 0.04573228  162.4713
## [20,] 0.001147208 0.001736161 0.03309804 0.96401859 0.03598141  121.1486
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.726393197 0.204229822 0.06035929 0.009017688 0.99098231 5119.2103
##  [2,] 0.527647077 0.275965562 0.16437850 0.032008862 0.96799114 5324.0327
##  [3,] 0.383279247 0.280200248 0.25739472 0.079125782 0.92087422 5312.7704
##  [4,] 0.278411438 0.253362104 0.32062555 0.147600913 0.85239909 5045.7970
##  [5,] 0.202236175 0.215174971 0.35231065 0.230278202 0.76972180 4588.7370
##  [6,] 0.146902981 0.175756219 0.35769483 0.319645974 0.68035403 4027.3524
##  [7,] 0.106709326 0.139824452 0.34398162 0.409484600 0.59051540 3434.5356
##  [8,] 0.077512929 0.109163497 0.31800782 0.495315755 0.50468424 2861.4771
##  [9,] 0.056304864 0.084042013 0.28535113 0.574301988 0.42569801 2338.9283
## [10,] 0.040899470 0.064013362 0.25014951 0.644937653 0.35506235 1881.7996
## [11,] 0.029709097 0.048352081 0.21523884 0.706699982 0.29330002 1494.0972
## [12,] 0.021580486 0.036280614 0.18240351 0.759735389 0.24026461 1173.0641
## [13,] 0.015675918 0.027077570 0.15263932 0.804607190 0.19539281  912.2533
## [14,] 0.011386880 0.020121096 0.12638489 0.842107131 0.15789287  703.6214
## [15,] 0.008271352 0.014898346 0.10370751 0.873122791 0.12687721  538.8500
## [16,] 0.006008254 0.010998591 0.08444344 0.898549711 0.10145029  410.1055
## [17,] 0.004364355 0.008099610 0.06829886 0.919237172 0.08076283  310.4212
## [18,] 0.003170238 0.005952428 0.05491922 0.935958109 0.06404189  233.8366
## [19,] 0.002302839 0.004366873 0.04393474 0.949395553 0.05060445  175.3938
## [20,] 0.001672767 0.003198979 0.03498841 0.960139842 0.03986016  131.0564
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.724474415 0.196510543 0.06615423 0.01286081 0.98713919 5132.97726
##  [2,] 0.524863178 0.250326625 0.18321526 0.04159494 0.95840506 5379.12636
##  [3,] 0.380249944 0.240666611 0.28085616 0.09822728 0.90177272 5345.34637
##  [4,] 0.275481356 0.206941528 0.33988859 0.17768853 0.82231147 5010.32048
##  [5,] 0.199579194 0.167825372 0.36223591 0.27035952 0.72964048 4473.85197
##  [6,] 0.144590020 0.131420004 0.35677387 0.36721611 0.63278389 3845.22691
##  [7,] 0.104751770 0.100613521 0.33313967 0.46149504 0.53850496 3207.61810
##  [8,] 0.075889977 0.075860294 0.29940309 0.54884664 0.45115336 2613.25369
##  [9,] 0.054980347 0.056589619 0.26150543 0.62692460 0.37307540 2089.09529
## [10,] 0.039831855 0.041893654 0.22342827 0.69484623 0.30515377 1644.58135
## [11,] 0.028857160 0.030843086 0.18759918 0.75270057 0.24729943 1278.36445
## [12,] 0.020906274 0.022615437 0.15531731 0.80116098 0.19883902  983.27293
## [13,] 0.015146061 0.016532864 0.12711578 0.84120530 0.15879470  749.61122
## [14,] 0.010972933 0.012059253 0.10304062 0.87392719 0.12607281  567.17447
## [15,] 0.007949609 0.008781459 0.08285179 0.90041714 0.09958286  426.36391
## [16,] 0.005759289 0.006386576 0.06616059 0.92169355 0.07830645  318.71766
## [17,] 0.004172457 0.004640444 0.05251932 0.93866778 0.06133222  237.08583
## [18,] 0.003022839 0.003369318 0.04147648 0.95213137 0.04786863  175.60544
## [19,] 0.002189969 0.002445069 0.03260831 0.96275665 0.03724335  129.57475
## [20,] 0.001586577 0.001773634 0.02553476 0.97110503 0.02889497   95.28756
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.711937807 0.210709245 0.06867433 0.008678617 0.99132138 5171.6651
##  [2,] 0.506855441 0.269396552 0.18950247 0.034245542 0.96575446 5452.0552
##  [3,] 0.360849551 0.259435143 0.29148715 0.088228162 0.91177184 5448.0699
##  [4,] 0.256902438 0.223026368 0.35438792 0.165683275 0.83431672 5133.7532
##  [5,] 0.182898558 0.180495089 0.37949140 0.257114949 0.74288505 4607.0788
##  [6,] 0.130212398 0.140804207 0.37549247 0.353490921 0.64650908 3978.3801
##  [7,] 0.092703129 0.107214492 0.35214592 0.447936455 0.55206355 3333.3245
##  [8,] 0.065998863 0.080279518 0.31777887 0.535942750 0.46405725 2726.8990
##  [9,] 0.046987085 0.059391732 0.27862095 0.615000227 0.38499977 2188.4430
## [10,] 0.033451883 0.043551071 0.23891354 0.684083506 0.31591649 1729.1606
## [11,] 0.023815660 0.031724000 0.20129084 0.743169497 0.25683050 1348.8627
## [12,] 0.016955269 0.022992519 0.16720152 0.792850690 0.20714931 1041.0376
## [13,] 0.012071097 0.016599846 0.13727756 0.834051498 0.16594850  796.2857
## [14,] 0.008593870 0.011948713 0.11162344 0.867833976 0.13216602  604.4568
## [15,] 0.006118301 0.008580768 0.09002771 0.895273217 0.10472678  455.8611
## [16,] 0.004355850 0.006150916 0.07210974 0.917383489 0.08261651  341.8701
## [17,] 0.003101094 0.004402834 0.05741665 0.935079424 0.06492058  255.1366
## [18,] 0.002207786 0.003148008 0.04548397 0.949160233 0.05083977  189.5989
## [19,] 0.001571806 0.002248815 0.03587112 0.960308259 0.03969174  140.3703
## [20,] 0.001119028 0.001605339 0.02817984 0.969095789 0.03090421  103.5813
## 
## , , 5
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.743571870 0.189944003 0.05633218 0.01015195 0.98984805 5086.0858
##  [2,] 0.552899126 0.254843567 0.15819788 0.03405942 0.96594058 5274.8963
##  [3,] 0.411120237 0.257443207 0.24916170 0.08227485 0.91772515 5250.5939
##  [4,] 0.305697444 0.232068017 0.31041186 0.15182268 0.84817732 4973.3987
##  [5,] 0.227308020 0.196866549 0.34051693 0.23530851 0.76469149 4510.6751
##  [6,] 0.169019849 0.160922757 0.34495452 0.32510288 0.67489712 3948.7490
##  [7,] 0.125678406 0.128353089 0.33098430 0.41498420 0.58501580 3359.8319
##  [8,] 0.093450927 0.100640545 0.30536576 0.50054277 0.49945723 2793.8037
##  [9,] 0.069487481 0.077944105 0.27353083 0.57903758 0.42096242 2280.0151
## [10,] 0.051668936 0.059817526 0.23945498 0.64905856 0.35094144 1832.1928
## [11,] 0.038419567 0.045591395 0.20582642 0.71016262 0.28983738 1453.4897
## [12,] 0.028567710 0.034566029 0.17431155 0.76255471 0.23744529 1140.6206
## [13,] 0.021242145 0.026100397 0.14582137 0.80683609 0.19316391  886.8757
## [14,] 0.015795062 0.019645608 0.12074010 0.84381923 0.15618077  684.1403
## [15,] 0.011744764 0.014750323 0.09910540 0.87439951 0.12560049  524.1462
## [16,] 0.008733076 0.011053097 0.08074239 0.89947143 0.10052857  399.1783
## [17,] 0.006493669 0.008269713 0.06535881 0.91987780 0.08012220  302.4172
## [18,] 0.004828510 0.006179594 0.05260964 0.93638226 0.06361774  228.0541
## [19,] 0.003590344 0.004613196 0.04213894 0.94965752 0.05034248  171.2719
## [20,] 0.002669679 0.003441142 0.03360537 0.96028381 0.03971619  128.1571
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.734141177 0.182619409 0.07446022 0.008779196 0.99122080 5197.4639
##  [2,] 0.538963267 0.240400445 0.18418301 0.036453274 0.96354673 5404.9313
##  [3,] 0.395675127 0.238400770 0.27488337 0.091040729 0.90895927 5343.8103
##  [4,] 0.290481403 0.211069243 0.33104057 0.167408783 0.83259122 5008.4679
##  [5,] 0.213254359 0.175944766 0.35401111 0.256789762 0.74321024 4488.2743
##  [6,] 0.156558806 0.141390023 0.35115875 0.350892416 0.64910758 3880.4922
##  [7,] 0.114936266 0.110916463 0.33080947 0.443337796 0.55666220 3260.7477
##  [8,] 0.084379446 0.085571837 0.30018840 0.529860321 0.47013968 2678.1035
##  [9,] 0.061946426 0.065234401 0.26480954 0.608009634 0.39199037 2159.1943
## [10,] 0.045477422 0.049296017 0.22851641 0.676710148 0.32328985 1714.5449
## [11,] 0.033386848 0.037008169 0.19376796 0.735837018 0.26416298 1344.3588
## [12,] 0.024510660 0.027645471 0.16197653 0.785867343 0.21413266 1042.9608
## [13,] 0.017994285 0.020572980 0.13381471 0.827618023 0.17238198  801.8724
## [14,] 0.013210345 0.015264934 0.10946321 0.862061511 0.13793849  611.7709
## [15,] 0.009698258 0.011300629 0.08879702 0.890204092 0.10979591  463.6348
## [16,] 0.007119891 0.008350997 0.07151818 0.913010934 0.08698907  349.3355
## [17,] 0.005227005 0.006162684 0.05724598 0.931364336 0.06863566  261.8790
## [18,] 0.003837360 0.004542838 0.04557538 0.946044422 0.05395558  195.4388
## [19,] 0.002817164 0.003345890 0.03611264 0.957724304 0.04227570  145.2758
## [20,] 0.002068196 0.002462648 0.02849520 0.966973961 0.03302604  107.6055
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.726051212 0.206937717 0.05943926 0.00757181 0.99242819 5121.4074
##  [2,] 0.527150363 0.272906565 0.16956293 0.03038014 0.96961986 5359.3668
##  [3,] 0.382738160 0.270848508 0.26580060 0.08061273 0.91938727 5348.2793
##  [4,] 0.277887505 0.239744295 0.32792494 0.15444326 0.84555674 5051.4631
##  [5,] 0.201760560 0.199610190 0.35550501 0.24312424 0.75687576 4551.8926
##  [6,] 0.146488499 0.160067774 0.35553017 0.33791355 0.66208645 3949.7123
##  [7,] 0.106358152 0.125191734 0.33655065 0.43189947 0.56810053 3325.7198
##  [8,] 0.077221465 0.096215010 0.30620071 0.52036281 0.47963719 2733.6570
##  [9,] 0.056066739 0.073010017 0.27039770 0.60052554 0.39947446 2203.5323
## [10,] 0.040707324 0.054877900 0.23330979 0.67110499 0.32889501 1747.9548
## [11,] 0.029555602 0.040951921 0.19762718 0.73186530 0.26813470 1368.2144
## [12,] 0.021458880 0.030389797 0.16491051 0.78324081 0.21675919 1059.0500
## [13,] 0.015580246 0.022453742 0.13591646 0.82604955 0.17395045  811.9948
## [14,] 0.011312057 0.016533254 0.11086451 0.86129018 0.13870982  617.5287
## [15,] 0.008213132 0.012140726 0.08963905 0.89000709 0.10999291  466.3486
## [16,] 0.005963155 0.008895838 0.07193418 0.91320682 0.08679318  350.0345
## [17,] 0.004329556 0.006506874 0.05735240 0.93181117 0.06818883  261.3286
## [18,] 0.003143479 0.004752799 0.04546850 0.94663522 0.05336478  194.1846
## [19,] 0.002282327 0.003467654 0.03586862 0.95838140 0.04161860  143.6903
## [20,] 0.001657086 0.002527699 0.02817192 0.96764329 0.03235671  105.9308
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.729825028 0.199319162 0.06253329 0.008322516 0.99167748 5133.9609
##  [2,] 0.532644572 0.259734012 0.17518917 0.032432242 0.96756776 5378.0036
##  [3,] 0.388737340 0.255066857 0.27326402 0.082931788 0.91706821 5373.7267
##  [4,] 0.283710240 0.223707797 0.33680080 0.155781159 0.84421884 5086.3162
##  [5,] 0.207058834 0.184796329 0.36555664 0.242588200 0.75741180 4597.5846
##  [6,] 0.151116719 0.147211027 0.36657153 0.335100725 0.66489927 4005.6676
##  [7,] 0.110288764 0.114513750 0.34836683 0.426830654 0.57316935 3389.7107
##  [8,] 0.080491500 0.087631227 0.31852872 0.513348555 0.48665144 2802.5665
##  [9,] 0.058744711 0.066280821 0.28294280 0.592031667 0.40796833 2274.0781
## [10,] 0.042873361 0.049706485 0.24577465 0.661645506 0.33835449 1817.1992
## [11,] 0.031290052 0.037041269 0.20973939 0.721929295 0.27807071 1433.8382
## [12,] 0.022836263 0.027471764 0.17644205 0.773249920 0.22675008 1119.4388
## [13,] 0.016666476 0.020300747 0.14669379 0.816338985 0.18366102  866.1995
## [14,] 0.012163611 0.014959982 0.12077044 0.852105967 0.14789403  665.1599
## [15,] 0.008877308 0.011000715 0.09860883 0.881513148 0.11848685  507.4456
## [16,] 0.006478882 0.008075919 0.07994805 0.905497145 0.09450285  384.9361
## [17,] 0.004728450 0.005921137 0.06442658 0.924923830 0.07507617  290.5617
## [18,] 0.003450941 0.004336946 0.05164605 0.940566065 0.05943393  218.3741
## [19,] 0.002518583 0.003174128 0.04121094 0.953096350 0.04690365  163.4923
## [20,] 0.001838125 0.002321669 0.03275156 0.963088648 0.03691135  121.9870
## 
## , , 9
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.729535842 0.195365542 0.06327691 0.01182171 0.98817829 5120.6242
##  [2,] 0.532222545 0.257959258 0.17135779 0.03846041 0.96153959 5329.2130
##  [3,] 0.388275422 0.256394973 0.26525230 0.09007731 0.90992269 5301.8061
##  [4,] 0.283260837 0.227348397 0.32638595 0.16300482 0.83699518 5006.7983
##  [5,] 0.206648933 0.189669793 0.35436494 0.24931634 0.75068366 4521.0756
##  [6,] 0.150757804 0.152439801 0.35569771 0.34110469 0.65889531 3937.5342
##  [7,] 0.109983221 0.119523000 0.33840954 0.43208424 0.56791576 3331.7132
##  [8,] 0.080236702 0.092107930 0.30973434 0.51792103 0.48207897 2754.4651
##  [9,] 0.058535550 0.070098100 0.27534398 0.59602237 0.40397763 2234.7408
## [10,] 0.042703782 0.052853781 0.23929201 0.66515043 0.33484957 1785.2394
## [11,] 0.031153939 0.039571872 0.20424640 0.72502779 0.27497221 1407.9280
## [12,] 0.022727915 0.029467723 0.17180188 0.77600248 0.22399752 1098.4312
## [13,] 0.016580829 0.021851461 0.14277768 0.81879003 0.18120997  849.1529
## [14,] 0.012096309 0.016150411 0.11746516 0.85428812 0.14571188  651.3186
## [15,] 0.008824691 0.011905785 0.09581821 0.88345131 0.11654869  496.2074
## [16,] 0.006437928 0.008758657 0.07759173 0.90721169 0.09278831  375.8199
## [17,] 0.004696699 0.006432863 0.06243769 0.92643275 0.07356725  283.1801
## [18,] 0.003426411 0.004718475 0.04996884 0.94188628 0.05811372  212.4122
## [19,] 0.002499689 0.003457346 0.03979865 0.95424431 0.04575569  158.6921
## [20,] 0.001823613 0.002531150 0.03156468 0.96408056 0.03591944  118.1361
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.725508105 0.194339771 0.07077904 0.009373081 0.99062692 5176.20781
##  [2,] 0.526362010 0.253895486 0.18344229 0.036300216 0.96369978 5405.05119
##  [3,] 0.381879904 0.249791979 0.27724437 0.091083751 0.90891625 5358.85106
##  [4,] 0.277056965 0.219329455 0.33485091 0.168762666 0.83123733 5023.87253
##  [5,] 0.201007074 0.181261186 0.35763916 0.260092582 0.73990742 4493.97301
##  [6,] 0.145832261 0.144366158 0.35354416 0.356257422 0.64374258 3872.58586
##  [7,] 0.105802487 0.112209575 0.33148495 0.450502992 0.54949701 3239.82198
##  [8,] 0.076760562 0.085749043 0.29912662 0.538363777 0.46163622 2647.11488
##  [9,] 0.055690410 0.064732971 0.26224777 0.617328846 0.38267115 2121.86033
## [10,] 0.040403844 0.048429054 0.22481421 0.686352888 0.31364711 1674.37366
## [11,] 0.029313316 0.035986613 0.18930993 0.745390140 0.25460986 1304.18603
## [12,] 0.021267048 0.026602928 0.15711478 0.795015243 0.20498476 1004.81849
## [13,] 0.015429416 0.019587829 0.12884087 0.836141884 0.16385812  767.04129
## [14,] 0.011194166 0.014377969 0.10459985 0.869828014 0.13017199  580.91602
## [15,] 0.008121458 0.010528258 0.08420069 0.897149590 0.10285041  436.96159
## [16,] 0.005892184 0.007694644 0.06728831 0.919124861 0.08087514  326.73519
## [17,] 0.004274827 0.005615239 0.05343598 0.936673957 0.06332604  243.04825
## [18,] 0.003101422 0.004092905 0.04220375 0.950601922 0.04939808  179.97058
## [19,] 0.002250107 0.002980476 0.03317293 0.961596489 0.03840351  132.72393
## [20,] 0.001632471 0.002168773 0.02596429 0.970234471 0.02976553   97.52765</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.150018 8.408730 7.784175 7.945390 8.354212 8.014012 8.111931
##  [8] 8.216678 8.143621 7.903825</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 46074.70 46017.34 43702.46 45045.89 45228.59 44460.16 44771.29
##  [8] 45630.25 44974.49 44087.64</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.857940672 0.104233367 0.03282965 0.00499631 0.99500369 6907.0684
##  [2,] 0.736062197 0.171772522 0.07857500 0.01359028 0.98640972 6733.9272
##  [3,] 0.524682548 0.253954549 0.18028933 0.04107358 0.95892642 5062.3961
##  [4,] 0.374006134 0.256712172 0.27833534 0.09094635 0.90905365 5063.0921
##  [5,] 0.266600420 0.226550177 0.34469144 0.16215797 0.83784203 4811.9106
##  [6,] 0.190039087 0.186559829 0.37597096 0.24743012 0.75256988 4366.4219
##  [7,] 0.135464357 0.147412286 0.37831768 0.33880567 0.66119433 3815.3995
##  [8,] 0.096562199 0.113382597 0.36027769 0.42977752 0.57022248 3235.0367
##  [9,] 0.068831820 0.085600713 0.32975894 0.51580853 0.48419147 2677.7965
## [10,] 0.049064950 0.063768579 0.29299726 0.59416922 0.40583078 2174.0283
## [11,] 0.034974657 0.047038645 0.25443988 0.66354682 0.33645318 1737.4150
## [12,] 0.024930763 0.034441247 0.21699549 0.72363250 0.27636750 1370.5756
## [13,] 0.017771238 0.025074829 0.18238550 0.77476843 0.22523157 1069.5764
## [14,] 0.012667759 0.018175673 0.15147983 0.81767674 0.18232326  827.1451
## [15,] 0.009029878 0.013129708 0.12457442 0.85326599 0.14673401  634.7687
## [16,] 0.006436711 0.009459111 0.10160274 0.88250144 0.11749856  483.9512
## [17,] 0.004588240 0.006800198 0.08228783 0.90632373 0.09367627  366.8934
## [18,] 0.003270606 0.004880446 0.06624669 0.92560226 0.07439774  276.7964
## [19,] 0.002331365 0.003497949 0.05305837 0.94111232 0.05888768  207.9402
## [20,] 0.001661852 0.002504386 0.04230621 0.95352755 0.04647245  155.6341
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.829709152 0.127111129 0.03756718 0.005612542 0.99438746 6937.2551
##  [2,] 0.688417277 0.202897688 0.09204701 0.016638029 0.98336197 6797.7609
##  [3,] 0.500061627 0.267377354 0.18557861 0.046982412 0.95301759 5068.5181
##  [4,] 0.363241364 0.269200075 0.26862567 0.098932890 0.90106711 4986.0982
##  [5,] 0.263856056 0.242396237 0.32388357 0.169864137 0.83013586 4689.2314
##  [6,] 0.191663244 0.205350231 0.34987844 0.253108087 0.74689191 4235.2109
##  [7,] 0.139222877 0.167457854 0.35161499 0.341704277 0.65829572 3698.6310
##  [8,] 0.101130550 0.133070655 0.33587541 0.429923381 0.57007662 3142.5278
##  [9,] 0.073460544 0.103803988 0.30906105 0.513674416 0.48632558 2610.7633
## [10,] 0.053361239 0.079865470 0.27637142 0.590401867 0.40959813 2129.2458
## [11,] 0.038761241 0.060802444 0.24164538 0.658790931 0.34120907 1710.0415
## [12,] 0.028155902 0.045909027 0.20749716 0.718437915 0.28156208 1355.7510
## [13,] 0.020452256 0.034436846 0.17555558 0.769555314 0.23044469 1063.1627
## [14,] 0.014856379 0.025695061 0.14671307 0.812735486 0.18726451  825.9523
## [15,] 0.010791573 0.019089851 0.12134385 0.848774729 0.15122527  636.5124
## [16,] 0.007838925 0.014132386 0.09947865 0.878550041 0.12144996  487.0992
## [17,] 0.005694142 0.010431661 0.08093629 0.902937908 0.09706209  370.4847
## [18,] 0.004136186 0.007681208 0.06541797 0.922764634 0.07723537  280.2765
## [19,] 0.003004497 0.005644388 0.05257190 0.938779212 0.06122079  211.0270
## [20,] 0.002182446 0.004140543 0.04203542 0.951641586 0.04835841  158.2176
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.860158369 0.099737942 0.03357625 0.00652744 0.99347256 6899.9299
##  [2,] 0.739872419 0.162717517 0.08026619 0.01714388 0.98285612 6718.4290
##  [3,] 0.536018638 0.234787144 0.17997905 0.04921517 0.95078483 5021.5924
##  [4,] 0.388331790 0.234321633 0.27238394 0.10496263 0.89503737 4972.4863
##  [5,] 0.281336446 0.205043866 0.33132923 0.18229046 0.81770954 4669.0050
##  [6,] 0.203821057 0.167933414 0.35540938 0.27283614 0.72716386 4181.7661
##  [7,] 0.147663141 0.132312931 0.35201026 0.36801367 0.63198633 3605.2746
##  [8,] 0.106978168 0.101707982 0.33018064 0.46113321 0.53886679 3015.7957
##  [9,] 0.077502946 0.076899084 0.29782210 0.54777587 0.45222413 2462.8566
## [10,] 0.056148901 0.057477279 0.26088731 0.62548651 0.37451349 1972.8762
## [11,] 0.040678442 0.042610953 0.22343279 0.69327781 0.30672219 1555.7778
## [12,] 0.029470491 0.031403522 0.18797229 0.75115370 0.24884630 1211.1156
## [13,] 0.021350617 0.023043857 0.15588128 0.79972425 0.20027575  932.7191
## [14,] 0.015467975 0.016855550 0.12775318 0.83992330 0.16007670  711.8394
## [15,] 0.011206152 0.012299791 0.10367845 0.87281560 0.12718440  539.0985
## [16,] 0.008118571 0.008959436 0.08344814 0.89947386 0.10052614  405.5875
## [17,] 0.005881697 0.006517557 0.06669439 0.92090636 0.07909364  303.4022
## [18,] 0.004261139 0.004736457 0.05298283 0.93801957 0.06198043  225.8341
## [19,] 0.003087086 0.003439493 0.04187004 0.95160338 0.04839662  167.3640
## [20,] 0.002236515 0.002496248 0.03293679 0.96233045 0.03766955  123.5543
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.851552164 0.108585341 0.03539012 0.004472374 0.99552763 6926.9030
##  [2,] 0.725141088 0.176798568 0.08463061 0.013429737 0.98657026 6769.9583
##  [3,] 0.516255356 0.252965328 0.18820347 0.042575847 0.95742415 5097.3377
##  [4,] 0.367541706 0.252106109 0.28423510 0.096117084 0.90388292 5070.6063
##  [5,] 0.261666836 0.220283947 0.34627904 0.171770173 0.82822983 4781.7822
##  [6,] 0.186290513 0.179945177 0.37253255 0.261231764 0.73876824 4300.9107
##  [7,] 0.132627259 0.141207352 0.37023174 0.355933645 0.64406635 3723.2199
##  [8,] 0.094422360 0.107951741 0.34850331 0.449122590 0.55087741 3126.7502
##  [9,] 0.067222848 0.081059490 0.31545270 0.536264962 0.46373504 2563.1160
## [10,] 0.047858487 0.060091558 0.27727424 0.614775714 0.38522429 2060.6149
## [11,] 0.034072266 0.044131194 0.23824954 0.683547001 0.31645300 1630.6103
## [12,] 0.024257335 0.032183409 0.20107549 0.742483769 0.25751623 1273.6261
## [13,] 0.017269714 0.023345878 0.16726235 0.792122057 0.20787794  984.0579
## [14,] 0.012294962 0.016866310 0.13749387 0.833344859 0.16665514  753.4193
## [15,] 0.008753248 0.012146859 0.11191453 0.867185363 0.13281464  572.3884
## [16,] 0.006231768 0.008726617 0.09034217 0.894699444 0.10530056  431.9855
## [17,] 0.004436632 0.006257460 0.07241671 0.916889199 0.08311080  324.1673
## [18,] 0.003158606 0.004480222 0.05769916 0.934662012 0.06533799  242.0578
## [19,] 0.002248731 0.003203973 0.04573412 0.948813171 0.05118683  179.9666
## [20,] 0.001600956 0.002289151 0.03608665 0.960023244 0.03997676  133.2960
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.827154550 0.128031807 0.03797072 0.006842925 0.99315708 6931.6263
##  [2,] 0.684184650 0.199250452 0.09662931 0.019935586 0.98006441 6801.3943
##  [3,] 0.508740460 0.249129558 0.18870419 0.053425796 0.94657420 5053.1536
##  [4,] 0.378285095 0.245637953 0.26732604 0.108750913 0.89124909 4934.9905
##  [5,] 0.281282156 0.218770391 0.31758249 0.182364961 0.81763504 4607.5483
##  [6,] 0.209153498 0.184275628 0.33933466 0.267236216 0.73276378 4134.2125
##  [7,] 0.155520658 0.149943716 0.33813577 0.356399853 0.64360015 3589.9472
##  [8,] 0.115640787 0.119222374 0.32082892 0.444307923 0.55569208 3035.5122
##  [9,] 0.085987236 0.093272829 0.29362355 0.527116380 0.47288362 2511.7482
## [10,] 0.063937690 0.072119750 0.26143093 0.602511632 0.39748837 2041.7753
## [11,] 0.047542268 0.055279798 0.22779638 0.669381552 0.33061845 1635.4916
## [12,] 0.035351093 0.042093519 0.19508064 0.727474745 0.27252525 1294.0093
## [13,] 0.026286078 0.031891092 0.16471546 0.777107371 0.22289263 1013.2163
## [14,] 0.019545588 0.024067120 0.13745274 0.818934549 0.18106545  786.3335
## [15,] 0.014533550 0.018107244 0.11357523 0.853783981 0.14621602  605.6060
## [16,] 0.010806739 0.013590602 0.09306082 0.882541836 0.11745816  463.3337
## [17,] 0.008035587 0.010181289 0.07570390 0.906079219 0.09392078  352.4382
## [18,] 0.005975036 0.007615796 0.06120071 0.925208460 0.07479154  266.7239
## [19,] 0.004442869 0.005689972 0.04920686 0.940660301 0.05933970  200.9494
## [20,] 0.003303592 0.004247100 0.03937421 0.953075098 0.04692490  150.7904
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.868931055 0.090031743 0.03670904 0.004328162 0.99567184 6930.4686
##  [2,] 0.755041179 0.149721392 0.08198869 0.013248744 0.98675126 6749.2742
##  [3,] 0.554306819 0.225061985 0.17802392 0.042607274 0.95739273 5036.8432
##  [4,] 0.406939461 0.232271825 0.26521819 0.095570525 0.90442947 4973.9754
##  [5,] 0.298751014 0.209557688 0.32218855 0.169502748 0.83049725 4675.4097
##  [6,] 0.219325421 0.176574839 0.34741334 0.256686403 0.74331360 4205.6448
##  [7,] 0.161015823 0.142865584 0.34694603 0.349172563 0.65082744 3649.3767
##  [8,] 0.118208346 0.112589561 0.32859771 0.440604384 0.55939562 3076.4465
##  [9,] 0.086781614 0.087143561 0.29946058 0.526614243 0.47338576 2533.7673
## [10,] 0.063709956 0.066588236 0.26508248 0.604619324 0.39538068 2047.6823
## [11,] 0.046772102 0.050406356 0.22939980 0.673421738 0.32657826 1629.2977
## [12,] 0.034337326 0.037891109 0.19497300 0.732798560 0.26720144 1279.7379
## [13,] 0.025208445 0.028333148 0.16330366 0.783154747 0.21684525  994.3123
## [14,] 0.018506557 0.021100816 0.13513496 0.825257664 0.17474234  765.4582
## [15,] 0.013586426 0.015665823 0.11069975 0.860048001 0.13995200  584.6466
## [16,] 0.009974355 0.011602730 0.08990956 0.888513354 0.11148665  443.5145
## [17,] 0.007322584 0.008577319 0.07249078 0.911609319 0.08839068  334.4647
## [18,] 0.005375811 0.006331478 0.05807805 0.930214660 0.06978534  250.9230
## [19,] 0.003946604 0.004668295 0.04627534 0.945109758 0.05489024  187.3898
## [20,] 0.002897365 0.003438889 0.03669358 0.956970165 0.04302984  139.3772
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.837005046 0.123124486 0.03536537 0.004505101 0.99549490 6930.5971
##  [2,] 0.700577447 0.196345269 0.08867328 0.014404008 0.98559599 6791.4239
##  [3,] 0.508655105 0.261356570 0.18556703 0.044421291 0.95557871 5077.7859
##  [4,] 0.369309656 0.260175058 0.27200625 0.098509037 0.90149096 5002.4108
##  [5,] 0.268137723 0.230638906 0.32749764 0.173725728 0.82627427 4688.9864
##  [6,] 0.194681719 0.192195512 0.35098973 0.262133043 0.73786696 4205.3356
##  [7,] 0.141348898 0.154207957 0.34880720 0.355635947 0.64436405 3637.7081
##  [8,] 0.102626539 0.120654839 0.32891999 0.447798633 0.55220137 3056.4860
##  [9,] 0.074512123 0.092753623 0.29850482 0.534229433 0.46577057 2508.5235
## [10,] 0.054099617 0.070397668 0.26314146 0.612361252 0.38763875 2019.7745
## [11,] 0.039279093 0.052922398 0.22676181 0.681036700 0.31896330 1600.8095
## [12,] 0.028518633 0.039497272 0.19189863 0.740085461 0.25991454 1252.1935
## [13,] 0.020705988 0.029312988 0.16001326 0.789967761 0.21003224  968.7254
## [14,] 0.015033608 0.021659678 0.13180408 0.831502630 0.16849737  742.4174
## [15,] 0.010915169 0.015949465 0.10746007 0.865675292 0.13432471  564.4113
## [16,] 0.007924972 0.011712563 0.08685323 0.893509235 0.10649077  426.1067
## [17,] 0.005753935 0.008582419 0.06967644 0.915987208 0.08401279  319.7478
## [18,] 0.004177652 0.006277805 0.05553741 0.934007132 0.06599287  238.6649
## [19,] 0.003033189 0.004585587 0.04401951 0.948361712 0.05163829  177.3105
## [20,] 0.002202251 0.003345718 0.03471870 0.959733330 0.04026667  131.1823
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.860001404 0.103282708 0.03240335 0.004312541 0.99568746 6908.8825
##  [2,] 0.739602414 0.169268506 0.07826501 0.012864073 0.98713593 6736.1454
##  [3,] 0.539780353 0.244455361 0.17536966 0.040394628 0.95960537 5037.0843
##  [4,] 0.393945211 0.247730194 0.26755579 0.090768806 0.90923119 5008.3205
##  [5,] 0.287511075 0.220539856 0.32977172 0.162177346 0.83782265 4740.8166
##  [6,] 0.209832778 0.183737787 0.35915339 0.247276041 0.75272396 4292.2697
##  [7,] 0.153141213 0.147157086 0.36144781 0.338253888 0.66174611 3747.0639
##  [8,] 0.111766290 0.114886347 0.34458133 0.428766028 0.57123397 3176.9503
##  [9,] 0.081569836 0.088139329 0.31590062 0.514390213 0.48560979 2631.1921
## [10,] 0.059531708 0.066787039 0.28122423 0.592457023 0.40754298 2138.2460
## [11,] 0.043447730 0.050153554 0.24472759 0.661671127 0.33832887 1710.8927
## [12,] 0.031709241 0.037412048 0.20916448 0.721714234 0.27828577 1351.4842
## [13,] 0.023142198 0.027767877 0.17618448 0.772905444 0.22709456 1056.1736
## [14,] 0.016889755 0.020531481 0.14663931 0.815939452 0.18406055  817.9385
## [15,] 0.012326566 0.015136761 0.12083805 0.851698620 0.14830138  628.5632
## [16,] 0.008996236 0.011134539 0.09874315 0.881126079 0.11887392  479.8353
## [17,] 0.006565678 0.008176343 0.08011257 0.905145410 0.09485459  364.1978
## [18,] 0.004791796 0.005996008 0.06459826 0.924613933 0.07538607  275.0451
## [19,] 0.003497173 0.004392495 0.05181118 0.940299156 0.05970084  206.8039
## [20,] 0.002552324 0.003215187 0.04136207 0.952870419 0.04712958  154.8910
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.817616892 0.131741577 0.04266975 0.007971777 0.99202822 6952.7897
##  [2,] 0.668497382 0.203108354 0.10571304 0.022681226 0.97731877 6835.5458
##  [3,] 0.487692800 0.250609341 0.20259116 0.059106694 0.94089331 5102.3955
##  [4,] 0.355789378 0.243352646 0.28309305 0.117764930 0.88223507 4976.5806
##  [5,] 0.259561103 0.213295593 0.33262498 0.194518326 0.80548167 4630.8852
##  [6,] 0.189359128 0.176736485 0.35200357 0.281900815 0.71809918 4136.4262
##  [7,] 0.138144271 0.141420234 0.34769498 0.372740520 0.62725948 3573.3026
##  [8,] 0.100781197 0.110547762 0.32720374 0.461467303 0.53853270 3004.7069
##  [9,] 0.073523495 0.085007089 0.29713740 0.544332018 0.45566798 2472.0051
## [10,] 0.053638025 0.064590989 0.26259760 0.619173386 0.38082661 1997.7677
## [11,] 0.039130862 0.048643059 0.22717948 0.685046603 0.31495340 1590.8839
## [12,] 0.028547366 0.036385912 0.19320992 0.741856805 0.25814320 1251.3779
## [13,] 0.020826327 0.027076042 0.16204484 0.790052796 0.20994720  974.1683
## [14,] 0.015193552 0.020066815 0.13434568 0.830393954 0.16960605  751.7044
## [15,] 0.011084241 0.014824914 0.11030634 0.863784510 0.13621549  575.6680
## [16,] 0.008086351 0.010924883 0.08982600 0.891162770 0.10883723  437.9798
## [17,] 0.005899283 0.008034837 0.07263386 0.913432016 0.08656798  331.3298
## [18,] 0.004303738 0.005899956 0.05837499 0.931421314 0.06857869  249.4005
## [19,] 0.003139731 0.004326832 0.04666662 0.945866819 0.05413318  186.9052
## [20,] 0.002290547 0.003169934 0.03713308 0.957406435 0.04259356  139.5243
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.859968128 0.099142315 0.03610789 0.004781672 0.99521833 6926.4210
##  [2,] 0.739545181 0.163206756 0.08311623 0.014131828 0.98586817 6753.5031
##  [3,] 0.536546023 0.238536929 0.18082055 0.044096499 0.95590350 5048.5757
##  [4,] 0.389268488 0.242848685 0.26972846 0.098154367 0.90184563 4988.4845
##  [5,] 0.282417443 0.216731690 0.32695871 0.173892159 0.82610784 4682.7668
##  [6,] 0.204896144 0.180793786 0.35110530 0.263204768 0.73679523 4199.6624
##  [7,] 0.148653813 0.144850426 0.34878581 0.357709956 0.64229004 3628.8335
##  [8,] 0.107849546 0.113039247 0.32835680 0.450754406 0.54924559 3043.5274
##  [9,] 0.078245720 0.086628861 0.29729331 0.537832112 0.46216789 2492.2333
## [10,] 0.056767904 0.065532720 0.26135481 0.616344564 0.38365544 2001.5371
## [11,] 0.041185574 0.049103063 0.22455646 0.685154905 0.31484509 1582.0310
## [12,] 0.029880468 0.036530095 0.18945045 0.744138989 0.25586101 1234.0107
## [13,] 0.021678522 0.027028881 0.15748177 0.793810827 0.20618917  951.9192
## [14,] 0.015727943 0.019915249 0.12931651 0.835040294 0.16495971  727.4345
## [15,] 0.011410750 0.014626197 0.10510764 0.868855411 0.13114459  551.4321
## [16,] 0.008278592 0.010714555 0.08469406 0.896312795 0.10368720  415.1218
## [17,] 0.006006185 0.007833410 0.06774140 0.918419009 0.08158099  310.6273
## [18,] 0.004357536 0.005718008 0.05383668 0.936087774 0.06391223  231.2128
## [19,] 0.003161428 0.004168682 0.04254867 0.950121219 0.04987878  171.3034
## [20,] 0.002293642 0.003036159 0.03346384 0.961206358 0.03879364  126.3958</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 9.119287 9.130190 8.735387 8.880536 8.976861 8.989948 8.892410
##  [8] 9.140356 8.767919 8.849950</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 51977.77 51393.77 49696.30 50946.77 50410.80 50488.01 50340.60
##  [8] 51462.80 50171.35 50067.03</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 6090.233 7452.144 6301.275 6310.117 8322.838 6176.481 7135.756
##  [8] 6314.484 8324.329 6319.876</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     8.150018      9.119287       46074.70        51977.77 6090.233
##  [2,]     8.408730      9.130190       46017.34        51393.77 7452.144
##  [3,]     7.784175      8.735387       43702.46        49696.30 6301.275
##  [4,]     7.945390      8.880536       45045.89        50946.77 6310.117
##  [5,]     8.354212      8.976861       45228.59        50410.80 8322.838
##  [6,]     8.014012      8.989948       44460.16        50488.01 6176.481
##  [7,]     8.111931      8.892410       44771.29        50340.60 7135.756
##  [8,]     8.216678      9.140356       45630.25        51462.80 6314.484
##  [9,]     8.143621      8.767919       44974.49        50171.35 8324.329
## [10,]     7.903825      8.849950       44087.64        50067.03 6319.876</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
