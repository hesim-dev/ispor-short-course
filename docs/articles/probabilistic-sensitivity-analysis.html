<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-model-hesim.html">Simple Markov Cohort Model (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model-simple.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.737431 0.1846464 0.07116827 0.006754289
## [2,] 0.000000 0.5877909 0.40287322 0.009335842
## [3,] 0.000000 0.0000000 0.72522598 0.274774023
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7211511 0.2081417 0.06392587 0.006781306
## [2,] 0.0000000 0.5806496 0.40474976 0.014600597
## [3,] 0.0000000 0.0000000 0.74113454 0.258865458
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7378897 0.1807823 0.0740163 0.007311726
## [2,] 0.0000000 0.6091082 0.3781851 0.012706737
## [3,] 0.0000000 0.0000000 0.7333115 0.266688488
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 4
## 
##          [,1]      [,2]       [,3]       [,4]
## [1,] 0.720489 0.1980223 0.07144969 0.01003893
## [2,] 0.000000 0.5703854 0.40977613 0.01983851
## [3,] 0.000000 0.0000000 0.75087508 0.24912492
## [4,] 0.000000 0.0000000 0.00000000 1.00000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7114757 0.2125537 0.06303315 0.01293746
## [2,] 0.0000000 0.5653601 0.42778299 0.00685695
## [3,] 0.0000000 0.0000000 0.75047156 0.24952844
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7257296 0.2008020 0.06241374 0.01105460
## [2,] 0.0000000 0.5817022 0.40806566 0.01023216
## [3,] 0.0000000 0.0000000 0.73337585 0.26662415
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7288483 0.1955004 0.06433509 0.01131622
## [2,] 0.0000000 0.5710070 0.41699859 0.01199441
## [3,] 0.0000000 0.0000000 0.74877075 0.25122925
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7408735 0.1887275 0.0603509 0.010048100
## [2,] 0.0000000 0.6003782 0.3915826 0.008039239
## [3,] 0.0000000 0.0000000 0.7555051 0.244494923
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7336907 0.2031552 0.05569513 0.007459023
## [2,] 0.0000000 0.6043336 0.38292225 0.012744152
## [3,] 0.0000000 0.0000000 0.74756671 0.252433293
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7135663 0.2037370 0.07185221 0.01084441
## [2,] 0.0000000 0.5864681 0.39842091 0.01511095
## [3,] 0.0000000 0.0000000 0.77147030 0.22852970
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.3801631 0.4578667 0.5171962 0.5927206 0.5066717 0.5258553 0.6002764
##  [8] 0.4343476 0.3779122 0.5627645</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##          [,1]       [,2]       [,3]        [,4]
## [1,] 0.900181 0.07019576 0.02705555 0.002567732
## [2,] 0.000000 0.84329332 0.15315754 0.003549143
## [3,] 0.000000 0.00000000 0.89554105 0.104458949
## [4,] 0.000000 0.00000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8723244 0.09530115 0.02926953 0.003104934
## [2,] 0.0000000 0.80799343 0.18532144 0.006685127
## [3,] 0.0000000 0.00000000 0.88147412 0.118525877
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8644375 0.0934999 0.03828095 0.003781597
## [2,] 0.0000000 0.7978322 0.19559591 0.006571877
## [3,] 0.0000000 0.0000000 0.86206972 0.137930285
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.8343281 0.1173719 0.0423497 0.005950282
## [2,] 0.0000000 0.7453585 0.2428828 0.011758696
## [3,] 0.0000000 0.0000000 0.8523385 0.147661477
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8538129 0.1076950 0.03193711 0.006555044
## [2,] 0.0000000 0.7797802 0.21674554 0.003474223
## [3,] 0.0000000 0.0000000 0.87357100 0.126429000
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.8557735 0.1055928 0.0328206 0.005813122
## [2,] 0.0000000 0.7800359 0.2145835 0.005380636
## [3,] 0.0000000 0.0000000 0.8597943 0.140205728
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 7
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.837234 0.1173543 0.03861884 0.006792858
## [2,] 0.000000 0.7424856 0.25031443 0.007199959
## [3,] 0.000000 0.0000000 0.84919300 0.150806998
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##          [,1]       [,2]       [,3]        [,4]
## [1,] 0.887449 0.08197336 0.02621327 0.004364369
## [2,] 0.000000 0.82642520 0.17008298 0.003491825
## [3,] 0.000000 0.00000000 0.89380421 0.106195791
## [4,] 0.000000 0.00000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8993585 0.07677481 0.02104787 0.002818856
## [2,] 0.0000000 0.85047285 0.14471098 0.004816170
## [3,] 0.0000000 0.00000000 0.90460239 0.095397613
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]     [,2]       [,3]        [,4]
## [1,] 0.8388053 0.114656 0.04043587 0.006102847
## [2,] 0.0000000 0.767279 0.22421713 0.008503904
## [3,] 0.0000000 0.000000 0.87139161 0.128608392
## [4,] 0.0000000 0.000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.737431003 0.184646437 0.07116827 0.006754289 0.99324571 5188.23313
##  [2,] 0.543804484 0.244697510 0.17848387 0.033014133 0.96698587 5389.76505
##  [3,] 0.401018286 0.244242539 0.26672484 0.088014335 0.91198566 5315.23388
##  [4,] 0.295723317 0.217610150 0.32037434 0.166292195 0.83370780 4961.64119
##  [5,] 0.218075542 0.182513531 0.34105921 0.258351716 0.74164828 4423.35186
##  [6,] 0.160815666 0.147546672 0.33639487 0.355242790 0.64475721 3801.27833
##  [7,] 0.118590458 0.116420637 0.31484988 0.450139030 0.54986097 3172.71296
##  [8,] 0.087452280 0.090328301 0.28367994 0.538539476 0.46146052 2586.82922
##  [9,] 0.064490023 0.069241909 0.24834674 0.617921324 0.38207868 2069.45173
## [10,] 0.047556942 0.052607620 0.21259286 0.687242574 0.31275743 1629.90451
## [11,] 0.035069964 0.039703502 0.17875661 0.746469920 0.25353008 1267.15065
## [12,] 0.025861678 0.029812903 0.14813029 0.796195132 0.20380487  974.42808
## [13,] 0.019071203 0.022299021 0.12127928 0.837350493 0.16264951  742.40421
## [14,] 0.014063697 0.016628592 0.09829583 0.871011882 0.12898812  561.14523
## [15,] 0.010371006 0.012370947 0.07898679 0.898271254 0.10172875  421.23356
## [16,] 0.007647901 0.009186500 0.06300528 0.920160315 0.07983968  314.31798
## [17,] 0.005639800 0.006811899 0.04993835 0.937609950 0.06239005  233.31061
## [18,] 0.004158963 0.005045342 0.03936230 0.951433399 0.04856660  172.38015
## [19,] 0.003066948 0.003733544 0.03087518 0.962324329 0.03767567  126.83939
## [20,] 0.002261663 0.002760844 0.02411390 0.970863597 0.02913640   92.98822
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.721151143 0.208141683 0.06392587 0.006781306 0.99321869 5151.95608
##  [2,] 0.520058971 0.270959006 0.17772318 0.031258844 0.96874116 5400.31544
##  [3,] 0.375041121 0.265578199 0.27463260 0.084748079 0.91525192 5375.84525
##  [4,] 0.270461333 0.232269576 0.33500725 0.162261841 0.83773816 5053.60193
##  [5,] 0.195043500 0.191161523 0.35958598 0.254209002 0.74579100 4527.38890
##  [6,] 0.140655843 0.151594552 0.35634249 0.351407112 0.64859289 3903.63828
##  [7,] 0.101434122 0.117299666 0.33444714 0.446819076 0.55318092 3265.47201
##  [8,] 0.073149333 0.089222678 0.30183160 0.535796388 0.46420361 2666.47763
##  [9,] 0.052751725 0.067032541 0.26448682 0.615728917 0.38427108 2135.31476
## [10,] 0.038041967 0.049902254 0.22652392 0.685531859 0.31446814 1682.89282
## [11,] 0.027434008 0.036893845 0.19051449 0.745157654 0.25484235 1308.91057
## [12,] 0.019784066 0.027132558 0.15788339 0.795199986 0.20480001 1006.82195
## [13,] 0.014267302 0.019872399 0.12925944 0.836600856 0.16339914  767.22426
## [14,] 0.010288881 0.014508522 0.10475404 0.870448561 0.12955144  579.97773
## [15,] 0.007419838 0.010565913 0.08416688 0.897847367 0.10215263  435.41235
## [16,] 0.005350825 0.007679471 0.06712985 0.919839851 0.08016015  324.92668
## [17,] 0.003858753 0.005572812 0.05320257 0.937365861 0.06263414  241.20828
## [18,] 0.002782744 0.004039019 0.04193253 0.951245704 0.04875430  178.23563
## [19,] 0.002006779 0.002924460 0.03289033 0.962178431 0.03782157  131.16636
## [20,] 0.001447191 0.002115781 0.02568812 0.970748909 0.02925109   96.17701
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.737889718 0.180782258 0.07401630 0.007311726 0.99268827 5201.3021
##  [2,] 0.544481235 0.243513320 0.17726202 0.034743420 0.96525658 5374.9079
##  [3,] 0.401767105 0.246758502 0.26238187 0.089092519 0.91090748 5288.5082
##  [4,] 0.296459815 0.222934986 0.31546535 0.165139850 0.83486015 4943.1782
##  [5,] 0.218754650 0.189386198 0.33758792 0.254271236 0.74572876 4424.0067
##  [6,] 0.161416807 0.154903641 0.33537155 0.348308002 0.65169200 3822.9140
##  [7,] 0.119107802 0.123534369 0.31646154 0.440896289 0.55910371 3211.7572
##  [8,] 0.087888422 0.096778372 0.28759967 0.527733541 0.47226646 2637.5295
##  [9,] 0.064851963 0.074837165 0.25400546 0.606305414 0.39369459 2125.9800
## [10,] 0.047853597 0.057308014 0.21936753 0.675470862 0.32452914 1687.4184
## [11,] 0.035310677 0.043557861 0.18607972 0.735051746 0.26494825 1322.1455
## [12,] 0.026055385 0.032914993 0.15554090 0.785488725 0.21451128 1024.6906
## [13,] 0.019226001 0.024759143 0.12843641 0.827578443 0.17242156  786.7845
## [14,] 0.014186668 0.018556716 0.10497048 0.862286139 0.13771386  599.2801
## [15,] 0.010468197 0.013867746 0.08504398 0.890620081 0.10937992  453.2889
## [16,] 0.007724375 0.010339421 0.06838312 0.913553085 0.08644692  340.7785
## [17,] 0.005699737 0.007694256 0.05462807 0.931977934 0.06802207  254.8231
## [18,] 0.004205777 0.005717046 0.04339112 0.946686056 0.05331394  189.6455
## [19,] 0.003103400 0.004242629 0.03429261 0.958361365 0.04163863  140.5433
## [20,] 0.002289967 0.003145260 0.02698136 0.967583410 0.03241659  103.7613
## 
## , , 4
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.720489046 0.198022335 0.07144969 0.01003893 0.98996107 5178.0289
##  [2,] 0.519104466 0.255621964 0.18627333 0.03900024 0.96099976 5409.1594
##  [3,] 0.374009082 0.248597304 0.28170563 0.09568798 0.90431202 5362.5085
##  [4,] 0.269469446 0.215858414 0.34011781 0.17455433 0.82544567 5026.0435
##  [5,] 0.194149784 0.176483448 0.36309312 0.26627364 0.73372636 4495.1410
##  [6,] 0.139882793 0.139109569 0.35882822 0.36217941 0.63782059 3873.7585
##  [7,] 0.100784020 0.107045979 0.33643354 0.45573647 0.54426353 3241.8570
##  [8,] 0.072613783 0.081014946 0.30368543 0.54268584 0.45731416 2650.4644
##  [9,] 0.052317435 0.060588890 0.26641605 0.62067763 0.37932237 2126.5786
## [10,] 0.037694139 0.044919036 0.22861112 0.68877571 0.31122429 1680.2362
## [11,] 0.027158214 0.033085442 0.19275837 0.74699797 0.25300203 1310.8255
## [12,] 0.019567196 0.024249385 0.16023553 0.79594789 0.20405211 1011.8338
## [13,] 0.014097950 0.017706236 0.13165176 0.83654406 0.16345594  774.0689
## [14,] 0.010157419 0.012891087 0.10711691 0.86983458 0.13016542  587.6660
## [15,] 0.007318309 0.009364283 0.08643962 0.89687778 0.10312222  443.2286
## [16,] 0.005272761 0.006790438 0.06926551 0.91867129 0.08132871  332.3939
## [17,] 0.003798967 0.004917291 0.05516904 0.93611470 0.06388530  248.0402
## [18,] 0.002737114 0.003557031 0.04371148 0.94999437 0.05000563  184.2884
## [19,] 0.001972061 0.002570888 0.03447502 0.96098204 0.03901796  136.3964
## [20,] 0.001420848 0.001856909 0.02708082 0.96964142 0.03035858  100.6060
## 
## , , 5
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.711475654 0.212553740 0.06303315 0.01293746 0.98706254 5118.68769
##  [2,] 0.506197607 0.271396207 0.18307801 0.03932818 0.96067182 5394.06894
##  [3,] 0.360147273 0.261030771 0.28540075 0.09342121 0.90657879 5394.57306
##  [4,] 0.256236017 0.224127023 0.34855088 0.17108608 0.82891392 5083.56674
##  [5,] 0.182305688 0.181176392 0.37360662 0.26291130 0.73708870 4557.93686
##  [6,] 0.129706058 0.141179652 0.36937662 0.35973767 0.64026233 3929.33939
##  [7,] 0.092282703 0.107386845 0.34577669 0.45455377 0.54544623 3284.72567
##  [8,] 0.065656896 0.080327267 0.31125071 0.54276513 0.45723487 2679.75689
##  [9,] 0.046713283 0.059369448 0.27208600 0.62183127 0.37816873 2143.90617
## [10,] 0.033235364 0.043494198 0.23253453 0.69073591 0.30926409 1688.18549
## [11,] 0.023646152 0.031654183 0.19521156 0.74948810 0.25051190 1312.07707
## [12,] 0.016823662 0.022922089 0.16153234 0.79872191 0.20127809 1008.72729
## [13,] 0.011969626 0.016535166 0.13209156 0.83940365 0.16059635  768.44625
## [14,] 0.008516097 0.011892511 0.10695890 0.87263249 0.12736751  580.86869
## [15,] 0.006058996 0.008533679 0.08589382 0.89951350 0.10048650  436.16605
## [16,] 0.004310828 0.006112464 0.06849335 0.92108335 0.07891665  325.63508
## [17,] 0.003067049 0.004372025 0.05428885 0.93827208 0.06172792  241.90383
## [18,] 0.002182131 0.003123681 0.04280584 0.95188835 0.04811165  178.91986
## [19,] 0.001552533 0.002229825 0.03359837 0.96261927 0.03738073  131.82777
## [20,] 0.001104589 0.001590651 0.02626636 0.97103840 0.02896160   96.80121
## 
## , , 6
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.725729611 0.200802048 0.06241374 0.01105460 0.98894540 5120.69510
##  [2,] 0.526683468 0.262534980 0.17300865 0.03777291 0.96222709 5342.68299
##  [3,] 0.382229788 0.258476288 0.26688416 0.09240976 0.90759024 5301.02963
##  [4,] 0.277395475 0.227108743 0.32505809 0.17043770 0.82956230 4970.52946
##  [5,] 0.201314110 0.187811229 0.34837832 0.26249634 0.73750366 4443.12120
##  [6,] 0.146099611 0.149674486 0.34469633 0.35952957 0.64047043 3823.09161
##  [7,] 0.106028814 0.116403075 0.32298761 0.45458051 0.54541949 3191.67065
##  [8,] 0.076948250 0.089002725 0.29098906 0.54305996 0.45694004 2600.97162
##  [9,] 0.055843623 0.067224445 0.25452594 0.62240599 0.37759401 2078.59842
## [10,] 0.040527371 0.050318120 0.21758057 0.69157394 0.30842606 1634.76054
## [11,] 0.029411913 0.037408139 0.18263090 0.75054905 0.24945095 1268.73334
## [12,] 0.021345096 0.027666368 0.15103778 0.79995076 0.20004924  973.74899
## [13,] 0.015490768 0.020379726 0.12338938 0.84074012 0.15925988  740.32196
## [14,] 0.011242109 0.014965509 0.09977390 0.87401849 0.12598151  558.31976
## [15,] 0.008158732 0.010962908 0.07998034 0.90089802 0.09910198  418.13359
## [16,] 0.005921033 0.008015437 0.06363845 0.92242508 0.07757492  311.25167
## [17,] 0.004297069 0.005851553 0.05031128 0.93954010 0.06045990  230.46246
## [18,] 0.003118510 0.004266721 0.03955309 0.95306167 0.04693833  169.84557
## [19,] 0.002263195 0.003108164 0.03094302 0.96368562 0.03631438  124.65347
## [20,] 0.001642468 0.002262480 0.02410246 0.97199260 0.02800740   91.14783
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.728848298 0.195500399 0.06433509 0.01131622 0.98868378 5129.3027
##  [2,] 0.531219842 0.254122232 0.17658614 0.03807179 0.96192821 5359.0306
##  [3,] 0.387178678 0.248959267 0.27236722 0.09149483 0.90850517 5331.3091
##  [4,] 0.282194521 0.217851072 0.33266545 0.16728896 0.83271104 5018.5811
##  [5,] 0.205676996 0.179563631 0.35808875 0.25667062 0.74332938 4508.5700
##  [6,] 0.149907329 0.142742026 0.35623641 0.35111423 0.64888577 3902.3629
##  [7,] 0.109259702 0.110813640 0.33590693 0.44401973 0.55598027 3279.6359
##  [8,] 0.079633748 0.084635680 0.30475565 0.53097492 0.46902508 2692.3218
##  [9,] 0.058040921 0.063895996 0.26860832 0.60945476 0.39054524 2168.7092
## [10,] 0.042303027 0.047832085 0.23150466 0.67836023 0.32163977 1720.0952
## [11,] 0.030832489 0.035582714 0.19601140 0.73757340 0.26242660 1346.9195
## [12,] 0.022472207 0.026345743 0.16358916 0.78759289 0.21240711 1043.4625
## [13,] 0.016378830 0.019436930 0.13492266 0.82926158 0.17073842  801.0828
## [14,] 0.011937682 0.014300691 0.11018505 0.86357658 0.13642342  610.2671
## [15,] 0.008700759 0.010499616 0.08923472 0.89156490 0.10843510  461.8191
## [16,] 0.006341534 0.007696356 0.07175444 0.91420767 0.08579233  347.4691
## [17,] 0.004622016 0.005634446 0.05734498 0.93239856 0.06760144  260.1173
## [18,] 0.003368749 0.004120914 0.04558516 0.94692518 0.05307482  193.8632
## [19,] 0.002455307 0.003011663 0.03606798 0.95846505 0.04153495  143.9183
## [20,] 0.001789546 0.002199694 0.02842047 0.96759029 0.03240971  106.4682
## 
## , , 8
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.740873473 0.188727529 0.06035090 0.01004810 0.98995190 5109.9384
##  [2,] 0.548893503 0.253131104 0.16421021 0.03376519 0.96623481 5309.2122
##  [3,] 0.406660636 0.255565699 0.25630960 0.08146407 0.91853593 5291.0697
##  [4,] 0.301284077 0.230184119 0.31826062 0.15027118 0.84972882 5018.0056
##  [5,] 0.223213381 0.195058115 0.34876638 0.23296213 0.76703787 4557.6356
##  [6,] 0.165372873 0.159235140 0.35334726 0.32204472 0.67795528 3996.2339
##  [7,] 0.122520374 0.126811713 0.33928976 0.41137815 0.58862185 3406.1292
##  [8,] 0.090772095 0.099257949 0.31338662 0.49658334 0.50341666 2837.5098
##  [9,] 0.067250637 0.076723497 0.28111104 0.57491482 0.42508518 2320.1319
## [10,] 0.049824213 0.058755158 0.24648304 0.64493758 0.35506242 1868.1328
## [11,] 0.036913438 0.044678514 0.21223363 0.70617442 0.29382558 1485.0220
## [12,] 0.027348187 0.033790586 0.18006667 0.75879456 0.24120544 1167.7920
## [13,] 0.020261546 0.025448485 0.15092358 0.80336639 0.19663361  909.9273
## [14,] 0.015011242 0.019102626 0.12521151 0.84067462 0.15932538  703.4335
## [15,] 0.011121431 0.014301834 0.10298413 0.87159260 0.12840740  540.1037
## [16,] 0.008239573 0.010685429 0.08407657 0.89699842 0.10300158  412.2404
## [17,] 0.006104481 0.007970332 0.06820177 0.91772341 0.08227659  313.0115
## [18,] 0.004522648 0.005937297 0.05501624 0.93452382 0.06547618  236.5770
## [19,] 0.003350710 0.004418172 0.04416294 0.94806818 0.05193182  178.0788
## [20,] 0.002482452 0.003284945 0.03529762 0.95893498 0.04106502  133.5581
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.733690670 0.203155176 0.05569513 0.007459023 0.99254098 5098.8070
##  [2,] 0.538301999 0.271826555 0.16029146 0.029579985 0.97042002 5311.0866
##  [3,] 0.394947154 0.273632757 0.25389780 0.077522292 0.92247771 5299.5621
##  [4,] 0.289769042 0.245601026 0.31658224 0.148047687 0.85195231 5022.1760
##  [5,] 0.212600843 0.207293032 0.34685117 0.233254956 0.76674504 4550.2941
##  [6,] 0.155983255 0.168465105 0.35051233 0.325039308 0.67496069 3975.0401
##  [7,] 0.114443459 0.133497928 0.33522790 0.416830718 0.58316928 3372.3045
##  [8,] 0.083966098 0.103927064 0.30809848 0.504008354 0.49599165 2794.1860
##  [9,] 0.061605143 0.079864763 0.27479666 0.583733437 0.41626656 2271.0432
## [10,] 0.045199118 0.060780363 0.23944193 0.654578585 0.34542142 1816.7899
## [11,] 0.033162171 0.045914050 0.20479034 0.716133436 0.28386656 1434.2945
## [12,] 0.024330776 0.034484470 0.17252292 0.768661830 0.23133817 1119.7736
## [13,] 0.017851263 0.025783047 0.14353237 0.812833319 0.18716668  865.9690
## [14,] 0.013097305 0.019208138 0.11816715 0.849527404 0.15047260  664.2598
## [15,] 0.009609371 0.014268908 0.09642251 0.879699212 0.12030079  505.9568
## [16,] 0.007050306 0.010575374 0.07808133 0.904292985 0.09570701  383.0201
## [17,] 0.005172743 0.007823360 0.06281322 0.924190677 0.07580932  288.3961
## [18,] 0.003795194 0.005778789 0.05024091 0.940185110 0.05981489  216.1182
## [19,] 0.002784498 0.004263329 0.03998263 0.952969542 0.04703046  161.2721
## [20,] 0.002042960 0.003142158 0.03167729 0.963137591 0.03686241  119.8921
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.713566337 0.203737042 0.07185221 0.01084441 0.98915559 5178.1732
##  [2,] 0.509176917 0.264865181 0.18787627 0.03808164 0.96191836 5424.6277
##  [3,] 0.363331507 0.259073191 0.28705427 0.09054103 0.90945897 5414.9385
##  [4,] 0.259261133 0.225962261 0.35078020 0.16399641 0.83600359 5123.3045
##  [5,] 0.185000017 0.185340765 0.37927308 0.25038614 0.74961386 4632.4425
##  [6,] 0.132009784 0.146387811 0.37973421 0.34186819 0.65813181 4039.4837
##  [7,] 0.094197738 0.112747071 0.36076283 0.43229236 0.56770764 3422.6112
##  [8,] 0.067216335 0.085314135 0.33000691 0.51746262 0.48253738 2834.1593
##  [9,] 0.047963314 0.063728480 0.29341111 0.59489710 0.40510290 2303.8254
## [10,] 0.034225006 0.047146627 0.25519499 0.66343338 0.33656662 1844.6324
## [11,] 0.024421812 0.034622897 0.21811870 0.72283659 0.27716341 1458.6478
## [12,] 0.017426583 0.025280854 0.18382134 0.77347122 0.22652878 1141.4871
## [13,] 0.012435023 0.018376856 0.15313727 0.81605085 0.18394915  885.4965
## [14,] 0.008873214 0.013310916 0.12635606 0.85145981 0.14854019  681.8260
## [15,] 0.006331627 0.009614230 0.10342086 0.88063329 0.11936671  521.6738
## [16,] 0.004518036 0.006928427 0.08407157 0.90448197 0.09551803  396.9608
## [17,] 0.003223918 0.004983793 0.06794378 0.92384851 0.07615149  300.6338
## [18,] 0.002300479 0.003579667 0.05463390 0.93948595 0.06051405  226.7438
## [19,] 0.001641545 0.002568054 0.04373994 0.95205046 0.04794954  170.3981
## [20,] 0.001171351 0.001840525 0.03488518 0.96210294 0.03789706  127.6484</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7.906798 7.938824 8.031540 7.862784 7.846031 7.837817 7.992078
##  [8] 8.404779 8.308315 8.169775</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 43444.60 44232.96 43933.24 44173.12 44356.12 43393.77 44425.31
##  [8] 45793.74 45270.24 46129.71</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.900180952 0.070195765 0.02705555 0.002567732 0.99743227 6879.8277
##  [2,] 0.810325746 0.122384510 0.05933526 0.007954484 0.99204552 6649.5965
##  [3,] 0.597559328 0.221560268 0.15000640 0.030874009 0.96912599 4938.5164
##  [4,] 0.440658774 0.240568319 0.24057650 0.078196410 0.92180359 4923.1878
##  [5,] 0.324955442 0.222769951 0.30275178 0.149522826 0.85047717 4662.6992
##  [6,] 0.239632217 0.190944023 0.33243802 0.236985739 0.76301426 4212.5645
##  [7,] 0.176712226 0.156482402 0.33507313 0.331732240 0.66826776 3661.0868
##  [8,] 0.130313074 0.124608221 0.31862261 0.426456092 0.57354391 3084.2425
##  [9,] 0.096096901 0.097305428 0.29054887 0.516048804 0.48395120 2534.0556
## [10,] 0.070864834 0.074939200 0.25675439 0.597441579 0.40255842 2040.1695
## [11,] 0.052257926 0.057133522 0.22143928 0.669169277 0.33083072 1615.4099
## [12,] 0.038536615 0.043231806 0.18733019 0.730901392 0.26909861 1261.5269
## [13,] 0.028418094 0.032526913 0.15601624 0.783038754 0.21696125  973.8107
## [14,] 0.020956384 0.024366324 0.12827372 0.826403574 0.17359643  744.3642
## [15,] 0.015453887 0.018191826 0.10433540 0.862018885 0.13798112  564.2184
## [16,] 0.011396175 0.013546496 0.08409557 0.890961759 0.10903824  424.5828
## [17,] 0.008403893 0.010066771 0.06725686 0.914272478 0.08572752  317.4998
## [18,] 0.006197291 0.007468906 0.05343014 0.932903660 0.06709634  236.1197
## [19,] 0.004570075 0.005534463 0.04219900 0.947696462 0.05230354  174.7489
## [20,] 0.003370115 0.004096955 0.03315874 0.959374187 0.04062581  128.7748
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.872324390 0.095301149 0.02926953 0.003104934 0.99689507 6896.2856
##  [2,] 0.760949842 0.160136218 0.06899420 0.009919741 0.99008026 6700.8229
##  [3,] 0.548759848 0.251368418 0.16459346 0.035278274 0.96472173 5003.8689
##  [4,] 0.395738792 0.260176780 0.25880716 0.085277273 0.91472273 4989.8178
##  [5,] 0.285387482 0.233441292 0.32241536 0.158755868 0.84124413 4722.1785
##  [6,] 0.205807509 0.194948633 0.35168211 0.247561749 0.75243825 4260.6714
##  [7,] 0.148418320 0.156033975 0.35270560 0.342842110 0.65715789 3697.1067
##  [8,] 0.107032041 0.121493110 0.33404478 0.437430064 0.56256994 3109.4889
##  [9,] 0.077186279 0.092822760 0.30358855 0.526402409 0.47359759 2550.6668
## [10,] 0.055662973 0.069963184 0.26750415 0.606869690 0.39313031 2050.3673
## [11,] 0.040141417 0.052209883 0.23013245 0.677516247 0.32248375 1621.1335
## [12,] 0.028948029 0.038670752 0.19425712 0.738124097 0.26187590 1264.3055
## [13,] 0.020875904 0.028479449 0.16147317 0.789171478 0.21082852  974.7677
## [14,] 0.015054682 0.020881728 0.13253490 0.831528686 0.16847131  744.2781
## [15,] 0.010856701 0.015258475 0.10764045 0.866244371 0.13375563  563.6011
## [16,] 0.007829322 0.011119560 0.08664595 0.894405172 0.10559483  423.7522
## [17,] 0.005646125 0.008086177 0.06921744 0.917050260 0.08294974  316.6404
## [18,] 0.004071709 0.005870430 0.05493325 0.935124615 0.06487539  235.3287
## [19,] 0.002936318 0.004256155 0.04334927 0.949458258 0.05054174  174.0690
## [20,] 0.002117529 0.003082505 0.03403803 0.960761941 0.03923806  128.2168
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.864437546 0.093499905 0.03828095 0.003781597 0.99621840 6944.3787
##  [2,] 0.747252271 0.155422065 0.08438054 0.012945124 0.98705488 6766.0070
##  [3,] 0.551389767 0.229758803 0.17596438 0.042887054 0.95711295 5026.0185
##  [4,] 0.406864839 0.239629453 0.25673989 0.096765822 0.90323418 4928.9551
##  [5,] 0.300221381 0.219514204 0.30900923 0.171255187 0.82874481 4609.4578
##  [6,] 0.221530270 0.187982596 0.33183830 0.258648836 0.74135116 4132.4264
##  [7,] 0.163464909 0.154550479 0.33082991 0.351154704 0.64884530 3578.0418
##  [8,] 0.120619075 0.123689516 0.31314913 0.442542275 0.55745772 3011.7987
##  [9,] 0.089003575 0.097146084 0.28534117 0.528509168 0.47149083 2477.6324
## [10,] 0.065674823 0.075262742 0.25257088 0.606491553 0.39350845 2000.1812
## [11,] 0.048460777 0.057715994 0.21853739 0.675285840 0.32471416 1589.7248
## [12,] 0.035758709 0.043916133 0.18567020 0.734654960 0.26534504 1247.0803
## [13,] 0.026385984 0.033214216 0.15540925 0.784990553 0.21500945  967.5207
## [14,] 0.019469946 0.025001168 0.12847750 0.827051382 0.17294862  743.5683
## [15,] 0.014366673 0.018748237 0.10511020 0.861774895 0.13822510  566.8206
## [16,] 0.010601020 0.014016944 0.08523219 0.890149848 0.10985015  429.0434
## [17,] 0.007822384 0.010454311 0.06858739 0.913135913 0.08686409  322.7558
## [18,] 0.005772057 0.007781955 0.05482857 0.931617416 0.06838258  241.4831
## [19,] 0.004259141 0.005783538 0.04357667 0.946380652 0.05361935  179.8088
## [20,] 0.003142776 0.004292777 0.03445777 0.958106680 0.04189332  133.3143
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.834328091 0.117371923 0.04234970 0.005950282 0.99404972 6960.4699
##  [2,] 0.696103364 0.185410858 0.09993745 0.018548330 0.98145167 6824.9448
##  [3,] 0.501534849 0.243599652 0.20075385 0.054111649 0.94588835 5112.1226
##  [4,] 0.361350365 0.238260777 0.28639689 0.113991965 0.88600804 5006.7897
##  [5,] 0.260348980 0.207455902 0.33850024 0.193694878 0.80630512 4660.1351
##  [6,] 0.187578588 0.169884722 0.35778373 0.284752965 0.71524704 4150.3463
##  [7,] 0.135148318 0.134044508 0.35166802 0.379139154 0.62086085 3566.9457
##  [8,] 0.097372883 0.103219410 0.32864330 0.470764409 0.52923559 2979.6279
##  [9,] 0.070156095 0.078156846 0.29602418 0.555662882 0.44433712 2432.9244
## [10,] 0.050546698 0.058471995 0.25931662 0.631664688 0.36833531 1950.1914
## [11,] 0.036418342 0.043360945 0.22228636 0.697934352 0.30206565 1539.7712
## [12,] 0.026239017 0.031944093 0.18727965 0.754537241 0.24546276 1200.5786
## [13,] 0.018904924 0.023416355 0.15558832 0.802090403 0.19790960  926.3278
## [14,] 0.013620791 0.017099943 0.12777361 0.841505660 0.15849434  708.4047
## [15,] 0.009813631 0.012450778 0.10392237 0.873813225 0.12618678  537.6579
## [16,] 0.007070613 0.009045059 0.08383593 0.900048399 0.09995160  405.4132
## [17,] 0.005094299 0.006559309 0.06716195 0.921184440 0.07881556  303.9723
## [18,] 0.003670387 0.004750119 0.05348207 0.938097423 0.06190258  226.7916
## [19,] 0.002644474 0.003436217 0.04236709 0.951552222 0.04844778  168.4757
## [20,] 0.001905314 0.002483633 0.03340942 0.962201636 0.03779836  124.6765
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.853812875 0.107694968 0.03193711 0.006555044 0.99344496 6892.3001
##  [2,] 0.728996425 0.175929758 0.07851006 0.016563759 0.98343624 6715.8162
##  [3,] 0.518663208 0.254414576 0.18013026 0.046791953 0.95320805 5037.5060
##  [4,] 0.369016245 0.254079645 0.27670984 0.100194268 0.89980573 5017.5513
##  [5,] 0.262546075 0.222082267 0.33961407 0.175757585 0.82424241 4736.0477
##  [6,] 0.186795140 0.181361595 0.36642283 0.265420439 0.73457956 4259.4178
##  [7,] 0.132900195 0.142238608 0.36434760 0.360513595 0.63948640 3683.6277
##  [8,] 0.094555253 0.108664462 0.34265689 0.454123396 0.54587660 3088.1586
##  [9,] 0.067273760 0.081532620 0.30959917 0.541594445 0.45840556 2525.6613
## [10,] 0.047863643 0.060394576 0.27146412 0.620277659 0.37972234 2024.9189
## [11,] 0.034053816 0.044318278 0.23257887 0.689049033 0.31095097 1597.3757
## [12,] 0.024228461 0.032294050 0.19564895 0.747828533 0.25217147 1243.4133
## [13,] 0.017237960 0.023407616 0.16217102 0.797183404 0.20281660  957.1998
## [14,] 0.012264389 0.016897724 0.13280468 0.838033205 0.16196679  730.0198
## [15,] 0.008725814 0.012160140 0.10766776 0.871446286 0.12855371  552.3630
## [16,] 0.006208204 0.008729562 0.08655351 0.898508725 0.10149127  415.1146
## [17,] 0.004416986 0.006254923 0.06908163 0.920246463 0.07975354  310.1487
## [18,] 0.003142578 0.004475131 0.05479796 0.937584328 0.06241567  230.5498
## [19,] 0.002235868 0.003198027 0.04323678 0.951329321 0.04867068  170.6201
## [20,] 0.001590766 0.002283279 0.03395697 0.962168983 0.03783102  125.7765
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.855773455 0.105592827 0.03282060 0.005813122 0.99418688 6901.9073
##  [2,] 0.732348206 0.172729729 0.07896443 0.015957630 0.98404237 6721.3425
##  [3,] 0.531486778 0.247534279 0.17410427 0.046874672 0.95312533 5003.8193
##  [4,] 0.385715693 0.250714862 0.26186618 0.101703261 0.89829674 4937.2488
##  [5,] 0.279925299 0.223293881 0.31842842 0.178352397 0.82164760 4627.5943
##  [6,] 0.203150079 0.186100110 0.34211747 0.268632345 0.73136765 4141.9017
##  [7,] 0.147432027 0.149047791 0.33952111 0.363999072 0.63600093 3570.0886
##  [8,] 0.106995788 0.116306077 0.31901965 0.457678482 0.54232152 2985.6453
##  [9,] 0.077650012 0.089140471 0.28809983 0.545109683 0.45489032 2436.9735
## [10,] 0.056352913 0.067445487 0.25250706 0.623694545 0.37630546 1950.3094
## [11,] 0.040896977 0.050548967 0.21622196 0.692332095 0.30766791 1535.7785
## [12,] 0.029680147 0.037616641 0.18175180 0.750951415 0.24904858 1193.2113
## [13,] 0.021539762 0.027841516 0.15049489 0.800123835 0.19987617  916.6559
## [14,] 0.015632043 0.020520699 0.12307486 0.840772398 0.15922760  697.4939
## [15,] 0.011344636 0.015075881 0.09960958 0.873969904 0.12603010  526.4038
## [16,] 0.008233139 0.011047699 0.07991127 0.900807892 0.09919211  394.4842
## [17,] 0.005975032 0.008079702 0.06362704 0.922318222 0.07768178  293.8140
## [18,] 0.004336258 0.005899779 0.05033251 0.939431453 0.06056855  217.6605
## [19,] 0.003146951 0.004302644 0.03959079 0.952959619 0.04704038  160.4829
## [20,] 0.002283835 0.003134771 0.03098710 0.963594292 0.03640571  117.8293
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.837234023 0.117354283 0.03861884 0.006792858 0.99320714 6932.8031
##  [2,] 0.700960809 0.185386866 0.09450332 0.019149006 0.98085099 6790.8995
##  [3,] 0.510894093 0.242895318 0.19316376 0.053046833 0.94695317 5076.6118
##  [4,] 0.372364290 0.238574928 0.27879079 0.110269991 0.88973001 4984.0436
##  [5,] 0.271397079 0.209025323 0.33219189 0.187385711 0.81261429 4654.7484
##  [6,] 0.197807299 0.172413162 0.35335919 0.276420351 0.72357965 4160.9468
##  [7,] 0.144171514 0.137120530 0.34920702 0.369500938 0.63049906 3589.5879
##  [8,] 0.105079162 0.106482372 0.32793036 0.460508110 0.53949189 3009.8312
##  [9,] 0.076586769 0.081345199 0.29670793 0.545360098 0.45463990 2466.7112
## [10,] 0.055820136 0.061421423 0.26101427 0.621744169 0.37825583 1984.4908
## [11,] 0.040684411 0.045984922 0.22464369 0.688686974 0.31131303 1572.4655
## [12,] 0.029652764 0.034211531 0.18999971 0.746135996 0.25386400 1230.3799
## [13,] 0.021612366 0.025332151 0.15844010 0.794615384 0.20538462  952.5935
## [14,] 0.015752137 0.018690062 0.13058922 0.834968585 0.16503142  730.9526
## [15,] 0.011480918 0.013751705 0.10658853 0.868178846 0.13182115  556.6078
## [16,] 0.008367847 0.010096844 0.08628344 0.895251867 0.10474813  421.0632
## [17,] 0.006098891 0.007401286 0.06935523 0.917144589 0.08285541  316.7087
## [18,] 0.004445167 0.005418522 0.05540987 0.934726442 0.06527356  237.0279
## [19,] 0.003239852 0.003963046 0.04403479 0.948762317 0.05123768  176.6146
## [20,] 0.002361361 0.002896319 0.03483298 0.959909340 0.04009066  131.0873
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.887449006 0.081973356 0.02621327 0.004364369 0.99563563 6866.0798
##  [2,] 0.787565738 0.140492019 0.06063474 0.011307499 0.98869250 6640.3460
##  [3,] 0.583486563 0.232983674 0.14835439 0.035175374 0.96482463 4914.5046
##  [4,] 0.432289717 0.249998285 0.23852879 0.079183212 0.92081679 4911.3250
##  [5,] 0.320271984 0.231678478 0.30419376 0.143855776 0.85614422 4692.7231
##  [6,] 0.237281017 0.199538836 0.33986990 0.223310250 0.77668975 4295.6393
##  [7,] 0.175795211 0.164580218 0.34922949 0.310395078 0.68960492 3792.9674
##  [8,] 0.130242008 0.131987763 0.33890080 0.398869424 0.60113058 3252.2727
##  [9,] 0.096492849 0.103822821 0.31558561 0.484098716 0.51590128 2723.0314
## [10,] 0.071488992 0.080543811 0.28490517 0.563062023 0.43693798 2235.9964
## [11,] 0.052964298 0.061848685 0.25110129 0.634085731 0.36591427 1806.8569
## [12,] 0.039239843 0.047128420 0.21712361 0.696508127 0.30349187 1440.6982
## [13,] 0.029071759 0.035700512 0.18486082 0.750366910 0.24963309 1135.8963
## [14,] 0.021538495 0.026920449 0.15539749 0.796143563 0.20385644  887.0662
## [15,] 0.015957300 0.020227356 0.12924504 0.834570302 0.16542970  687.0983
## [16,] 0.011822340 0.015155645 0.10652900 0.866493011 0.13350699  528.4595
## [17,] 0.008758858 0.011330319 0.08713138 0.892779444 0.10722056  403.9555
## [18,] 0.006489206 0.008455514 0.07079356 0.914261721 0.08573828  307.1253
## [19,] 0.004807680 0.006301197 0.05718756 0.931703567 0.06829643  232.3998
## [20,] 0.003561883 0.004690443 0.04596308 0.945784599 0.05421540  175.1170
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.899358464 0.076774813 0.02104787 0.002818856 0.99718114 6844.5495
##  [2,] 0.808845646 0.134342972 0.04907969 0.007731694 0.99226831 6597.1033
##  [3,] 0.593442504 0.245509151 0.13318202 0.027866327 0.97213367 4868.8787
##  [4,] 0.435403228 0.268930344 0.22662522 0.069041210 0.93095879 4897.2649
##  [5,] 0.319451286 0.250978061 0.29664672 0.132923932 0.86707607 4702.8612
##  [6,] 0.234378428 0.216572656 0.33566018 0.213388738 0.78661126 4315.8519
##  [7,] 0.171961266 0.178497323 0.34691260 0.302628811 0.69737119 3812.0757
##  [8,] 0.126166376 0.142806750 0.33726831 0.393758561 0.60624144 3264.0215
##  [9,] 0.092567093 0.111934269 0.31384130 0.481657341 0.51834266 2725.2730
## [10,] 0.067915613 0.086451123 0.28263496 0.562998301 0.43700170 2229.2277
## [11,] 0.049829051 0.066042726 0.24817512 0.635953106 0.36404689 1792.9231
## [12,] 0.036559110 0.050034868 0.21359192 0.699814102 0.30018590 1421.8836
## [13,] 0.026823078 0.037664924 0.18086984 0.754642161 0.24535784 1114.3823
## [14,] 0.019679842 0.028211426 0.15112892 0.800979811 0.19902019  864.6653
## [15,] 0.014438916 0.021047174 0.12487780 0.839636106 0.16036389  665.1676
## [16,] 0.010593698 0.015652855 0.10221810 0.871535349 0.12846465  507.9177
## [17,] 0.007772498 0.011611711 0.08299869 0.897617101 0.10238290  385.3490
## [18,] 0.005702609 0.008596370 0.06692633 0.918774691 0.08122531  290.7115
## [19,] 0.004183951 0.006353590 0.05364125 0.935821214 0.06417879  218.2272
## [20,] 0.003069726 0.004689679 0.04276637 0.949474230 0.05052577  163.0949
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.838805314 0.114655966 0.04043587 0.006102847 0.99389715 6947.4004
##  [2,] 0.703594355 0.184147146 0.09486113 0.017397364 0.98260264 6803.6649
##  [3,] 0.502061247 0.251344669 0.19710543 0.049488652 0.95051135 5114.4386
##  [4,] 0.358254005 0.249694116 0.28827617 0.103775710 0.89622429 5059.5116
##  [5,] 0.255637998 0.219427257 0.34762120 0.177313543 0.82268646 4767.0096
##  [6,] 0.182414670 0.180770026 0.37397200 0.262843308 0.73715669 4301.7070
##  [7,] 0.130164967 0.143180488 0.37363774 0.353016801 0.64698320 3747.5332
##  [8,] 0.092881339 0.110490221 0.35464916 0.441979277 0.55802072 3173.8868
##  [9,] 0.066276997 0.083722364 0.32429664 0.525703998 0.47429600 2627.7724
## [10,] 0.047293034 0.062603579 0.28830412 0.601799271 0.39820073 2136.0064
## [11,] 0.033746717 0.046350348 0.25075875 0.669144188 0.33085581 1710.3425
## [12,] 0.024080521 0.034058459 0.21434465 0.727516370 0.27248363 1352.5679
## [13,] 0.017183049 0.024880295 0.18066037 0.777276283 0.22272372 1058.5746
## [14,] 0.012261246 0.018092324 0.15052158 0.819124848 0.18087515  821.2606
## [15,] 0.008749212 0.013108642 0.12421229 0.853929858 0.14607014  632.4271
## [16,] 0.006243143 0.009470339 0.10167750 0.882609019 0.11739098  483.9233
## [17,] 0.004454897 0.006826012 0.08266294 0.906056156 0.09394384  368.2672
## [18,] 0.003178864 0.004910866 0.06681172 0.925098550 0.07490145  278.9254
## [19,] 0.002268331 0.003527719 0.05372826 0.940475693 0.05952431  210.3864
## [20,] 0.001618604 0.002531038 0.04301826 0.952832101 0.04716790  158.1160</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 9.105480 8.987173 8.961871 8.648754 8.798830 8.754924 8.761442
##  [8] 9.483681 9.500938 9.006516</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50027.00 50427.37 49896.02 49786.57 50313.59 49330.65 49976.18
##  [8] 51929.56 51681.43 51753.72</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 5491.368 5908.727 6409.308 7142.058 6252.598 6473.486 7214.881
##  [8] 5687.092 5375.700 6721.324</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     7.906798      9.105480       43444.60        50027.00 5491.368
##  [2,]     7.938824      8.987173       44232.96        50427.37 5908.727
##  [3,]     8.031540      8.961871       43933.24        49896.02 6409.308
##  [4,]     7.862784      8.648754       44173.12        49786.57 7142.058
##  [5,]     7.846031      8.798830       44356.12        50313.59 6252.598
##  [6,]     7.837817      8.754924       43393.77        49330.65 6473.486
##  [7,]     7.992078      8.761442       44425.31        49976.18 7214.881
##  [8,]     8.404779      9.483681       45793.74        51929.56 5687.092
##  [9,]     8.308315      9.500938       45270.24        51681.43 5375.700
## [10,]     8.169775      9.006516       46129.71        51753.72 6721.324</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
