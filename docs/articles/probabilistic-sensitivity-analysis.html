<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model-simple.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7103658 0.2011678 0.07755131 0.010915095
## [2,] 0.0000000 0.5895960 0.40112311 0.009280893
## [3,] 0.0000000 0.0000000 0.75214582 0.247854178
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7239939 0.1972487 0.06735438 0.01140308
## [2,] 0.0000000 0.5764048 0.41148620 0.01210899
## [3,] 0.0000000 0.0000000 0.75218620 0.24781380
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7204047 0.2091013 0.06004409 0.01044993
## [2,] 0.0000000 0.5752877 0.41424429 0.01046804
## [3,] 0.0000000 0.0000000 0.74534986 0.25465014
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7142128 0.1993866 0.07497996 0.01142073
## [2,] 0.0000000 0.5675945 0.41936688 0.01303859
## [3,] 0.0000000 0.0000000 0.75629184 0.24370816
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7188977 0.1870556 0.08325644 0.01079027
## [2,] 0.0000000 0.5717572 0.41452227 0.01372048
## [3,] 0.0000000 0.0000000 0.74571465 0.25428535
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7093599 0.2202447 0.06283952 0.007555929
## [2,] 0.0000000 0.5788406 0.41366204 0.007497336
## [3,] 0.0000000 0.0000000 0.73066948 0.269330519
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7345807 0.1897671 0.06764095 0.00801122
## [2,] 0.0000000 0.5780695 0.41189743 0.01003303
## [3,] 0.0000000 0.0000000 0.77782965 0.22217035
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7288784 0.1974501 0.06274075 0.01093071
## [2,] 0.0000000 0.5804462 0.39984312 0.01971068
## [3,] 0.0000000 0.0000000 0.75950061 0.24049939
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7185221 0.2000401 0.07343013 0.008007655
## [2,] 0.0000000 0.5873337 0.40463142 0.008034889
## [3,] 0.0000000 0.0000000 0.74997847 0.250021534
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.6982956 0.2189755 0.07374688 0.008982005
## [2,] 0.0000000 0.5727821 0.41384119 0.013376726
## [3,] 0.0000000 0.0000000 0.75000366 0.249996337
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.4614569 0.4735277 0.4637842 0.7769649 0.6597586 0.5540158 0.5466557
##  [8] 0.4886380 0.3705794 0.3746126</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8663463 0.09283024 0.03578658 0.005036846
## [2,] 0.0000000 0.81061625 0.18510101 0.004282732
## [3,] 0.0000000 0.00000000 0.88562599 0.114374012
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8693035 0.09340271 0.03189416 0.005399674
## [2,] 0.0000000 0.79941595 0.19485011 0.005733940
## [3,] 0.0000000 0.00000000 0.88265331 0.117346694
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]       [,2]      [,3]        [,4]
## [1,] 0.8703281 0.09697788 0.0278475 0.004846514
## [2,] 0.0000000 0.80302514 0.1921199 0.004854913
## [3,] 0.0000000 0.00000000 0.8818973 0.118102706
## [4,] 0.0000000 0.00000000 0.0000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7779534 0.1549163 0.05825679 0.008873509
## [2,] 0.0000000 0.6640361 0.32583334 0.010130523
## [3,] 0.0000000 0.0000000 0.81064732 0.189352676
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8145403 0.1234116 0.05492916 0.007118973
## [2,] 0.0000000 0.7174631 0.27348465 0.009052204
## [3,] 0.0000000 0.0000000 0.83223304 0.167766959
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]     [,2]       [,3]        [,4]
## [1,] 0.8389808 0.122019 0.03481409 0.004186104
## [2,] 0.0000000 0.766671 0.22917532 0.004153643
## [3,] 0.0000000 0.000000 0.85078663 0.149213371
## [4,] 0.0000000 0.000000 0.00000000 1.000000000
## 
## , , 7
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.854907 0.1037373 0.03697631 0.004379379
## [2,] 0.000000 0.7693493 0.22516610 0.005484613
## [3,] 0.000000 0.0000000 0.87854930 0.121450697
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8675197 0.09648162 0.03065751 0.005341161
## [2,] 0.0000000 0.79499009 0.19537853 0.009631386
## [3,] 0.0000000 0.00000000 0.88248287 0.117517128
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]       [,2]      [,3]        [,4]
## [1,] 0.8956901 0.07413075 0.0272117 0.002967472
## [2,] 0.0000000 0.84707437 0.1499481 0.002977564
## [3,] 0.0000000 0.00000000 0.9073472 0.092652829
## [4,] 0.0000000 0.00000000 0.0000000 1.000000000
## 
## , , 10
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8869777 0.08203099 0.02762651 0.003364773
## [2,] 0.0000000 0.83995878 0.15503013 0.005011090
## [3,] 0.0000000 0.00000000 0.90634822 0.093651784
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.710365841 0.201167756 0.07755131 0.01091510 0.98908490 5210.7286
##  [2,] 0.504619629 0.261510405 0.19411273 0.03975724 0.96024276 5450.9325
##  [3,] 0.358464547 0.255698686 0.29003286 0.09580391 0.90419609 5407.4885
##  [4,] 0.254640969 0.222870430 0.34851305 0.17397555 0.82602445 5071.5633
##  [5,] 0.180888247 0.182629066 0.37127885 0.26520383 0.73479617 4538.7611
##  [6,] 0.128496831 0.144066249 0.36654070 0.36089622 0.63910378 3913.3332
##  [7,] 0.091279760 0.110790303 0.34344545 0.45448448 0.54551552 3275.9360
##  [8,] 0.064842023 0.083684063 0.30984048 0.54163343 0.45836657 2678.4238
##  [9,] 0.046061558 0.062383913 0.27164142 0.61991311 0.38008689 2148.5047
## [10,] 0.032720558 0.046047406 0.23290972 0.68832232 0.31167768 1696.7016
## [11,] 0.023243567 0.033731687 0.19619027 0.74683447 0.25316553 1322.6609
## [12,] 0.016511436 0.024563924 0.16289682 0.79602782 0.20397218 1019.9476
## [13,] 0.011729160 0.017804360 0.13365581 0.83681067 0.16318933  779.3265
## [14,] 0.008331995 0.012856908 0.10858001 0.87023109 0.12976891  590.8238
## [15,] 0.005918764 0.009256510 0.08747136 0.89735337 0.10264663  444.9074
## [16,] 0.004204488 0.006648266 0.06996323 0.91918402 0.08081598  333.0782
## [17,] 0.002986725 0.004765598 0.05561538 0.93663229 0.06336771  248.0920
## [18,] 0.002121667 0.003410610 0.04397410 0.95049363 0.04950637  183.9679
## [19,] 0.001507160 0.002437693 0.03460754 0.96144760 0.03855240  135.8825
## [20,] 0.001070635 0.001740446 0.02712462 0.97006430 0.02993570  100.0168
## 
## , , 2
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.723993871 0.197248672 0.06735438 0.01140308 0.98859692 5147.1837
##  [2,] 0.524167125 0.256501914 0.18059229 0.03873867 0.96126133 5378.9574
##  [3,] 0.379493786 0.251240208 0.27669098 0.09257503 0.90742497 5350.0035
##  [4,] 0.274751175 0.219670711 0.33706558 0.16851253 0.83148747 5035.9156
##  [5,] 0.198918167 0.180813560 0.36243324 0.25783503 0.74216497 4524.7599
##  [6,] 0.144015533 0.143458151 0.36041758 0.35210874 0.64789126 3917.4083
##  [7,] 0.104266364 0.111096841 0.33983225 0.44480454 0.55519546 3293.3828
##  [8,] 0.075488208 0.084603156 0.30835475 0.53155389 0.46844611 2704.6027
##  [9,] 0.054653000 0.063655615 0.27183768 0.60985371 0.39014629 2179.4269
## [10,] 0.039568437 0.047471635 0.23434708 0.67861285 0.32138715 1729.2470
## [11,] 0.028647306 0.035167701 0.19847167 0.73771333 0.26228667 1354.5852
## [12,] 0.020740474 0.025921475 0.16568820 0.78764986 0.21235014 1049.7783
## [13,] 0.015015976 0.019032294 0.13669167 0.82926006 0.17073994  806.2146
## [14,] 0.010871475 0.013932187 0.11166050 0.86353584 0.13646416  614.3889
## [15,] 0.007870881 0.010174964 0.09045463 0.89149952 0.10850048  465.0983
## [16,] 0.005698470 0.007417419 0.07275572 0.91412839 0.08587161  350.0575
## [17,] 0.004125657 0.005399452 0.05816183 0.93231306 0.06768694  262.1476
## [18,] 0.002986950 0.003926050 0.04624821 0.94683879 0.05316121  195.4474
## [19,] 0.002162534 0.002852166 0.03660396 0.95838134 0.04161866  145.1494
## [20,] 0.001565661 0.002070559 0.02885228 0.96751150 0.03248850  107.4216
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.720404657 0.209101318 0.06004409 0.01044993 0.98955007 5111.91003
##  [2,] 0.518982870 0.270930974 0.17462892 0.03545723 0.96454277 5364.28378
##  [3,] 0.373877677 0.264383251 0.27355310 0.08818597 0.91181403 5355.35185
##  [4,] 0.269343220 0.230274739 0.33586116 0.16452088 0.83547912 5048.35460
##  [5,] 0.194036110 0.188794241 0.36189653 0.25527312 0.74472688 4533.65529
##  [6,] 0.139784517 0.149184205 0.35959719 0.35143409 0.64856591 3917.38207
##  [7,] 0.100701417 0.115052960 0.33821765 0.44602797 0.55397203 3283.35332
##  [8,] 0.072545770 0.087245349 0.30579703 0.53441185 0.46558815 2686.03559
##  [9,] 0.052262311 0.065360589 0.26842261 0.61395449 0.38604551 2154.87120
## [10,] 0.037650012 0.048529259 0.23028205 0.68353868 0.31646132 1701.38645
## [11,] 0.027123244 0.035790952 0.19400432 0.74308148 0.25691852 1325.73610
## [12,] 0.019539711 0.026261599 0.16105588 0.79314281 0.20685719 1021.69587
## [13,] 0.014076499 0.019193754 0.13209494 0.83463481 0.16536519  780.08024
## [14,] 0.010140775 0.013985344 0.10725306 0.86862082 0.13137918  590.88812
## [15,] 0.007305462 0.010166046 0.08634329 0.89618520 0.10381480  444.53116
## [16,] 0.005262889 0.007375982 0.06900584 0.91835529 0.08164471  332.44934
## [17,] 0.003791410 0.005343789 0.05480496 0.93605985 0.06394015  247.34440
## [18,] 0.002731349 0.003867004 0.04329015 0.95011150 0.04988850  183.19130
## [19,] 0.001967677 0.002795769 0.03403219 0.96120436 0.03879564  135.13356
## [20,] 0.001417523 0.002019815 0.02664217 0.96992049 0.03007951   99.32799
## 
## , , 4
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.714212760 0.199386551 0.07497996 0.01142073 0.98857927 5192.6662
##  [2,] 0.510099866 0.255575136 0.19387449 0.04045051 0.95954949 5444.9375
##  [3,] 0.364319833 0.246770103 0.29205271 0.09685736 0.90314264 5411.4180
##  [4,] 0.260201873 0.212705837 0.35168097 0.17541132 0.82458868 5079.1407
##  [5,] 0.185839498 0.172611424 0.37468516 0.26686392 0.73313608 4546.2118
##  [6,] 0.132728941 0.135027197 0.36969308 0.36255078 0.63744922 3919.4670
##  [7,] 0.094796703 0.103105065 0.34617381 0.45592442 0.54407558 3280.9449
##  [8,] 0.067705015 0.077423059 0.31215513 0.54271680 0.45728320 2682.9173
##  [9,] 0.048355785 0.057444374 0.27362557 0.62057427 0.37942573 2153.0106
## [10,] 0.034536319 0.042246606 0.23465677 0.68856031 0.31143969 1701.5025
## [11,] 0.024666280 0.030865020 0.19777536 0.74669334 0.25330666 1327.8077
## [12,] 0.017616972 0.022436941 0.16436913 0.79557695 0.20442305 1025.3365
## [13,] 0.012582266 0.016247672 0.13504127 0.83612880 0.16387120  784.7802
## [14,] 0.008986415 0.011730825 0.10988776 0.86939500 0.13060500  596.1537
## [15,] 0.006418212 0.008450122 0.08870054 0.89643113 0.10356887  449.9511
## [16,] 0.004583969 0.006075948 0.07110843 0.91823165 0.08176835  337.7167
## [17,] 0.003273929 0.004362657 0.05667048 0.93569293 0.06430707  252.2531
## [18,] 0.002338282 0.003128998 0.04493446 0.94959826 0.05040174  187.6210
## [19,] 0.001670031 0.002242224 0.03547109 0.96061666 0.03938334  139.0300
## [20,] 0.001192757 0.001605656 0.02789203 0.96930956 0.03069044  102.6848
## 
## , , 5
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.718897682 0.187055610 0.08325644 0.01079027 0.98920973 5241.02476
##  [2,] 0.516813878 0.241424246 0.19947712 0.04228475 0.95771525 5464.16130
##  [3,] 0.371536299 0.234708998 0.29185682 0.10189788 0.89810212 5386.08797
##  [4,] 0.267096584 0.203694520 0.34586681 0.18334209 0.81665791 5016.61662
##  [5,] 0.192015115 0.166425733 0.36459137 0.27696778 0.72303222 4459.68674
##  [6,] 0.138039221 0.131072624 0.35685479 0.37403336 0.62596664 3821.31818
##  [7,] 0.099236076 0.100762734 0.33193702 0.46806417 0.53193583 3180.65499
##  [8,] 0.071340585 0.076174488 0.29756074 0.55492419 0.44507581 2586.89116
##  [9,] 0.051286581 0.056897973 0.25941099 0.63240446 0.36759554 2065.07210
## [10,] 0.036869804 0.042125271 0.22130199 0.69970293 0.30029707 1623.54579
## [11,] 0.026505617 0.030982133 0.18555965 0.75695260 0.24304740 1260.39429
## [12,] 0.019054827 0.022672283 0.15342410 0.80484879 0.19515121  968.17394
## [13,] 0.013698471 0.016527355 0.12539520 0.84437898 0.15562102  737.07764
## [14,] 0.009847799 0.012012011 0.10150048 0.87663971 0.12336029  556.87051
## [15,] 0.007079560 0.008710040 0.08148953 0.90272087 0.09727913  417.96289
## [16,] 0.005089479 0.006304300 0.06496786 0.92363836 0.07636164  311.91929
## [17,] 0.003658815 0.004556545 0.05148449 0.94030015 0.05969985  231.62272
## [18,] 0.002630313 0.003289639 0.04058615 0.95349390 0.04650610  171.24436
## [19,] 0.001890926 0.002372890 0.03184831 0.96388788 0.03611212  126.11535
## [20,] 0.001359382 0.001710425 0.02489080 0.97203940 0.02796060   92.55996
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.709359888 0.220244659 0.06283952 0.007555929 0.99244407 5145.25069
##  [2,] 0.503191451 0.283719283 0.18159761 0.031491652 0.96850835 5424.18888
##  [3,] 0.356943831 0.275053476 0.28167204 0.086330649 0.91366935 5408.45739
##  [4,] 0.253201636 0.237827098 0.34201853 0.166952737 0.83304726 5070.91596
##  [5,] 0.179611084 0.193430294 0.36419361 0.262765008 0.73723499 4517.22841
##  [6,] 0.127408898 0.151523694 0.35740660 0.363660804 0.63633920 3864.82717
##  [7,] 0.090378762 0.115769199 0.33183201 0.462020027 0.53797997 3203.40772
##  [8,] 0.064111068 0.086917355 0.29602821 0.552943371 0.44705663 2589.13192
##  [9,] 0.045477820 0.064431416 0.25628189 0.633808868 0.36619113 2050.62985
## [10,] 0.032260142 0.047311768 0.21676799 0.703660095 0.29633990 1597.45360
## [11,] 0.022884050 0.034491097 0.17998405 0.762640799 0.23735920 1227.49706
## [12,] 0.016233027 0.025004938 0.14721454 0.811547499 0.18845250  932.46829
## [13,] 0.011515059 0.018049112 0.11892884 0.851506993 0.14849301  701.51469
## [14,] 0.008168321 0.012983689 0.09508751 0.883760485 0.11623951  523.41228
## [15,] 0.005794279 0.009314516 0.07536169 0.909529515 0.09047049  387.75251
## [16,] 0.004110229 0.006667779 0.05928166 0.929940333 0.07005967  285.48160
## [17,] 0.002915632 0.004764837 0.04633179 0.945987740 0.05401226  209.05148
## [18,] 0.002068232 0.003400234 0.03600747 0.958524059 0.04147594  152.35719
## [19,] 0.001467121 0.002423711 0.02784608 0.968263091 0.03173691  110.57209
## [20,] 0.001040717 0.001726068 0.02144107 0.975792147 0.02420785   79.94716
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.734580742 0.189767091 0.06764095 0.00801122 0.99198878 5162.8926
##  [2,] 0.539608867 0.249097825 0.18046545 0.03082786 0.96917214 5411.7435
##  [3,] 0.396386282 0.246395870 0.27947379 0.07774406 0.92225594 5426.0902
##  [4,] 0.291177729 0.217655018 0.34568477 0.14548248 0.85451752 5169.9498
##  [5,] 0.213893552 0.181075687 0.37823094 0.22679982 0.77320018 4715.3558
##  [6,] 0.157122085 0.145264296 0.38325182 0.31436180 0.68563820 4152.3642
##  [7,] 0.115418857 0.113789465 0.36856651 0.40222517 0.59777483 3555.9203
##  [8,] 0.084784470 0.087680924 0.34135859 0.48617602 0.51382398 2977.9350
##  [9,] 0.062281039 0.066774974 0.30736928 0.56357471 0.43642529 2449.3325
## [10,] 0.045750452 0.050419470 0.27079813 0.63303195 0.36696805 1985.0937
## [11,] 0.033607401 0.037827890 0.23449707 0.69406764 0.30593236 1589.3716
## [12,] 0.024687349 0.028244729 0.20025322 0.74681470 0.25318530 1259.6574
## [13,] 0.018134851 0.021012264 0.16906670 0.79178618 0.20821382  989.8148
## [14,] 0.013321513 0.015587948 0.14138665 0.82970389 0.17029611  772.1215
## [15,] 0.009785727 0.011538903 0.11729644 0.86137893 0.13862107  598.5476
## [16,] 0.007188406 0.008527297 0.09665141 0.88763288 0.11236712  461.4905
## [17,] 0.005280465 0.006293494 0.07917694 0.90924910 0.09075090  354.1472
## [18,] 0.003878928 0.004640135 0.06453562 0.92694532 0.07305468  270.6556
## [19,] 0.002849386 0.003418414 0.05237135 0.94136085 0.05863915  206.0995
## [20,] 0.002093104 0.002516800 0.04233676 0.95305333 0.04694667  156.4392
## 
## , , 8
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.728878429 0.197450113 0.06274075 0.01093071 0.98906929 5122.2759
##  [2,] 0.531263764 0.258526296 0.17233108 0.03787886 0.96212114 5337.3827
##  [3,] 0.387226697 0.254958696 0.26758741 0.09022720 0.90977280 5313.0713
##  [4,] 0.282241187 0.224447761 0.32947117 0.16383988 0.83616012 5018.0646
##  [5,] 0.205719513 0.186008404 0.35768547 0.25058661 0.74941339 4530.9980
##  [6,] 0.149944515 0.148587212 0.35894351 0.34252476 0.65747524 3945.9941
##  [7,] 0.109291322 0.115853444 0.34143702 0.43341821 0.56658179 3339.1109
##  [8,] 0.079660087 0.088826275 0.31250185 0.51901179 0.48098821 2761.2646
##  [9,] 0.058062519 0.067287767 0.27785986 0.59678986 0.40321014 2241.2703
## [10,] 0.042320518 0.050521380 0.24158217 0.66557593 0.33442407 1791.6516
## [11,] 0.030846513 0.037681134 0.20633765 0.72513470 0.27486530 1414.2360
## [12,] 0.022483358 0.027962518 0.17371545 0.77583868 0.22416132 1104.5643
## [13,] 0.016387634 0.020670079 0.14452823 0.81841405 0.18158595  855.0067
## [14,] 0.011944593 0.015233609 0.11906224 0.85375955 0.14624045  656.7911
## [15,] 0.008706156 0.011200752 0.09726831 0.88282478 0.11717522  501.2187
## [16,] 0.006345730 0.008220465 0.07890012 0.90653369 0.09346631  380.3203
## [17,] 0.004625265 0.006024503 0.06360972 0.92574051 0.07425949  287.1501
## [18,] 0.003371256 0.004410159 0.05101067 0.94120791 0.05879209  215.8582
## [19,] 0.002457236 0.003225515 0.04071752 0.95359973 0.04640027  161.6403
## [20,] 0.001791026 0.002357419 0.03236885 0.96348270 0.03651730  120.6259
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.718522072 0.200040138 0.07343013 0.008007655 0.99199234 5199.9180
##  [2,] 0.516273969 0.261223567 0.18877472 0.033727748 0.96627225 5448.1732
##  [3,] 0.370954242 0.256700917 0.28518630 0.087158538 0.91284146 5418.8415
##  [4,] 0.266538811 0.224974835 0.34499206 0.163494292 0.83650571 5096.4159
##  [5,] 0.191514019 0.185453760 0.36934049 0.253691736 0.74630826 4573.6366
##  [6,] 0.137607049 0.147233732 0.36610073 0.349058489 0.65094151 3954.0647
##  [7,] 0.098873702 0.114002264 0.34424756 0.442876471 0.55712353 3318.7654
##  [8,] 0.071042938 0.086736080 0.31156747 0.530653517 0.46934648 2720.4427
##  [9,] 0.051045919 0.065154461 0.27398173 0.609817894 0.39018211 2187.7291
## [10,] 0.036677619 0.048478643 0.23559225 0.679251493 0.32074851 1731.9646
## [11,] 0.026353679 0.035810136 0.19899834 0.738837849 0.26116215 1353.4376
## [12,] 0.018935700 0.026304293 0.16566953 0.789090480 0.21090952 1046.1726
## [13,] 0.013605718 0.019237298 0.13628257 0.830874412 0.16912559  801.2341
## [14,] 0.009776009 0.014020403 0.11099208 0.865211509 0.13478849  608.8214
## [15,] 0.007024278 0.010190249 0.08963262 0.893152854 0.10684715  459.4832
## [16,] 0.005047099 0.007390214 0.07186162 0.915701064 0.08429894  344.7378
## [17,] 0.003626452 0.005350144 0.05725559 0.933767812 0.06623219  257.3188
## [18,] 0.002605686 0.003867756 0.04537159 0.948154970 0.05184503  191.2003
## [19,] 0.001872243 0.002792905 0.03578407 0.959550787 0.04044921  141.5039
## [20,] 0.001345248 0.002014891 0.02810485 0.968535007 0.03146499  104.3531
## 
## , , 10
## 
##            State A     State B    State C       Death    Disc LY
##  [1,] 0.6982955921 0.218975518 0.07374688 0.008982005 0.99101799
##  [2,] 0.4876167340 0.278334893 0.19742865 0.036619727 0.96338027
##  [3,] 0.3405006160 0.266201368 0.29921886 0.094079151 0.90592085
##  [4,] 0.2377700792 0.227036674 0.35969119 0.175502052 0.82449795
##  [5,] 0.1660337983 0.182108367 0.38126164 0.270596192 0.72940381
##  [6,] 0.1159406695 0.140665748 0.37355605 0.369837537 0.63016246
##  [7,] 0.0809608584 0.105958989 0.34693195 0.466148207 0.53385179
##  [8,] 0.0565346106 0.078419857 0.31002103 0.555024498 0.44497550
##  [9,] 0.0394778694 0.057297185 0.26913953 0.634085416 0.36591458
## [10,] 0.0275672222 0.041463488 0.22847894 0.702490352 0.29750965
## [11,] 0.0192500697 0.029786090 0.19055234 0.760411504 0.23958850
## [12,] 0.0134422388 0.021276233 0.15666129 0.808620235 0.19137977
## [13,] 0.0093866561 0.015130166 0.12729285 0.848190329 0.15180967
## [14,] 0.0065546606 0.010721736 0.10242383 0.880299778 0.11970022
## [15,] 0.0045770906 0.007576529 0.08173873 0.906107655 0.09389235
## [16,] 0.0031961622 0.005341971 0.06477737 0.926684497 0.07331550
## [17,] 0.0022318660 0.003759666 0.05102970 0.942978769 0.05702123
## [18,] 0.0015585022 0.002642194 0.03999296 0.955806345 0.04419365
## [19,] 0.0010882952 0.001854675 0.03120325 0.965853781 0.03414622
## [20,] 0.0007599517 0.001300635 0.02425035 0.973689063 0.02631094
##        Disc cost
##  [1,] 5202.44633
##  [2,] 5487.86925
##  [3,] 5465.60104
##  [4,] 5121.80055
##  [5,] 4564.99224
##  [6,] 3911.80753
##  [7,] 3250.43032
##  [8,] 2635.86004
##  [9,] 2096.12861
## [10,] 1640.65242
## [11,] 1267.47598
## [12,]  968.58994
## [13,]  733.44990
## [14,]  551.10518
## [15,]  411.35888
## [16,]  305.30214
## [17,]  225.47182
## [18,]  165.79983
## [19,]  121.46107
## [20,]   88.68449</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7.864016 7.985170 7.945429 7.860995 7.716687 7.731318 8.569772
##  [8] 8.142680 7.999385 7.717993</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 44551.08 44611.18 44316.96 44615.55 43719.00 43481.55 47665.02
##  [8] 45098.50 44958.21 44216.29</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.866346329 0.092830242 0.03578658 0.005036846 0.99496315 6921.0493
##  [2,] 0.750555961 0.155672843 0.07988008 0.013891121 0.98610888 6735.0399
##  [3,] 0.533169317 0.242771743 0.18073204 0.043326904 0.95667310 5052.4164
##  [4,] 0.378745270 0.250393723 0.27466618 0.096194827 0.90380517 5022.5155
##  [5,] 0.269047703 0.223822473 0.33639992 0.170729905 0.82927010 4740.3316
##  [6,] 0.191122298 0.186088556 0.36366716 0.259121984 0.74087802 4270.6126
##  [7,] 0.135766752 0.148164712 0.36299694 0.353071596 0.64692840 3704.0943
##  [8,] 0.096444063 0.114669214 0.34298781 0.445898912 0.55410109 3116.5478
##  [9,] 0.068510568 0.087009945 0.31145268 0.533026803 0.46697320 2559.0072
## [10,] 0.048667567 0.065082832 0.27447262 0.611776981 0.38822302 2060.0901
## [11,] 0.034571777 0.048162923 0.23632390 0.680941404 0.31905860 1631.8075
## [12,] 0.024558610 0.035351393 0.19975038 0.740339618 0.25966038 1275.3397
## [13,] 0.017445597 0.025783440 0.16632623 0.790444736 0.20955526  985.6114
## [14,] 0.012392756 0.018711305 0.13679684 0.832099100 0.16790090  754.5074
## [15,] 0.008803391 0.013525133 0.11135778 0.866313694 0.13368631  572.9374
## [16,] 0.006253628 0.009745323 0.08986525 0.894135800 0.10586420  432.0475
## [17,] 0.004442364 0.007003832 0.07198582 0.916567982 0.08343202  323.8496
## [18,] 0.003155704 0.005023092 0.05729775 0.934523459 0.06547654  241.4793
## [19,] 0.002241704 0.003596420 0.04535587 0.948806009 0.05119399  179.2354
## [20,] 0.001592430 0.002571394 0.03573068 0.960105496 0.03989450  132.4991
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.869303456 0.093402707 0.03189416 0.005399674 0.99460033 6895.8175
##  [2,] 0.755688499 0.155862911 0.07407672 0.014371870 0.98562813 6699.7570
##  [3,] 0.547113842 0.238898685 0.17075385 0.043233622 0.95676638 4999.4780
##  [4,] 0.396107068 0.245619831 0.26359271 0.094680386 0.90531961 4972.6060
##  [5,] 0.286779089 0.219708047 0.32601952 0.167493346 0.83250665 4703.1085
##  [6,] 0.207626303 0.183207571 0.35495004 0.254216087 0.74578391 4249.0075
##  [7,] 0.150320171 0.146555738 0.35636045 0.346763642 0.65323636 3697.3062
##  [8,] 0.108830882 0.114125887 0.33847980 0.438563432 0.56143657 3121.9350
##  [9,] 0.078792892 0.087249458 0.30889130 0.525066352 0.47493365 2573.2912
## [10,] 0.057045571 0.065832801 0.27355277 0.603568862 0.39643114 2080.0759
## [11,] 0.041300644 0.049198506 0.23669417 0.672806675 0.32719332 1654.7604
## [12,] 0.029901413 0.036504753 0.20106438 0.732529456 0.26747054 1299.1304
## [13,] 0.021648440 0.026939529 0.16827304 0.783138987 0.21686101 1008.7199
## [14,] 0.015673338 0.019798200 0.13911602 0.825412438 0.17458756  775.9500
## [15,] 0.011347400 0.014503323 0.11384351 0.860305769 0.13969423  592.1615
## [16,] 0.008215448 0.010598045 0.09236373 0.888822776 0.11117722  448.8232
## [17,] 0.005947934 0.007729250 0.07438902 0.911933796 0.08806620  338.1715
## [18,] 0.004306268 0.005628399 0.05953549 0.930529840 0.06947016  253.4861
## [19,] 0.003117712 0.004093642 0.04738783 0.945400815 0.05459918  189.1478
## [20,] 0.002257204 0.002974559 0.03753894 0.957229295 0.04277071  140.5753
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.870328105 0.096977883 0.02784750 0.004846514 0.99515349 6876.6681
##  [2,] 0.757471010 0.162278255 0.06742648 0.012824256 0.98717574 6674.2575
##  [3,] 0.545685643 0.251744866 0.16296081 0.039608676 0.96039132 4977.0905
##  [4,] 0.393114479 0.258929304 0.25851189 0.089444326 0.91055567 4971.4477
##  [5,] 0.283201501 0.231159592 0.32354599 0.162092920 0.83790708 4714.4021
##  [6,] 0.204019681 0.192201070 0.35391607 0.249863177 0.75013682 4261.7753
##  [7,] 0.146976728 0.153231690 0.35565967 0.344131917 0.65586808 3704.5178
##  [8,] 0.105882719 0.118885329 0.33739132 0.437840634 0.56215937 3120.8328
##  [9,] 0.076278404 0.090533480 0.30707977 0.526108345 0.47389165 2564.0592
## [10,] 0.054951318 0.068032710 0.27096491 0.606051065 0.39394893 2064.4292
## [11,] 0.039587185 0.050628772 0.23344532 0.676338725 0.32366128 1634.9186
## [12,] 0.028518793 0.037403841 0.19734809 0.736729276 0.26327072 1277.2109
## [13,] 0.020545071 0.027481286 0.16430008 0.787673560 0.21232644  986.4493
## [14,] 0.014800765 0.020105646 0.13507862 0.830014969 0.16998503  754.5798
## [15,] 0.010662540 0.014661390 0.10989818 0.864777893 0.13522211  572.4966
## [16,] 0.007681343 0.010664068 0.08862621 0.893028378 0.10697162  431.3002
## [17,] 0.005533676 0.007741086 0.07093628 0.915788957 0.08421104  322.9505
## [18,] 0.003986486 0.005610450 0.05641131 0.933991752 0.06600825  240.5367
## [19,] 0.002871883 0.004061202 0.04460963 0.948457289 0.05154271  178.3193
## [20,] 0.002068918 0.002936874 0.03510455 0.959889661 0.04011034  131.6512
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.777953352 0.154916347 0.05825679 0.008873509 0.99112649 7045.1228
##  [2,] 0.605211419 0.223387745 0.14302369 0.028377147 0.97162285 7012.3622
##  [3,] 0.432249717 0.247464680 0.24722780 0.073057805 0.92694219 5276.9211
##  [4,] 0.308718264 0.226644380 0.32316492 0.141472434 0.85852757 5076.5429
##  [5,] 0.220490523 0.190196381 0.36260182 0.226711272 0.77328873 4644.7009
##  [6,] 0.157477145 0.151917271 0.37052724 0.320078348 0.67992165 4077.3923
##  [7,] 0.112472186 0.117626238 0.35574343 0.414158148 0.58584185 3463.4162
##  [8,] 0.080329070 0.089189451 0.32680756 0.503673917 0.49632608 2865.8815
##  [9,] 0.057372047 0.066639981 0.29058807 0.585399906 0.41460009 2322.1883
## [10,] 0.040975848 0.049263704 0.25201774 0.657742710 0.34225729 1849.8883
## [11,] 0.029265474 0.036131842 0.21433089 0.720271791 0.27972821 1453.2115
## [12,] 0.020901775 0.026343378 0.17944353 0.773311319 0.22668868 1128.4435
## [13,] 0.014928314 0.019119890 0.14832643 0.817625364 0.18237464  867.7844
## [14,] 0.010661992 0.013828850 0.12131564 0.854193514 0.14580649  661.8712
## [15,] 0.007614931 0.009975038 0.09834883 0.884061202 0.11593880  501.2885
## [16,] 0.005438681 0.007180092 0.07913459 0.908246642 0.09175336  377.3816
## [17,] 0.003884375 0.005159781 0.06326773 0.927688118 0.07231188  282.6202
## [18,] 0.002774270 0.003703155 0.05030396 0.943218617 0.05678138  210.6910
## [19,] 0.001981419 0.002655043 0.03980547 0.955558070 0.04444193  156.4419
## [20,] 0.001415155 0.001902056 0.03136655 0.965316234 0.03468377  115.7523
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.814540315 0.123411556 0.05492916 0.007118973 0.99288103 7028.4885
##  [2,] 0.663475925 0.189066931 0.12420704 0.023250107 0.97674989 6931.1303
##  [3,] 0.476971304 0.232207282 0.22623410 0.064587309 0.93541269 5198.7465
##  [4,] 0.342893565 0.221986356 0.30467211 0.130447971 0.86955203 5027.8448
##  [5,] 0.246505389 0.191062473 0.34776484 0.214667297 0.78533270 4620.8931
##  [6,] 0.177212153 0.155351570 0.35905615 0.308380129 0.69161987 4069.0735
##  [7,] 0.127397406 0.121971914 0.34690417 0.403726512 0.59627349 3462.4485
##  [8,] 0.091585700 0.093568726 0.31985825 0.494987325 0.50501268 2866.8755
##  [9,] 0.065840747 0.070630216 0.28493440 0.578594634 0.42140537 2322.2462
## [10,] 0.047332761 0.052699219 0.24723922 0.652728798 0.34727120 1847.8705
## [11,] 0.034027412 0.038985019 0.21015567 0.716831902 0.28316810 1449.0296
## [12,] 0.024462228 0.028654986 0.17570932 0.771173467 0.22882653 1122.5313
## [13,] 0.017585839 0.020959493 0.14494378 0.816510887 0.18348911  860.7565
## [14,] 0.012642419 0.015273272 0.11823901 0.853845297 0.14615470  654.3293
## [15,] 0.009088606 0.011097439 0.09555624 0.884257718 0.11574228  493.7304
## [16,] 0.006533777 0.008045116 0.07661451 0.908806600 0.09119340  370.1717
## [17,] 0.004697117 0.005822033 0.06101142 0.928469431 0.07153057  275.9945
## [18,] 0.003376747 0.004207412 0.04830154 0.944114305 0.05588570  204.7784
## [19,] 0.002427535 0.003037258 0.03804437 0.956490842 0.04350916  151.2888
## [20,] 0.001745150 0.002190658 0.02983136 0.966232833 0.03376717  111.3480
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.838980777 0.122019028 0.03481409 0.004186104 0.99581390 6929.1804
##  [2,] 0.703888744 0.195920074 0.08679147 0.013399717 0.98660028 6787.2076
##  [3,] 0.499310440 0.268434234 0.18869261 0.043562719 0.95643728 5099.5782
##  [4,] 0.354190798 0.265351098 0.28028941 0.100168693 0.89983131 5038.0197
##  [5,] 0.251248745 0.231604627 0.33682178 0.180324852 0.81967515 4707.9302
##  [6,] 0.178225781 0.189398361 0.35769979 0.274676072 0.72532393 4189.8089
##  [7,] 0.126426220 0.148884742 0.35090685 0.373782185 0.62621781 3584.6373
##  [8,] 0.089681689 0.114025237 0.32592946 0.470363616 0.52963638 2972.2570
##  [9,] 0.063616593 0.085754352 0.29095017 0.559678880 0.44032112 2403.5158
## [10,] 0.045127059 0.063649318 0.25205937 0.639164253 0.36083575 1904.6346
## [11,] 0.032011326 0.046781805 0.21333716 0.707869711 0.29213029 1484.4882
## [12,] 0.022707550 0.034129532 0.17724238 0.765920533 0.23407947 1141.2407
## [13,] 0.016107825 0.024756777 0.14505062 0.814084774 0.18591523  867.3225
## [14,] 0.011426245 0.017877891 0.11723721 0.853458653 0.14654135  652.7614
## [15,] 0.008105320 0.012865019 0.09377508 0.885254584 0.11474542  487.2089
## [16,] 0.005749589 0.009231949 0.07434969 0.910668771 0.08933123  361.0469
## [17,] 0.004078528 0.006610143 0.05850526 0.930806070 0.06919393  265.8951
## [18,] 0.002893144 0.004724493 0.04573866 0.946643698 0.05335630  194.7584
## [19,] 0.002052280 0.003371928 0.03555599 0.959019797 0.04098020  141.9728
## [20,] 0.001455805 0.002403813 0.02750348 0.968636899 0.03136310  103.0570
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.854907037 0.103737271 0.03697631 0.004379379 0.99562062 6935.5279
##  [2,] 0.730866042 0.168495919 0.08745494 0.013183099 0.98681690 6785.0470
##  [3,] 0.536880120 0.236096681 0.18686455 0.040158647 0.95984135 5096.3348
##  [4,] 0.394381797 0.238362478 0.27891149 0.088344239 0.91165576 5072.0182
##  [5,] 0.289705273 0.212630774 0.34180288 0.155861077 0.84413892 4819.0260
##  [6,] 0.212811915 0.177891900 0.37304242 0.236253764 0.76374624 4391.3703
##  [7,] 0.156327534 0.143218587 0.37783147 0.322622406 0.67737759 3866.7325
##  [8,] 0.114835196 0.112456124 0.36345403 0.409254646 0.59074535 3312.1415
##  [9,] 0.084355724 0.086799401 0.33679328 0.492051600 0.50794840 2774.8198
## [10,] 0.061966090 0.066184030 0.30342615 0.568423732 0.43157627 2283.1993
## [11,] 0.045519096 0.050018096 0.26746633 0.636996475 0.36300353 1851.1825
## [12,] 0.033437452 0.037551964 0.23172453 0.697286059 0.30271394 1482.7018
## [13,] 0.024562508 0.028052975 0.19797151 0.749413012 0.25058699 1175.5100
## [14,] 0.018043145 0.020877726 0.16720449 0.793874642 0.20612536  923.9712
## [15,] 0.013254147 0.015492772 0.13987655 0.831376535 0.16862347  720.9525
## [16,] 0.009736241 0.011471101 0.11607808 0.862714577 0.13728542  559.0149
## [17,] 0.007152055 0.008478712 0.09567246 0.888696773 0.11130323  431.1016
## [18,] 0.005253762 0.006258510 0.07839301 0.910094721 0.08990528  330.8893
## [19,] 0.003859312 0.004614845 0.06390964 0.927616203 0.07238380  252.9235
## [20,] 0.002834977 0.003400072 0.05187270 0.941892248 0.05810775  192.6258
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.867519710 0.096481619 0.03065751 0.005341161 0.99465884 6889.7776
##  [2,] 0.752590447 0.160401638 0.07250116 0.014506758 0.98549324 6691.3323
##  [3,] 0.548546942 0.241703590 0.16641825 0.043331218 0.95666878 4977.0074
##  [4,] 0.399824033 0.248606586 0.25745453 0.094114856 0.90588514 4945.1687
##  [5,] 0.291423113 0.223248048 0.32002576 0.165303077 0.83469692 4684.1331
##  [6,] 0.212412021 0.187125008 0.35060806 0.249854909 0.75014509 4246.1679
##  [7,] 0.154822540 0.150556777 0.35443457 0.340186109 0.65981389 3712.1084
##  [8,] 0.112846810 0.117959837 0.33910605 0.430087303 0.56991270 3151.8742
##  [9,] 0.082251605 0.090750954 0.31179678 0.515200664 0.48479934 2614.0508
## [10,] 0.059951421 0.068916635 0.27825651 0.592875429 0.40712457 2127.0630
## [11,] 0.043697297 0.051839814 0.24265323 0.661809655 0.33819034 1703.9575
## [12,] 0.031850017 0.038718259 0.20776467 0.721667050 0.27833295 1347.4458
## [13,] 0.023214791 0.028762656 0.17527692 0.772745633 0.22725437 1054.0290
## [14,] 0.016920760 0.021278937 0.14607999 0.815720310 0.18427969  816.9779
## [15,] 0.012333177 0.015692284 0.12051770 0.851456837 0.14854316  628.3041
## [16,] 0.008989387 0.011543714 0.09858151 0.880885386 0.11911461  479.9623
## [17,] 0.006552170 0.008475460 0.08005240 0.904919974 0.09508003  364.5124
## [18,] 0.004775735 0.006213275 0.06459979 0.924411203 0.07558880  275.4285
## [19,] 0.003480931 0.004549442 0.05184755 0.940122082 0.05987792  207.1890
## [20,] 0.002537175 0.003328016 0.04141570 0.952719107 0.04728089  155.2434
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.895690079 0.074130754 0.02721170 0.002967472 0.99703253 6879.1619
##  [2,] 0.802260718 0.129192442 0.06017946 0.008367377 0.99163262 6653.4698
##  [3,] 0.576442033 0.236363418 0.15631874 0.030875813 0.96912419 4975.3178
##  [4,] 0.414186324 0.254135742 0.25520397 0.076473966 0.92352603 5005.6630
##  [5,] 0.297602016 0.232116373 0.32464254 0.145639067 0.85436093 4781.6303
##  [6,] 0.213833617 0.195862114 0.35924945 0.231054817 0.76894518 4352.7884
##  [7,] 0.153644174 0.157811725 0.36438315 0.324160952 0.67583905 3808.5461
##  [8,] 0.110396730 0.123423144 0.34841721 0.417762915 0.58223708 3228.3320
##  [9,] 0.079322487 0.094574348 0.31935273 0.506750431 0.49324957 2667.8558
## [10,] 0.056994958 0.071414382 0.28360009 0.587990573 0.41200943 2159.8589
## [11,] 0.040952135 0.053345352 0.24577561 0.659926904 0.34007310 1719.4669
## [12,] 0.029425013 0.039523593 0.20891874 0.722132653 0.27786735 1349.9846
## [13,] 0.021142521 0.029099722 0.17483773 0.774920030 0.22507997 1047.6568
## [14,] 0.015191368 0.021320600 0.14445169 0.819036342 0.18096366  805.0981
## [15,] 0.010915333 0.015561190 0.11807815 0.855445331 0.14455467  613.5469
## [16,] 0.007842908 0.011323116 0.09565413 0.885179848 0.11482015  464.2232
## [17,] 0.005635303 0.008219344 0.07689613 0.909249223 0.09075078  349.0640
## [18,] 0.004049089 0.005954784 0.06141005 0.928586079 0.07141392  261.0532
## [19,] 0.002909360 0.004307426 0.04876303 0.944020183 0.05597982  194.3070
## [20,] 0.002090439 0.003111885 0.03852778 0.956269898 0.04373010  144.0212
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.886977720 0.082030994 0.02762651 0.003364773 0.99663523 6881.1453
##  [2,] 0.786729475 0.141662317 0.06226062 0.009347588 0.99065241 6662.1209
##  [3,] 0.549369725 0.253416132 0.16334024 0.033873901 0.96612610 5003.7361
##  [4,] 0.383622457 0.265450741 0.26789412 0.083032684 0.91696732 5044.9974
##  [5,] 0.267881871 0.236049356 0.33906698 0.157001792 0.84299821 4807.1352
##  [6,] 0.187060730 0.193864415 0.37174388 0.247330979 0.75266902 4349.6705
##  [7,] 0.130623683 0.152003784 0.37283349 0.344539038 0.65546096 3774.3094
##  [8,] 0.091213942 0.115668434 0.35216500 0.440952622 0.55904738 3168.3483
##  [9,] 0.063694294 0.086226427 0.31872015 0.531359132 0.46864087 2590.7282
## [10,] 0.044477445 0.063336444 0.27942258 0.612763531 0.38723647 2074.3062
## [11,] 0.031058403 0.046017452 0.23905926 0.683864883 0.31613512 1632.7278
## [12,] 0.021687946 0.033159002 0.20062970 0.744523352 0.25547665 1267.2822
## [13,] 0.015144597 0.023742012 0.16579499 0.795318402 0.20468160  972.2686
## [14,] 0.010575406 0.016915295 0.13528914 0.837220162 0.16277984  738.7015
## [15,] 0.007384759 0.012004533 0.10924750 0.871363210 0.12863679  556.6387
## [16,] 0.005156745 0.008493063 0.08744860 0.898901596 0.10109840  416.5110
## [17,] 0.003600932 0.005993875 0.06948184 0.920923352 0.07907665  309.7837
## [18,] 0.002514515 0.004221700 0.05485771 0.938406080 0.06159392  229.2050
## [19,] 0.001755875 0.002968732 0.04307603 0.952199363 0.04780064  168.8179
## [20,] 0.001226120 0.002084930 0.03366525 0.963023696 0.03697630  123.8480</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.903647 8.998533 8.980498 8.290964 8.374778 8.598329 9.429506
##  [8] 9.122741 9.213190 8.930690</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50711.02 50693.31 50459.89 49389.90 49069.58 49316.52 53257.09
##  [8] 51071.73 51461.05 50772.28</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1]  5925.122  6001.931  5934.806 11103.953  8130.459  6729.989  6504.416
##  [8]  6094.759  5357.395  5406.127</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi      ICER
##  [1,]     7.864016      8.903647       44551.08        50711.02  5925.122
##  [2,]     7.985170      8.998533       44611.18        50693.31  6001.931
##  [3,]     7.945429      8.980498       44316.96        50459.89  5934.806
##  [4,]     7.860995      8.290964       44615.55        49389.90 11103.953
##  [5,]     7.716687      8.374778       43719.00        49069.58  8130.459
##  [6,]     7.731318      8.598329       43481.55        49316.52  6729.989
##  [7,]     8.569772      9.429506       47665.02        53257.09  6504.416
##  [8,]     8.142680      9.122741       45098.50        51071.73  6094.759
##  [9,]     7.999385      9.213190       44958.21        51461.05  5357.395
## [10,]     7.717993      8.930690       44216.29        50772.28  5406.127</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
