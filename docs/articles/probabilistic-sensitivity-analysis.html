<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (HESIM)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="number-of-psa-simulations" class="section level1">
<h1 class="hasAnchor">
<a href="#number-of-psa-simulations" class="anchor"></a><span class="header-section-number">2</span> Number of PSA simulations</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="create-psa-samples-for-transition-matrix-monotherapy-based-on-dirichlet-distribution-using-rdirichlet_mat-function-from-hesim-package" class="section level1">
<h1 class="hasAnchor">
<a href="#create-psa-samples-for-transition-matrix-monotherapy-based-on-dirichlet-distribution-using-rdirichlet_mat-function-from-hesim-package" class="anchor"></a><span class="header-section-number">3</span> Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)

<span class="co">#Show first 10 PSA samples</span>
<span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7295366 0.1967305 0.06404283 0.009690114
## [2,] 0.0000000 0.5908437 0.39683648 0.012319785
## [3,] 0.0000000 0.0000000 0.74406519 0.255934810
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7075769 0.2063054 0.07659368 0.009524078
## [2,] 0.0000000 0.5695905 0.41756172 0.012847780
## [3,] 0.0000000 0.0000000 0.74030813 0.259691874
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7336763 0.1924610 0.06642298 0.007439737
## [2,] 0.0000000 0.5928017 0.39842670 0.008771577
## [3,] 0.0000000 0.0000000 0.73186466 0.268135344
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7079163 0.2113370 0.06792527 0.01282142
## [2,] 0.0000000 0.5888679 0.40077640 0.01035574
## [3,] 0.0000000 0.0000000 0.75348226 0.24651774
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 5
## 
##          [,1]      [,2]       [,3]       [,4]
## [1,] 0.699042 0.2211799 0.06901578 0.01076235
## [2,] 0.000000 0.5892663 0.39322157 0.01751209
## [3,] 0.000000 0.0000000 0.75229056 0.24770944
## [4,] 0.000000 0.0000000 0.00000000 1.00000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7154741 0.2023721 0.06893496 0.01321884
## [2,] 0.0000000 0.5907075 0.39197094 0.01732157
## [3,] 0.0000000 0.0000000 0.75510006 0.24489994
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7284873 0.1944005 0.06726189 0.009850292
## [2,] 0.0000000 0.5573668 0.43023553 0.012397638
## [3,] 0.0000000 0.0000000 0.73686245 0.263137553
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##          [,1]      [,2]      [,3]       [,4]
## [1,] 0.728307 0.1910200 0.0728142 0.00785877
## [2,] 0.000000 0.5788223 0.4096388 0.01153893
## [3,] 0.000000 0.0000000 0.7680458 0.23195424
## [4,] 0.000000 0.0000000 0.0000000 1.00000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.6949975 0.2227578 0.07215737 0.01008739
## [2,] 0.0000000 0.6033109 0.38501673 0.01167240
## [3,] 0.0000000 0.0000000 0.73462977 0.26537023
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7247999 0.1961404 0.07154406 0.007515660
## [2,] 0.0000000 0.5807904 0.41096313 0.008246467
## [3,] 0.0000000 0.0000000 0.75028938 0.249710625
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="create-psa-samples-for-relative-risk-according-to-normal-distribution-of-log-transformed-relative-risk" class="section level1">
<h1 class="hasAnchor">
<a href="#create-psa-samples-for-relative-risk-according-to-normal-distribution-of-log-transformed-relative-risk" class="anchor"></a><span class="header-section-number">4</span> Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )

<span class="co">#Show first 10 PSA samples</span>
RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.5245350 0.4112913 0.5336085 0.4906578 0.4988522 0.5321206 0.5018820
##  [8] 0.4513204 0.6378281 0.4798077</code></pre>
</div>
<div id="create-psa-samples-for-transition-matrix-for-combination-therapy" class="section level1">
<h1 class="hasAnchor">
<a href="#create-psa-samples-for-transition-matrix-for-combination-therapy" class="anchor"></a><span class="header-section-number">5</span> Create PSA samples for transition matrix for combination therapy</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}

<span class="co">#Show first 10 PSA samples</span>
<span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.8581325 0.1031920 0.0335927 0.005082804
## [2,] 0.0000000 0.7853832 0.2081546 0.006462158
## [3,] 0.0000000 0.0000000 0.8657532 0.134246759
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.8797289 0.0848516 0.03150231 0.00391717
## [2,] 0.0000000 0.8229763 0.17173950 0.00528418
## [3,] 0.0000000 0.0000000 0.89319099 0.10680901
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8578874 0.1026988 0.03544387 0.003969907
## [2,] 0.0000000 0.7827155 0.21260389 0.004680588
## [3,] 0.0000000 0.0000000 0.85692069 0.143079306
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8566869 0.1036941 0.03332806 0.006290931
## [2,] 0.0000000 0.7982748 0.19664406 0.005081124
## [3,] 0.0000000 0.0000000 0.87904416 0.120955845
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8498664 0.1103361 0.03442868 0.005368822
## [2,] 0.0000000 0.7951046 0.19615947 0.008735944
## [3,] 0.0000000 0.0000000 0.87642959 0.123570410
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8485979 0.1076864 0.03668171 0.007034016
## [2,] 0.0000000 0.7822070 0.20857582 0.009217163
## [3,] 0.0000000 0.0000000 0.86968369 0.130316306
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8637327 0.09756612 0.03375753 0.004943685
## [2,] 0.0000000 0.77785036 0.21592749 0.006222152
## [3,] 0.0000000 0.00000000 0.86793599 0.132064013
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8773794 0.08621124 0.03286254 0.003546823
## [2,] 0.0000000 0.80991388 0.18487836 0.005207756
## [3,] 0.0000000 0.00000000 0.89531431 0.104685688
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.8054608 0.1420812 0.0460240 0.006434023
## [2,] 0.0000000 0.7469805 0.2455745 0.007444985
## [3,] 0.0000000 0.0000000 0.8307394 0.169260593
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 10
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8679568 0.09410969 0.03432739 0.003606072
## [2,] 0.0000000 0.79885999 0.19718329 0.003956719
## [3,] 0.0000000 0.00000000 0.88018691 0.119813092
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000</code></pre>
</div>
<div id="parameters-for-which-no-uncertainty-is-propagated" class="section level1">
<h1 class="hasAnchor">
<a href="#parameters-for-which-no-uncertainty-is-propagated" class="anchor"></a><span class="header-section-number">6</span> Parameters for which no uncertainty is propagated</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## define LY by health state per cycle
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

## define costs 
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
<div id="model-simulation-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-simulation-settings" class="anchor"></a><span class="header-section-number">7</span> Model simulation settings</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## discount rates
discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span>

## define starting distribution
initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

## define duration of follow-up
follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
</div>
<div id="monotherapy-results" class="section level1">
<h1 class="hasAnchor">
<a href="#monotherapy-results" class="anchor"></a><span class="header-section-number">8</span> Monotherapy results</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## data format
trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)

Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)

## trace and expected LY and cost by PSA sample
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}

<span class="co">#Presentation of results for first 10 PSA samples</span>
trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.729536568 0.196730487 0.06404283 0.009690114 0.99030989 5135.6452
##  [2,] 0.532223603 0.259759060 0.17244346 0.035573874 0.96442613 5348.6596
##  [3,] 0.388276581 0.258181622 0.26547615 0.088065642 0.91193436 5311.9276
##  [4,] 0.283261964 0.228930835 0.32485378 0.162953418 0.83704658 4999.7879
##  [5,] 0.206649961 0.190988613 0.35070140 0.251660029 0.74833997 4495.4383
##  [6,] 0.150758703 0.153498773 0.34997040 0.345772124 0.65422788 3895.9530
##  [7,] 0.109983987 0.120352621 0.33096972 0.438693673 0.56130633 3278.8195
##  [8,] 0.080237340 0.092746796 0.30106704 0.525948821 0.47405118 2695.2360
##  [9,] 0.058536074 0.070583994 0.26595745 0.604922487 0.39507751 2173.5773
## [10,] 0.042704206 0.053219941 0.22964880 0.674427056 0.32557294 1725.5638
## [11,] 0.031154280 0.039845888 0.19472819 0.734271644 0.26572836 1352.1144
## [12,] 0.022728187 0.029671690 0.16269798 0.784902147 0.21509785 1047.9148
## [13,] 0.016581043 0.022002659 0.13428829 0.827128010 0.17287199  804.6152
## [14,] 0.012096477 0.016262130 0.10971260 0.861928798 0.13807120  612.8865
## [15,] 0.008824823 0.011988124 0.08886142 0.890325632 0.10967437  463.6324
## [16,] 0.006438031 0.008819219 0.07144118 0.913301568 0.08669843  348.6247
## [17,] 0.004696779 0.006477337 0.05706899 0.931756889 0.06824311  260.7689
## [18,] 0.003426472 0.004751094 0.04533429 0.946488143 0.05351186  194.1499
## [19,] 0.002499737 0.003481246 0.03583652 0.958182502 0.04181750  143.9562
## [20,] 0.001823649 0.002548646 0.02820628 0.967421425 0.03257858  106.3480
## 
## , , 2
## 
##            State A     State B    State C       Death    Disc LY
##  [1,] 0.7075768792 0.206305363 0.07659368 0.009524078 0.99047592
##  [2,] 0.5006650400 0.263486479 0.19704406 0.038804417 0.96119558
##  [3,] 0.3542590066 0.253369278 0.29424297 0.098128749 0.90187125
##  [4,] 0.2506654823 0.217402266 0.35076177 0.181170479 0.81882952
##  [5,] 0.1773650997 0.175543898 0.36965005 0.277440956 0.72255904
##  [6,] 0.1254994437 0.136579508 0.36054039 0.377380657 0.62261934
##  [7,] 0.0888005047 0.103685598 0.33355382 0.473960077 0.52603992
##  [8,] 0.0628331840 0.077378352 0.29702930 0.562759167 0.43724083
##  [9,] 0.0444593083 0.057036797 0.25701607 0.641487830 0.35851217
## [10,] 0.0314583786 0.041659811 0.21749277 0.709389044 0.29061096
## [11,] 0.0222592214 0.030219065 0.18081672 0.766704996 0.23329500
## [12,] 0.0157501104 0.021804689 0.14818333 0.814261875 0.18573813
## [13,] 0.0111444139 0.015669076 0.12001248 0.853174028 0.14682597
## [14,] 0.0078855296 0.011224109 0.09624261 0.884647747 0.11535225
## [15,] 0.0055796185 0.008019973 0.07653993 0.909860479 0.09013952
## [16,] 0.0039480090 0.005719206 0.06043933 0.929893457 0.07010654
## [17,] 0.0027935199 0.004072101 0.04743424 0.945700140 0.05429986
## [18,] 0.0019766301 0.002895748 0.03703027 0.958097349 0.04190265
## [19,] 0.0013986178 0.002057180 0.02877436 0.967769840 0.03223016
## [20,] 0.0009896296 0.001460292 0.02226802 0.975282059 0.02471794
##        Disc cost
##  [1,] 5213.12195
##  [2,] 5472.03008
##  [3,] 5419.17990
##  [4,] 5052.72644
##  [5,] 4483.55327
##  [6,] 3826.82986
##  [7,] 3168.21293
##  [8,] 2560.28448
##  [9,] 2029.17033
## [10,] 1582.94541
## [11,] 1218.79521
## [12,]  928.21646
## [13,]  700.42582
## [14,]  524.40005
## [15,]  389.97065
## [16,]  288.31263
## [17,]  212.07221
## [18,]  155.29735
## [19,]  113.27477
## [20,]   82.33508
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.733676296 0.192460991 0.06642298 0.007439737 0.99256026 5159.17626
##  [2,] 0.538280908 0.255295274 0.17402719 0.032396629 0.96760337 5370.52931
##  [3,] 0.394923943 0.254937555 0.26483502 0.085303480 0.91469652 5319.43108
##  [4,] 0.289746336 0.227134874 0.32162935 0.161489444 0.83851056 4989.23885
##  [5,] 0.212580018 0.190410811 0.34513156 0.251877607 0.74812239 4468.47469
##  [6,] 0.155964921 0.153789217 0.34257454 0.347671320 0.65232868 3856.68236
##  [7,] 0.114427765 0.121183676 0.32235158 0.442036975 0.55796303 3231.96209
##  [8,] 0.083952939 0.093860773 0.29180118 0.530385112 0.46961489 2645.09106
##  [9,] 0.061594281 0.071798493 0.25653201 0.610075216 0.38992478 2123.56318
## [10,] 0.045190264 0.054416767 0.22044442 0.679948546 0.32005145 1678.11282
## [11,] 0.033155026 0.040955716 0.18601825 0.739871011 0.26012899 1308.75740
## [12,] 0.024325056 0.030659668 0.15466029 0.790354989 0.20964501 1009.44899
## [13,] 0.017846717 0.022856728 0.12702177 0.832274784 0.16772522  771.29055
## [14,] 0.013093713 0.016984305 0.10325491 0.866667074 0.13333293  584.57668
## [15,] 0.009606547 0.012588354 0.08320534 0.894599757 0.10540024  439.97578
## [16,] 0.007048096 0.009311284 0.06654868 0.917091940 0.08290806  329.13203
## [17,] 0.005171021 0.006876228 0.05288265 0.935070104 0.06492990  244.90068
## [18,] 0.003793855 0.005071460 0.04178609 0.949348597 0.05065140  181.36778
## [19,] 0.002783462 0.003736539 0.03285436 0.960625634 0.03937437  133.75505
## [20,] 0.002042160 0.002750735 0.02571857 0.969488534 0.03051147   98.27328
## 
## , , 4
## 
##            State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.7079163309 0.211336975 0.06792527 0.01282142 0.98717858 5147.7486
##  [2,] 0.5011455316 0.274058447 0.18396477 0.04083125 0.95916875 5392.9695
##  [3,] 0.3547691060 0.267294791 0.28249079 0.09544531 0.90455469 5372.3019
##  [4,] 0.2511468439 0.232377140 0.34407503 0.17240098 0.82759902 5058.0964
##  [5,] 0.1777909522 0.189916043 0.36944493 0.26284808 0.73715192 4540.6681
##  [6,] 0.1258611186 0.149409255 0.36656056 0.35816906 0.64183094 3924.2137
##  [7,] 0.0890991413 0.114581416 0.34462574 0.45169371 0.54830629 3290.9323
##  [8,] 0.0630747372 0.086303256 0.31164299 0.53897902 0.46102098 2694.3633
##  [9,] 0.0446516365 0.064151238 0.27369014 0.61750699 0.38249301 2163.5639
## [10,] 0.0316096227 0.047213144 0.23496394 0.68621329 0.31378671 1709.9930
## [11,] 0.0223769681 0.034482585 0.19811017 0.74503028 0.25496972 1333.8845
## [12,] 0.0158410212 0.025034767 0.16461226 0.79451195 0.20548805 1029.1383
## [13,] 0.0112141176 0.018089963 0.13514177 0.83555415 0.16444585  786.6867
## [14,] 0.0079386570 0.013022555 0.10983868 0.86920011 0.13079989  596.6211
## [15,] 0.0056199049 0.009346296 0.08851986 0.89651394 0.10348606  449.4166
## [16,] 0.0039784225 0.006691427 0.07082566 0.91850450 0.08149550  336.5519
## [17,] 0.0028163902 0.004781154 0.05631788 0.93608458 0.06391542  250.7484
## [18,] 0.0019937686 0.003410675 0.04454200 0.95005356 0.04994644  185.9877
## [19,] 0.0014114214 0.002429794 0.03506395 0.96109483 0.03890517  137.4116
## [20,] 0.0009991682 0.001729113 0.02748974 0.96978198 0.03021802  101.1706
## 
## , , 5
## 
##            State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.6990420072 0.221179865 0.06901578 0.01076235 0.98923765 5166.70679
##  [2,] 0.4886597279 0.284947867 0.18713754 0.03925486 0.96074514 5420.55211
##  [3,] 0.3415936770 0.275991879 0.28655469 0.09585976 0.90414024 5394.04082
##  [4,] 0.2387883296 0.238186368 0.34767370 0.17535160 0.82464840 5065.51146
##  [5,] 0.1669230732 0.193170380 0.37169182 0.26821472 0.73178528 4531.69571
##  [6,] 0.1166862402 0.150748826 0.36709934 0.36546560 0.63453440 3900.97374
##  [7,] 0.0815685835 0.114639856 0.34349625 0.46029531 0.53970469 3257.45098
##  [8,] 0.0570198664 0.085594736 0.30911737 0.54826803 0.45173197 2654.98798
##  [9,] 0.0398592818 0.063049743 0.27013905 0.62695193 0.37304807 2122.08971
## [10,] 0.0278633124 0.045969162 0.23076649 0.69540103 0.30459897 1669.30971
## [11,] 0.0194776258 0.033250884 0.19360253 0.75366896 0.24633104 1295.94058
## [12,] 0.0136156786 0.023901685 0.16006458 0.80241805 0.19758195  995.06493
## [13,] 0.0095179313 0.017095972 0.13075343 0.84263266 0.15736734  756.98152
## [14,] 0.0066534338 0.012179256 0.10574397 0.87542335 0.12457665  571.33319
## [15,] 0.0046510297 0.008648431 0.08479853 0.90190201 0.09809799  428.30622
## [16,] 0.0032512652 0.006124943 0.06751487 0.92310892 0.07689108  319.21493
## [17,] 0.0022727709 0.004328337 0.05342365 0.93997524 0.06002476  236.70659
## [18,] 0.0015887623 0.003053235 0.04204896 0.95330904 0.04669096  174.74942
## [19,] 0.0011106116 0.002150571 0.03294328 0.96379553 0.03620447  128.50951
## [20,] 0.0007763642 0.001512904 0.02570522 0.97200551 0.02799449   94.18231
## 
## , , 6
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.715474128 0.202372081 0.06893496 0.01321884 0.98678116 5149.3122
##  [2,] 0.511903227 0.264334691 0.18069794 0.04306414 0.95693586 5362.2295
##  [3,] 0.366253515 0.259739402 0.27534457 0.09866251 0.90133749 5319.3196
##  [4,] 0.262044914 0.227549496 0.33497067 0.17543492 0.82456508 4999.7878
##  [5,] 0.187486356 0.187445765 0.36019322 0.26487466 0.73512534 4489.2825
##  [6,] 0.134141637 0.148667621 0.35837958 0.35881116 0.64118884 3885.7291
##  [7,] 0.095974871 0.114965599 0.33813288 0.45092665 0.54907335 3266.5834
##  [8,] 0.068667537 0.087333674 0.30700336 0.53699543 0.46300457 2682.6231
##  [9,] 0.049129846 0.065485048 0.27078411 0.61460100 0.38539900 2161.7041
## [10,] 0.035151134 0.048625017 0.23352410 0.68269975 0.31730025 1715.0769
## [11,] 0.025149727 0.035836770 0.19781680 0.74119671 0.25880329 1343.2957
## [12,] 0.017993979 0.026258651 0.16515214 0.79059523 0.20940477 1040.7941
## [13,] 0.012874226 0.019152661 0.13623944 0.83173368 0.16826632  799.0679
## [14,] 0.009211176 0.013919004 0.11126918 0.86560064 0.13439936  608.7079
## [15,] 0.006590358 0.010086145 0.09011018 0.89321332 0.10678668  460.5890
## [16,] 0.004715231 0.007291666 0.07244998 0.91554312 0.08445688  346.4871
## [17,] 0.003373626 0.005261473 0.05789015 0.93347475 0.06652525  259.3300
## [18,] 0.002413742 0.003790719 0.04600776 0.94778778 0.05221222  193.2331
## [19,] 0.001726970 0.002727680 0.03639271 0.95915264 0.04084736  143.4175
## [20,] 0.001235602 0.001960751 0.02866836 0.96813529 0.03186471  106.0739
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.728487323 0.194400495 0.06726189 0.009850292 0.99014971 5153.21721
##  [2,] 0.530693780 0.249970683 0.18220019 0.037135341 0.96286466 5393.36546
##  [3,] 0.386603692 0.242492501 0.27749822 0.093405590 0.90659441 5348.55569
##  [4,] 0.281635889 0.210313225 0.33481060 0.173240285 0.82675971 5003.70493
##  [5,] 0.205168175 0.171971772 0.35613694 0.266723110 0.73327689 4459.95925
##  [6,] 0.149462414 0.135736156 0.35021231 0.364589124 0.63541088 3826.53524
##  [7,] 0.108881474 0.104710398 0.32650994 0.459898190 0.54010181 3186.20910
##  [8,] 0.079318774 0.079528715 0.29296662 0.548185892 0.45181411 2590.77833
##  [9,] 0.057782721 0.059746277 0.25542731 0.627043692 0.37295631 2066.80471
## [10,] 0.042093980 0.044533582 0.21780634 0.695566099 0.30443390 1623.37067
## [11,] 0.030664931 0.033004632 0.18248456 0.753845875 0.24615412 1258.82213
## [12,] 0.022339013 0.024356965 0.15072837 0.802575654 0.19742435  965.73415
## [13,] 0.016273688 0.017918480 0.12304787 0.842759963 0.15724004  734.21243
## [14,] 0.011855175 0.013150779 0.09947312 0.875520926 0.12447907  553.90534
## [15,] 0.008636345 0.009634460 0.07975334 0.901975854 0.09802415  415.11343
## [16,] 0.006291468 0.007048838 0.06349323 0.923166468 0.07683353  309.31253
## [17,] 0.004583255 0.005151853 0.05024161 0.940023282 0.05997672  229.32052
## [18,] 0.003338843 0.003762459 0.03954594 0.953352754 0.04664725  169.26427
## [19,] 0.002432305 0.002746143 0.03098324 0.963838311 0.03616169  124.44709
## [20,] 0.001771903 0.002003450 0.02417548 0.972049170 0.02795083   91.17744
## 
## , , 8
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.728307013 0.191020016 0.07281420 0.00785877 0.99214123 5194.4740
##  [2,] 0.530431105 0.249687858 0.18720494 0.03267610 0.96732390 5441.1127
##  [3,] 0.386316693 0.245847853 0.28468671 0.08314874 0.91685126 5430.4701
##  [4,] 0.281357157 0.216096435 0.34749058 0.15505583 0.84494417 5140.3529
##  [5,] 0.204914390 0.178826279 0.37589695 0.24036238 0.75963762 4652.9377
##  [6,] 0.149240587 0.142651384 0.37688092 0.33122711 0.66877289 4063.8932
##  [7,] 0.108692966 0.111077739 0.35876417 0.42146513 0.57853487 3450.2221
##  [8,] 0.079161850 0.085056802 0.32896344 0.50681791 0.49318209 2863.6393
##  [9,] 0.057654130 0.064354270 0.29326565 0.58472595 0.41527405 2333.7029
## [10,] 0.041989907 0.048262778 0.25580149 0.65394583 0.34605417 1873.6030
## [11,] 0.030581544 0.035956484 0.21929501 0.71416696 0.28583304 1485.7198
## [12,] 0.022272753 0.026654101 0.18538455 0.76568860 0.23431140 1166.0154
## [13,] 0.016221402 0.019682529 0.15492414 0.80917193 0.19082807  907.1498
## [14,] 0.011814161 0.014491299 0.12823271 0.84546183 0.15453817  700.5239
## [15,] 0.008604336 0.010644628 0.10528503 0.87546601 0.12453399  537.5173
## [16,] 0.006266598 0.007804948 0.08585069 0.90007777 0.09992223  410.1682
## [17,] 0.004564008 0.005714724 0.06959076 0.92013050 0.07986950  311.4880
## [18,] 0.003323999 0.004179626 0.05612219 0.93637419 0.06362581  235.5534
## [19,] 0.002420892 0.003054211 0.04505858 0.94946632 0.05053368  177.4696
## [20,] 0.001763152 0.002230284 0.03603445 0.95997211 0.04002789  133.2691
## 
## , , 9
## 
##            State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.6949974622 0.222757777 0.07215737 0.01008739 0.98991261 5188.87932
##  [2,] 0.4830214724 0.289208278 0.18892361 0.03884664 0.96115336 5433.43996
##  [3,] 0.3356986975 0.282079288 0.28499249 0.09722953 0.90277047 5381.56506
##  [4,] 0.2333097428 0.244960996 0.34219234 0.17953692 0.82046308 5023.27105
##  [5,] 0.1621496791 0.199759192 0.36253378 0.27555735 0.72444265 4462.75411
##  [6,] 0.1126936155 0.156636994 0.35493903 0.37573036 0.62426964 3812.18819
##  [7,] 0.0783217768 0.119604181 0.32918832 0.47288573 0.52711427 3156.79484
##  [8,] 0.0544334361 0.089605287 0.29353264 0.56242864 0.43757136 2549.88539
##  [9,] 0.0378310999 0.066185315 0.25406512 0.64191846 0.35808154 2018.57168
## [10,] 0.0262925184 0.048357492 0.21485605 0.71049394 0.28950606 1571.74307
## [11,] 0.0182732336 0.035031464 0.17835529 0.76834001 0.23165999 1207.10443
## [12,] 0.0126998510 0.025205368 0.14583135 0.81626343 0.18373657  916.40280
## [13,] 0.0088263642 0.018035663 0.11775293 0.85538504 0.14461496  688.91384
## [14,] 0.0061343007 0.012847253 0.09408573 0.88693272 0.11306728  513.56155
## [15,] 0.0042633234 0.009117350 0.07450722 0.91211211 0.08788789  380.07464
## [16,] 0.0029629990 0.006450285 0.05855318 0.93203353 0.06796647  279.51579
## [17,] 0.0020592768 0.004551558 0.04571218 0.94767698 0.05232302  204.43171
## [18,] 0.0014311921 0.003204724 0.03548255 0.95988154 0.04011846  148.79323
## [19,] 0.0009946749 0.002252254 0.02740368 0.96934939 0.03065061  107.83391
## [20,] 0.0006912965 0.001580381 0.02107049 0.97665784 0.02334216   77.85261
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.724799878 0.196140407 0.07154406 0.00751566 0.99248434 5190.0430
##  [2,] 0.525334863 0.256079009 0.18614034 0.03244579 0.96755421 5437.9055
##  [3,] 0.380762645 0.251767624 0.28248274 0.08498699 0.91501301 5412.6043
##  [4,] 0.275976718 0.220907160 0.34265231 0.16046381 0.83953619 5095.9610
##  [5,] 0.200027892 0.182430944 0.36761758 0.24992358 0.75007642 4579.0948
##  [6,] 0.144980192 0.145187694 0.36510276 0.34472935 0.65527065 3964.6032
##  [7,] 0.105081625 0.112760093 0.34397198 0.43818630 0.56181370 3333.0774
##  [8,] 0.076163149 0.086100733 0.31193673 0.52579939 0.47420061 2737.1042
##  [9,] 0.055203041 0.064945150 0.27487606 0.60497575 0.39502425 2205.4291
## [10,] 0.040011158 0.048547067 0.23687610 0.67456567 0.32543433 1749.6289
## [11,] 0.029000082 0.036043475 0.20053924 0.73441721 0.26558279 1370.2710
## [12,] 0.021019256 0.026621792 0.16734978 0.78500917 0.21499083 1061.6495
## [13,] 0.015234754 0.019584407 0.13800514 0.82717570 0.17282430  815.0601
## [14,] 0.011042148 0.014362587 0.11268222 0.86191305 0.13808695  620.8833
## [15,] 0.008003347 0.010507464 0.09123676 0.89025243 0.10974757  469.7989
## [16,] 0.005800825 0.007672414 0.07334475 0.91318201 0.08681799  353.4120
## [17,] 0.004204437 0.005593841 0.05859788 0.93160384 0.06839616  264.5070
## [18,] 0.003047376 0.004073509 0.04656503 0.94631409 0.05368591  197.0819
## [19,] 0.002208738 0.002963568 0.03682933 0.95799836 0.04200164  146.2631
## [20,] 0.001600893 0.002154435 0.02900860 0.96723608 0.03276392  108.1663</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.046586 7.624563 7.995984 7.886761 7.785936 7.914278 7.795254
##  [8] 8.306740 7.610652 8.061306</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 44395.62 43421.15 43943.74 44502.47 44184.31 44332.64 43503.81
##  [8] 46509.28 43123.58 45112.54</code></pre>
</div>
<div id="combination-therapy-results" class="section level1">
<h1 class="hasAnchor">
<a href="#combination-therapy-results" class="anchor"></a><span class="header-section-number">9</span> Combination therapy results</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## data format
trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)

Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)

## trace and expected LY and cost by PSA sample
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}

<span class="co">#Presentation of results for first 10 PSA samples</span>
trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.858132470 0.103192021 0.03359270 0.005082804 0.99491720 6910.6964
##  [2,] 0.736391336 0.169597707 0.07938988 0.014621078 0.98537892 6731.3549
##  [3,] 0.537224408 0.245076369 0.17353439 0.044164835 0.95583516 5011.6709
##  [4,] 0.391924851 0.250490257 0.26078151 0.096803380 0.90319662 4951.3633
##  [5,] 0.285923510 0.225104165 0.31854209 0.170430229 0.82956977 4658.3265
##  [6,] 0.208591656 0.189251257 0.34465698 0.257500106 0.74249989 4193.2559
##  [7,] 0.152175241 0.152854258 0.34490786 0.350062637 0.64993736 3639.8899
##  [8,] 0.111017403 0.120250490 0.32703781 0.441694292 0.55830571 3068.3090
##  [9,] 0.080991255 0.092889756 0.29816710 0.527951885 0.47204812 2526.0025
## [10,] 0.059086082 0.070816779 0.26390472 0.606192422 0.39380758 2039.8482
## [11,] 0.043105458 0.053465684 0.22824903 0.675179824 0.32482018 1621.3231
## [12,] 0.031447008 0.040070022 0.19380989 0.734673080 0.26532692 1271.7556
## [13,] 0.022941742 0.029861707 0.16212240 0.785074156 0.21492584  986.5324
## [14,] 0.016736840 0.022156942 0.13394910 0.827157118 0.17284288  758.0885
## [15,] 0.012210137 0.016383937 0.10953142 0.861874506 0.13812549  577.8513
## [16,] 0.008907741 0.012082453 0.08878223 0.890227574 0.10977243  437.3995
## [17,] 0.006498523 0.008891266 0.07142500 0.913185208 0.08681479  329.0791
## [18,] 0.004740910 0.006531806 0.05708942 0.931637862 0.06836214  246.2687
## [19,] 0.003458667 0.004791958 0.04537393 0.946375443 0.05362456  183.4337
## [20,] 0.002523224 0.003511724 0.03588429 0.958080762 0.04191924  136.0634
## 
## , , 2
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.879728917 0.084851600 0.03150231 0.00391717 0.99608283 6901.0782
##  [2,] 0.773922967 0.144477263 0.07042345 0.01117632 0.98882368 6696.6854
##  [3,] 0.547609998 0.241957335 0.17174084 0.03869183 0.96130817 5024.6148
##  [4,] 0.387476173 0.250791478 0.27011672 0.09161563 0.90838437 5018.3418
##  [5,] 0.274169181 0.222786855 0.33436875 0.16867521 0.83132479 4738.3439
##  [6,] 0.193995774 0.183459848 0.36156279 0.26098158 0.73901842 4254.1914
##  [7,] 0.137266924 0.144519355 0.35913253 0.35908119 0.64091881 3667.1918
##  [8,] 0.097126902 0.110635754 0.33672826 0.45550908 0.54449092 3060.8964
##  [9,] 0.068724750 0.083054875 0.30291923 0.54530114 0.45469886 2490.1680
## [10,] 0.048628044 0.061485552 0.26419799 0.62568842 0.37431158 1984.5271
## [11,] 0.034408080 0.045053812 0.22498653 0.69555158 0.30444842 1555.2454
## [12,] 0.024346362 0.032760795 0.18800755 0.75488530 0.24511470 1202.0893
## [13,] 0.017226923 0.023683022 0.15472794 0.80436211 0.19563789  918.4818
## [14,] 0.012189372 0.017043631 0.12575495 0.84501204 0.15498796  695.0090
## [15,] 0.008624918 0.012222623 0.10114781 0.87800465 0.12199535  521.5886
## [16,] 0.006102792 0.008741257 0.08064486 0.90451109 0.09548891  388.6822
## [17,] 0.004318195 0.006237976 0.06381949 0.92562434 0.07437566  287.8777
## [18,] 0.003055455 0.004443958 0.05018158 0.94231901 0.05768099  212.0864
## [19,] 0.002161969 0.003161593 0.03923948 0.95543695 0.04456305  155.5236
## [20,] 0.001529759 0.002246839 0.03053506 0.96568834 0.03431166  113.5794
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.857887401 0.102698826 0.03544387 0.003969907 0.99603009 6928.9517
##  [2,] 0.735970792 0.168487995 0.08261360 0.012927615 0.98707239 6759.7299
##  [3,] 0.539964325 0.241525641 0.17647746 0.042032575 0.95796743 5035.2474
##  [4,] 0.396159026 0.247098885 0.26125392 0.095488172 0.90451183 4958.1515
##  [5,] 0.290652487 0.222725803 0.31596736 0.170654347 0.82934565 4644.9305
##  [6,] 0.213244840 0.187971505 0.33929126 0.259492399 0.74050760 4162.2735
##  [7,] 0.156452685 0.152471145 0.33737250 0.353703669 0.64629633 3596.2981
##  [8,] 0.114785626 0.120496196 0.31805164 0.446666540 0.55333346 3017.4070
##  [9,] 0.084215493 0.093522107 0.28840406 0.533858342 0.46614166 2472.3915
## [10,] 0.061786911 0.071648263 0.25392829 0.612636541 0.38736346 1987.0485
## [11,] 0.045331592 0.054364784 0.21849179 0.681811835 0.31818816 1571.7461
## [12,] 0.033258715 0.040952101 0.18457786 0.741211326 0.25878867 1226.8485
## [13,] 0.024401131 0.030677481 0.15361156 0.791309824 0.20869018  946.9858
## [14,] 0.017902531 0.022881929 0.12626640 0.832949142 0.16705086  724.0459
## [15,] 0.013134663 0.017009986 0.10271582 0.867139527 0.13286047  549.0921
## [16,] 0.009636591 0.012611459 0.08282376 0.894928193 0.10507181  413.4844
## [17,] 0.007070138 0.009330762 0.06628061 0.917318485 0.08268151  309.4583
## [18,] 0.005187193 0.006892018 0.05269568 0.935225106 0.06477489  230.3572
## [19,] 0.003805720 0.005083932 0.04165662 0.949453726 0.05054627  170.6605
## [20,] 0.002792167 0.003746217 0.03276537 0.960696246 0.03930375  125.9006
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.856686879 0.103694128 0.03332806 0.006290931 0.99370907 6901.1599
##  [2,] 0.733912409 0.171609811 0.07823939 0.016238396 0.98376160 6715.2343
##  [3,] 0.519548580 0.256158330 0.17758035 0.046712740 0.95328726 5024.8911
##  [4,] 0.367796924 0.260643232 0.27175634 0.099803509 0.90019649 4996.1216
##  [5,] 0.260369449 0.231213511 0.33420594 0.174211100 0.82578890 4718.6229
##  [6,] 0.184319785 0.191179896 0.36216883 0.262331488 0.73766851 4253.6825
##  [7,] 0.130482986 0.151533282 0.36202815 0.355955581 0.64404442 3691.0746
##  [8,] 0.092371037 0.116808958 0.34237584 0.448444160 0.55155584 3106.5062
##  [9,] 0.065390965 0.088306456 0.31106273 0.535239852 0.46476015 2551.1974
## [10,] 0.046291332 0.065820363 0.27421309 0.613675216 0.38632478 2053.9702
## [11,] 0.032770390 0.048542566 0.23613830 0.682548747 0.31745125 1626.9931
## [12,] 0.023198694 0.035510752 0.19960667 0.741683884 0.25831612 1271.5537
## [13,] 0.016422735 0.025813882 0.16620773 0.791555650 0.20844435  982.6464
## [14,] 0.011625922 0.018671697 0.13669569 0.833006690 0.16699331  752.2018
## [15,] 0.008230180 0.013452149 0.11127065 0.867047023 0.13295298  571.1607
## [16,] 0.005826279 0.009660880 0.08979080 0.894722041 0.10527796  430.6928
## [17,] 0.004124518 0.006920290 0.07192338 0.917031813 0.08296819  322.8283
## [18,] 0.002919814 0.004946799 0.05724664 0.934886749 0.06511325  240.7188
## [19,] 0.002066984 0.003530076 0.04531522 0.949087725 0.05091227  178.6762
## [20,] 0.001463252 0.002515578 0.03569938 0.960321788 0.03967821  132.0934
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.849866429 0.110336073 0.03442868 0.005368822 0.99463118 6915.6998
##  [2,] 0.722272947 0.181499642 0.08107755 0.015149859 0.98485014 6740.5282
##  [3,] 0.504899131 0.266703863 0.18221168 0.046185325 0.95381467 5054.0485
##  [4,] 0.352945702 0.268833131 0.27679585 0.101425320 0.89857468 5016.5275
##  [5,] 0.246723872 0.236478798 0.33830071 0.178496618 0.82150338 4722.7938
##  [6,] 0.172470351 0.193919348 0.36451684 0.269093463 0.73090654 4240.6044
##  [7,] 0.120564020 0.152417114 0.36237902 0.364639842 0.63536016 3663.6332
##  [8,] 0.084279315 0.116480608 0.34086884 0.458371240 0.54162876 3069.1812
##  [9,] 0.058914781 0.087278989 0.30805170 0.545754530 0.45424547 2508.5470
## [10,] 0.041183907 0.064461334 0.27013042 0.624224342 0.37577566 2009.8417
## [11,] 0.028789281 0.047093945 0.23140649 0.692710284 0.30728972 1584.2388
## [12,] 0.020124917 0.034118486 0.19459019 0.751166409 0.24883359 1232.0420
## [13,] 0.014068162 0.024556102 0.16119342 0.800182312 0.19981769  947.4163
## [14,] 0.009834236 0.017581678 0.13189121 0.840692880 0.15930712  721.6619
## [15,] 0.006874544 0.012535426 0.10681272 0.873777307 0.12622269  545.2828
## [16,] 0.004805595 0.008907216 0.08575785 0.900529334 0.09947067  409.1734
## [17,] 0.003359313 0.006311623 0.06834900 0.921980068 0.07801993  305.2133
## [18,] 0.002348301 0.004462240 0.05413202 0.939057443 0.06094256  226.4920
## [19,] 0.001641561 0.003148844 0.04263972 0.952569871 0.04743013  167.3177
## [20,] 0.001147520 0.002218588 0.03342895 0.963204943 0.03679506  123.1153
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.848597918 0.107686356 0.03668171 0.007034016 0.99296598 6917.0597
##  [2,] 0.720118426 0.175615441 0.08549028 0.018775854 0.98122415 6740.5474
##  [3,] 0.515226102 0.249469220 0.18303120 0.052273481 0.94772652 5028.3340
##  [4,] 0.368630946 0.251630714 0.27150864 0.108229698 0.89177030 4959.1835
##  [5,] 0.263745904 0.223240759 0.32905968 0.183953658 0.81604634 4656.1721
##  [6,] 0.188703371 0.185244795 0.35415819 0.271893647 0.72810635 4183.2095
##  [7,] 0.135012380 0.147613781 0.35304370 0.364330134 0.63566987 3624.9151
##  [8,] 0.096597865 0.114519302 0.33375071 0.455132125 0.54486788 3051.1304
##  [9,] 0.069113273 0.087196120 0.30356239 0.540128218 0.45987178 2508.6865
## [10,] 0.049448759 0.065493998 0.26816264 0.616894599 0.38310540 2023.7475
## [11,] 0.035379307 0.048694843 0.23157012 0.684355728 0.31564427 1607.1823
## [12,] 0.025312979 0.035924192 0.19638445 0.742378380 0.25762162 1259.8670
## [13,] 0.018110782 0.026343330 0.16411610 0.791429791 0.20857021  976.8870
## [14,] 0.012957796 0.019226319 0.13549836 0.832317524 0.16768248  750.4984
## [15,] 0.009270968 0.013979426 0.11074422 0.866005382 0.13399462  572.0408
## [16,] 0.006633137 0.010133937 0.08974159 0.893491332 0.10650867  433.0656
## [17,] 0.004745838 0.007328554 0.07219335 0.915732261 0.08426774  325.9293
## [18,] 0.003395524 0.005289457 0.05771293 0.933602084 0.06639792  244.0412
## [19,] 0.002429410 0.003811681 0.04588642 0.947872484 0.05212752  181.9058
## [20,] 0.001738180 0.002743233 0.03631038 0.959208205 0.04079179  135.0533
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.863732663 0.097566118 0.03375753 0.004943685 0.99505632 6911.0320
##  [2,] 0.746034113 0.160162882 0.07952407 0.014278934 0.98572107 6731.7844
##  [3,] 0.543476394 0.234298879 0.17768573 0.044538998 0.95546100 5029.1991
##  [4,] 0.395915664 0.236242503 0.26828889 0.099552940 0.90044706 4974.2311
##  [5,] 0.288419542 0.208639936 0.32596197 0.176978557 0.82302144 4664.7110
##  [6,] 0.210109980 0.172357881 0.34935309 0.268179050 0.73182095 4172.5280
##  [7,] 0.153062457 0.136912050 0.34571205 0.364313442 0.63568656 3592.3846
##  [8,] 0.111504060 0.106065653 0.32394193 0.458488361 0.54151164 3000.4905
##  [9,] 0.081229294 0.080793921 0.29183383 0.546142958 0.45385704 2446.2480
## [10,] 0.059174511 0.060822866 0.25526544 0.624737183 0.37526282 1955.9122
## [11,] 0.043107881 0.045404202 0.21824386 0.693244052 0.30675595 1539.2160
## [12,] 0.031403545 0.033686990 0.18324973 0.751659739 0.24834026 1195.5146
## [13,] 0.022877084 0.024880875 0.15163544 0.800606597 0.19939340  918.4483
## [14,] 0.016665666 0.018315091 0.12397786 0.841041386 0.15895861  699.1029
## [15,] 0.012140726 0.013448038 0.10035539 0.874055842 0.12594416  527.9676
## [16,] 0.008844365 0.009855654 0.08055055 0.900749428 0.09925057  396.0342
## [17,] 0.006443008 0.007212563 0.06418982 0.922154610 0.07784539  295.3310
## [18,] 0.004693650 0.005272567 0.05083554 0.939198246 0.06080175  219.1084
## [19,] 0.003419264 0.003851202 0.04004295 0.952686586 0.04731341  161.8272
## [20,] 0.002490891 0.002811239 0.03139305 0.963304816 0.03669518  119.0451
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.877379401 0.086211238 0.03286254 0.003546823 0.99645318 6911.9673
##  [2,] 0.769794613 0.145463643 0.07419381 0.010547938 0.98945206 6721.9036
##  [3,] 0.560646815 0.231243777 0.17262377 0.035485639 0.96451436 5040.1377
##  [4,] 0.408323007 0.240943813 0.26813243 0.082600753 0.91739925 5042.1538
##  [5,] 0.297384510 0.217461514 0.33436962 0.150784356 0.84921564 4804.4700
##  [6,] 0.216587224 0.182677963 0.36754566 0.233189155 0.76681084 4379.0220
##  [7,] 0.157741994 0.147110569 0.37289449 0.322252945 0.67774705 3848.2112
##  [8,] 0.114884600 0.115282753 0.35814809 0.411684559 0.58831544 3284.1821
##  [9,] 0.083671260 0.088673484 0.33066364 0.496991616 0.50300838 2737.7494
## [10,] 0.060938365 0.067309073 0.29638136 0.575371198 0.42462880 2239.2662
## [11,] 0.044381839 0.050600439 0.25964404 0.645373686 0.35462631 1803.2998
## [12,] 0.032323605 0.037766481 0.22337803 0.706531882 0.29346812 1433.6739
## [13,] 0.023541508 0.028034536 0.18938879 0.759035171 0.24096483 1127.6443
## [14,] 0.017145445 0.020723913 0.15865744 0.803473198 0.19652680  878.9484
## [15,] 0.012487148 0.015270586 0.13159393 0.840648338 0.15935166  679.8458
## [16,] 0.009094477 0.011224250 0.10823483 0.871446447 0.12855355  522.3831
## [17,] 0.006623572 0.008234073 0.08838939 0.896752960 0.10324704  399.1072
## [18,] 0.004823994 0.006031300 0.07174239 0.917402320 0.08259768  303.4130
## [19,] 0.003513348 0.004412530 0.05792335 0.934150776 0.06584922  229.6636
## [20,] 0.002558796 0.003225191 0.04655115 0.947664868 0.05233513  173.1766
## 
## , , 9
## 
##            State A     State B    State C       Death    Disc LY
##  [1,] 0.8054608100 0.142081170 0.04602400 0.006434023 0.99356598
##  [2,] 0.6487671164 0.220572681 0.11019599 0.020464217 0.97953578
##  [3,] 0.4508914994 0.277591817 0.21269075 0.058825933 0.94117407
##  [4,] 0.3133684478 0.267913749 0.29566159 0.123056209 0.87694379
##  [5,] 0.2177902759 0.231440536 0.34296492 0.207804263 0.79219574
##  [6,] 0.1513636891 0.188145069 0.35677589 0.303715348 0.69628465
##  [7,] 0.1051973798 0.147227405 0.34545920 0.402116020 0.59788398
##  [8,] 0.0731119120 0.112257428 0.31806039 0.496570272 0.50342973
##  [9,] 0.0508125933 0.084012374 0.28215318 0.583021853 0.41697815
## [10,] 0.0353146234 0.062004479 0.24329080 0.659390101 0.34060990
## [11,] 0.0245435736 0.045274583 0.20514963 0.725032210 0.27496779
## [12,] 0.0170577214 0.032781920 0.16991150 0.780248860 0.21975114
## [13,] 0.0118550731 0.023577429 0.13867447 0.825893026 0.17410697
## [14,] 0.0082392457 0.016865329 0.11180753 0.863087895 0.13691211
## [15,] 0.0057262548 0.012010392 0.08922510 0.893038257 0.10696174
## [16,] 0.0039797326 0.008521568 0.07058480 0.916913894 0.08308611
## [17,] 0.0027659040 0.006027671 0.05542181 0.935784613 0.06421539
## [18,] 0.0019222963 0.004252686 0.04323485 0.950590170 0.04940983
## [19,] 0.0013359910 0.002993898 0.03353767 0.962132442 0.03786756
## [20,] 0.0009285104 0.002103854 0.02588687 0.971080764 0.02891924
##        Disc cost
##  [1,] 6985.78807
##  [2,] 6879.13753
##  [3,] 5163.29530
##  [4,] 5023.47238
##  [5,] 4633.21998
##  [6,] 4082.42225
##  [7,] 3466.80487
##  [8,] 2858.29560
##  [9,] 2301.10896
## [10,] 1816.90176
## [11,] 1411.77976
## [12,] 1082.42286
## [13,]  820.60310
## [14,]  616.17679
## [15,]  458.88582
## [16,]  339.32446
## [17,]  249.36608
## [18,]  182.26597
## [19,]  132.58710
## [20,]   96.04241
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.867956850 0.094109686 0.03432739 0.003606072 0.99639393 6922.4134
##  [2,] 0.753349093 0.156863610 0.07856607 0.011221223 0.98877878 6744.9642
##  [3,] 0.546027331 0.238867077 0.17731010 0.037795492 0.96220451 5056.8654
##  [4,] 0.395760543 0.245829728 0.27026446 0.088145273 0.91185473 5031.7476
##  [5,] 0.286847193 0.220400181 0.33211782 0.160634807 0.83936519 4757.5472
##  [6,] 0.207906810 0.184268635 0.36028303 0.247541524 0.75245848 4296.4164
##  [7,] 0.150690831 0.147800381 0.36091864 0.340590147 0.65940985 3737.1691
##  [8,] 0.109220696 0.115397604 0.34231496 0.433066738 0.56693326 3154.5733
##  [9,] 0.079163147 0.088444413 0.31207353 0.520318909 0.47968109 2599.4202
## [10,] 0.057377439 0.066894758 0.27615650 0.599571303 0.40042870 2100.5768
## [11,] 0.041587161 0.050105868 0.23879358 0.669513389 0.33048661 1670.5484
## [12,] 0.030142369 0.037257930 0.20273127 0.729868435 0.27013156 1311.0766
## [13,] 0.021847186 0.027551185 0.16957526 0.781026372 0.21897363 1017.6073
## [14,] 0.015834837 0.020286579 0.14011607 0.823762512 0.17623749  782.4525
## [15,] 0.011477088 0.014888102 0.11459752 0.859037285 0.14096271  596.8402
## [16,] 0.008318592 0.010897988 0.09292088 0.887862537 0.11213746  452.1320
## [17,] 0.006029315 0.007961059 0.07479137 0.911218258 0.08878174  340.4686
## [18,] 0.004370046 0.005806299 0.05981823 0.930005422 0.06999458  255.0486
## [19,] 0.003167409 0.004229385 0.04757981 0.945023396 0.05497660  190.1856
## [20,] 0.002295738 0.003077643 0.03766336 0.956963263 0.04303674  141.2449</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.962031 8.767967 8.896526 8.869205 8.755420 8.814961 8.759145
##  [8] 9.355065 8.314800 9.063228</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50278.51 49886.20 49831.01 50522.03 50203.36 50179.46 49550.12
##  [8] 52560.22 48599.90 51159.30</code></pre>
</div>
<div id="icer" class="section level1">
<h1 class="hasAnchor">
<a href="#icer" class="anchor"></a><span class="header-section-number">10</span> ICER</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}

<span class="co">#Presentation of results for first 10 PSA samples</span>
ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 6426.268 5654.209 6537.466 6127.126 6208.508 6491.527 6272.815
##  [8] 5772.003 7777.243 6035.155</code></pre>
</div>
<div id="overview-psa-results" class="section level1">
<h1 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">11</span> Overview PSA results</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)

<span class="co">#Presentation of results first 10 PSA samples</span>
Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     8.046586      8.962031       44395.62        50278.51 6426.268
##  [2,]     7.624563      8.767967       43421.15        49886.20 5654.209
##  [3,]     7.995984      8.896526       43943.74        49831.01 6537.466
##  [4,]     7.886761      8.869205       44502.47        50522.03 6127.126
##  [5,]     7.785936      8.755420       44184.31        50203.36 6208.508
##  [6,]     7.914278      8.814961       44332.64        50179.46 6491.527
##  [7,]     7.795254      8.759145       43503.81        49550.12 6272.815
##  [8,]     8.306740      9.355065       46509.28        52560.22 5772.003
##  [9,]     7.610652      8.314800       43123.58        48599.90 7777.243
## [10,]     8.061306      9.063228       45112.54        51159.30 6035.155</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#number-of-psa-simulations"><span class="toc-section-number">2</span> Number of PSA simulations</a></li>
      <li><a href="#create-psa-samples-for-transition-matrix-monotherapy-based-on-dirichlet-distribution-using-rdirichlet_mat-function-from-hesim-package"><span class="toc-section-number">3</span> Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</a></li>
      <li><a href="#create-psa-samples-for-relative-risk-according-to-normal-distribution-of-log-transformed-relative-risk"><span class="toc-section-number">4</span> Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</a></li>
      <li><a href="#create-psa-samples-for-transition-matrix-for-combination-therapy"><span class="toc-section-number">5</span> Create PSA samples for transition matrix for combination therapy</a></li>
      <li><a href="#parameters-for-which-no-uncertainty-is-propagated"><span class="toc-section-number">6</span> Parameters for which no uncertainty is propagated</a></li>
      <li><a href="#model-simulation-settings"><span class="toc-section-number">7</span> Model simulation settings</a></li>
      <li><a href="#monotherapy-results"><span class="toc-section-number">8</span> Monotherapy results</a></li>
      <li><a href="#combination-therapy-results"><span class="toc-section-number">9</span> Combination therapy results</a></li>
      <li><a href="#icer"><span class="toc-section-number">10</span> ICER</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">11</span> Overview PSA results</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
