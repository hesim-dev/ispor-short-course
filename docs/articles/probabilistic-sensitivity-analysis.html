<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-model-hesim.html">Simple Markov Cohort Model (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model-simple.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7325862 0.1835542 0.06987227 0.01398736
## [2,] 0.0000000 0.5998350 0.38408798 0.01607704
## [3,] 0.0000000 0.0000000 0.75817746 0.24182254
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 2
## 
##           [,1]      [,2]      [,3]       [,4]
## [1,] 0.7205922 0.1999057 0.0698184 0.00968373
## [2,] 0.0000000 0.5989096 0.3893147 0.01177568
## [3,] 0.0000000 0.0000000 0.7428681 0.25713186
## [4,] 0.0000000 0.0000000 0.0000000 1.00000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7359814 0.1886057 0.06487204 0.01054082
## [2,] 0.0000000 0.5897528 0.39678435 0.01346288
## [3,] 0.0000000 0.0000000 0.74472436 0.25527564
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7313324 0.1916537 0.0709250 0.006088806
## [2,] 0.0000000 0.5815980 0.4124303 0.005971729
## [3,] 0.0000000 0.0000000 0.7571545 0.242845512
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7219543 0.2020302 0.06544672 0.01056878
## [2,] 0.0000000 0.5817911 0.40608282 0.01212604
## [3,] 0.0000000 0.0000000 0.74620830 0.25379170
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7220437 0.2021842 0.06101076 0.014761354
## [2,] 0.0000000 0.5914061 0.39900455 0.009589317
## [3,] 0.0000000 0.0000000 0.76014674 0.239853255
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##          [,1]      [,2]       [,3]       [,4]
## [1,] 0.735445 0.1890929 0.05995198 0.01551012
## [2,] 0.000000 0.5883082 0.39780578 0.01388604
## [3,] 0.000000 0.0000000 0.76887429 0.23112571
## [4,] 0.000000 0.0000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7355976 0.1893353 0.06239176 0.01267539
## [2,] 0.0000000 0.5909847 0.39577517 0.01324015
## [3,] 0.0000000 0.0000000 0.74456251 0.25543749
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7122634 0.2174067 0.06322291 0.007106978
## [2,] 0.0000000 0.5918210 0.39215637 0.016022615
## [3,] 0.0000000 0.0000000 0.76082623 0.239173772
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7363609 0.1936588 0.06135492 0.008625358
## [2,] 0.0000000 0.5809912 0.40190606 0.017102751
## [3,] 0.0000000 0.0000000 0.75300499 0.246995006
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.4582198 0.5276844 0.5964555 0.7869459 0.3941311 0.4710580 0.5506166
##  [8] 0.4458074 0.5760649 0.4811664</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8774657 0.08410817 0.03201686 0.006409286
## [2,] 0.0000000 0.81663645 0.17599674 0.007366817
## [3,] 0.0000000 0.00000000 0.88919211 0.110807887
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8525609 0.1054871 0.03684208 0.005109953
## [2,] 0.0000000 0.7883509 0.20543530 0.006213842
## [3,] 0.0000000 0.0000000 0.86431553 0.135684470
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8425247 0.1124949 0.03869328 0.006287130
## [2,] 0.0000000 0.7553058 0.23666419 0.008030007
## [3,] 0.0000000 0.0000000 0.84773945 0.152260550
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7885732 0.1508211 0.05581414 0.004791561
## [2,] 0.0000000 0.6707403 0.32456030 0.004699428
## [3,] 0.0000000 0.0000000 0.80889372 0.191106278
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8904136 0.07962637 0.02579459 0.004165486
## [2,] 0.0000000 0.83517089 0.16004987 0.004779249
## [3,] 0.0000000 0.00000000 0.89997280 0.100027198
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8690665 0.09524047 0.02873961 0.006953454
## [2,] 0.0000000 0.80752860 0.18795428 0.004517124
## [3,] 0.0000000 0.00000000 0.88701521 0.112984793
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8543316 0.1041177 0.03301056 0.008540131
## [2,] 0.0000000 0.7733157 0.21903845 0.007645883
## [3,] 0.0000000 0.0000000 0.87273836 0.127261644
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8821274 0.08440707 0.02781471 0.005650782
## [2,] 0.0000000 0.81765795 0.17643949 0.005902558
## [3,] 0.0000000 0.00000000 0.88612408 0.113875920
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 9
## 
##          [,1]      [,2]      [,3]        [,4]
## [1,] 0.834245 0.1252404 0.0364205 0.004094081
## [2,] 0.000000 0.7648624 0.2259075 0.009230066
## [3,] 0.000000 0.0000000 0.8622204 0.137779617
## [4,] 0.000000 0.0000000 0.0000000 1.000000000
## 
## , , 10
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8731457 0.09318213 0.02952192 0.004150232
## [2,] 0.0000000 0.79838704 0.19338369 0.008229269
## [3,] 0.0000000 0.00000000 0.88115431 0.118845695
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.732586189 0.183554180 0.06987227 0.01398736 0.98601264 5145.9351
##  [2,] 0.536682525 0.244571475 0.17466400 0.04408201 0.95591799 5318.8937
##  [3,] 0.393166206 0.245212847 0.26386250 0.09775845 0.90224155 5259.2672
##  [4,] 0.288028132 0.219254544 0.32170932 0.17100800 0.82899200 4949.8329
##  [5,] 0.211005432 0.184385313 0.34825097 0.25635829 0.74364171 4464.8581
##  [6,] 0.154579665 0.149331690 0.34959965 0.34648900 0.65351100 3890.9056
##  [7,] 0.113242928 0.117948115 0.33321591 0.43559304 0.56440696 3298.0647
##  [8,] 0.082960205 0.091535618 0.30585179 0.51965239 0.48034761 2733.6633
##  [9,] 0.060775500 0.070133958 0.27284428 0.59624626 0.40375374 2224.8313
## [10,] 0.044523292 0.053224399 0.23804852 0.66420379 0.33579621 1783.6211
## [11,] 0.032617149 0.040098293 0.20403682 0.72324774 0.27675226 1412.0403
## [12,] 0.023894873 0.030039373 0.17237642 0.77368933 0.22631067 1106.0871
## [13,] 0.017505054 0.022404670 0.14389927 0.81619101 0.18380899  858.6508
## [14,] 0.012823961 0.016652231 0.11892967 0.85159414 0.14840586  661.4317
## [15,] 0.009394657 0.012342482 0.09746175 0.88080111 0.11919889  506.1150
## [16,] 0.006882396 0.009127881 0.07929033 0.90469939 0.09530061  385.0211
## [17,] 0.005041948 0.006738515 0.06410294 0.92411660 0.07588340  291.4093
## [18,] 0.003693661 0.004967468 0.05154188 0.93979699 0.06020301  219.5677
## [19,] 0.002705925 0.003657648 0.04124392 0.95239251 0.04760749  164.7788
## [20,] 0.001982324 0.002690669 0.03286414 0.96246287 0.03753713  123.2228
## 
## , , 2
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.720592182 0.199905690 0.06981840 0.00968373 0.99031627 5170.62169
##  [2,] 0.519253093 0.263775914 0.18000268 0.03696831 0.96303169 5385.52507
##  [3,] 0.374169719 0.261779575 0.27266352 0.09138718 0.90861282 5336.50544
##  [4,] 0.269623774 0.231580957 0.33059162 0.16820365 0.83179635 5007.88464
##  [5,] 0.194288784 0.192595385 0.35456856 0.25854728 0.74145272 4487.94986
##  [6,] 0.140002979 0.154186659 0.35194283 0.35386753 0.64613247 3876.05970
##  [7,] 0.100885052 0.120331262 0.33124904 0.44753465 0.55246535 3250.37778
##  [8,] 0.072696980 0.092235044 0.29996472 0.53510325 0.46489675 2661.90444
##  [9,] 0.052384875 0.069772994 0.26381828 0.61402385 0.38597615 2138.40179
## [10,] 0.037748131 0.052259750 0.22680328 0.68318884 0.31681116 1690.84371
## [11,] 0.027201008 0.038844933 0.19146593 0.74248812 0.25751188 1319.42703
## [12,] 0.019600834 0.028702239 0.15925598 0.79244095 0.20755905 1018.21928
## [13,] 0.014124208 0.021108365 0.13084890 0.83391853 0.16608147  778.38466
## [14,] 0.010177794 0.015465512 0.10640740 0.86794929 0.13205071  590.23902
## [15,] 0.007334039 0.011297042 0.08577822 0.89559070 0.10440930  444.44570
## [16,] 0.005284851 0.008232023 0.06863206 0.91785106 0.08214894  332.62852
## [17,] 0.003808222 0.005986710 0.05455840 0.93564667 0.06435333  247.61513
## [18,] 0.002744175 0.004346783 0.04312629 0.94978275 0.05021725  183.46200
## [19,] 0.001977431 0.003151906 0.03392101 0.96094965 0.03905035  135.36248
## [20,] 0.001424921 0.002283007 0.02656398 0.96972809 0.03027191   99.50189
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.735981393 0.188605744 0.06487204 0.01054082 0.98945918 5134.2264
##  [2,] 0.541668611 0.250041079 0.17089221 0.03739810 0.96260190 5329.2963
##  [3,] 0.398658019 0.249624231 0.26161913 0.09009862 0.90990138 5280.9647
##  [4,] 0.293404884 0.222405775 0.31974288 0.16444646 0.83555354 4966.9987
##  [5,] 0.215940536 0.186502270 0.34540122 0.25215598 0.74784402 4467.8226
##  [6,] 0.158928216 0.150717856 0.34523839 0.34511554 0.65488446 3876.8501
##  [7,] 0.116968210 0.118861049 0.32721992 0.43695082 0.56304918 3268.7718
##  [8,] 0.086086426 0.092159510 0.29843881 0.52331525 0.47668475 2693.1370
##  [9,] 0.063358008 0.070587721 0.26440671 0.60164756 0.39835244 2177.5983
## [10,] 0.046630315 0.053578989 0.22902838 0.67076231 0.32923769 1733.7590
## [11,] 0.034319044 0.040393102 0.19484732 0.73044053 0.26955947 1362.7516
## [12,] 0.025258178 0.030294713 0.16336124 0.78108586 0.21891414 1059.6143
## [13,] 0.018589549 0.022630229 0.13531812 0.82346211 0.17653789  816.3724
## [14,] 0.013681562 0.016852336 0.11095996 0.85850614 0.14149386  624.0332
## [15,] 0.010069375 0.012519133 0.09020888 0.88720261 0.11279739  473.7725
## [16,] 0.007410873 0.009282335 0.07280137 0.91050543 0.08949457  357.5665
## [17,] 0.005454264 0.006872016 0.05838079 0.92929293 0.07070707  268.4637
## [18,] 0.004014237 0.005081496 0.04655814 0.94434613 0.05565387  200.6421
## [19,] 0.002954404 0.003753935 0.03694965 0.95634201 0.04365799  149.3449
## [20,] 0.002174386 0.002771111 0.02919846 0.96585604 0.03414396  110.7594
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.731332447 0.191653745 0.07092500 0.006088806 0.99391119 5191.9157
##  [2,] 0.534847149 0.251628038 0.18461474 0.028910070 0.97108993 5444.0863
##  [3,] 0.391151074 0.248851825 0.28149493 0.078502166 0.92149783 5434.1042
##  [4,] 0.286061472 0.219697294 0.34351157 0.150729666 0.84927033 5138.7457
##  [5,] 0.209206037 0.182600261 0.37099005 0.237203654 0.76279635 4642.7339
##  [6,] 0.152999163 0.146295068 0.37104459 0.329661177 0.67033882 4044.4917
##  [7,] 0.111893252 0.114407783 0.35212606 0.421572907 0.57842709 3422.9204
##  [8,] 0.081831166 0.087984099 0.32173509 0.508449649 0.49155035 2830.6799
##  [9,] 0.059845787 0.066854626 0.28569435 0.587605242 0.41239476 2297.5483
## [10,] 0.043767166 0.050352187 0.24813219 0.657748458 0.34225154 1836.4894
## [11,] 0.032008348 0.037672873 0.21174535 0.718573426 0.28142657 1449.4415
## [12,] 0.023408744 0.028044988 0.17813157 0.770414699 0.22958530 1131.8647
## [13,] 0.017119574 0.020797282 0.14809998 0.813983160 0.18601684  875.9497
## [14,] 0.012520100 0.015376688 0.12192620 0.850177010 0.14982299  672.7049
## [15,] 0.009156355 0.011342575 0.09954677 0.879954299 0.12004570  513.2086
## [16,] 0.006696340 0.008351669 0.08069972 0.904252271 0.09574773  389.2847
## [17,] 0.004897251 0.006140693 0.06502157 0.923940483 0.07605952  293.8054
## [18,] 0.003581518 0.004509991 0.05211132 0.939797169 0.06020283  220.7670
## [19,] 0.002619280 0.003309413 0.04157040 0.952500909 0.04749909  165.2388
## [20,] 0.001915565 0.002426743 0.03302589 0.962631805 0.03736820  123.2485
## 
## , , 5
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.721954322 0.202030172 0.06544672 0.01056878 0.98943122 5141.2313
##  [2,] 0.521218042 0.263395920 0.17812742 0.03725862 0.96274138 5373.6915
##  [3,] 0.376295618 0.258543183 0.27399273 0.09116847 0.90883153 5343.6018
##  [4,] 0.271668248 0.226441201 0.33407291 0.16781764 0.83218236 5025.4560
##  [5,] 0.196132065 0.186626667 0.35902166 0.25821961 0.74178039 4508.6632
##  [6,] 0.141598392 0.148202336 0.35652703 0.35367224 0.64632776 3895.7052
##  [7,] 0.102227571 0.114829954 0.33549300 0.44744947 0.55255053 3267.2233
##  [8,] 0.073803637 0.087460103 0.30366860 0.53506766 0.46493234 2675.6565
##  [9,] 0.053282855 0.065794075 0.26694628 0.61397679 0.38602321 2149.4183
## [10,] 0.038467787 0.049043154 0.22940256 0.68308650 0.31691350 1699.6726
## [11,] 0.027771985 0.036304526 0.19361527 0.74230822 0.25769178 1326.5856
## [12,] 0.020050105 0.026732430 0.16103755 0.79217991 0.20782009 1024.1171
## [13,] 0.014475260 0.019603417 0.13233535 0.83358597 0.16641403  783.3171
## [14,] 0.010450476 0.014329534 0.10765771 0.86756228 0.13243772  594.4089
## [15,] 0.007544767 0.010448107 0.08683800 0.89516912 0.10483088  447.9906
## [16,] 0.005446977 0.007602887 0.06953582 0.91741432 0.08258568  335.6445
## [17,] 0.003932468 0.005523746 0.05533209 0.93521169 0.06478831  250.1735
## [18,] 0.002839063 0.004008144 0.04378973 0.94936306 0.05063694  185.6200
## [19,] 0.002049674 0.002905479 0.03448971 0.96055514 0.03944486  137.1697
## [20,] 0.001479771 0.002104478 0.02705052 0.96936524 0.03063476  101.0032
## 
## , , 6
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.722043716 0.202184169 0.06101076 0.01476135 0.98523865 5095.2039
##  [2,] 0.521347127 0.265558767 0.17110197 0.04199214 0.95800786 5313.9689
##  [3,] 0.376435417 0.262461220 0.26782955 0.09327382 0.90672618 5303.3298
##  [4,] 0.271802827 0.231330458 0.33127959 0.16558713 0.83441287 5021.6655
##  [5,] 0.196253523 0.191764481 0.36070590 0.25127609 0.74872391 4543.7863
##  [6,] 0.141703623 0.153090047 0.36267789 0.34252844 0.65747156 3963.3770
##  [7,] 0.102316211 0.119188622 0.34541749 0.43307768 0.56692232 3357.4554
##  [8,] 0.073876777 0.091175601 0.31636717 0.51858045 0.48141955 2778.2229
##  [9,] 0.053342262 0.068858524 0.28137224 0.59642698 0.40357302 2255.6224
## [10,] 0.038515445 0.051508315 0.24461350 0.66536273 0.33463727 1802.9950
## [11,] 0.027809835 0.038249547 0.20884407 0.72509655 0.27490345 1422.6793
## [12,] 0.020079917 0.028243725 0.17571058 0.77596578 0.22403422 1110.4856
## [13,] 0.014498578 0.020763354 0.14606029 0.81867778 0.18132222  858.8873
## [14,] 0.010468607 0.015210958 0.12019650 0.85412394 0.14587606  659.1128
## [15,] 0.007558792 0.011112440 0.09807491 0.88325385 0.11674615  502.4104
## [16,] 0.005457778 0.008100233 0.07944641 0.90699558 0.09300442  380.7352
## [17,] 0.003940754 0.005894004 0.06395594 0.92620930 0.07379070  287.0631
## [18,] 0.002845397 0.004282508 0.05120806 0.94166403 0.05833597  215.4728
## [19,] 0.002054501 0.003107996 0.04080798 0.95402952 0.04597048  161.1007
## [20,] 0.001483440 0.002253475 0.03238551 0.96387758 0.03612242  120.0290
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.735444969 0.189092923 0.05995198 0.01551012 0.98448988 5081.7485
##  [2,] 0.540879302 0.250312352 0.16540918 0.04339916 0.95660084 5271.9774
##  [3,] 0.397786962 0.249537253 0.25918135 0.09349443 0.90650557 5253.7957
##  [4,] 0.292550420 0.222023507 0.32239336 0.16303271 0.83696729 4985.6697
##  [5,] 0.215154734 0.185937460 0.35374118 0.24516663 0.75483337 4532.9464
##  [6,] 0.158234467 0.150072767 0.35884845 0.33284432 0.66715568 3980.2388
##  [7,] 0.116372742 0.118210055 0.34509563 0.42032158 0.57967842 3398.6308
##  [8,] 0.085585748 0.091549205 0.31933658 0.50352847 0.49647153 2837.4782
##  [9,] 0.062943608 0.070042805 0.28707952 0.57993407 0.42006593 2326.0891
## [10,] 0.046291560 0.053108946 0.25236509 0.64823440 0.35176560 1878.4637
## [11,] 0.034044895 0.039997834 0.21793935 0.70801793 0.29198207 1498.1921
## [12,] 0.025038146 0.029968702 0.18552039 0.75947276 0.24052724 1182.4754
## [13,] 0.018414179 0.022365369 0.15606467 0.80315579 0.19684421  925.0635
## [14,] 0.013542615 0.016639720 0.12999515 0.83982252 0.16017748  718.2342
## [15,] 0.009959848 0.012350096 0.10738121 0.87030884 0.12969116  554.0282
## [16,] 0.007324920 0.009149000 0.08807270 0.89545338 0.10454662  424.9562
## [17,] 0.005387076 0.006767522 0.07179551 0.91604990 0.08395010  324.3503
## [18,] 0.003961898 0.005000046 0.05821684 0.93282121 0.06717879  246.4919
## [19,] 0.002913758 0.003690735 0.04698801 0.94640750 0.05359250  186.6074
## [20,] 0.002142908 0.002722261 0.03777075 0.95736408 0.04263592  140.7923
## 
## , , 8
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.735597569 0.189335286 0.06239176 0.01267539 0.98732461 5109.6662
##  [2,] 0.541103784 0.251168828 0.16728399 0.04044340 0.95955660 5295.8759
##  [3,] 0.398034628 0.250886966 0.25772019 0.09335822 0.90664178 5247.0380
##  [4,] 0.292793305 0.223632351 0.31601770 0.16755664 0.83244336 4936.4399
##  [5,] 0.215378044 0.187599396 0.34207095 0.25495161 0.74504839 4441.9929
##  [6,] 0.158431565 0.151647031 0.34237820 0.34754320 0.65245680 3855.8248
##  [7,] 0.116541874 0.119617756 0.32482493 0.43901544 0.56098456 3252.0520
##  [8,] 0.085727920 0.092757749 0.29646545 0.52504888 0.47495112 2680.0332
##  [9,] 0.063061249 0.071049728 0.26279699 0.60309203 0.39690797 2167.4194
## [10,] 0.046387702 0.053929020 0.22772301 0.67196027 0.32803973 1725.8930
## [11,] 0.034122681 0.040654053 0.19379199 0.73143128 0.26856872 1356.6898
## [12,] 0.025100561 0.030486550 0.16250909 0.78190380 0.21809620 1054.9490
## [13,] 0.018463912 0.022769505 0.13463006 0.82413652 0.17586348  812.7836
## [14,] 0.013582008 0.016952299 0.11040410 0.85906160 0.14093840  621.2727
## [15,] 0.009990892 0.012590102 0.08975946 0.88765955 0.11234045  471.6492
## [16,] 0.007349276 0.009332186 0.07243772 0.91088081 0.08911919  355.9336
## [17,] 0.005406110 0.006906656 0.05808640 0.92960084 0.07039916  267.2085
## [18,] 0.003976721 0.005105295 0.04631973 0.94459825 0.05540175  199.6778
## [19,] 0.002925266 0.003770085 0.03675660 0.95654805 0.04345195  148.6048
## [20,] 0.002151819 0.002781918 0.02904220 0.96602406 0.03397594  110.1922
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.712263396 0.217406715 0.06322291 0.007106978 0.99289302 5148.8512
##  [2,] 0.507319145 0.283516709 0.17839044 0.030773704 0.96922630 5409.5094
##  [3,] 0.361344857 0.278085736 0.27898120 0.081588205 0.91841180 5415.1328
##  [4,] 0.257372715 0.243135781 0.34415458 0.155336922 0.84466308 5129.0539
##  [5,] 0.183317164 0.199847422 0.37346093 0.243374485 0.75662552 4634.8777
##  [6,] 0.130570106 0.158128287 0.37410015 0.337201453 0.66279855 4033.6671
##  [7,] 0.093000307 0.121970461 0.35489125 0.430137986 0.56986201 3407.2298
##  [8,] 0.066240714 0.092403574 0.32372181 0.517633901 0.48236610 2810.2851
##  [9,] 0.047180836 0.069087553 0.28672063 0.597010986 0.40298901 2273.7112
## [10,] 0.033605183 0.051144897 0.24822061 0.667029316 0.33297068 1810.8409
## [11,] 0.023935741 0.037574617 0.21103416 0.727455480 0.27254452 1423.5304
## [12,] 0.017048552 0.027441239 0.17680874 0.778701471 0.22129853 1106.9351
## [13,] 0.012143060 0.019946772 0.14635984 0.821550328 0.17844967  852.8722
## [14,] 0.008649057 0.014444901 0.11994438 0.856961663 0.14303834  651.9972
## [15,] 0.006160407 0.010429159 0.09746831 0.885942126 0.11405787  495.0970
## [16,] 0.004387832 0.007511510 0.07863578 0.909464873 0.09053513  373.7788
## [17,] 0.003125292 0.005399413 0.06305127 0.928424029 0.07157597  280.7683
## [18,] 0.002226031 0.003874946 0.05028606 0.943612962 0.05638704  209.9742
## [19,] 0.001585521 0.002777229 0.03991927 0.955717976 0.04428202  156.4229
## [20,] 0.001129308 0.001988325 0.03156098 0.965321386 0.03467861  116.1312
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.736360884 0.193658843 0.06135492 0.008625358 0.99137464 5123.9930
##  [2,] 0.542227352 0.255116878 0.16921258 0.033443190 0.96655681 5339.0080
##  [3,] 0.399275012 0.253227779 0.26321925 0.084277958 0.91572204 5314.8604
##  [4,] 0.294010501 0.224446245 0.32447667 0.157066580 0.84293342 5020.3424
##  [5,] 0.216497832 0.187339024 0.35257785 0.243585292 0.75641471 4533.7709
##  [6,] 0.159420535 0.150769041 0.35406878 0.335741644 0.66425836 3949.0396
##  [7,] 0.117391046 0.118468681 0.33699178 0.427148489 0.57285151 3342.1360
##  [8,] 0.086442175 0.091563074 0.30857229 0.513422457 0.48657754 2764.0147
##  [9,] 0.063652636 0.069937630 0.27445989 0.591949848 0.40805015 2243.5762
## [10,] 0.046871311 0.052960043 0.23868342 0.661485221 0.33851478 1793.4354
## [11,] 0.034514200 0.039846362 0.20389056 0.721748879 0.27825112 1415.4942
## [12,] 0.025414907 0.029834365 0.17166272 0.773088009 0.22691199 1105.3441
## [13,] 0.018714543 0.022255325 0.14281283 0.816217305 0.18378269  855.3840
## [14,] 0.013780658 0.016554384 0.11763155 0.852033407 0.14796659  656.8518
## [15,] 0.010147537 0.012286698 0.09607596 0.881489801 0.11851020  501.0469
## [16,] 0.007472250 0.009103623 0.07790638 0.905517747 0.09448225  379.9911
## [17,] 0.005502272 0.006736192 0.06278115 0.924980382 0.07501962  286.7259
## [18,] 0.004051658 0.004979232 0.05031943 0.940649680 0.05935032  215.3879
## [19,] 0.002983483 0.003677529 0.04014056 0.953198433 0.04680157  161.1602
## [20,] 0.002196920 0.002714390 0.03188711 0.963201579 0.03679842  120.1611</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.125630 7.935146 8.080529 8.277303 7.938999 8.127239 8.325660
##  [8] 8.052510 8.159654 8.211129</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 44798.20 44155.36 44352.75 46119.23 44266.35 45153.60 45748.23
##  [8] 44111.20 45740.67 45121.72</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.877465684 0.084108168 0.03201686 0.006409286 0.99359071 6887.1631
##  [2,] 0.769946027 0.142487827 0.07136560 0.016200545 0.98379945 6669.5609
##  [3,] 0.564051826 0.226795995 0.16263353 0.046518651 0.95348135 4939.9663
##  [4,] 0.413216577 0.239574242 0.24982627 0.097382908 0.90261709 4892.2496
##  [5,] 0.302716758 0.219552641 0.31030262 0.167427984 0.83257202 4629.9046
##  [6,] 0.221766116 0.187260281 0.34074349 0.250230115 0.74976988 4201.3944
##  [7,] 0.162462794 0.153031365 0.34576376 0.338742083 0.66125792 3681.3830
##  [8,] 0.119017999 0.121614291 0.33227944 0.427088270 0.57291173 3135.2513
##  [9,] 0.087190942 0.094794757 0.30695343 0.511060872 0.48893913 2609.1741
## [10,] 0.063874880 0.072865473 0.27522693 0.588032719 0.41196728 2130.7535
## [11,] 0.046793855 0.055431761 0.24112069 0.656653695 0.34334630 1713.1439
## [12,] 0.034280532 0.041839117 0.20737254 0.716507813 0.28349219 1359.5938
## [13,] 0.025113444 0.031388901 0.17569034 0.767807310 0.23219269 1067.2602
## [14,] 0.018397762 0.023437839 0.14701529 0.811149106 0.18885089  830.0245
## [15,] 0.013477947 0.017435822 0.12175137 0.847334865 0.15266514  640.3955
## [16,] 0.009873758 0.012932549 0.09994777 0.877245926 0.12275407  490.6980
## [17,] 0.007233378 0.009569765 0.08143528 0.901761574 0.09823843  373.7474
## [18,] 0.005299073 0.007067997 0.06592344 0.921709490 0.07829051  283.1808
## [19,] 0.003882028 0.005212299 0.05306666 0.937839016 0.06216098  213.5712
## [20,] 0.002843920 0.003839082 0.04250717 0.950809828 0.04919017  160.4148
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.852560854 0.105487114 0.03684208 0.005109953 0.99489005 6930.3170
##  [2,] 0.726860009 0.173095040 0.08492407 0.015120878 0.98487912 6759.8974
##  [3,] 0.523769640 0.248971733 0.18122404 0.046034591 0.95396541 5045.0951
##  [4,] 0.377424308 0.253816093 0.26812268 0.100636919 0.89936308 4973.2062
##  [5,] 0.271969005 0.227462161 0.32434530 0.176223534 0.82377647 4664.1628
##  [6,] 0.195978739 0.190597424 0.34848860 0.264935240 0.73506476 4184.0360
##  [7,] 0.141220747 0.153327892 0.34676638 0.358684980 0.64131502 3618.8428
##  [8,] 0.101762566 0.120060378 0.32715431 0.451022747 0.54897725 3039.2677
##  [9,] 0.073329310 0.092248229 0.29687868 0.537543776 0.46245622 2492.5429
## [10,] 0.052840527 0.069907296 0.26157505 0.615677131 0.38432287 2004.9050
## [11,] 0.038076471 0.052431273 0.22522095 0.684271308 0.31572869 1587.0812
## [12,] 0.027437607 0.039013296 0.19038017 0.743168925 0.25683107 1239.6911
## [13,] 0.019771325 0.028850371 0.15853146 0.792846839 0.20715316  957.5235
## [14,] 0.014247062 0.021231165 0.13038025 0.834141522 0.16585848  732.5490
## [15,] 0.010266322 0.015563617 0.10611565 0.868054414 0.13194559  555.8596
## [16,] 0.007397831 0.011373496 0.08560586 0.895622816 0.10437718  418.8095
## [17,] 0.005330819 0.008290564 0.06853824 0.917840378 0.08215962  313.6091
## [18,] 0.003841347 0.006030960 0.05451470 0.935612992 0.06438701  233.5675
## [19,] 0.002768044 0.004379907 0.04311337 0.949738676 0.05026132  173.1272
## [20,] 0.001994631 0.003176516 0.03392597 0.960902879 0.03909712  127.7858
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.842524661 0.112494925 0.03869328 0.00628713 0.99371287 6935.2826
##  [2,] 0.709847804 0.179747819 0.09202539 0.01837899 0.98162101 6780.5084
##  [3,] 0.522434776 0.239888148 0.18590395 0.05177313 0.94822687 5043.1451
##  [4,] 0.384502274 0.240008900 0.26752247 0.10796636 0.89203364 4937.7717
##  [5,] 0.282986520 0.214065253 0.31940572 0.18354251 0.81645749 4610.5945
##  [6,] 0.208272813 0.179618460 0.34116488 0.27094385 0.72905615 4128.1484
##  [7,] 0.153284915 0.145211934 0.33885467 0.36264848 0.63735152 3571.0846
##  [8,] 0.112814845 0.114549556 0.31991505 0.45272054 0.54727946 3004.4899
##  [9,] 0.083029627 0.088833447 0.29101853 0.53711839 0.46288161 2471.5298
## [10,] 0.061108261 0.068049636 0.25736261 0.61347949 0.38652051 1996.0718
## [11,] 0.044974543 0.051657831 0.22262945 0.68073817 0.31926183 1587.7963
## [12,] 0.033100427 0.038947806 0.18921219 0.73873958 0.26126042 1247.1341
## [13,] 0.024361298 0.029212507 0.15851210 0.78791410 0.21208590  969.1589
## [14,] 0.017929462 0.021822838 0.13121925 0.82902845 0.17097155  746.3306
## [15,] 0.013195751 0.016251679 0.10754425 0.86300832 0.13699168  570.2702
## [16,] 0.009711827 0.012073267 0.08739527 0.89081963 0.10918037  432.8123
## [17,] 0.007147724 0.008951949 0.07050590 0.91339443 0.08660557  326.5610
## [18,] 0.005260592 0.006627539 0.05652314 0.93158873 0.06841127  245.1251
## [19,] 0.003871698 0.004900787 0.04506513 0.94616239 0.05383761  183.1608
## [20,] 0.002849497 0.003620477 0.03575682 0.95777321 0.04222679  136.3077
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.788573173 0.150821127 0.05581414 0.004791561 0.99520844 7056.9967
##  [2,] 0.621847649 0.220095299 0.13811179 0.019945262 0.98005474 7037.6066
##  [3,] 0.454777363 0.247186418 0.23945047 0.058585750 0.94141425 5297.2012
##  [4,] 0.332593442 0.230922913 0.31550324 0.120980403 0.87901960 5121.3201
##  [5,] 0.243236376 0.198047085 0.35771348 0.201003055 0.79899694 4720.3100
##  [6,] 0.177886654 0.161800952 0.36977652 0.290535872 0.70946413 4180.9860
##  [7,] 0.130094282 0.128195755 0.35932617 0.382383789 0.61761621 3586.7686
##  [8,] 0.095142170 0.099491452 0.33416417 0.471202207 0.52879779 2999.2054
##  [9,] 0.069580556 0.076098383 0.30079515 0.553525914 0.44647409 2456.5835
## [10,] 0.050886518 0.057594042 0.26406867 0.627450767 0.37254923 1978.4787
## [11,] 0.037214962 0.043249172 0.22730343 0.692232433 0.30776757 1571.3953
## [12,] 0.027216509 0.032286019 0.19258055 0.747916919 0.25208308 1233.6588
## [13,] 0.019904316 0.023993630 0.16105929 0.795042761 0.20495724  959.0752
## [14,] 0.014556672 0.017769384 0.13325418 0.834419764 0.16558024  739.4222
## [15,] 0.010645767 0.013124479 0.10925506 0.866974690 0.13302531  566.0149
## [16,] 0.007785595 0.009673472 0.08889095 0.893649988 0.10635001  430.6044
## [17,] 0.005693858 0.007118210 0.07184600 0.915341927 0.08465807  325.8296
## [18,] 0.004164103 0.005231186 0.05773813 0.932866584 0.06713342  245.3875
## [19,] 0.003045344 0.003840513 0.04616952 0.946944622 0.05305538  184.0373
## [20,] 0.002227159 0.002817286 0.03675739 0.958198160 0.04180184  137.5168
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.890413553 0.079626372 0.02579459 0.004165486 0.99583451 6864.2915
##  [2,] 0.792836296 0.137402029 0.05892647 0.010835205 0.98916479 6633.0214
##  [3,] 0.572391590 0.240116136 0.15165656 0.035835711 0.96416429 4930.8175
##  [4,] 0.413240582 0.255337812 0.24813558 0.083286027 0.91671397 4943.7842
##  [5,] 0.298340824 0.232040342 0.31589437 0.153724463 0.84627554 4710.3350
##  [6,] 0.215388447 0.195272863 0.34947603 0.239862660 0.76013734 4278.3398
##  [7,] 0.155500620 0.157122987 0.35417534 0.333201055 0.66679895 3735.7085
##  [8,] 0.112264345 0.122828578 0.33827053 0.426636546 0.57336345 3160.4003
##  [9,] 0.081049729 0.094141363 0.30964619 0.515162720 0.48483728 2606.8008
## [10,] 0.058514202 0.071145102 0.27459419 0.595746510 0.40425349 2106.5774
## [11,] 0.042244581 0.053213224 0.23762483 0.666917366 0.33308263 1674.0685
## [12,] 0.030498658 0.039493662 0.20169137 0.728316314 0.27168369 1312.0580
## [13,] 0.022018638 0.029138712 0.16853751 0.780305143 0.21969486 1016.4884
## [14,] 0.015896451 0.021401074 0.13903787 0.823664610 0.17633539  779.8353
## [15,] 0.011476511 0.015662518 0.11348219 0.859378782 0.14062122  593.3094
## [16,] 0.008285517 0.011430916 0.09179273 0.888490837 0.11150916  448.1730
## [17,] 0.005981765 0.008324330 0.07368066 0.912013249 0.08798675  336.4439
## [18,] 0.004318561 0.006051518 0.05875297 0.930876949 0.06912305  251.2040
## [19,] 0.003117804 0.004393199 0.04658201 0.945906988 0.05409301  186.6700
## [20,] 0.002250912 0.003185815 0.03674793 0.957815339 0.04218466  138.1332
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.869066471 0.095240469 0.02873961 0.006953454 0.99304655 6867.2895
##  [2,] 0.755276531 0.159679700 0.06836995 0.016673819 0.98332618 6654.4246
##  [3,] 0.545342673 0.247140512 0.16176412 0.045752698 0.95424730 4943.6968
##  [4,] 0.393761250 0.256420071 0.25484643 0.094972253 0.90502775 4930.6682
##  [5,] 0.284312836 0.231260695 0.32005713 0.164369341 0.83563066 4689.5644
##  [6,] 0.205286296 0.194252548 0.35291060 0.247550560 0.75244944 4265.9794
##  [7,] 0.148225680 0.156387788 0.35829616 0.337090368 0.66290963 3739.6741
##  [8,] 0.107025421 0.122457584 0.34380046 0.426716533 0.57328347 3181.7669
##  [9,] 0.077277033 0.094061012 0.31672964 0.511932318 0.48806768 2642.6205
## [10,] 0.055797396 0.071252452 0.28300651 0.589943647 0.41005635 2152.2702
## [11,] 0.040288159 0.053420488 0.24696077 0.659330586 0.34066941 1724.9626
## [12,] 0.029089812 0.039738832 0.21149945 0.719671903 0.28032810 1364.1896
## [13,] 0.021004116 0.029383289 0.17840139 0.771211209 0.22878879 1066.8935
## [14,] 0.015165890 0.021624157 0.14861678 0.814593177 0.18540682  826.5465
## [15,] 0.010950436 0.015854962 0.12252398 0.850670625 0.14932938  635.2087
## [16,] 0.007906693 0.011590727 0.10013050 0.880372081 0.11962792  484.7965
## [17,] 0.005708978 0.008453435 0.08122102 0.904616568 0.09538343  367.7900
## [18,] 0.004122132 0.006153678 0.06546116 0.924263029 0.07573697  277.5701
## [19,] 0.002976359 0.004472753 0.05246693 0.940083959 0.05991604  208.5246
## [20,] 0.002149062 0.003246986 0.04184880 0.952755148 0.04724485  156.0235
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.854331618 0.104117695 0.03301056 0.008540131 0.99145987 6884.2958
##  [2,] 0.729882513 0.169466884 0.07981732 0.020833285 0.97916672 6694.3275
##  [3,] 0.536788422 0.237714372 0.17254229 0.052954911 0.94704509 4967.4818
##  [4,] 0.394778344 0.241352202 0.25940902 0.104460438 0.89553956 4911.8933
##  [5,] 0.290337747 0.216639267 0.31913197 0.173891018 0.82610898 4646.1911
##  [6,] 0.213527435 0.182351467 0.34895904 0.255162056 0.74483794 4219.0713
##  [7,] 0.157037678 0.147655387 0.35364750 0.341659439 0.65834056 3703.3325
##  [8,] 0.115492570 0.116561586 0.34006335 0.427882490 0.57211751 3162.3326
##  [9,] 0.084938430 0.090412963 0.31475885 0.509889757 0.49011024 2640.7756
## [10,] 0.062467541 0.069251942 0.28306901 0.585211504 0.41478850 2165.4596
## [11,] 0.045941439 0.052553654 0.24893836 0.652566545 0.34743346 1749.2768
## [12,] 0.033787400 0.039604946 0.21506273 0.711544920 0.28845508 1395.5710
## [13,] 0.024848773 0.029688872 0.18313690 0.762325450 0.23767455 1101.7859
## [14,] 0.018274905 0.022164933 0.15410940 0.805450766 0.19454923  862.1594
## [15,] 0.013440187 0.016495467 0.12840371 0.841660638 0.15833936  669.5496
## [16,] 0.009884518 0.012245862 0.10609407 0.871775552 0.12822445  516.5823
## [17,] 0.007269519 0.009073433 0.08703707 0.896619975 0.10338002  396.3088
## [18,] 0.005346331 0.006712590 0.07096585 0.916975226 0.08302477  302.5363
## [19,] 0.003931932 0.004960025 0.05755465 0.933553393 0.06644661  229.9493
## [20,] 0.002891720 0.003661524 0.04646114 0.946985612 0.05301439  174.1077
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.882127445 0.084407068 0.02781471 0.005650782 0.99434922 6867.5613
##  [2,] 0.778148829 0.143473901 0.06407613 0.014301135 0.98569886 6641.3046
##  [3,] 0.572404387 0.232121907 0.15304217 0.042431539 0.95756846 4908.2248
##  [4,] 0.421059276 0.245556837 0.24153086 0.091853025 0.90814698 4874.6285
##  [5,] 0.309730180 0.224841705 0.30329075 0.162137363 0.83786264 4618.2230
##  [6,] 0.227836767 0.191520853 0.33413030 0.246512082 0.75348792 4186.3354
##  [7,] 0.167596172 0.156323428 0.33879523 0.337285173 0.66271483 3657.9386
##  [8,] 0.123283337 0.124116619 0.32457977 0.428020270 0.57197973 3102.5747
##  [9,] 0.090686923 0.096692905 0.29848407 0.514136101 0.48586390 2569.0074
## [10,] 0.066709080 0.074314259 0.26616682 0.592809845 0.40719015 2085.9401
## [11,] 0.049071037 0.056548971 0.23175167 0.662628325 0.33737167 1666.6225
## [12,] 0.036096536 0.042710454 0.19799591 0.723197102 0.27680290 1313.8580
## [13,] 0.026552524 0.032075571 0.16657619 0.774795711 0.22520429 1024.1510
## [14,] 0.019531972 0.023983501 0.13837776 0.818106765 0.18189323  790.7231
## [15,] 0.014367671 0.017871973 0.11374160 0.854018755 0.14598125  605.5177
## [16,] 0.010568824 0.013282369 0.09265744 0.883491368 0.11650863  460.4235
## [17,] 0.007774401 0.009850728 0.07490549 0.907469376 0.09253062  347.9496
## [18,] 0.005718831 0.007293598 0.06015555 0.926832017 0.07316798  261.5383
## [19,] 0.004206758 0.005393181 0.04803300 0.942367058 0.05763294  195.6554
## [20,] 0.003094481 0.003983775 0.03816053 0.954761217 0.04523878  145.7540
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.834245040 0.125240379 0.03642050 0.004094081 0.99590592 6940.1715
##  [2,] 0.695964787 0.200272824 0.09007886 0.013683527 0.98631647 6804.8445
##  [3,] 0.495710242 0.269833084 0.19107354 0.043383129 0.95661687 5113.1812
##  [4,] 0.353076260 0.267463626 0.28253077 0.096929343 0.90307066 5062.5294
##  [5,] 0.251483296 0.235051745 0.34216689 0.171298065 0.82870194 4767.6163
##  [6,] 0.179122346 0.193782720 0.36840609 0.258688842 0.74131116 4294.6383
##  [7,] 0.127582291 0.153627088 0.36761078 0.351179841 0.64882016 3730.6840
##  [8,] 0.090872196 0.118656986 0.34799989 0.442470930 0.55752907 3147.7725
##  [9,] 0.064724939 0.089979924 0.31704474 0.528250398 0.47174960 2594.4497
## [10,] 0.046101205 0.067323646 0.28059425 0.605980897 0.39401910 2098.1207
## [11,] 0.032836201 0.049866260 0.24279952 0.674498024 0.32550198 1670.4839
## [12,] 0.023388024 0.036650711 0.20635961 0.733601654 0.26639835 1312.9194
## [13,] 0.016658433 0.026775375 0.17285527 0.783710919 0.21628908 1020.7765
## [14,] 0.011865192 0.019467885 0.14306615 0.825600769 0.17439923  786.4088
## [15,] 0.008451142 0.014101076 0.11723309 0.860214693 0.13978531  601.1443
## [16,] 0.006019439 0.010182648 0.09525814 0.888539771 0.11146023  456.4579
## [17,] 0.004287426 0.007334972 0.07684865 0.911528953 0.08847105  344.5947
## [18,] 0.003053777 0.005273106 0.06161599 0.930057130 0.06994287  258.8392
## [19,] 0.002175093 0.003784646 0.04914001 0.944900251 0.05509975  193.5704
## [20,] 0.001549239 0.002712713 0.03900870 0.956729350 0.04327065  144.2006
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.873145719 0.093182126 0.02952192 0.004150232 0.99584977 6890.1600
##  [2,] 0.762383446 0.155756976 0.06981021 0.012049364 0.98795064 6690.7122
##  [3,] 0.561389349 0.238135727 0.16194308 0.038531841 0.96146816 4972.9182
##  [4,] 0.413385157 0.247072770 0.25209614 0.087445934 0.91255407 4944.8694
##  [5,] 0.304400660 0.223602793 0.31449291 0.157503640 0.84249636 4687.7061
##  [6,] 0.224148739 0.188861132 0.34535852 0.241631605 0.75836840 4252.5797
##  [7,] 0.165054364 0.153135038 0.34971375 0.332096844 0.66790316 3720.0722
##  [8,] 0.121539577 0.120934345 0.33500900 0.422517078 0.57748292 3160.2679
##  [9,] 0.089496990 0.093799002 0.30832475 0.508379260 0.49162074 2622.0636
## [10,] 0.065902083 0.071828277 0.27535954 0.586910097 0.41308990 2134.2006
## [11,] 0.048527716 0.054494117 0.24025875 0.656719419 0.34328058 1709.9850
## [12,] 0.035733912 0.041058423 0.20579497 0.717412698 0.28258730 1352.3143
## [13,] 0.026313055 0.030774770 0.17365872 0.769253457 0.23074654 1057.8078
## [14,] 0.019375904 0.022975626 0.14474888 0.812899586 0.18710041  819.8002
## [15,] 0.014267658 0.017100951 0.11941948 0.849211908 0.15078809  630.3291
## [16,] 0.010506145 0.012698560 0.09767183 0.879123460 0.12087654  481.3499
## [17,] 0.007736314 0.009412360 0.07929561 0.903555715 0.09644428  365.4090
## [18,] 0.005696719 0.006966704 0.06396754 0.923369041 0.07663096  275.9600
## [19,] 0.004194841 0.005150813 0.05131736 0.939336989 0.06066301  207.4587
## [20,] 0.003088917 0.003804945 0.04096974 0.952136395 0.04786361  155.3329</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 9.162088 8.846810 8.855974 8.686008 9.107858 9.140477 9.180057
##  [8] 9.117195 8.974659 9.205765</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50908.83 50051.88 49923.28 50828.40 50706.46 51180.46 51392.99
##  [8] 50323.93 51343.40 51131.30</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1]  5895.687  6467.865  7183.663 11522.184  5509.742  5948.119  6606.718
##  [8]  5835.281  6874.477  6041.978</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi      ICER
##  [1,]     8.125630      9.162088       44798.20        50908.83  5895.687
##  [2,]     7.935146      8.846810       44155.36        50051.88  6467.865
##  [3,]     8.080529      8.855974       44352.75        49923.28  7183.663
##  [4,]     8.277303      8.686008       46119.23        50828.40 11522.184
##  [5,]     7.938999      9.107858       44266.35        50706.46  5509.742
##  [6,]     8.127239      9.140477       45153.60        51180.46  5948.119
##  [7,]     8.325660      9.180057       45748.23        51392.99  6606.718
##  [8,]     8.052510      9.117195       44111.20        50323.93  5835.281
##  [9,]     8.159654      8.974659       45740.67        51343.40  6874.477
## [10,]     8.211129      9.205765       45121.72        51131.30  6041.978</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
