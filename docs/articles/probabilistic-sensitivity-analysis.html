<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (HESIM)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="number-of-psa-simulations" class="section level1">
<h1 class="hasAnchor">
<a href="#number-of-psa-simulations" class="anchor"></a><span class="header-section-number">2</span> Number of PSA simulations</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="create-psa-samples-for-transition-matrix-monotherapy-based-on-dirichlet-distribution-using-rdirichlet_mat-function-from-hesim-package" class="section level1">
<h1 class="hasAnchor">
<a href="#create-psa-samples-for-transition-matrix-monotherapy-based-on-dirichlet-distribution-using-rdirichlet_mat-function-from-hesim-package" class="anchor"></a><span class="header-section-number">3</span> Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)

<span class="co">#Show first 10 PSA samples</span>
<span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7195363 0.2009563 0.07239559 0.007111829
## [2,] 0.0000000 0.5858988 0.40243457 0.011666652
## [3,] 0.0000000 0.0000000 0.74841429 0.251585715
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7133009 0.2166574 0.05803719 0.01200449
## [2,] 0.0000000 0.5948310 0.38996842 0.01520062
## [3,] 0.0000000 0.0000000 0.72555704 0.27444296
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7394531 0.1881468 0.06347553 0.008924618
## [2,] 0.0000000 0.5946335 0.39581812 0.009548384
## [3,] 0.0000000 0.0000000 0.76096445 0.239035551
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7198531 0.1990423 0.07089003 0.01021463
## [2,] 0.0000000 0.5661889 0.41391099 0.01990013
## [3,] 0.0000000 0.0000000 0.75500543 0.24499457
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7304582 0.1847847 0.06690581 0.01785127
## [2,] 0.0000000 0.5991386 0.38920223 0.01165914
## [3,] 0.0000000 0.0000000 0.74574194 0.25425806
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7326553 0.1899745 0.06798643 0.009383724
## [2,] 0.0000000 0.5817776 0.40572250 0.012499951
## [3,] 0.0000000 0.0000000 0.75841721 0.241582786
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7227859 0.1978720 0.06553695 0.01380514
## [2,] 0.0000000 0.6027313 0.38399881 0.01326984
## [3,] 0.0000000 0.0000000 0.74943326 0.25056674
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7255595 0.2031484 0.06399522 0.007296901
## [2,] 0.0000000 0.5986934 0.39112886 0.010177702
## [3,] 0.0000000 0.0000000 0.73881670 0.261183300
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7211028 0.2046847 0.06513285 0.009079661
## [2,] 0.0000000 0.6119205 0.37862281 0.009456736
## [3,] 0.0000000 0.0000000 0.77733427 0.222665729
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7092792 0.2134069 0.06596783 0.01134608
## [2,] 0.0000000 0.5384401 0.44589921 0.01566068
## [3,] 0.0000000 0.0000000 0.73599716 0.26400284
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000</code></pre>
</div>
<div id="create-psa-samples-for-relative-risk-according-to-normal-distribution-of-log-transformed-relative-risk" class="section level1">
<h1 class="hasAnchor">
<a href="#create-psa-samples-for-relative-risk-according-to-normal-distribution-of-log-transformed-relative-risk" class="anchor"></a><span class="header-section-number">4</span> Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )

<span class="co">#Show first 10 PSA samples</span>
RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.4947526 0.5341266 0.6494186 0.4911300 0.3872494 0.4469611 0.5011076
##  [8] 0.5629246 0.4802675 0.4314884</code></pre>
</div>
<div id="create-psa-samples-for-transition-matrix-for-combination-therapy" class="section level1">
<h1 class="hasAnchor">
<a href="#create-psa-samples-for-transition-matrix-for-combination-therapy" class="anchor"></a><span class="header-section-number">5</span> Create PSA samples for transition matrix for combination therapy</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}

<span class="co">#Show first 10 PSA samples</span>
<span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8612398 0.09942366 0.03581791 0.003518596
## [2,] 0.0000000 0.79512234 0.19910555 0.005772107
## [3,] 0.0000000 0.00000000 0.87552731 0.124472689
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8468664 0.1157225 0.03099921 0.006411915
## [2,] 0.0000000 0.7835884 0.20829251 0.008119056
## [3,] 0.0000000 0.0000000 0.85341271 0.146587286
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.830796 0.1221860 0.04122219 0.005795812
## [2,] 0.000000 0.7367475 0.25705163 0.006200898
## [3,] 0.000000 0.0000000 0.84476588 0.155234122
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8624114 0.09775562 0.03481622 0.005016712
## [2,] 0.0000000 0.78694234 0.20328410 0.009773553
## [3,] 0.0000000 0.00000000 0.87967582 0.120324181
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8956201 0.07155776 0.02590924 0.006912893
## [2,] 0.0000000 0.84476667 0.15071834 0.004514996
## [3,] 0.0000000 0.00000000 0.90153871 0.098461286
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8805073 0.08491121 0.03038729 0.004194159
## [2,] 0.0000000 0.81307084 0.18134217 0.005586992
## [3,] 0.0000000 0.00000000 0.89202189 0.107978106
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]       [,2]       [,3]       [,4]
## [1,] 0.8610859 0.09915515 0.03284106 0.00691786
## [2,] 0.0000000 0.80092566 0.19242472 0.00664962
## [3,] 0.0000000 0.00000000 0.87443911 0.12556089
## [4,] 0.0000000 0.00000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8455107 0.1143572 0.03602449 0.004107605
## [2,] 0.0000000 0.7740947 0.22017606 0.005729279
## [3,] 0.0000000 0.0000000 0.85297349 0.147026510
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8660547 0.09830343 0.03128119 0.004360666
## [2,] 0.0000000 0.81361801 0.18184023 0.004541763
## [3,] 0.0000000 0.00000000 0.89306089 0.106939110
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8745574 0.0920826 0.02846435 0.004895701
## [2,] 0.0000000 0.8008423 0.19240034 0.006757401
## [3,] 0.0000000 0.0000000 0.88608584 0.113914164
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="parameters-for-which-no-uncertainty-is-propagated" class="section level1">
<h1 class="hasAnchor">
<a href="#parameters-for-which-no-uncertainty-is-propagated" class="anchor"></a><span class="header-section-number">6</span> Parameters for which no uncertainty is propagated</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
<div id="model-simulation-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-simulation-settings" class="anchor"></a><span class="header-section-number">7</span> Model simulation settings</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># discount rates</span>
discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span>

<span class="co"># define starting distribution</span>
initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define duration of follow-up</span>
follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
</div>
<div id="monotherapy-results" class="section level1">
<h1 class="hasAnchor">
<a href="#monotherapy-results" class="anchor"></a><span class="header-section-number">8</span> Monotherapy results</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data format</span>
trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)

Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)

<span class="co"># Trace and expected LY and cost by PSA sample</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}

<span class="co"># Presentation of results for first 10 PSA samples</span>
trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.719536262 0.200956317 0.07239559 0.007111829 0.99288817 5198.3273
##  [2,] 0.517732432 0.262335418 0.18714492 0.032787232 0.96721277 5443.6127
##  [3,] 0.372527259 0.257743604 0.28311632 0.086612821 0.91338718 5410.5430
##  [4,] 0.268046872 0.225873368 0.34258256 0.163497197 0.83650280 5084.6847
##  [5,] 0.192869444 0.186204643 0.36669835 0.254227566 0.74577243 4559.4453
##  [6,] 0.138776559 0.147855406 0.36334036 0.350027671 0.64997233 3938.5909
##  [7,] 0.099854766 0.114516328 0.34147806 0.444150849 0.55584915 3303.0865
##  [8,] 0.071849125 0.087161423 0.30888143 0.532108022 0.46789198 2705.3932
##  [9,] 0.051698051 0.065506307 0.27144960 0.611346038 0.38865396 2173.8687
## [10,] 0.037198622 0.048769115 0.23326147 0.680770788 0.31922921 1719.6063
## [11,] 0.026765758 0.036049063 0.19689561 0.740289565 0.25971043 1342.7010
## [12,] 0.019258933 0.026499850 0.16380460 0.790436615 0.20956339 1037.0402
## [13,] 0.013857501 0.019396434 0.13465242 0.832093643 0.16790636  793.6011
## [14,] 0.009970974 0.014149099 0.10958481 0.866295113 0.13370489  602.5348
## [15,] 0.007174478 0.010293670 0.08843078 0.894101071 0.10589893  454.3695
## [16,] 0.005162297 0.007472805 0.07084479 0.916520108 0.08347989  340.6223
## [17,] 0.003714460 0.005415704 0.05640230 0.934467541 0.06553246  254.0371
## [18,] 0.002672688 0.003919498 0.04466066 0.948747153 0.05125285  188.6044
## [19,] 0.001923096 0.002833523 0.03519551 0.960047872 0.03995213  139.4649
## [20,] 0.001383738 0.002046616 0.02762035 0.968949294 0.03105071  102.7614
## 
## , , 2
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.713300947 0.216657381 0.05803719 0.01200449 0.98799551 5094.80231
##  [2,] 0.508798241 0.283416433 0.16799681 0.03978852 0.96021148 5311.27081
##  [3,] 0.362926267 0.278819762 0.26194394 0.09631003 0.90368997 5263.67199
##  [4,] 0.258875650 0.244481280 0.31984940 0.17679367 0.82320633 4923.46860
##  [5,] 0.184656246 0.201512354 0.34243338 0.27139802 0.72860198 4384.89678
##  [6,] 0.131715475 0.159872925 0.33775533 0.37065627 0.62934373 3755.14666
##  [7,] 0.093952773 0.123634495 0.31505055 0.46736218 0.53263782 3117.30595
##  [8,] 0.067016602 0.093897187 0.28225345 0.55683276 0.44316724 2524.11996
##  [9,] 0.047803006 0.070372595 0.24529737 0.63652703 0.36347297 2002.92940
## [10,] 0.034097929 0.052216672 0.20819468 0.70549072 0.29450928 1563.19310
## [11,] 0.024322085 0.038447661 0.17339891 0.76383134 0.23616866 1203.27235
## [12,] 0.017348966 0.028139418 0.14221576 0.81229585 0.18770415  915.52823
## [13,] 0.012375034 0.020496979 0.11516602 0.85196197 0.14803803  689.75284
## [14,] 0.008827124 0.014873380 0.09227090 0.88402859 0.11597141  515.27531
## [15,] 0.006296396 0.010759608 0.07326025 0.90968374 0.09031626  382.12580
## [16,] 0.004491225 0.007764309 0.05771583 0.93002864 0.06997136  281.58136
## [17,] 0.003203595 0.005591508 0.04516462 0.94604028 0.05395972  206.33465
## [18,] 0.002285127 0.004020085 0.03513594 0.95855884 0.04144116  150.45147
## [19,] 0.001629984 0.002886361 0.02719346 0.96829020 0.03170980  109.22392
## [20,] 0.001162669 0.002070045 0.02095060 0.97581669 0.02418331   78.98441
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.739453076 0.188146773 0.06347553 0.008924618 0.99107538 5133.5382
##  [2,] 0.546790852 0.251004083 0.16971170 0.032493361 0.96750664 5344.9568
##  [3,] 0.404326178 0.252132370 0.26320438 0.080337074 0.91966293 5331.1668
##  [4,] 0.298980236 0.225999019 0.32575255 0.149268191 0.85073181 5058.1191
##  [5,] 0.221081855 0.190638753 0.35631855 0.231960842 0.76803916 4595.7016
##  [6,] 0.163479658 0.154956026 0.36063731 0.320927006 0.67907299 4031.4326
##  [7,] 0.120885536 0.122900214 0.34614353 0.410070717 0.58992928 3438.2294
##  [8,] 0.089389181 0.095824808 0.31972233 0.495063683 0.50493632 2866.5203
##  [9,] 0.066099105 0.073798927 0.28690055 0.573201422 0.42679858 2346.1457
## [10,] 0.048877187 0.056319647 0.25172774 0.643075422 0.35692458 1891.2714
## [11,] 0.036142386 0.042685634 0.21695071 0.704221274 0.29577873 1505.4238
## [12,] 0.026725599 0.032182381 0.18428168 0.756810341 0.24318966 1185.6136
## [13,] 0.019762326 0.024165057 0.15466660 0.801406019 0.19859398  925.3456
## [14,] 0.014613313 0.018087570 0.12851517 0.838783943 0.16121606  716.6443
## [15,] 0.010805859 0.013504923 0.10588245 0.869806764 0.13019324  551.3162
## [16,] 0.007990426 0.010063567 0.08660418 0.895341823 0.10465818  421.6703
## [17,] 0.005908545 0.007487507 0.07039324 0.916210704 0.08378930  320.8736
## [18,] 0.004369092 0.005563996 0.05690550 0.933161417 0.06683858  243.0785
## [19,] 0.003230738 0.004130569 0.04578272 0.946855973 0.05314403  183.4141
## [20,] 0.002388979 0.003064028 0.03667905 0.957867944 0.04213206  137.9051
## 
## , , 4
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.719853085 0.199042256 0.07089003 0.01021463 0.98978537 5174.1789
##  [2,] 0.518188464 0.255976693 0.18693854 0.03889631 0.96110369 5413.4193
##  [3,] 0.373019565 0.248072557 0.28382557 0.09508231 0.90491769 5376.0645
##  [4,] 0.268519284 0.214702577 0.34341317 0.17336497 0.82663503 5046.8315
##  [5,] 0.193294435 0.175008895 0.36718191 0.26451476 0.73548524 4520.5304
##  [6,] 0.139143596 0.137561850 0.36336509 0.35992947 0.64007053 3901.4127
##  [7,] 0.100162947 0.105581444 0.34114487 0.45311074 0.54688926 3269.9457
##  [8,] 0.072102606 0.079715698 0.30836810 0.53981359 0.46018641 2677.6600
##  [9,] 0.051903283 0.059485607 0.27092615 0.61768496 0.38231504 2151.9895
## [10,] 0.037362739 0.044011035 0.23285189 0.68577434 0.31422566 1703.3254
## [11,] 0.026895683 0.032355322 0.19666974 0.74407926 0.25592074 1331.3315
## [12,] 0.019360940 0.023672601 0.16378558 0.79318088 0.20681912 1029.6998
## [13,] 0.013937033 0.017256809 0.13482985 0.83397631 0.16602369  789.3808
## [14,] 0.010032616 0.012544671 0.10992805 0.86749466 0.13250534  600.6028
## [15,] 0.007222009 0.009099568 0.08889986 0.89477856 0.10522144  454.0225
## [16,] 0.005198786 0.006589559 0.07139826 0.91681340 0.08318660  341.3001
## [17,] 0.003742362 0.004765713 0.05700211 0.93448982 0.06551018  255.3164
## [18,] 0.002693951 0.003443182 0.04527478 0.94858809 0.05141191  190.1804
## [19,] 0.001939249 0.002485701 0.03579885 0.95977620 0.04022380  141.1294
## [20,] 0.001395974 0.001793369 0.02819466 0.96861600 0.03138400  104.3806
## 
## , , 5
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.730458249 0.184784674 0.06690581 0.01785127 0.98214873 5110.4351
##  [2,] 0.533569253 0.245689126 0.17068498 0.05005664 0.94994336 5270.2836
##  [3,] 0.389750063 0.245797266 0.25860859 0.10584409 0.89415591 5197.6624
##  [4,] 0.284696148 0.219286475 0.31459666 0.18142072 0.81857928 4873.1033
##  [5,] 0.207958650 0.183990482 0.33900253 0.26904833 0.73095167 4373.8341
##  [6,] 0.151905111 0.148663376 0.33833156 0.36109996 0.63890004 3789.2600
##  [7,] 0.110960342 0.117139708 0.32033148 0.45156847 0.54843153 3190.8574
##  [8,] 0.081051897 0.090686694 0.29189955 0.53636186 0.46363814 2626.0105
##  [9,] 0.059205027 0.069311050 0.25840004 0.61308388 0.38691612 2121.0743
## [10,] 0.043246800 0.052467109 0.22363692 0.68064917 0.31935083 1686.9647
## [11,] 0.031589982 0.039426417 0.19008921 0.73889439 0.26110561 1324.5143
## [12,] 0.023075163 0.029459234 0.15921590 0.78824970 0.21175030 1028.6916
## [13,] 0.016855443 0.021914101 0.13174344 0.82948702 0.17051298  791.5771
## [14,] 0.012312197 0.016244212 0.10790335 0.86354024 0.13645976  604.2939
## [15,] 0.008993546 0.012007640 0.08761410 0.89138472 0.10861528  458.1567
## [16,] 0.006569410 0.008856111 0.07061263 0.91396185 0.08603815  345.2817
## [17,] 0.004798680 0.006519964 0.05654515 0.93213621 0.06786379  258.8484
## [18,] 0.003505235 0.004793085 0.04502673 0.94667495 0.05332505  193.1512
## [19,] 0.002560428 0.003519436 0.03567832 0.95824181 0.04175819  143.5344
## [20,] 0.001870286 0.002581758 0.02814790 0.96740006 0.03259994  106.2708
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.732655345 0.189974506 0.06798643 0.009383724 0.99061628 5158.4698
##  [2,] 0.536783854 0.249708740 0.17844962 0.035057781 0.96494222 5381.7386
##  [3,] 0.393277560 0.247250187 0.27314574 0.086326517 0.91367348 5356.8150
##  [4,] 0.288136906 0.218557319 0.33421093 0.159094848 0.84090515 5059.0721
##  [5,] 0.211105044 0.181890408 0.36173434 0.245270207 0.75472979 4568.9985
##  [6,] 0.154667239 0.145924333 0.36249486 0.336913569 0.66308643 3981.0010
##  [7,] 0.113317779 0.114278334 0.34464240 0.427761489 0.57223851 3371.0646
##  [8,] 0.083022877 0.088012058 0.31545209 0.513512976 0.48648702 2790.0515
##  [9,] 0.060827154 0.066975670 0.28059720 0.591599980 0.40840002 2266.8075
## [10,] 0.044565340 0.050520550 0.24411870 0.660795410 0.33920459 1813.9432
## [11,] 0.032651034 0.037858000 0.20867099 0.720819979 0.27918002 1433.3891
## [12,] 0.023921955 0.028227799 0.17583934 0.772010909 0.22798909 1120.7773
## [13,] 0.017526548 0.020966861 0.14643860 0.815067989 0.18493201  868.5438
## [14,] 0.012840919 0.015527647 0.12075985 0.850871583 0.14912842  667.9534
## [15,] 0.009407968 0.011473083 0.09875927 0.880359675 0.11964033  510.3192
## [16,] 0.006892798 0.008462056 0.08019524 0.904449910 0.09555009  387.6646
## [17,] 0.005050045 0.006232490 0.06472331 0.923994154 0.07600585  293.0227
## [18,] 0.003699943 0.004585303 0.05195927 0.939755485 0.06024451  220.5153
## [19,] 0.002710783 0.003370521 0.04151871 0.952399986 0.04760001  165.3060
## [20,] 0.001986070 0.002475873 0.03304030 0.962497760 0.03750224  123.4915
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.722785930 0.197871979 0.06553695 0.01380514 0.98619486 5125.2326
##  [2,] 0.522419501 0.262282727 0.17246736 0.04283041 0.95716959 5316.9463
##  [3,] 0.377597465 0.261458202 0.26420682 0.09673752 0.90326248 5269.4269
##  [4,] 0.272922135 0.232305012 0.32315160 0.17162125 0.82837875 4957.5887
##  [5,] 0.197264279 0.194021156 0.34927189 0.25944267 0.74055733 4460.1557
##  [6,] 0.142579846 0.155975706 0.34918797 0.35225648 0.64774352 3870.0104
##  [7,] 0.103054706 0.122224003 0.33093181 0.44378948 0.55621052 3261.9700
##  [8,] 0.074486492 0.094059877 0.30169907 0.52975456 0.47024544 2685.9387
##  [9,] 0.053837788 0.071431626 0.26710382 0.60762677 0.39237323 2169.9096
## [10,] 0.038913196 0.053707070 0.23113451 0.67624522 0.32375478 1725.7194
## [11,] 0.028125911 0.040070766 0.19639359 0.73540973 0.26459027 1354.6155
## [12,] 0.020329012 0.029717236 0.16441430 0.78553945 0.21446055 1051.6590
## [13,] 0.014693524 0.021934052 0.13596123 0.82741119 0.17258881  808.8402
## [14,] 0.010620273 0.016127777 0.11127949 0.86197246 0.13802754  617.1039
## [15,] 0.007676184 0.011822171 0.09028562 0.89021603 0.10978397  467.5569
## [16,] 0.005548237 0.008644495 0.07270582 0.91310145 0.08689855  352.1127
## [17,] 0.004010188 0.006308149 0.05817125 0.93151041 0.06848959  263.7699
## [18,] 0.002898507 0.004595623 0.04628061 0.94622526 0.05377474  196.6698
## [19,] 0.002095000 0.003343459 0.03663890 0.95792264 0.04207736  146.0328
## [20,] 0.001514237 0.002429750 0.02887959 0.96717642 0.03282358  108.0339
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.725559457 0.203148420 0.06399522 0.007296901 0.99270310 5148.5221
##  [2,] 0.526436525 0.269019884 0.17317029 0.031373304 0.96862670 5373.9624
##  [3,] 0.381960999 0.268005188 0.26685196 0.083181851 0.91681815 5342.2319
##  [4,] 0.277135415 0.238047722 0.32642293 0.158393935 0.84160606 5027.8753
##  [5,] 0.201078221 0.198817231 0.35200939 0.248095162 0.75190484 4516.6896
##  [6,] 0.145894205 0.159879295 0.35070161 0.343524885 0.65647511 3908.4816
##  [7,] 0.105854920 0.125356863 0.33097415 0.437814070 0.56218593 3282.7678
##  [8,] 0.076804038 0.096554591 0.30033412 0.526307248 0.47369275 2691.9367
##  [9,] 0.055725896 0.073409219 0.26457224 0.606292641 0.39370736 2164.8645
## [10,] 0.040432451 0.055270246 0.22774905 0.676548256 0.32345174 1713.3089
## [11,] 0.029336147 0.041303722 0.19247007 0.736890059 0.26310994 1337.9622
## [12,] 0.021285119 0.030687860 0.16023255 0.787794468 0.21220553 1033.1695
## [13,] 0.015443619 0.022696659 0.13174754 0.830112182 0.16988782  790.2222
## [14,] 0.011205264 0.016725687 0.10720292 0.864866130 0.13513387  599.4683
## [15,] 0.008130085 0.012289891 0.08646229 0.893117735 0.10688227  451.5471
## [16,] 0.005898860 0.009009491 0.06920700 0.915884648 0.08411535  338.0305
## [17,] 0.004279974 0.006592267 0.05503266 0.934095100 0.06590490  251.6832
## [18,] 0.003105376 0.004816217 0.04351137 0.948567036 0.05143296  186.4981
## [19,] 0.002253135 0.003514290 0.03422942 0.960003157 0.03999684  137.6099
## [20,] 0.001634783 0.002561703 0.02680800 0.968995518 0.03100448  101.1531
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.721102752 0.204684740 0.06513285 0.009079661 0.99092034 5147.1935
##  [2,] 0.519989179 0.272849508 0.17509578 0.032065533 0.96793447 5382.5821
##  [3,] 0.374965628 0.273396044 0.27328337 0.078354954 0.92164505 5397.7283
##  [4,] 0.270388746 0.244046373 0.34036909 0.145195791 0.85480421 5150.9608
##  [5,] 0.194978069 0.204681417 0.37459327 0.225747243 0.77425276 4707.5446
##  [6,] 0.140599222 0.165157781 0.38138072 0.312862280 0.68713772 4153.5914
##  [7,] 0.101386486 0.129841939 0.36815043 0.400621142 0.59937886 3562.7208
##  [8,] 0.073110074 0.100205205 0.34194066 0.484744062 0.51525594 2987.0665
##  [9,] 0.052719875 0.076282131 0.30850404 0.562493957 0.43750604 2458.4169
## [10,] 0.038016447 0.057469550 0.27212671 0.632387292 0.36761271 1992.7085
## [11,] 0.027413765 0.042948180 0.23576882 0.693869235 0.30613076 1594.8839
## [12,] 0.019768141 0.031892049 0.20131788 0.747021929 0.25297807 1262.9829
## [13,] 0.014254861 0.023561634 0.16985390 0.792329604 0.20767040  991.1931
## [14,] 0.010279220 0.017335598 0.14188269 0.830502492 0.16949751  771.9437
## [15,] 0.007412373 0.012712006 0.11752345 0.862352175 0.13764783  597.2402
## [16,] 0.005345083 0.009295936 0.09665085 0.888708134 0.11129187  459.4479
## [17,] 0.003854354 0.006782431 0.07899781 0.910365406 0.08963459  351.6982
## [18,] 0.002779385 0.004939235 0.06422673 0.928054647 0.07194535  268.0537
## [19,] 0.002004222 0.003591317 0.05197678 0.942427684 0.05757232  203.5262
## [20,] 0.001445250 0.002607834 0.04189363 0.954053291 0.04594671  154.0143
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.709279205 0.213406888 0.06596783 0.01134608 0.98865392 5143.78979
##  [2,] 0.503076991 0.266271895 0.19049971 0.04015141 0.95984859 5430.32037
##  [3,] 0.356822048 0.250731563 0.29212457 0.10032182 0.89967818 5398.13670
##  [4,] 0.253086459 0.211152212 0.35034263 0.18541870 0.81458130 5032.24641
##  [5,] 0.179508962 0.167703213 0.36869935 0.28408847 0.71591153 4452.37225
##  [6,] 0.127321974 0.128606585 0.35798222 0.38608922 0.61391078 3782.98836
##  [7,] 0.090306828 0.096418330 0.32921863 0.48405622 0.51594378 3114.95891
##  [8,] 0.064052756 0.071187595 0.29125418 0.57350547 0.42649453 2502.54393
##  [9,] 0.045431288 0.051999556 0.25033016 0.65223900 0.34776100 1971.51586
## [10,] 0.032223467 0.037693996 0.21042585 0.71965669 0.28034331 1528.76073
## [11,] 0.022855435 0.027172669 0.17380626 0.77616563 0.22383437 1170.14694
## [12,] 0.016210885 0.019508362 0.14154491 0.82273584 0.17726416  886.05635
## [13,] 0.011498044 0.013963599 0.11394481 0.86059355 0.13940645  664.89546
## [14,] 0.008155323 0.009972324 0.09084792 0.89102444 0.10897556  495.12280
## [15,] 0.005784401 0.007109901 0.07184845 0.91525725 0.08474275  366.28536
## [16,] 0.004102755 0.005062687 0.05643214 0.93440242 0.06559758  269.44067
## [17,] 0.002909999 0.003601510 0.04406199 0.94942650 0.05057350  197.22590
## [18,] 0.002064002 0.002560211 0.03422738 0.96114841 0.03885159  143.74327
## [19,] 0.001463954 0.001818993 0.02646901 0.97024805 0.02975195  104.36527
## [20,] 0.001038352 0.001291836 0.02038877 0.97728104 0.02271896   75.51906</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7.985412 7.666300 8.434211 7.899821 7.903045 8.212056 7.989405
##  [8] 8.040846 8.566763 7.504844</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 44792.90 42473.34 46228.37 44472.70 43493.81 45538.94 44209.29
##  [8] 44397.98 47595.50 42730.43</code></pre>
</div>
<div id="combination-therapy-results" class="section level1">
<h1 class="hasAnchor">
<a href="#combination-therapy-results" class="anchor"></a><span class="header-section-number">9</span> Combination therapy results</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data format</span>
trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)

Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)

<span class="co"># Trace and expected LY and cost by PSA sample</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}

<span class="co"># Presentation of results for first 10 PSA samples</span>
trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.861239834 0.099423662 0.03581791 0.003518596 0.99648140 6933.2747
##  [2,] 0.741734051 0.164681593 0.08200317 0.011581186 0.98841881 6763.8643
##  [3,] 0.533704547 0.245542887 0.18134418 0.039408381 0.96059162 5072.8801
##  [4,] 0.384019774 0.251114578 0.27317338 0.091692267 0.90830773 5033.2466
##  [5,] 0.276316153 0.224298924 0.33330539 0.166079536 0.83392046 4743.4754
##  [6,] 0.198819492 0.186943942 0.35972022 0.254516341 0.74548366 4269.7425
##  [7,] 0.143057834 0.149484260 0.35884611 0.348611791 0.65138821 3702.0289
##  [8,] 0.102935299 0.116331021 0.33907995 0.441653731 0.55834627 3114.9380
##  [9,] 0.074065680 0.088843702 0.30803996 0.529050654 0.47094935 2558.5489
## [10,] 0.053292943 0.066937383 0.27165731 0.608112360 0.39188764 2060.8708
## [11,] 0.038346205 0.049928084 0.23410831 0.677617405 0.32238259 1633.6017
## [12,] 0.027591485 0.036958716 0.19807888 0.737370916 0.26262908 1277.8105
## [13,] 0.019853074 0.027198750 0.16511603 0.787832144 0.21216786  988.4271
## [14,] 0.014285007 0.019925315 0.13595819 0.829831489 0.17016851  757.3965
## [15,] 0.010278580 0.014544880 0.11080586 0.864370682 0.13562932  575.7051
## [16,] 0.007395811 0.010587373 0.08952617 0.892490642 0.10750936  434.5714
## [17,] 0.005321554 0.007689364 0.07179882 0.915190266 0.08480973  326.0664
## [18,] 0.003829051 0.005574589 0.05721498 0.933381377 0.06661862  243.3695
## [19,] 0.002755141 0.004035617 0.04534112 0.947868118 0.05213188  180.8084
## [20,] 0.001982424 0.002918126 0.03575748 0.959341973 0.04065803  133.7818
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.846866407 0.115722473 0.03099921 0.006411915 0.99358808 6889.9723
##  [2,] 0.717182711 0.188680265 0.07681143 0.017325598 0.98267440 6704.8968
##  [3,] 0.511567107 0.267615791 0.17093368 0.049883419 0.95011658 4979.4525
##  [4,] 0.364901302 0.270020946 0.25807376 0.107003991 0.89299601 4901.8615
##  [5,] 0.260284444 0.239675378 0.31372472 0.186315455 0.81368454 4579.2916
##  [6,] 0.185661141 0.198958880 0.33619719 0.279182791 0.72081721 4081.0548
##  [7,] 0.132432267 0.158571757 0.33229317 0.376702806 0.62329719 3499.3842
##  [8,] 0.094464062 0.123015818 0.31062162 0.471898496 0.52810150 2909.0423
##  [9,] 0.067381305 0.093639953 0.27882842 0.560150322 0.43984968 2358.6427
## [10,] 0.048063148 0.070298600 0.24273317 0.638905082 0.36109492 1873.9088
## [11,] 0.034283489 0.052229019 0.20632045 0.707167046 0.29283295 1464.0953
## [12,] 0.024454445 0.038495208 0.17205464 0.764995708 0.23500429 1128.0806
## [13,] 0.017443379 0.028196378 0.14126664 0.813093606 0.18690639  859.0494
## [14,] 0.012442379 0.020551315 0.11450507 0.852501241 0.14749876  647.6892
## [15,] 0.008875161 0.014920292 0.09181644 0.884388107 0.11561189  484.1740
## [16,] 0.006330660 0.010797920 0.07295160 0.909919822 0.09008018  359.2732
## [17,] 0.004515666 0.007794522 0.05750881 0.930181005 0.06981899  264.8807
## [18,] 0.003221029 0.005614775 0.04502761 0.946136582 0.05386342  194.1879
## [19,] 0.002297563 0.004037702 0.03504663 0.958618108 0.04138189  141.6539
## [20,] 0.001638854 0.002899534 0.02713625 0.968325365 0.03167464  102.8759
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.830795994 0.122186005 0.04122219 0.005795812 0.99420419 6956.2028
##  [2,] 0.690221983 0.191531874 0.10047844 0.017767703 0.98223230 6834.5144
##  [3,] 0.510386769 0.243754307 0.19608451 0.049774410 0.95022559 5105.9861
##  [4,] 0.377407066 0.240972099 0.27809279 0.103528047 0.89647195 5008.0324
##  [5,] 0.279074816 0.214298004 0.33095596 0.175671217 0.82432878 4694.2079
##  [6,] 0.206362731 0.179935798 0.35438318 0.259318294 0.74068171 4227.7202
##  [7,] 0.152595557 0.145822335 0.35399383 0.347588277 0.65241172 3684.5624
##  [8,] 0.112837254 0.115421206 0.33678193 0.434959612 0.56504039 3126.8989
##  [9,] 0.083437854 0.089863281 0.30912728 0.517571581 0.48242842 2596.9538
## [10,] 0.061698378 0.069134280 0.27610065 0.593066692 0.40693331 2119.0362
## [11,] 0.045623056 0.052717909 0.24138372 0.660275318 0.33972468 1703.9828
## [12,] 0.033736109 0.039931666 0.20744708 0.718885147 0.28111485 1353.5973
## [13,] 0.024946269 0.030092046 0.17580695 0.769154738 0.23084526 1064.2418
## [14,] 0.018446596 0.022587299 0.14727729 0.811688815 0.18831119  829.4358
## [15,] 0.013640392 0.016901832 0.12218415 0.847273624 0.15272638  641.5870
## [16,] 0.010086430 0.012616791 0.10053368 0.876763101 0.12323690  493.0597
## [17,] 0.007458442 0.009400096 0.08213675 0.901004712 0.09899529  376.7721
## [18,] 0.005515168 0.006992894 0.06669730 0.920794635 0.07920537  286.4812
## [19,] 0.004078208 0.005195870 0.05387227 0.936853653 0.06314635  216.8735
## [20,] 0.003015643 0.003856940 0.04331037 0.949817049 0.05018295  163.5403
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.862411446 0.097755623 0.03481622 0.005016712 0.99498329 6916.8376
##  [2,] 0.743753502 0.161233607 0.08052506 0.014487836 0.98551216 6736.3113
##  [3,] 0.535393253 0.239327049 0.18025792 0.045021776 0.95497822 5041.9083
##  [4,] 0.385404485 0.242070194 0.27310985 0.099415473 0.90058453 5000.0160
##  [5,] 0.277434607 0.213769229 0.33371627 0.175079897 0.82492010 4709.2090
##  [6,] 0.199712158 0.176254969 0.36010637 0.263926498 0.73607350 4235.8192
##  [7,] 0.143763413 0.139544761 0.35899374 0.357698087 0.64230191 3670.2659
##  [8,] 0.103488536 0.107623686 0.33899273 0.449895052 0.55010495 3086.9495
##  [9,] 0.074496542 0.081533925 0.30782428 0.536145252 0.46385475 2535.3310
## [10,] 0.053626566 0.060991561 0.27143785 0.613944019 0.38605598 2042.7295
## [11,] 0.038603249 0.045206696 0.23398372 0.682206334 0.31779367 1620.2861
## [12,] 0.027788668 0.033279206 0.19810711 0.740825012 0.25917499 1268.7156
## [13,] 0.020003758 0.024373435 0.16531652 0.790306290 0.20969371  982.7833
## [14,] 0.014399767 0.017781561 0.13632137 0.831497304 0.16850270  754.4110
## [15,] 0.010365717 0.012933884 0.11130416 0.865396242 0.13460376  574.6516
## [16,] 0.007461793 0.009386237 0.09012355 0.893028424 0.10697158  434.8357
## [17,] 0.005371395 0.006799595 0.07245780 0.915371210 0.08462879  327.1601
## [18,] 0.003866615 0.004918990 0.05790124 0.933313157 0.06668684  244.9247
## [19,] 0.002783395 0.003554697 0.04602588 0.947636030 0.05236397  182.5622
## [20,] 0.002003635 0.002566643 0.03641843 0.959011291 0.04098871  135.5566
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.895620113 0.071557758 0.02590924 0.006912893 0.99308711 6844.2576
##  [2,] 0.802135387 0.124538176 0.05734808 0.015978358 0.98402164 6588.2558
##  [3,] 0.585926410 0.222837958 0.14490492 0.046330710 0.95366929 4846.7291
##  [4,] 0.427994779 0.241781049 0.23399259 0.096231582 0.90376842 4818.9593
##  [5,] 0.312632317 0.223947241 0.29723515 0.166185292 0.83381471 4574.5117
##  [6,] 0.228364855 0.191945104 0.32973840 0.249951640 0.75004836 4154.8640
##  [7,] 0.166810992 0.157200051 0.33588415 0.340104803 0.65989520 3636.5692
##  [8,] 0.121848465 0.125008737 0.32282614 0.430316661 0.56968334 3088.6097
##  [9,] 0.089005216 0.097413292 0.29755104 0.516030452 0.48396955 2560.0370
## [10,] 0.065014595 0.074810866 0.26576473 0.594409813 0.40559019 2080.1212
## [11,] 0.047490447 0.056835780 0.23165831 0.664015460 0.33598454 1662.6814
## [12,] 0.034689789 0.042828018 0.19805532 0.724426874 0.27557313 1310.9833
## [13,] 0.025339442 0.032070061 0.16668787 0.775902630 0.22409737 1021.8650
## [14,] 0.018509405 0.023896753 0.13848323 0.819110614 0.18088939  788.7683
## [15,] 0.013520347 0.017737722 0.11381181 0.854930123 0.14506988  603.7699
## [16,] 0.009876049 0.013125707 0.09268239 0.884315854 0.11568415  458.8329
## [17,] 0.007214042 0.009689061 0.07488646 0.908210433 0.09178957  346.5023
## [18,] 0.005269556 0.007138135 0.06009964 0.927492666 0.07250733  260.2346
## [19,] 0.003849191 0.005250466 0.04794957 0.942950777 0.05704922  194.4979
## [20,] 0.002811673 0.003857028 0.03805903 0.955272270 0.04472773  144.7423
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.880507341 0.084911213 0.03038729 0.004194159 0.99580584 6892.6585
##  [2,] 0.775293177 0.143803777 0.06926034 0.011642708 0.98835729 6687.0813
##  [3,] 0.568022690 0.230947747 0.16358207 0.037447490 0.96255251 4984.3171
##  [4,] 0.416164860 0.242270045 0.25638199 0.085183106 0.91481689 4973.9870
##  [5,] 0.304905409 0.220007987 0.32103248 0.154054121 0.84594588 4730.4341
##  [6,] 0.223390577 0.185919963 0.35346818 0.237221280 0.76277872 4303.3541
##  [7,] 0.163668300 0.150602575 0.35869579 0.327033333 0.67296667 3773.8666
##  [8,] 0.119912455 0.118710002 0.34427114 0.417106404 0.58289360 3213.2695
##  [9,] 0.087854501 0.091843124 0.31741690 0.502885479 0.49711452 2671.7309
## [10,] 0.064367070 0.070122383 0.28397017 0.581540374 0.41845963 2179.0683
## [11,] 0.047158878 0.053023731 0.24819418 0.651623209 0.34837679 1749.4011
## [12,] 0.034551204 0.039807001 0.21295382 0.712687971 0.28731203 1386.1897
## [13,] 0.025314124 0.029722667 0.18000746 0.764955753 0.23504425 1086.4112
## [14,] 0.018546528 0.022101019 0.15030092 0.809051528 0.19094847  843.6040
## [15,] 0.013588213 0.016381244 0.12421860 0.845811941 0.15418806  649.8995
## [16,] 0.009955477 0.012111654 0.10177958 0.876153290 0.12384671  497.2751
## [17,] 0.007293933 0.008937575 0.08278219 0.900986299 0.09901370  378.2540
## [18,] 0.005343939 0.006585342 0.06690550 0.921165215 0.07883479  286.2413
## [19,] 0.003915266 0.004846416 0.05377742 0.937460895 0.06253910  215.6330
## [20,] 0.002868540 0.003563337 0.04301821 0.950549915 0.04945009  161.7934
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.861085927 0.099155150 0.03284106 0.00691786 0.99308214 6892.8088
##  [2,] 0.741468973 0.164797008 0.07607639 0.01765763 0.98234237 6692.4114
##  [3,] 0.535923342 0.246044256 0.16888965 0.04914275 0.95085725 4966.4939
##  [4,] 0.387357851 0.254342798 0.25617500 0.10212435 0.89787565 4908.2412
##  [5,] 0.279976805 0.229947642 0.31503965 0.17503590 0.82496410 4625.7124
##  [6,] 0.202363295 0.193996216 0.34274964 0.26089084 0.73910916 4173.8080
##  [7,] 0.146265343 0.156969626 0.34462457 0.35214046 0.64785954 3632.5660
##  [8,] 0.105718532 0.123552327 0.32813505 0.44259409 0.55740591 3070.3837
##  [9,] 0.076411867 0.095387596 0.30028774 0.52791280 0.47208720 2534.4029
## [10,] 0.055229423 0.072612861 0.26668215 0.60547557 0.39452443 2051.8548
## [11,] 0.039919050 0.054694403 0.23136329 0.67402326 0.32597674 1634.8368
## [12,] 0.028852927 0.040864892 0.19701011 0.73327207 0.26672793 1285.3191
## [13,] 0.020854490 0.030339738 0.16522893 0.78357684 0.21642316  999.2370
## [14,] 0.015073332 0.022413230 0.13684522 0.82566822 0.17433178  769.4444
## [15,] 0.010894792 0.016491746 0.11215087 0.86046259 0.13953741  587.6628
## [16,] 0.007874603 0.012095867 0.09109642 0.88893311 0.11106689  445.6607
## [17,] 0.005691652 0.008848721 0.07343156 0.91202807 0.08797193  335.8956
## [18,] 0.004113846 0.006459620 0.05880297 0.93062357 0.06937643  251.8027
## [19,] 0.002973430 0.004707430 0.04681899 0.94550015 0.05449985  187.8673
## [20,] 0.002149153 0.003425674 0.03709023 0.95733494 0.04266506  139.5766
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.845510662 0.114357247 0.03602449 0.004107605 0.99589239 6934.7062
##  [2,] 0.714888279 0.185213605 0.08636575 0.013532368 0.98646763 6781.1779
##  [3,] 0.518693952 0.256114595 0.18200028 0.043191177 0.95680882 5062.9624
##  [4,] 0.376343302 0.258705985 0.26783259 0.097118126 0.90288187 4986.9471
##  [5,] 0.273059441 0.231339123 0.32315074 0.172450698 0.82754930 4673.6327
##  [6,] 0.198120860 0.193972810 0.34670707 0.261199262 0.73880074 4190.1478
##  [7,] 0.143748463 0.156378189 0.34470012 0.355173224 0.64482678 3622.6103
##  [8,] 0.104298057 0.122824869 0.32503344 0.447843629 0.55215637 3041.5041
##  [9,] 0.075674442 0.094722429 0.29485506 0.534748065 0.46525194 2493.8192
## [10,] 0.054906307 0.072082840 0.25973532 0.613275529 0.38672447 2005.5938
## [11,] 0.039837790 0.054309653 0.22360421 0.682248342 0.31775166 1587.4149
## [12,] 0.028904685 0.040607817 0.18899403 0.741493469 0.25850653 1239.8111
## [13,] 0.020972068 0.030183575 0.15736460 0.791479762 0.20852024  957.5152
## [14,] 0.015216482 0.022331151 0.12941137 0.833040997 0.16695900  732.4646
## [15,] 0.011040462 0.016460718 0.10531942 0.867179399 0.13282060  555.7315
## [16,] 0.008010512 0.012097776 0.08495655 0.894935166 0.10506483  418.6588
## [17,] 0.005812103 0.008870182 0.06801174 0.917305976 0.08269402  313.4496
## [18,] 0.004217026 0.006491239 0.05408954 0.935202195 0.06479780  233.4086
## [19,] 0.003059703 0.004742945 0.04277104 0.949426317 0.05057368  172.9752
## [20,] 0.002219997 0.003461144 0.03365086 0.960667996 0.03933200  127.6445
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.866054720 0.098303425 0.03128119 0.004360666 0.99563933 6900.5512
##  [2,] 0.750050778 0.165117583 0.07290274 0.011928895 0.98807111 6711.1465
##  [3,] 0.540863680 0.254562774 0.16804003 0.036533518 0.96346648 5017.4465
##  [4,] 0.390018288 0.266478710 0.26223454 0.081268465 0.91873153 5024.2504
##  [5,] 0.281243261 0.242894564 0.33014181 0.145720363 0.85427964 4809.3962
##  [6,] 0.202805289 0.206198355 0.36691414 0.224082213 0.77591779 4413.4655
##  [7,] 0.146243452 0.167688139 0.37649562 0.309572785 0.69042722 3909.6848
##  [8,] 0.105456556 0.132545605 0.36567876 0.396319081 0.60368092 3365.4532
##  [9,] 0.076045013 0.102692714 0.34130811 0.479954167 0.52004583 2830.3547
## [10,] 0.054836268 0.078405026 0.30914532 0.557613386 0.44238661 2335.5696
## [11,] 0.039542584 0.059201786 0.27356683 0.627688804 0.37231120 1897.3857
## [12,] 0.028514266 0.044320547 0.23764354 0.689521650 0.31047835 1521.5098
## [13,] 0.020561716 0.032957084 0.20336645 0.743114749 0.25688525 1206.8663
## [14,] 0.014827110 0.024375783 0.17190126 0.788895848 0.21110415  948.5004
## [15,] 0.010691870 0.017950924 0.14381970 0.827537507 0.17246249  739.6051
## [16,] 0.007709937 0.013173000 0.11928900 0.859828061 0.14017194  572.8342
## [17,] 0.005559656 0.009638934 0.09821720 0.886584211 0.11341579  441.0858
## [18,] 0.004009084 0.007036238 0.08035923 0.908595448 0.09140455  337.9202
## [19,] 0.002890961 0.005126216 0.06539119 0.926591635 0.07340836  257.7391
## [20,] 0.002084680 0.003728572 0.05296001 0.941226738 0.05877326  195.8200
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.874557351 0.092082595 0.02846435 0.004895701 0.99510430 6878.6083
##  [2,] 0.764850560 0.154275145 0.06783229 0.013042004 0.98695800 6673.0269
##  [3,] 0.542492597 0.246292303 0.16917107 0.042044030 0.95795597 4998.0363
##  [4,] 0.384778718 0.248385311 0.27011803 0.096717941 0.90328206 4997.4391
##  [5,] 0.272915543 0.215855042 0.33494393 0.176285482 0.82371452 4710.8698
##  [6,] 0.193573320 0.174467069 0.36077102 0.271188590 0.72881141 4212.6035
##  [7,] 0.137297530 0.135249947 0.35609079 0.371361737 0.62863826 3611.6076
##  [8,] 0.097382283 0.102124235 0.33144687 0.469046612 0.53095339 2995.8455
##  [9,] 0.069071228 0.075769834 0.29590517 0.559253770 0.44074623 2421.3664
## [10,] 0.048990786 0.055537793 0.25612755 0.639343871 0.36065613 1916.9891
## [11,] 0.034748146 0.040358747 0.21650522 0.708387885 0.29161211 1492.5448
## [12,] 0.024646137 0.029146261 0.17963542 0.766572181 0.23342782 1146.3115
## [13,] 0.017480993 0.020953172 0.14683331 0.814732530 0.18526747  870.4904
## [14,] 0.012398905 0.015012592 0.11856508 0.854023422 0.14597658  654.8001
## [15,] 0.008794285 0.010729393 0.09477559 0.885700727 0.11429927  488.6177
## [16,] 0.006237604 0.007653897 0.07511894 0.910989564 0.08901044  362.1202
## [17,] 0.004424203 0.005452313 0.05911167 0.931011814 0.06898819  266.7910
## [18,] 0.003137995 0.003879899 0.04622906 0.946753048 0.05324695  195.5519
## [19,] 0.002225714 0.002758763 0.03596151 0.959054016 0.04094598  142.6937
## [20,] 0.001578653 0.001960411 0.02784452 0.968616414 0.03138359  103.7129</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.960480 8.570894 9.102448 8.880778 9.080920 9.271246 8.948685
##  [8] 8.884381 9.553062 8.610979</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50804.41 48423.47 51483.69 50501.26 49985.79 51664.47 50185.99
##  [8] 50132.18 53436.59 49140.03</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level1">
<h1 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">10</span> Incremental Cost-Effectiveness Ratio</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}

<span class="co">#Presentation of results for first 10 PSA samples</span>
ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 6165.224 6577.686 7864.465 6145.590 5511.607 5783.219 6230.398
##  [8] 6797.810 5922.232 5794.585</code></pre>
</div>
<div id="overview-psa-results" class="section level1">
<h1 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">11</span> Overview PSA results</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)

<span class="co"># Presentation of results first 10 PSA samples</span>
Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     7.985412      8.960480       44792.90        50804.41 6165.224
##  [2,]     7.666300      8.570894       42473.34        48423.47 6577.686
##  [3,]     8.434211      9.102448       46228.37        51483.69 7864.465
##  [4,]     7.899821      8.880778       44472.70        50501.26 6145.590
##  [5,]     7.903045      9.080920       43493.81        49985.79 5511.607
##  [6,]     8.212056      9.271246       45538.94        51664.47 5783.219
##  [7,]     7.989405      8.948685       44209.29        50185.99 6230.398
##  [8,]     8.040846      8.884381       44397.98        50132.18 6797.810
##  [9,]     8.566763      9.553062       47595.50        53436.59 5922.232
## [10,]     7.504844      8.610979       42730.43        49140.03 5794.585</code></pre>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">12</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#number-of-psa-simulations"><span class="toc-section-number">2</span> Number of PSA simulations</a></li>
      <li><a href="#create-psa-samples-for-transition-matrix-monotherapy-based-on-dirichlet-distribution-using-rdirichlet_mat-function-from-hesim-package"><span class="toc-section-number">3</span> Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</a></li>
      <li><a href="#create-psa-samples-for-relative-risk-according-to-normal-distribution-of-log-transformed-relative-risk"><span class="toc-section-number">4</span> Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</a></li>
      <li><a href="#create-psa-samples-for-transition-matrix-for-combination-therapy"><span class="toc-section-number">5</span> Create PSA samples for transition matrix for combination therapy</a></li>
      <li><a href="#parameters-for-which-no-uncertainty-is-propagated"><span class="toc-section-number">6</span> Parameters for which no uncertainty is propagated</a></li>
      <li><a href="#model-simulation-settings"><span class="toc-section-number">7</span> Model simulation settings</a></li>
      <li><a href="#monotherapy-results"><span class="toc-section-number">8</span> Monotherapy results</a></li>
      <li><a href="#combination-therapy-results"><span class="toc-section-number">9</span> Combination therapy results</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">10</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">11</span> Overview PSA results</a></li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">12</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
