<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model-simple.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7227572 0.2049022 0.06330104 0.009039562
## [2,] 0.0000000 0.6011252 0.38637762 0.012497160
## [3,] 0.0000000 0.0000000 0.74591279 0.254087207
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7084563 0.2033941 0.0784607 0.009688911
## [2,] 0.0000000 0.5731477 0.4193756 0.007476674
## [3,] 0.0000000 0.0000000 0.7582211 0.241778943
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7213554 0.2036310 0.06352877 0.01148480
## [2,] 0.0000000 0.5669317 0.41536324 0.01770509
## [3,] 0.0000000 0.0000000 0.73583501 0.26416499
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7136237 0.2032370 0.07284104 0.01029825
## [2,] 0.0000000 0.5905134 0.39722453 0.01226210
## [3,] 0.0000000 0.0000000 0.75500710 0.24499290
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 5
## 
##           [,1]     [,2]       [,3]        [,4]
## [1,] 0.7061432 0.205992 0.07955915 0.008305615
## [2,] 0.0000000 0.573810 0.40982637 0.016363649
## [3,] 0.0000000 0.000000 0.74428827 0.255711734
## [4,] 0.0000000 0.000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7370597 0.2000719 0.05495183 0.007916609
## [2,] 0.0000000 0.5549213 0.42989693 0.015181789
## [3,] 0.0000000 0.0000000 0.74280220 0.257197798
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7152978 0.2048724 0.06264607 0.017183687
## [2,] 0.0000000 0.5888652 0.40429638 0.006838374
## [3,] 0.0000000 0.0000000 0.74575747 0.254242526
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7128267 0.2065793 0.06975892 0.01083512
## [2,] 0.0000000 0.5819831 0.40240282 0.01561406
## [3,] 0.0000000 0.0000000 0.75148997 0.24851003
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7187772 0.1969152 0.07277676 0.01153084
## [2,] 0.0000000 0.5865603 0.40262899 0.01081069
## [3,] 0.0000000 0.0000000 0.76665712 0.23334288
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7454992 0.1801558 0.06461154 0.009733496
## [2,] 0.0000000 0.5939821 0.38543963 0.020578259
## [3,] 0.0000000 0.0000000 0.73706781 0.262932193
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.6165485 0.6224389 0.4602162 0.5270935 0.5925995 0.6678710 0.4432558
##  [8] 0.4874151 0.5177612 0.5696829</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8290663 0.1263322 0.03902816 0.005573328
## [2,] 0.0000000 0.7540744 0.23822054 0.007705105
## [3,] 0.0000000 0.0000000 0.84334292 0.156657083
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8185318 0.1266004 0.04883699 0.006030755
## [2,] 0.0000000 0.7343105 0.26103569 0.004653773
## [3,] 0.0000000 0.0000000 0.84950739 0.150492615
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8717632 0.0937143 0.02923697 0.005285490
## [2,] 0.0000000 0.8006949 0.19115689 0.008148167
## [3,] 0.0000000 0.0000000 0.87842700 0.121573004
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8490529 0.1071249 0.03839404 0.005428141
## [2,] 0.0000000 0.7841622 0.20937448 0.006463275
## [3,] 0.0000000 0.0000000 0.87086583 0.129134173
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8258606 0.1220707 0.04714671 0.004921903
## [2,] 0.0000000 0.7474400 0.24286290 0.009697090
## [3,] 0.0000000 0.0000000 0.84846536 0.151534642
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8243898 0.1336222 0.03670073 0.005287274
## [2,] 0.0000000 0.7027448 0.28711569 0.010139477
## [3,] 0.0000000 0.0000000 0.82822505 0.171774947
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8738041 0.09081089 0.02776824 0.007616770
## [2,] 0.0000000 0.81776212 0.17920673 0.003031149
## [3,] 0.0000000 0.00000000 0.88730552 0.112694485
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8600274 0.1006899 0.03400155 0.005281200
## [2,] 0.0000000 0.7962523 0.19613721 0.007610529
## [3,] 0.0000000 0.0000000 0.87887246 0.121127541
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8543937 0.1019551 0.03768098 0.005970219
## [2,] 0.0000000 0.7859370 0.20846565 0.005597357
## [3,] 0.0000000 0.0000000 0.87918412 0.120815880
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8550152 0.1026317 0.03680808 0.005545006
## [2,] 0.0000000 0.7686986 0.21957835 0.011723081
## [3,] 0.0000000 0.0000000 0.85021204 0.149787962
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.722757158 0.204902242 0.06330104 0.009039562 0.99096044 5136.6422
##  [2,] 0.522377909 0.271266466 0.17213797 0.034217651 0.96578235 5356.0677
##  [3,] 0.377552373 0.270101517 0.26627827 0.086067836 0.91393216 5327.5439
##  [4,] 0.272878680 0.239726160 0.32688101 0.160514149 0.83948585 5022.0829
##  [5,] 0.197225019 0.200018893 0.35372306 0.249033032 0.75096697 4521.4321
##  [6,] 0.142545794 0.160648248 0.35361393 0.343192032 0.65680797 3922.6569
##  [7,] 0.103025993 0.125777666 0.33485934 0.436337005 0.56366300 3303.9475
##  [8,] 0.074462774 0.096718383 0.30489519 0.523923652 0.47607635 2717.3837
##  [9,] 0.053818503 0.073397448 0.26950861 0.603275435 0.39672456 2192.1169
## [10,] 0.038897708 0.055148589 0.23279582 0.673157882 0.32684212 1740.4349
## [11,] 0.028113597 0.041121435 0.19741583 0.733349141 0.26665086 1363.6099
## [12,] 0.020319303 0.030479670 0.16492301 0.784278013 0.21572199 1056.5073
## [13,] 0.014685922 0.022485569 0.13608108 0.826747427 0.17325257  810.8346
## [14,] 0.010614355 0.016525821 0.11112217 0.861737649 0.13826235  617.2438
## [15,] 0.007671601 0.012108993 0.08994456 0.890274847 0.10972515  466.5792
## [16,] 0.005544705 0.008850949 0.07225506 0.913349285 0.08665072  350.5365
## [17,] 0.004007475 0.006456651 0.05766677 0.931869105 0.06813090  261.9445
## [18,] 0.002896431 0.004702396 0.04576276 0.946638409 0.05336159  194.8182
## [19,] 0.002093416 0.003420214 0.03613528 0.958351091 0.04164891  144.2870
## [20,] 0.001513032 0.002484923 0.02840778 0.967594269 0.03240573  106.4635
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.708456256 0.203394133 0.07846070 0.009688911 0.99031109 5222.5363
##  [2,] 0.501910267 0.260670727 0.20037507 0.037043937 0.96295606 5497.7073
##  [3,] 0.355581469 0.251488433 0.30062777 0.092302323 0.90769768 5476.8491
##  [4,] 0.251913916 0.216463203 0.36130960 0.170313283 0.82968672 5148.0245
##  [5,] 0.178469990 0.175303201 0.38449728 0.261729532 0.73827047 4611.9547
##  [6,] 0.126438181 0.136774377 0.37905470 0.357732742 0.64226726 3978.1836
##  [7,] 0.089575921 0.104108705 0.35468752 0.451627853 0.54837215 3330.9208
##  [8,] 0.063460621 0.077888882 0.31962039 0.539030107 0.46096989 2723.9262
##  [9,] 0.044959074 0.057549352 0.27998677 0.617504801 0.38249520 2185.7110
## [10,] 0.031851537 0.042128691 0.23995418 0.686065589 0.31393441 1726.9863
## [11,] 0.022565421 0.030624379 0.20210515 0.744705047 0.25529495 1347.3007
## [12,] 0.015986614 0.022141967 0.16785400 0.794017420 0.20598258 1040.0205
## [13,] 0.011325816 0.015942201 0.13781056 0.834921424 0.16507858  795.7034
## [14,] 0.008023846 0.011440840 0.11206527 0.868470045 0.13152996  604.1956
## [15,] 0.005684544 0.008189295 0.09039781 0.895728349 0.10427165  455.8221
## [16,] 0.004027250 0.005849878 0.07242193 0.917700942 0.08229906  341.9741
## [17,] 0.002853131 0.004171963 0.05768111 0.935293797 0.06470620  255.3244
## [18,] 0.002021318 0.002971461 0.04570851 0.949298711 0.05070129  189.8281
## [19,] 0.001432016 0.002114211 0.03606191 0.960391867 0.03960813  140.6122
## [20,] 0.001014520 0.001503018 0.02834190 0.969140559 0.03085944  103.8174
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.721355395 0.203631034 0.06352877 0.01148480 0.98851520 5126.01762
##  [2,] 0.520353606 0.262335228 0.17715436 0.04015680 0.95984320 5355.01408
##  [3,] 0.375359881 0.254686293 0.27237822 0.09757561 0.90242439 5307.08890
##  [4,] 0.270767875 0.220824647 0.33005891 0.17834857 0.82165143 4962.27323
##  [5,] 0.195319867 0.180329229 0.35179289 0.27255801 0.72744199 4419.56713
##  [6,] 0.140895040 0.142007538 0.34617209 0.37092533 0.62907467 3787.55408
##  [7,] 0.101635397 0.109199174 0.32266114 0.46650428 0.53349572 3148.97573
##  [8,] 0.073315242 0.082604592 0.28923946 0.55484070 0.44515930 2555.71330
##  [9,] 0.052886345 0.061760418 0.25180106 0.63355218 0.36644782 2034.34783
## [10,] 0.038149851 0.045783238 0.21429685 0.70177006 0.29822994 1593.88816
## [11,] 0.027519600 0.033724461 0.17912741 0.75962853 0.24037147 1232.54473
## [12,] 0.019851412 0.024723310 0.14756441 0.80786087 0.19213913  942.73677
## [13,] 0.014319923 0.018058791 0.12011335 0.84750794 0.15249206  714.42580
## [14,] 0.010329754 0.013154082 0.09679429 0.87972187 0.12027813  537.14569
## [15,] 0.007451424 0.009560924 0.07734459 0.90564306 0.09435694  401.11851
## [16,] 0.005375125 0.006937732 0.06135749 0.92632965 0.07367035  297.77601
## [17,] 0.003877375 0.005027762 0.04837214 0.94272272 0.05727728  219.92064
## [18,] 0.002796966 0.003639951 0.03792859 0.95563449 0.04436551  161.68541
## [19,] 0.002017606 0.002633153 0.02959877 0.96575047 0.03424953  118.39422
## [20,] 0.001455411 0.001903665 0.02300171 0.97363922 0.02636078   86.38466
## 
## , , 4
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.713623687 0.203237027 0.07284104 0.01029825 0.98970175 5186.4586
##  [2,] 0.509258767 0.265048938 0.18770732 0.03798498 0.96201502 5424.1693
##  [3,] 0.363419119 0.260015179 0.28409924 0.09246647 0.90753353 5391.5251
##  [4,] 0.259344492 0.227402660 0.34425317 0.16899968 0.83100032 5071.3745
##  [5,] 0.185074372 0.186992714 0.36913443 0.25879849 0.74120151 4553.8044
##  [6,] 0.132073456 0.148035662 0.36645822 0.35343266 0.64656734 3940.2845
##  [7,] 0.094250747 0.114259254 0.34510232 0.44638768 0.55361232 3310.6143
##  [8,] 0.067259565 0.086626858 0.31280660 0.53330697 0.46669303 2716.9016
##  [9,] 0.047998019 0.064823952 0.27548078 0.61169725 0.38830275 2187.6178
## [10,] 0.034252523 0.048034385 0.23723583 0.68047726 0.31952274 1734.1826
## [11,] 0.024443412 0.035326327 0.20069016 0.73954010 0.26045990 1357.0710
## [12,] 0.017443398 0.025828475 0.16733547 0.78939266 0.21060734 1050.5220
## [13,] 0.012448022 0.018797204 0.13786977 0.83088501 0.16911499  805.7996
## [14,] 0.008883203 0.013629899 0.11246609 0.86502081 0.13497919  613.2703
## [15,] 0.006339264 0.009854033 0.09097389 0.89283281 0.10716719  463.6124
## [16,] 0.004523849 0.007107312 0.07306195 0.91530688 0.08469312  348.4396
## [17,] 0.003228326 0.005116376 0.05831502 0.93334028 0.06665972  260.5517
## [18,] 0.002303810 0.003677404 0.04629576 0.94772303 0.05227697  193.9663
## [19,] 0.001644053 0.002639776 0.03658219 0.95913398 0.04086602  143.8314
## [20,] 0.001173235 0.001892955 0.02878815 0.96814566 0.03185434  106.2848
## 
## , , 5
## 
##            State A     State B    State C       Death    Disc LY
##  [1,] 0.7061432485 0.205991984 0.07955915 0.008305615 0.99169438
##  [2,] 0.4986382875 0.263660105 0.19981605 0.037885558 0.96211444
##  [3,] 0.3521100602 0.254006289 0.29644684 0.097436806 0.90256319
##  [4,] 0.2486401417 0.218283193 0.35275396 0.180322703 0.81967730
##  [5,] 0.1755755574 0.176470950 0.37179044 0.276163050 0.72383695
##  [6,] 0.1239814945 0.137427950 0.36301036 0.375580200 0.62441980
##  [7,] 0.0875486953 0.104396723 0.33636981 0.471684773 0.52831523
##  [8,] 0.0618219201 0.077938211 0.30010593 0.560133937 0.43986606
##  [9,] 0.0436551315 0.057456543 0.26022496 0.638663368 0.36133663
## [10,] 0.0308267764 0.041961745 0.22070275 0.706508725 0.29349128
## [11,] 0.0217681200 0.030428137 0.18391605 0.763887691 0.23611231
## [12,] 0.0153714110 0.021944027 0.15108867 0.811595897 0.18840410
## [13,] 0.0108544181 0.015758089 0.12266970 0.850717795 0.14928220
## [14,] 0.0076647740 0.011278072 0.09862327 0.882433889 0.11756611
## [15,] 0.0054124284 0.008050352 0.07863599 0.907901226 0.09209877
## [16,] 0.0038219498 0.005734289 0.06225770 0.928186059 0.07181394
## [17,] 0.0026988440 0.004077683 0.04899181 0.944231661 0.05576834
## [18,] 0.0019057705 0.002895756 0.03834989 0.956848584 0.04315142
## [19,] 0.0013457470 0.002054187 0.02988175 0.966718314 0.03328169
## [20,] 0.0009502901 0.001455926 0.02318956 0.974404220 0.02559578
##        Disc cost
##  [1,] 5236.30889
##  [2,] 5491.61411
##  [3,] 5433.82978
##  [4,] 5066.17749
##  [5,] 4498.56345
##  [6,] 3844.28072
##  [7,] 3187.67724
##  [8,] 2580.74638
##  [9,] 2049.53245
## [10,] 1602.29632
## [11,] 1236.50483
## [12,]  943.93215
## [13,]  714.02275
## [14,]  535.91845
## [15,]  399.55705
## [16,]  296.17223
## [17,]  218.43381
## [18,]  160.38968
## [19,]  117.31192
## [20,]   85.50873
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.737059704 0.200071857 0.05495183 0.007916609 0.99208339 5091.3896
##  [2,] 0.543257007 0.258489035 0.16733140 0.030922561 0.96907744 5340.7237
##  [3,] 0.400412849 0.252131505 0.26527074 0.082184907 0.91781509 5334.2016
##  [4,] 0.295128176 0.220024481 0.32743767 0.157409676 0.84259032 5032.5986
##  [5,] 0.217527086 0.181143109 0.35402710 0.247302703 0.75269730 4525.1862
##  [6,] 0.160330450 0.144041214 0.35279849 0.342829847 0.65717015 3916.8835
##  [7,] 0.118173114 0.112009146 0.33279282 0.437024918 0.56297508 3290.3429
##  [8,] 0.087100640 0.085799373 0.30184546 0.525254529 0.47474547 2699.1916
##  [9,] 0.064198372 0.065038285 0.26588270 0.604880645 0.39511935 2172.4538
## [10,] 0.047318033 0.048935416 0.22898583 0.674760721 0.32523928 1721.6036
## [11,] 0.034876216 0.036622311 0.19372858 0.734772897 0.26522710 1346.9908
## [12,] 0.025705853 0.027300249 0.16156234 0.785431554 0.21456845 1042.7136
## [13,] 0.018946749 0.020292507 0.13315774 0.827603003 0.17239700  799.9435
## [14,] 0.013964885 0.015051455 0.10867471 0.862308952 0.13769105  609.0120
## [15,] 0.010292954 0.011146353 0.08796178 0.890598910 0.10940109  460.6078
## [16,] 0.007586522 0.008244679 0.07069561 0.913473194 0.08652681  346.3830
## [17,] 0.005591719 0.006092997 0.05647411 0.931841176 0.06815882  259.1881
## [18,] 0.004121431 0.004499880 0.04487573 0.946502962 0.05349704  193.0935
## [19,] 0.003037741 0.003321661 0.03549475 0.958145844 0.04185416  143.2955
## [20,] 0.002238996 0.002451027 0.02796048 0.967349494 0.03265051  105.9728
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.715297843 0.204872396 0.06264607 0.01718369 0.98281631 5094.09448
##  [2,] 0.511651005 0.267187016 0.17435855 0.04680343 0.95319657 5310.95955
##  [3,] 0.365982860 0.262160315 0.27010486 0.10175197 0.89824803 5279.36278
##  [4,] 0.261786751 0.229356883 0.33035057 0.17850579 0.82149421 4965.09094
##  [5,] 0.187255498 0.188693175 0.35548948 0.26856185 0.73143815 4453.71668
##  [6,] 0.133943454 0.149478335 0.35312773 0.36345048 0.63654952 3846.29098
##  [7,] 0.095809464 0.115463912 0.33217222 0.45655440 0.54344560 3223.06032
##  [8,] 0.068532303 0.087621399 0.30040365 0.54344265 0.45655735 2636.42997
##  [9,] 0.049021008 0.065637574 0.26374656 0.62159486 0.37840514 2114.85318
## [10,] 0.035064622 0.048694737 0.22629898 0.68994167 0.31005833 1669.51226
## [11,] 0.025081648 0.035858411 0.19064792 0.74841202 0.25158798 1300.55839
## [12,] 0.017940849 0.026254309 0.15824580 0.79755904 0.20244096 1001.91687
## [13,] 0.012833051 0.019135835 0.12975144 0.83827968 0.16172032  764.60168
## [14,] 0.009179453 0.013897566 0.10530359 0.87161939 0.12838061  578.81027
## [15,] 0.006566043 0.010064410 0.08472473 0.89864481 0.10135519  435.13043
## [16,] 0.004696677 0.007271782 0.06766444 0.92036710 0.07963290  325.14983
## [17,] 0.003359523 0.005244319 0.05369545 0.93770071 0.06229929  241.69035
## [18,] 0.002403059 0.003776471 0.04237450 0.95144597 0.04855403  178.82313
## [19,] 0.001718903 0.002716153 0.03327846 0.96228649 0.03771351  131.76808
## [20,] 0.001229528 0.001951604 0.02602347 0.97079540 0.02920460   96.74252
## 
## , , 8
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.712826674 0.206579284 0.06975892 0.01083512 0.98916488 5166.66652
##  [2,] 0.508121868 0.267480880 0.18527724 0.03912001 0.96087999 5406.20524
##  [3,] 0.362202821 0.260636809 0.28231508 0.09484529 0.90515471 5372.26106
##  [4,] 0.258187833 0.226509823 0.34230482 0.17299753 0.82700247 5045.57703
##  [5,] 0.184043174 0.185161151 0.36639773 0.26439794 0.73560206 4519.55243
##  [6,] 0.131190884 0.145780171 0.36269224 0.36033670 0.63966330 3898.71741
##  [7,] 0.093516361 0.111942918 0.34037367 0.45416705 0.54583295 3264.45542
##  [8,] 0.066660957 0.084467431 0.30735714 0.54151447 0.45848553 2669.20548
##  [9,] 0.047517708 0.062929392 0.26961594 0.61993696 0.38006304 2141.03504
## [10,] 0.033871890 0.046440018 0.23125142 0.68843667 0.31156333 1690.65671
## [11,] 0.024144787 0.034024537 0.19483358 0.74699709 0.25300291 1317.80779
## [12,] 0.017211048 0.024789519 0.16179137 0.79620807 0.20379193 1016.09567
## [13,] 0.012268494 0.017982528 0.13276059 0.83698839 0.16301161  776.30819
## [14,] 0.008745310 0.012999944 0.10786030 0.87039444 0.12960556  588.48901
## [15,] 0.006233890 0.009372348 0.08689721 0.89749655 0.10250345  443.12343
## [16,] 0.004443683 0.006742341 0.06950871 0.91930526 0.08069474  331.73045
## [17,] 0.003167576 0.004841901 0.05525822 0.93673230 0.06326770  247.08434
## [18,] 0.002257933 0.003472260 0.04369536 0.95057444 0.04942556  183.22131
## [19,] 0.001609515 0.002487239 0.03439138 0.96151186 0.03848814  135.33386
## [20,] 0.001147305 0.001780024 0.02695793 0.97011474 0.02988526   99.61641
## 
## , , 9
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.718777158 0.196915247 0.07277676 0.01153084 0.98846916 5178.4606
##  [2,] 0.516640603 0.257040852 0.18738888 0.03892967 0.96107033 5416.0556
##  [3,] 0.371349464 0.252504375 0.28475454 0.09139162 0.90860838 5397.6408
##  [4,] 0.266917512 0.221233418 0.34700029 0.16484878 0.83515122 5100.0813
##  [5,] 0.191854211 0.182326871 0.37453062 0.25128829 0.74871171 4606.2297
##  [6,] 0.137900424 0.144724727 0.37450918 0.34286567 0.65713433 4012.5717
##  [7,] 0.099119675 0.112044478 0.35542645 0.43340940 0.56659060 3396.5484
##  [8,] 0.071244958 0.085239020 0.32481618 0.51869984 0.48130016 2809.8799
##  [9,] 0.051209249 0.064027045 0.28852732 0.59623639 0.40376361 2281.8173
## [10,] 0.036808038 0.047639606 0.25070751 0.66484485 0.33515515 1825.0826
## [11,] 0.026456777 0.035191566 0.21406655 0.72428510 0.27571490 1441.5517
## [12,] 0.019016527 0.025851719 0.18021023 0.77492152 0.22507848 1126.7246
## [13,] 0.013668645 0.018908237 0.14995207 0.81747105 0.18252895  872.8835
## [14,] 0.009824710 0.013782386 0.12356959 0.85282332 0.14717668  671.1477
## [15,] 0.007061777 0.010018836 0.10099970 0.88191969 0.11808031  512.7065
## [16,] 0.005075844 0.007267223 0.08197995 0.90567699 0.09432301  389.4854
## [17,] 0.003648401 0.005262176 0.06614591 0.92494352 0.07505648  294.4437
## [18,] 0.002622387 0.003805009 0.05309545 0.94047715 0.05952285  221.6499
## [19,] 0.001884912 0.002748255 0.04242886 0.95293797 0.04706203  166.2304
## [20,] 0.001354832 0.001983185 0.03377210 0.96288989 0.03711011  124.2569
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.745499174 0.180155794 0.06461154 0.009733496 0.99026650 5134.1645
##  [2,] 0.555769018 0.241315314 0.16523011 0.037685555 0.96231445 5294.2094
##  [3,] 0.414325344 0.243461988 0.25070737 0.091505295 0.90849470 5216.2178
##  [4,] 0.308879202 0.219255176 0.30539843 0.166467193 0.83353281 4887.1777
##  [5,] 0.230269190 0.185880030 0.32956614 0.254284636 0.74571536 4385.7102
##  [6,] 0.171665491 0.151893741 0.32943617 0.347004597 0.65299540 3800.7559
##  [7,] 0.127976482 0.121148697 0.31245424 0.438420586 0.56157941 3202.9165
##  [8,] 0.095406361 0.095015863 0.28526422 0.524313551 0.47568645 2638.8443
##  [9,] 0.071125364 0.073625732 0.25304631 0.602202598 0.39779740 2134.4438
## [10,] 0.053023900 0.056546014 0.21948608 0.670944006 0.32905599 1700.4310
## [11,] 0.039529273 0.043139883 0.18699715 0.730333689 0.26966631 1337.6130
## [12,] 0.029469041 0.032745746 0.15701145 0.780773763 0.21922624 1041.0297
## [13,] 0.021969146 0.024759406 0.13025363 0.823017815 0.17698219  802.8740
## [14,] 0.016377980 0.018664513 0.10696848 0.857989030 0.14201097  614.3861
## [15,] 0.012209770 0.014036975 0.08709527 0.886657985 0.11334202  466.9827
## [16,] 0.009102374 0.010537373 0.07039442 0.909965835 0.09003416  352.8592
## [17,] 0.006785812 0.007898856 0.05653510 0.928780233 0.07121977  265.2505
## [18,] 0.005058817 0.005914283 0.04515318 0.943873725 0.05612628  198.4848
## [19,] 0.003771344 0.004424353 0.03588741 0.955916894 0.04408311  147.9231
## [20,] 0.002811534 0.003307416 0.02840045 0.965480603 0.03451940  109.8428</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.067053 7.907293 7.707845 7.964829 7.660390 8.071485 7.815099
##  [8] 7.867089 8.147608 8.074649</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 44613.13 45177.40 43002.57 44860.28 43698.78 44431.78 43648.56
##  [8] 44313.14 45845.45 43732.12</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.829066345 0.126332167 0.03902816 0.005573328 0.99442667 6945.9167
##  [2,] 0.687351005 0.200001595 0.09536597 0.017281428 0.98271857 6811.3849
##  [3,] 0.496787859 0.261065764 0.19192087 0.050225505 0.94977449 5086.5292
##  [4,] 0.359056981 0.258726159 0.27547339 0.106743469 0.89325653 4986.4043
##  [5,] 0.259511003 0.229098398 0.32817380 0.183216794 0.81678321 4656.1016
##  [6,] 0.187563435 0.190891210 0.34973485 0.271810505 0.72818950 4165.1905
##  [7,] 0.135562815 0.153181688 0.34650075 0.364754745 0.63524525 3597.3888
##  [8,] 0.097978995 0.119858500 0.32622659 0.455935918 0.54406408 3020.0740
##  [9,] 0.070815020 0.092126082 0.29584940 0.541209499 0.45879050 2477.7907
## [10,] 0.051182062 0.069889467 0.26075597 0.618172497 0.38182750 1995.0287
## [11,] 0.036992202 0.052499640 0.22474482 0.685763338 0.31423666 1581.5674
## [12,] 0.026736379 0.039138643 0.19026637 0.743858611 0.25614139 1237.6306
## [13,] 0.019323909 0.029005569 0.15873685 0.792933668 0.20706633  957.9420
## [14,] 0.013966494 0.021395491 0.13083418 0.833803839 0.16619616  734.5774
## [15,] 0.010094383 0.015723135 0.10674172 0.867440763 0.13255924  558.8013
## [16,] 0.007295788 0.011519935 0.08633407 0.894850211 0.10514979  422.1495
## [17,] 0.005273083 0.008419847 0.06931056 0.916996510 0.08300349  316.9938
## [18,] 0.003811158 0.006141849 0.05528667 0.934760328 0.06523967  236.7734
## [19,] 0.002754542 0.004472935 0.04385335 0.948919169 0.05108083  176.0287
## [20,] 0.001990865 0.003253206 0.03461339 0.960142544 0.03985746  130.3262
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.818531839 0.126600417 0.04883699 0.006030755 0.99396925 7000.7630
##  [2,] 0.669994371 0.196590492 0.11450924 0.018905896 0.98109410 6906.6920
##  [3,] 0.474661704 0.248948314 0.22183680 0.054553178 0.94544682 5222.2387
##  [4,] 0.336277054 0.239227561 0.30984648 0.114648906 0.88535109 5120.5046
##  [5,] 0.238237583 0.205509508 0.36164286 0.194610046 0.80538995 4764.3637
##  [6,] 0.168780906 0.166243430 0.37908320 0.285892465 0.71410753 4239.4032
##  [7,] 0.119573889 0.129611086 0.37038997 0.380425052 0.61957495 3639.6001
##  [8,] 0.084712870 0.098606924 0.34457506 0.472105149 0.52789485 3037.0203
##  [9,] 0.060015363 0.073746433 0.30926404 0.556974169 0.44302583 2477.2315
## [10,] 0.042518259 0.054474372 0.27012681 0.632880562 0.36711944 1983.8462
## [11,] 0.030122327 0.039869826 0.23099707 0.699010779 0.30098922 1565.0562
## [12,] 0.021340351 0.028978004 0.19423069 0.755450952 0.24454905 1219.4502
## [13,] 0.015118705 0.020949178 0.16109685 0.802835268 0.19716473  940.3713
## [14,] 0.010710941 0.015082029 0.13211882 0.842088208 0.15791179  718.8572
## [15,] 0.007588233 0.010822773 0.10734070 0.874248298 0.12575170  545.4590
## [16,] 0.005375931 0.007746450 0.08652216 0.900355458 0.09964454  411.2634
## [17,] 0.003808612 0.005533293 0.06927340 0.921384699 0.07861530  308.3867
## [18,] 0.002698235 0.003946043 0.05514390 0.938211819 0.06178818  230.1458
## [19,] 0.001911582 0.002810471 0.04367785 0.951600100 0.04839990  171.0429
## [20,] 0.001354272 0.001999619 0.03444609 0.962200018 0.03779998  126.6549
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.871763243 0.093714298 0.02923697 0.00528549 0.99471451 6881.0017
##  [2,] 0.759971151 0.156733245 0.06908439 0.01421121 0.98578879 6673.2303
##  [3,] 0.548209290 0.243610752 0.16421598 0.04396398 0.95603602 4963.2483
##  [4,] 0.395453729 0.249743076 0.25684988 0.09795331 0.90204669 4927.1359
##  [5,] 0.285262681 0.222113912 0.31785592 0.17476749 0.82523251 4638.1444
##  [6,] 0.205775774 0.184011747 0.34426986 0.26594262 0.73405738 4160.4961
##  [7,] 0.148437464 0.146224421 0.34283021 0.36250790 0.63749210 3588.2819
##  [8,] 0.107076166 0.113125730 0.32243277 0.45736533 0.54263467 2999.4298
##  [9,] 0.077239970 0.085938590 0.29104801 0.54577343 0.45422657 2445.3430
## [10,] 0.055717469 0.064449764 0.25476601 0.62506676 0.37493324 1953.8420
## [11,] 0.040192097 0.047884418 0.21777547 0.69414801 0.30585199 1535.6632
## [12,] 0.028992786 0.035331552 0.18268960 0.75298606 0.24701394 1190.6983
## [13,] 0.020914102 0.025934407 0.15094671 0.80220478 0.19779522  912.8041
## [14,] 0.015086501 0.018961797 0.12317272 0.84277898 0.15722102  693.0927
## [15,] 0.010882729 0.013822123 0.09946926 0.87582589 0.12417411  521.9845
## [16,] 0.007850315 0.010052261 0.07962553 0.90247189 0.09752811  390.3677
## [17,] 0.005662867 0.007297513 0.06326531 0.92377431 0.07622569  290.1662
## [18,] 0.004084940 0.005290327 0.04994371 0.94068103 0.05931897  214.5420
## [19,] 0.002946693 0.003831074 0.03920725 0.95401499 0.04598501  157.8884
## [20,] 0.002125613 0.002771996 0.03062855 0.96447384 0.03552616  115.7164
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.849052895 0.107124924 0.03839404 0.005428141 0.99457186 6937.7890
##  [2,] 0.720890819 0.174958048 0.08846385 0.015687281 0.98431272 6776.4916
##  [3,] 0.514444764 0.249826773 0.18879890 0.046929564 0.95307044 5081.2812
##  [4,] 0.367119970 0.252080273 0.27925452 0.101545235 0.89845476 5024.2953
##  [5,] 0.261985506 0.223469142 0.33771301 0.176832337 0.82316766 4723.4316
##  [6,] 0.186959063 0.185206671 0.36282645 0.265007820 0.73499218 4245.8363
##  [7,] 0.133418416 0.147364019 0.36112347 0.358094097 0.64190590 3679.3333
##  [8,] 0.095210542 0.114135985 0.34090572 0.449747750 0.55025225 3096.1268
##  [9,] 0.067944498 0.086749132 0.30965909 0.535647280 0.46435272 2544.5172
## [10,] 0.048486803 0.065035360 0.27320284 0.613274993 0.38672501 2051.4392
## [11,] 0.034601331 0.048258563 0.23563556 0.681504548 0.31849545 1628.0624
## [12,] 0.024692330 0.035529598 0.19959640 0.740181671 0.25981833 1275.2827
## [13,] 0.017621031 0.025999098 0.16660854 0.789771326 0.21022867  988.0580
## [14,] 0.012574785 0.018934061 0.13740165 0.831089505 0.16891049  758.4566
## [15,] 0.008973665 0.013736478 0.11217625 0.865113603 0.13488640  577.6191
## [16,] 0.006403820 0.009935355 0.09080399 0.892856839 0.10714316  436.9140
## [17,] 0.004569917 0.007168453 0.07297068 0.915290947 0.08470905  328.5413
## [18,] 0.003261201 0.005161844 0.05827375 0.933303209 0.06669679  245.7832
## [19,] 0.002327271 0.003710935 0.04628505 0.947676742 0.05232326  183.0452
## [20,] 0.001660795 0.002664344 0.03658914 0.959085722 0.04091428  135.7816
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.825860641 0.122070744 0.04714671 0.004921903 0.99507810 6996.9794
##  [2,] 0.682045798 0.192053981 0.10858542 0.017314801 0.98268520 6882.6244
##  [3,] 0.481622035 0.250698457 0.21379063 0.053888881 0.94611112 5183.2514
##  [4,] 0.340094148 0.243063555 0.30018214 0.116660162 0.88333984 5065.5325
##  [5,] 0.240155187 0.209528961 0.35009350 0.200222354 0.79977765 4690.1926
##  [6,] 0.169583964 0.169699852 0.36554752 0.295168664 0.70483134 4147.5575
##  [7,] 0.119750571 0.132308406 0.35511216 0.392828862 0.60717114 3535.0904
##  [8,] 0.084561057 0.100587541 0.32805654 0.486794859 0.51320514 2926.2074
##  [9,] 0.059712220 0.075137035 0.29211967 0.573031078 0.42696892 2366.1983
## [10,] 0.042165381 0.055414619 0.25296503 0.649454967 0.35054503 1877.5080
## [11,] 0.029774799 0.040483192 0.21434392 0.715398089 0.28460191 1466.8572
## [12,] 0.021025273 0.029363029 0.17849360 0.771118096 0.22888190 1131.4235
## [13,] 0.014846855 0.021179837 0.14655719 0.817416118 0.18258388  863.3790
## [14,] 0.010484006 0.015211535 0.11894206 0.855362403 0.14463760  652.8871
## [15,] 0.007403210 0.010888152 0.09559536 0.886113275 0.11388673  489.9089
## [16,] 0.005227727 0.007772732 0.07620175 0.910797789 0.08920221  365.1785
## [17,] 0.003691524 0.005536941 0.06031745 0.930454081 0.06954592  270.6420
## [18,] 0.002606745 0.003937576 0.04745645 0.945999227 0.05400077  199.5753
## [19,] 0.001840735 0.002796389 0.03714239 0.958220482 0.04177952  146.5240
## [20,] 0.001299823 0.001983773 0.02893713 0.967779276 0.03222072  107.1587
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.824389805 0.133622189 0.03670073 0.005287274 0.99471273 6936.1488
##  [2,] 0.679618551 0.204059073 0.09901720 0.017305173 0.98269483 6832.6165
##  [3,] 0.500919448 0.249209268 0.19862085 0.051250436 0.94874956 5114.4151
##  [4,] 0.369207540 0.238511411 0.28219674 0.110084307 0.88991569 5001.6333
##  [5,] 0.272128001 0.206223096 0.33244031 0.189208589 0.81079141 4648.4319
##  [6,] 0.200574584 0.168882739 0.35054600 0.279996672 0.72000333 4135.1217
##  [7,] 0.147835443 0.133845956 0.34401046 0.374308146 0.62569185 3551.2457
##  [8,] 0.108963548 0.103851681 0.32119552 0.465989254 0.53401075 2965.6173
##  [9,] 0.080312640 0.079430047 0.28921800 0.551039310 0.44896069 2421.7414
## [10,] 0.059195211 0.060145723 0.25339183 0.627267237 0.37273276 1942.1485
## [11,] 0.043630405 0.045219437 0.21732936 0.693820802 0.30617920 1534.6463
## [12,] 0.032158213 0.033822444 0.18326999 0.750749351 0.24925065 1197.8750
## [13,] 0.023702523 0.025202748 0.15244067 0.798654058 0.20134594  925.4611
## [14,] 0.017470175 0.018727749 0.12537035 0.838431730 0.16156827  708.8174
## [15,] 0.012876562 0.013887717 0.10213639 0.871099332 0.12890067  538.8775
## [16,] 0.009490795 0.010282827 0.08254501 0.897681366 0.10231863  407.0714
## [17,] 0.006995282 0.007605001 0.06625671 0.919143008 0.08085699  305.8022
## [18,] 0.005155941 0.005619736 0.05286940 0.936354924 0.06364508  228.6131
## [19,] 0.003800236 0.004150070 0.04197074 0.950078952 0.04992105  170.1779
## [20,] 0.002801001 0.003063282 0.03316889 0.960966825 0.03903317  126.1994
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.873804106 0.090810886 0.02776824 0.00761677 0.99238323 6855.8682
##  [2,] 0.763533616 0.153612628 0.06517683 0.01767692 0.98232308 6628.7045
##  [3,] 0.546153949 0.246884099 0.15854352 0.04841843 0.95158157 4915.4628
##  [4,] 0.390662742 0.257273333 0.25226377 0.09980016 0.90019984 4898.8298
##  [5,] 0.279440217 0.231535336 0.31661575 0.17240869 0.82759131 4643.3085
##  [6,] 0.199882984 0.193592698 0.34723330 0.25929102 0.74070898 4199.1593
##  [7,] 0.142975868 0.154950517 0.34974254 0.35233108 0.64766892 3652.8071
##  [8,] 0.102270330 0.120536783 0.33242592 0.44476697 0.55523303 3079.7894
##  [9,] 0.073153746 0.091932289 0.30304854 0.53186543 0.46813457 2532.2350
## [10,] 0.052326717 0.069122913 0.26775140 0.61079897 0.38920103 2040.0464
## [11,] 0.037429188 0.051424381 0.23090181 0.68024462 0.31975538 1616.3092
## [12,] 0.026773017 0.037950238 0.19533224 0.73994451 0.26005549 1262.9852
## [13,] 0.019150682 0.027832628 0.16269084 0.79032585 0.20967415  975.5221
## [14,] 0.013698441 0.020313113 0.13378026 0.83220819 0.16779181  746.1339
## [15,] 0.009798465 0.014768119 0.10883830 0.86659512 0.13340488  565.9282
## [16,] 0.007008821 0.010703867 0.08775151 0.89453580 0.10546420  426.1653
## [17,] 0.005013395 0.007739049 0.07020795 0.91703960 0.08296040  318.9216
## [18,] 0.003586070 0.005584363 0.05580104 0.93502852 0.06497148  237.3690
## [19,] 0.002565108 0.004023124 0.04409644 0.94931533 0.05068467  175.8277
## [20,] 0.001834817 0.002894598 0.03467248 0.96059811 0.03940189  129.6932
## 
## , , 8
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.860027386 0.100689861 0.03400155 0.00528120 0.99471880 6911.0759
##  [2,] 0.739647105 0.166770568 0.07887432 0.01470800 0.98529200 6727.1910
##  [3,] 0.527240186 0.249853425 0.17797919 0.04492719 0.95507281 5032.9643
##  [4,] 0.375830869 0.254327376 0.27107101 0.09877075 0.90122925 4995.3655
##  [5,] 0.267902268 0.225653111 0.33226675 0.17417787 0.82582213 4708.4599
##  [6,] 0.190967883 0.186669360 0.35918715 0.26317560 0.73682440 4236.6063
##  [7,] 0.136127001 0.148088425 0.35836353 0.35742104 0.64257896 3670.2554
##  [8,] 0.097034957 0.114305982 0.33839387 0.45026519 0.54973481 3084.6727
##  [9,] 0.069169106 0.086569564 0.30706570 0.53719563 0.46280437 2530.2769
## [10,] 0.049305584 0.064670929 0.27041779 0.61560569 0.38439431 2035.1062
## [11,] 0.035146335 0.047822901 0.23267953 0.68435124 0.31564876 1610.7114
## [12,] 0.025053245 0.035092626 0.19655217 0.74330196 0.25669804 1257.9552
## [13,] 0.017858622 0.025598797 0.16357604 0.79296654 0.20703346  971.5740
## [14,] 0.012730102 0.018587289 0.13447258 0.83421003 0.16578997  743.3649
## [15,] 0.009074356 0.013447264 0.10942241 0.86805597 0.13194403  564.2200
## [16,] 0.006468443 0.009700655 0.08827408 0.89555682 0.10444318  425.3110
## [17,] 0.004610879 0.006981864 0.07069189 0.91771537 0.08228463  318.6984
## [18,] 0.003286757 0.005015839 0.05625542 0.93544199 0.06455801  237.5759
## [19,] 0.002342888 0.003598109 0.04452305 0.94953595 0.05046405  176.3005
## [20,] 0.001670073 0.002578031 0.03506995 0.96068194 0.03931806  130.3071
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.854393735 0.101955067 0.03768098 0.005970219 0.99402978 6928.4986
##  [2,] 0.729988654 0.167240029 0.08657704 0.016194277 0.98380572 6760.7482
##  [3,] 0.524699170 0.241842261 0.18683680 0.046621773 0.95337823 5070.2997
##  [4,] 0.377141778 0.245176340 0.27879837 0.098883512 0.90111649 5031.0314
##  [5,] 0.271080895 0.218075678 0.33990501 0.170938413 0.82906159 4754.6488
##  [6,] 0.194846755 0.181294500 0.36812258 0.255736166 0.74426383 4301.2614
##  [7,] 0.140051397 0.144708456 0.36939853 0.345841614 0.65415839 3754.2323
##  [8,] 0.100665745 0.112458493 0.35165832 0.435217439 0.56478256 3183.8789
##  [9,] 0.072356238 0.085786310 0.32220653 0.519650919 0.48034908 2638.4366
## [10,] 0.052008011 0.064566891 0.28682784 0.596597257 0.40340274 2145.8006
## [11,] 0.037382170 0.048113547 0.24968008 0.664824199 0.33517580 1718.5215
## [12,] 0.026869450 0.035582616 0.21351148 0.724036457 0.27596354 1358.9096
## [13,] 0.019313147 0.026162355 0.17997216 0.774552340 0.22544766 1063.1645
## [14,] 0.013881849 0.019148852 0.14991621 0.817053091 0.18294691  824.3380
## [15,] 0.009977956 0.013965505 0.12365449 0.852402052 0.14759795  634.2871
## [16,] 0.007171927 0.010156423 0.10114967 0.881521977 0.11847802  484.8586
## [17,] 0.005155017 0.007369616 0.08215834 0.905317030 0.09468297  368.5373
## [18,] 0.003705309 0.005337826 0.06632966 0.924627205 0.07537280  278.7452
## [19,] 0.002663291 0.003860589 0.05327093 0.940205190 0.05979481  209.9241
## [20,] 0.001914313 0.002788911 0.04258875 0.952708028 0.04729197  157.4974
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.855015244 0.102631667 0.03680808 0.005545006 0.99445499 6926.3965
##  [2,] 0.731051067 0.166644455 0.08530184 0.017002638 0.98299736 6748.3738
##  [3,] 0.544997966 0.230686910 0.17433895 0.049976173 0.95002383 4987.7550
##  [4,] 0.406295534 0.235208439 0.25262866 0.105867366 0.89413263 4871.2708
##  [5,] 0.302892985 0.212906099 0.30311449 0.181086430 0.81891357 4543.4790
##  [6,] 0.225806470 0.181030340 0.32504876 0.268114431 0.73188557 4067.4649
##  [7,] 0.168338537 0.148209127 0.32394895 0.359503390 0.64049661 3520.2369
##  [8,] 0.125496240 0.118360732 0.30677462 0.449368405 0.55063159 2964.2489
##  [9,] 0.093557343 0.092913032 0.27984312 0.533686504 0.46631350 2441.1217
## [10,] 0.069746922 0.072043576 0.24812060 0.610088898 0.38991110 1974.0033
## [11,] 0.051996273 0.055357907 0.21515661 0.677489205 0.32251079 1572.3814
## [12,] 0.038763178 0.042249036 0.18328170 0.735706081 0.26429392 1236.7854
## [13,] 0.028897918 0.032078583 0.15388005 0.785143454 0.21485655  962.5205
## [14,] 0.021543374 0.024260232 0.12765152 0.826544871 0.17345513  742.3154
## [15,] 0.016060567 0.018291307 0.10483063 0.860817492 0.13918251  568.0460
## [16,] 0.011973140 0.013758113 0.08535518 0.888913569 0.11108643  431.7657
## [17,] 0.008925966 0.010329104 0.06898908 0.911755852 0.08824415  326.2545
## [18,] 0.006654300 0.007743367 0.05540760 0.930194737 0.06980526  245.2563
## [19,] 0.004960775 0.005798232 0.04425370 0.944987292 0.05501271  183.5273
## [20,] 0.003698254 0.004337759 0.03517337 0.956790618 0.04320938  136.7790</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.805607 8.635588 8.753803 8.875931 8.451055 8.711283 8.889190
##  [8] 8.856654 9.071101 8.901418</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50094.60 50628.35 49253.08 50718.09 49364.68 49692.66 49901.07
##  [8] 50367.99 51667.62 49449.98</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7421.881 7484.534 5975.866 6429.359 7165.993 8222.725 5821.203
##  [8] 6118.699 6304.515 6915.919</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     8.067053      8.805607       44613.13        50094.60 7421.881
##  [2,]     7.907293      8.635588       45177.40        50628.35 7484.534
##  [3,]     7.707845      8.753803       43002.57        49253.08 5975.866
##  [4,]     7.964829      8.875931       44860.28        50718.09 6429.359
##  [5,]     7.660390      8.451055       43698.78        49364.68 7165.993
##  [6,]     8.071485      8.711283       44431.78        49692.66 8222.725
##  [7,]     7.815099      8.889190       43648.56        49901.07 5821.203
##  [8,]     7.867089      8.856654       44313.14        50367.99 6118.699
##  [9,]     8.147608      9.071101       45845.45        51667.62 6304.515
## [10,]     8.074649      8.901418       43732.12        49449.98 6915.919</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
