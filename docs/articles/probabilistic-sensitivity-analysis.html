<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-model-hesim.html">Simple Markov Cohort Model (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model-simple.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package). See Appendix for more detail.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]      [,3]       [,4]
## [1,] 0.7166809 0.2148659 0.0609693 0.00748393
## [2,] 0.0000000 0.5842855 0.4020423 0.01367220
## [3,] 0.0000000 0.0000000 0.7594593 0.24054067
## [4,] 0.0000000 0.0000000 0.0000000 1.00000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7124133 0.2078885 0.06803232 0.01166584
## [2,] 0.0000000 0.5931842 0.39610950 0.01070627
## [3,] 0.0000000 0.0000000 0.72702673 0.27297327
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 3
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7330537 0.1930026 0.0642613 0.009682434
## [2,] 0.0000000 0.5736590 0.4159393 0.010401647
## [3,] 0.0000000 0.0000000 0.7457838 0.254216226
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7106448 0.1929546 0.08664917 0.009751446
## [2,] 0.0000000 0.5852118 0.40598605 0.008802183
## [3,] 0.0000000 0.0000000 0.75409349 0.245906507
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7128141 0.2188512 0.05817156 0.01016312
## [2,] 0.0000000 0.5950990 0.39273276 0.01216826
## [3,] 0.0000000 0.0000000 0.76852116 0.23147884
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7397612 0.1918218 0.05858218 0.009834812
## [2,] 0.0000000 0.5768030 0.40693663 0.016260403
## [3,] 0.0000000 0.0000000 0.74238856 0.257611443
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7238096 0.1986198 0.06839167 0.009178909
## [2,] 0.0000000 0.5673485 0.41932868 0.013322864
## [3,] 0.0000000 0.0000000 0.76494787 0.235052125
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7069526 0.2155354 0.06915779 0.008354233
## [2,] 0.0000000 0.5572754 0.43162763 0.011096972
## [3,] 0.0000000 0.0000000 0.74938998 0.250610024
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7035964 0.2261911 0.06052552 0.009686982
## [2,] 0.0000000 0.6021072 0.38430482 0.013588031
## [3,] 0.0000000 0.0000000 0.77343069 0.226569309
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7375056 0.1819763 0.06683324 0.01368482
## [2,] 0.0000000 0.5739464 0.41070603 0.01534753
## [3,] 0.0000000 0.0000000 0.74429521 0.25570479
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to a normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.4428662 0.4879749 0.5719761 0.5870349 0.5848334 0.4736686 0.5103366
##  [8] 0.4902662 0.5259573 0.6589845</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8745275 0.09515686 0.02700124 0.003314380
## [2,] 0.0000000 0.81589408 0.17805096 0.006054956
## [3,] 0.0000000 0.00000000 0.89347266 0.106527342
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8596649 0.1014444 0.03319807 0.005692636
## [2,] 0.0000000 0.8014841 0.19329149 0.005224393
## [3,] 0.0000000 0.0000000 0.86679589 0.133204106
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8473131 0.1103929 0.03675592 0.005538121
## [2,] 0.0000000 0.7561432 0.23790733 0.005949493
## [3,] 0.0000000 0.0000000 0.85459440 0.145405599
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8301384 0.1132711 0.05086609 0.005724439
## [2,] 0.0000000 0.7565048 0.23832799 0.005167189
## [3,] 0.0000000 0.0000000 0.85564430 0.144355705
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8320441 0.1279915 0.03402067 0.005943733
## [2,] 0.0000000 0.7632004 0.22968324 0.007116407
## [3,] 0.0000000 0.0000000 0.86462344 0.135376558
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8767331 0.09085996 0.02774854 0.004658441
## [2,] 0.0000000 0.79954487 0.19275309 0.007702042
## [3,] 0.0000000 0.00000000 0.87797756 0.122022443
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8590499 0.1013630 0.03490277 0.004684333
## [2,] 0.0000000 0.7792021 0.21399879 0.006799145
## [3,] 0.0000000 0.0000000 0.88004429 0.119955708
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8563287 0.1056697 0.03390573 0.004095798
## [2,] 0.0000000 0.7829471 0.21161244 0.005440470
## [3,] 0.0000000 0.0000000 0.87713437 0.122865626
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8441044 0.1189669 0.03183384 0.005094939
## [2,] 0.0000000 0.7907254 0.20212791 0.007146724
## [3,] 0.0000000 0.0000000 0.88083423 0.119165773
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8270203 0.1199196 0.04404207 0.009018085
## [2,] 0.0000000 0.7192373 0.27064892 0.010113785
## [3,] 0.0000000 0.0000000 0.83149450 0.168505499
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define an array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define a matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for the first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.716680865 0.214865909 0.06096930 0.00748393 0.99251607 5133.0616
##  [2,] 0.513631462 0.279533319 0.17638441 0.03045080 0.96954920 5398.7464
##  [3,] 0.368109840 0.273689155 0.27765676 0.08054425 0.91945575 5411.5013
##  [4,] 0.263817278 0.239006859 0.34334703 0.15382883 0.84617117 5130.1007
##  [5,] 0.189072795 0.196333580 0.37293373 0.24165990 0.75834010 4638.0877
##  [6,] 0.135504854 0.155340161 0.37369004 0.33546494 0.66453506 4037.4406
##  [7,] 0.097113736 0.119878377 0.35451734 0.42849055 0.57150945 3410.7790
##  [8,] 0.069599556 0.090909628 0.32335864 0.51613218 0.48386782 2813.3263
##  [9,] 0.049880670 0.068071749 0.28637069 0.59567689 0.40432311 2276.2136
## [10,] 0.035748522 0.050490991 0.24789580 0.66586468 0.33413532 1812.8729
## [11,] 0.025620282 0.037182293 0.21074586 0.72645157 0.27354843 1425.1821
## [12,] 0.018361566 0.027229999 0.17656381 0.77784462 0.22215538 1108.2867
## [13,] 0.013159383 0.019855368 0.14616014 0.82082511 0.17917489  853.9859
## [14,] 0.009431078 0.014428706 0.11978770 0.85635252 0.14364748  652.9181
## [15,] 0.006759073 0.010456901 0.09734984 0.88543418 0.11456582  495.8584
## [16,] 0.004844098 0.007562110 0.07854946 0.90904433 0.09095567  374.4056
## [17,] 0.003471673 0.005459263 0.06299075 0.92807832 0.07192168  281.2806
## [18,] 0.002488081 0.003935712 0.05024543 0.94333078 0.05666922  210.3892
## [19,] 0.001783160 0.002834183 0.03989338 0.95548928 0.04451072  156.7555
## [20,] 0.001277957 0.002039113 0.03154558 0.96513735 0.03486265  116.3947
## 
## , , 2
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.712413319 0.207888519 0.06803232 0.01166584 0.98833416 5152.9049
##  [2,] 0.507532737 0.271418741 0.18027507 0.04077345 0.95922655 5372.0059
##  [3,] 0.361573082 0.266511545 0.27310496 0.09881041 0.90118959 5308.6230
##  [4,] 0.257589479 0.233257338 0.32872102 0.18043216 0.81956784 4950.2557
##  [5,] 0.183510176 0.191914470 0.34890883 0.27566653 0.72433347 4396.9646
##  [6,] 0.130735093 0.151990296 0.34216981 0.37510480 0.62489520 3757.1683
##  [7,] 0.093137422 0.117336571 0.31786561 0.47166040 0.52833960 3113.3792
##  [8,] 0.066352340 0.088964404 0.28391128 0.56077198 0.43922802 2517.2642
##  [9,] 0.047270291 0.066566171 0.24616484 0.63999870 0.36000130 1995.1279
## [10,] 0.033675985 0.049312954 0.20855182 0.70845924 0.29154076 1555.6154
## [11,] 0.023991220 0.036252517 0.17344713 0.76630913 0.23369087 1196.5181
## [12,] 0.017091665 0.026491921 0.14209284 0.81432357 0.18567643  909.8312
## [13,] 0.012176330 0.019267750 0.11496178 0.85359414 0.14640586  685.1316
## [14,] 0.008674579 0.013960645 0.09204081 0.88532396 0.11467604  511.6355
## [15,] 0.006179886 0.010084580 0.07303623 0.91069931 0.08930069  379.3249
## [16,] 0.004402633 0.007266741 0.05751432 0.93081631 0.06918369  279.4667
## [17,] 0.003136494 0.005225773 0.04499239 0.94664534 0.05335466  204.7635
## [18,] 0.002234480 0.003751887 0.03499403 0.95901960 0.04098040  149.3003
## [19,] 0.001591874 0.002690083 0.02707977 0.96863827 0.03136173  108.3907
## [20,] 0.001134072 0.001926647 0.02086159 0.97607770 0.02392230   78.3880
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.733053664 0.193002604 0.06426130 0.009682434 0.99031757 5135.9290
##  [2,] 0.537367675 0.252198956 0.17530938 0.035123988 0.96487601 5364.6277
##  [3,] 0.393919343 0.248389573 0.27017430 0.087516789 0.91248321 5336.4718
##  [4,] 0.288764018 0.218518384 0.33012036 0.162597237 0.83740276 5024.8436
##  [5,] 0.211679522 0.181087255 0.35564514 0.251588079 0.74841192 4516.6116
##  [6,] 0.155172449 0.144737041 0.35415849 0.345932024 0.65406798 3912.0129
##  [7,] 0.113749732 0.112978399 0.33429906 0.438972809 0.56102719 3290.2742
##  [8,] 0.083384658 0.086765075 0.30361668 0.526233590 0.47376641 2703.2253
##  [9,] 0.061125429 0.065867026 0.26787980 0.605127742 0.39487226 2179.2519
## [10,] 0.044808220 0.049582583 0.23110509 0.674504103 0.32549590 1729.8293
## [11,] 0.032846830 0.037091600 0.19585721 0.734204361 0.26579564 1355.5812
## [12,] 0.024078489 0.027617456 0.16360576 0.784698292 0.21530171 1050.9427
## [13,] 0.017650825 0.020490214 0.13504902 0.826809938 0.17319006  807.3855
## [14,] 0.012939002 0.015161052 0.11037432 0.861525626 0.13847437  615.4696
## [15,] 0.009484983 0.011194536 0.08945293 0.889867550 0.11013245  466.0394
## [16,] 0.006953001 0.008252473 0.07197831 0.912816216 0.08718378  350.8421
## [17,] 0.005096923 0.006076053 0.05755959 0.931267432 0.06873257  262.7787
## [18,] 0.003736318 0.004469302 0.04578181 0.946012566 0.05398743  195.9395
## [19,] 0.002738922 0.003284975 0.03624239 0.957733710 0.04226629  145.5223
## [20,] 0.002007777 0.002413075 0.02857135 0.967007803 0.03299220  107.6963
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.710644794 0.192954591 0.08664917 0.009751446 0.99024855 5267.6130
##  [2,] 0.505016024 0.250041473 0.20525523 0.039687276 0.96031272 5510.2144
##  [3,] 0.358887009 0.243772372 0.30005420 0.097286419 0.90271358 5450.8551
##  [4,] 0.255041184 0.211907356 0.35633436 0.176717096 0.82328290 5096.7875
##  [5,] 0.181243690 0.173222045 0.37683996 0.268694302 0.73130570 4549.5269
##  [6,] 0.128799885 0.136343381 0.37020291 0.364653821 0.63534618 3914.5251
##  [7,] 0.091530968 0.104642279 0.34568152 0.458145231 0.54185477 3271.7659
##  [8,] 0.065046006 0.078899213 0.31109057 0.544964206 0.45503579 2671.9181
##  [9,] 0.046224605 0.058723673 0.27225954 0.622792181 0.37720782 2141.5720
## [10,] 0.032849275 0.043285034 0.23315546 0.690710227 0.30928977 1690.3905
## [11,] 0.023344166 0.031669330 0.19624050 0.748746003 0.25125400 1317.4356
## [12,] 0.016589410 0.023037628 0.16286374 0.797509218 0.20249078 1015.9142
## [13,] 0.011789178 0.016682894 0.13360490 0.837923024 0.16207698  776.3964
## [14,] 0.008377918 0.012037802 0.10854513 0.871039147 0.12896085  588.8210
## [15,] 0.005953724 0.008661221 0.08746630 0.897918757 0.10208124  443.6331
## [16,] 0.004230983 0.006217447 0.06998999 0.919561584 0.08043842  332.3456
## [17,] 0.003006726 0.004454911 0.05566980 0.936868562 0.06313144  247.7425
## [18,] 0.002136714 0.003187228 0.04404940 0.950626662 0.04937334  183.8750
## [19,] 0.001518445 0.002277492 0.03469648 0.961507585 0.03849241  135.9508
## [20,] 0.001079075 0.001625806 0.02722059 0.970074529 0.02992547  100.1772
## 
## , , 5
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.712814138 0.218851178 0.05817156 0.01016312 0.98983688 5104.9521
##  [2,] 0.508103995 0.286238324 0.17212162 0.03353606 0.96646394 5362.9746
##  [3,] 0.362183711 0.281539290 0.27425148 0.08202552 0.91797448 5389.3190
##  [4,] 0.258169670 0.246808074 0.34240656 0.15261570 0.84738430 5132.1104
##  [5,] 0.184026990 0.203375967 0.37509444 0.23750261 0.76249739 4665.3767
##  [6,] 0.131177040 0.161303353 0.37884555 0.32867405 0.67132595 4085.5031
##  [7,] 0.093504849 0.124699709 0.36213071 0.41966473 0.58033527 3472.9269
##  [8,] 0.066651578 0.094672315 0.33271810 0.50595801 0.49404199 2882.8665
##  [9,] 0.047510187 0.070926174 0.29675904 0.58480459 0.41519541 2347.5454
## [10,] 0.033865933 0.052605754 0.25868438 0.65484393 0.34515607 1881.8591
## [11,] 0.024140116 0.038717229 0.22143446 0.71570820 0.28429180 1489.1082
## [12,] 0.017207416 0.028323676 0.18678686 0.76768205 0.23231795 1165.6302
## [13,] 0.012265689 0.020621254 0.15567427 0.81143879 0.18856121  904.1283
## [14,] 0.008743157 0.014956048 0.12845113 0.84784967 0.15215033  695.8720
## [15,] 0.006232246 0.010813779 0.10509974 0.87785423 0.12214577  532.0385
## [16,] 0.004442433 0.007799203 0.08538084 0.90237752 0.09762248  404.4541
## [17,] 0.003166629 0.005613529 0.06893841 0.92228143 0.07771857  305.9415
## [18,] 0.002257218 0.004033626 0.05536945 0.93833971 0.06166029  230.4233
## [19,] 0.001608977 0.002894401 0.04426804 0.95122859 0.04877141  172.8886
## [20,] 0.001146901 0.002074582 0.03525125 0.96152727 0.03847273  129.2871
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.739761190 0.191821817 0.05858218 0.009834812 0.99016519 5101.3849
##  [2,] 0.547246618 0.252545729 0.16488689 0.035320764 0.96467924 5305.8533
##  [3,] 0.404831810 0.250642966 0.25723915 0.087286076 0.91271392 5270.1174
##  [4,] 0.299478861 0.222227180 0.31668313 0.161610825 0.83838918 4963.1136
##  [5,] 0.221542839 0.185627876 0.34307844 0.249750846 0.75024915 4465.8266
##  [6,] 0.163888794 0.149567460 0.34321475 0.343328994 0.65667101 3874.0326
##  [7,] 0.121238569 0.117708401 0.32526415 0.435788884 0.56421112 3264.3042
##  [8,] 0.089687588 0.091150757 0.29647466 0.522686995 0.47731301 2687.2306
##  [9,] 0.066347397 0.069780063 0.26244607 0.601426468 0.39857353 2170.8613
## [10,] 0.049081229 0.052976226 0.22711980 0.670822745 0.32917725 1726.8275
## [11,] 0.036308389 0.039971695 0.19304439 0.730675524 0.26932448 1356.1257
## [12,] 0.026859537 0.030020533 0.16170692 0.781413011 0.21858699 1053.6163
## [13,] 0.019869643 0.022468178 0.13383931 0.823822868 0.17617713  811.1646
## [14,] 0.014698791 0.016771143 0.10966790 0.858862162 0.14113784  619.6576
## [15,] 0.010873595 0.012493194 0.08910208 0.887531135 0.11246887  470.1924
## [16,] 0.008043864 0.009291904 0.07186930 0.910794933 0.08920507  354.7004
## [17,] 0.005950538 0.006902586 0.05760739 0.929539487 0.07046051  266.2108
## [18,] 0.004401977 0.005122875 0.04592458 0.944550571 0.05544943  198.8983
## [19,] 0.003256412 0.003799285 0.03643644 0.956507860 0.04349214  148.0131
## [20,] 0.002408967 0.002816090 0.02878683 0.965988109 0.03401189  109.7540
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.723809599 0.198619826 0.06839167 0.009178909 0.99082109 5164.2464
##  [2,] 0.523900335 0.256449588 0.18510559 0.034544482 0.96545552 5422.8437
##  [3,] 0.379204091 0.249553271 0.28496322 0.086279422 0.91372058 5419.6100
##  [4,] 0.274471561 0.216901113 0.34856125 0.160066076 0.83993392 5125.8650
##  [5,] 0.198665150 0.177574004 0.37635561 0.247405232 0.75259477 4628.3101
##  [6,] 0.143795743 0.140205174 0.37594134 0.340057742 0.65994226 4027.9044
##  [7,] 0.104080739 0.108105874 0.35620201 0.431611376 0.56838862 3405.0169
##  [8,] 0.075334638 0.082006199 0.32492612 0.517733043 0.48226696 2812.7642
##  [9,] 0.054527934 0.061489043 0.28809136 0.595891665 0.40410833 2280.7867
## [10,] 0.039467842 0.045716042 0.24988825 0.664927868 0.33507213 1821.6717
## [11,] 0.028567203 0.033776022 0.21302080 0.724635972 0.27536403 1436.9569
## [12,] 0.020677216 0.024836786 0.17906682 0.775419174 0.22458083 1121.7783
## [13,] 0.014966367 0.018198017 0.14880571 0.818029903 0.18197010  868.1064
## [14,] 0.010832800 0.013297234 0.12248314 0.853386826 0.14661317  666.8257
## [15,] 0.007840885 0.009695774 0.10001000 0.882453339 0.11754666  508.9642
## [16,] 0.005675308 0.007058238 0.08110441 0.906162049 0.09383795  386.3454
## [17,] 0.004107842 0.005131709 0.06538851 0.925371941 0.07462806  291.8702
## [18,] 0.002973296 0.003727366 0.05245162 0.940847723 0.05915228  219.5783
## [19,] 0.002152100 0.002705271 0.04188909 0.953253538 0.04674646  164.5859
## [20,] 0.001557711 0.001962281 0.03332456 0.963155454 0.03684455  122.9658
## 
## , , 8
## 
##            State A     State B    State C       Death    Disc LY
##  [1,] 0.7069525693 0.215535409 0.06915779 0.008354233 0.99164577
##  [2,] 0.4997819352 0.272485892 0.19374847 0.033983705 0.96601630
##  [3,] 0.3533221232 0.259570387 0.29736941 0.089738076 0.91026192
##  [4,] 0.2497819828 0.220805619 0.35931839 0.170094013 0.82990599
##  [5,] 0.1765840145 0.176886400 0.38184977 0.264679813 0.73532019
##  [6,] 0.1248365227 0.136634547 0.37471561 0.363813321 0.63618668
##  [7,] 0.0882535005 0.103049762 0.34841679 0.460279952 0.53972005
##  [8,] 0.0623910389 0.076448851 0.31168259 0.549477522 0.45052248
##  [9,] 0.0441075053 0.056050542 0.27088407 0.628957883 0.37104212
## [10,] 0.0311819142 0.040742317 0.23024115 0.697834622 0.30216538
## [11,] 0.0220441343 0.029425498 0.19228239 0.756247979 0.24375202
## [12,] 0.0155841574 0.021149397 0.15831988 0.804946569 0.19505343
## [13,] 0.0110172601 0.015144977 0.12884976 0.844988005 0.15501200
## [14,] 0.0077886803 0.010814532 0.10385764 0.877539150 0.12246085
## [15,] 0.0055062276 0.007705409 0.08303637 0.903751992 0.09624801
## [16,] 0.0038926417 0.005480822 0.06593329 0.924693246 0.07530675
## [17,] 0.0027519131 0.003893329 0.05204463 0.941310130 0.05868987
## [18,] 0.0019454720 0.002762791 0.04087251 0.954419230 0.04558077
## [19,] 0.0013753564 0.001958954 0.03195649 0.964709201 0.03529080
## [20,] 0.0009723118 0.001388115 0.02488853 0.972751046 0.02724895
##        Disc cost
##  [1,] 5177.40435
##  [2,] 5477.66423
##  [3,] 5472.59446
##  [4,] 5140.05771
##  [5,] 4588.84005
##  [6,] 3937.45477
##  [7,] 3275.67681
##  [8,] 2659.53006
##  [9,] 2117.64300
## [10,] 1659.77132
## [11,] 1284.15777
## [12,]  982.91433
## [13,]  745.57273
## [14,]  561.22822
## [15,]  419.70758
## [16,]  312.10857
## [17,]  230.96200
## [18,]  170.18490
## [19,]  124.93185
## [20,]   91.40877
## 
## , , 9
## 
##            State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.7035963812 0.226191113 0.06052552 0.009686982 0.99031302 5123.1447
##  [2,] 0.4950478676 0.295338535 0.17632417 0.033289426 0.96671057 5389.8573
##  [3,] 0.3483138881 0.289800872 0.27983758 0.082047660 0.91795234 5420.5971
##  [4,] 0.2450723912 0.253276683 0.34888872 0.152762201 0.84723780 5165.1385
##  [5,] 0.1724320476 0.207932899 0.38200983 0.237625221 0.76237478 4698.2260
##  [6,] 0.1213225647 0.164200482 0.38580428 0.328672670 0.67132733 4116.7776
##  [7,] 0.0853621175 0.126308370 0.36883902 0.419490490 0.58050951 3501.7152
##  [8,] 0.0600604769 0.095359325 0.33897892 0.505601276 0.49439872 2908.6755
##  [9,] 0.0422583342 0.071001678 0.30245894 0.584281046 0.41571895 2370.2080
## [10,] 0.0297328110 0.052309078 0.26377502 0.654183088 0.34581691 1901.4367
## [11,] 0.0209198982 0.038220967 0.22591392 0.714945211 0.28505479 1505.8048
## [12,] 0.0147191647 0.027745013 0.19068345 0.766852371 0.23314763 1179.7257
## [13,] 0.0103563510 0.020034815 0.15903386 0.810574973 0.18942503  915.9317
## [14,] 0.0072866911 0.014405620 0.13132797 0.846979721 0.15302028  705.6909
## [15,] 0.0051268895 0.010321911 0.10755026 0.877000938 0.12299906  540.1618
## [16,] 0.0036072609 0.007374554 0.08745974 0.901558445 0.09844156  411.1433
## [17,] 0.0025380557 0.005256202 0.07069646 0.921509287 0.07849071  311.4268
## [18,] 0.0017857668 0.003738882 0.05685241 0.937622941 0.06237706  234.9045
## [19,] 0.0012564591 0.002655132 0.04551635 0.950572055 0.04942794  176.5366
## [20,] 0.0008840401 0.001882874 0.03630017 0.960932913 0.03906709  132.2468
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.737505607 0.181976334 0.06683324 0.01368482 0.98631518 5129.0096
##  [2,] 0.543914521 0.238653234 0.17377233 0.04365992 0.95634008 5314.2650
##  [3,] 0.401140009 0.235953743 0.26370580 0.09920045 0.90079955 5250.0489
##  [4,] 0.295843006 0.208422798 0.31999208 0.17574212 0.82425788 4919.9138
##  [5,] 0.218185876 0.173459947 0.34354122 0.26481296 0.73518704 4408.6378
##  [6,] 0.160913307 0.139261384 0.34151920 0.35830611 0.64169389 3811.2598
##  [7,] 0.118674466 0.109210988 0.32214095 0.44997360 0.55002640 3202.1585
##  [8,] 0.087523084 0.084277202 0.29255297 0.53564674 0.46435326 2629.6415
##  [9,] 0.064548765 0.064297729 0.25820838 0.61294512 0.38705488 2119.9003
## [10,] 0.047605076 0.048649800 0.22290473 0.68084039 0.31915961 1683.2404
## [11,] 0.035109011 0.036585377 0.18906929 0.73923632 0.26076368 1319.8060
## [12,] 0.025893092 0.027387055 0.15809565 0.78862420 0.21137580 1023.9697
## [13,] 0.019096301 0.020430633 0.13064838 0.82982468 0.17017532  787.3650
## [14,] 0.014083629 0.015201164 0.10690822 0.86380699 0.13619301  600.8121
## [15,] 0.010386755 0.011287541 0.08675574 0.89156997 0.10843003  455.4398
## [16,] 0.007660290 0.008368587 0.06990192 0.91406920 0.08593080  343.2634
## [17,] 0.005649507 0.006197112 0.05597666 0.93217672 0.06782328  257.4175
## [18,] 0.004166543 0.004584887 0.04458592 0.94666265 0.05333735  192.1860
## [19,] 0.003072849 0.003389692 0.03534659 0.95819087 0.04180913  142.9211
## [20,] 0.002266243 0.002504687 0.02790584 0.96732323 0.03267677  105.9125</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.176415 7.625209 8.050778 7.834823 8.293924 8.092457 8.169588
##  [8] 7.787430 8.303811 7.933703</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 45737.59 42622.06 44551.27 44707.46 46355.21 44217.89 45897.00
##  [8] 44429.81 46709.35 43697.17</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define an array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define a matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for the first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.874527519 0.095156858 0.02700124 0.003314380 0.99668562 6881.4618
##  [2,] 0.764798381 0.160855208 0.06468097 0.009665438 0.99033456 6678.6279
##  [3,] 0.548116365 0.258314464 0.16042239 0.033146785 0.96685322 4992.7125
##  [4,] 0.392824510 0.268700916 0.25910589 0.079368685 0.92063132 5016.8555
##  [5,] 0.281529810 0.241402643 0.32875975 0.148307793 0.85169221 4792.8773
##  [6,] 0.201767027 0.201539222 0.36389841 0.232795339 0.76720466 4368.2829
##  [7,] 0.144602568 0.161109300 0.36969493 0.324593201 0.67540680 3829.8306
##  [8,] 0.103633893 0.125203989 0.35435734 0.416804781 0.58319522 3254.9858
##  [9,] 0.074272428 0.095422266 0.32577577 0.504529534 0.49547047 2698.3868
## [10,] 0.053229628 0.071712459 0.29030558 0.584752338 0.41524766 2192.4163
## [11,] 0.038148656 0.053337782 0.25255209 0.655961469 0.34403853 1752.2961
## [12,] 0.027340412 0.039361338 0.21557299 0.717725265 0.28227473 1381.6587
## [13,] 0.019594350 0.028872781 0.18121076 0.770322105 0.22967790 1077.1545
## [14,] 0.014042896 0.021080105 0.15042494 0.814452060 0.18554794  831.7887
## [15,] 0.010064275 0.015334139 0.12357290 0.851028683 0.14897132  637.1282
## [16,] 0.007212873 0.011121985 0.10062718 0.881037964 0.11896204  484.6445
## [17,] 0.005169328 0.008048215 0.08133352 0.905448935 0.09455106  366.4506
## [18,] 0.003704759 0.005813168 0.06532040 0.925161678 0.07483832  275.6416
## [19,] 0.002655130 0.004192576 0.05217120 0.940981095 0.05901891  206.3936
## [20,] 0.001902881 0.003020158 0.04146938 0.953607583 0.04639242  153.9250
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.859664917 0.101444380 0.03319807 0.005692636 0.99430736 6903.7843
##  [2,] 0.739023769 0.168514234 0.07692350 0.015538500 0.98446150 6711.5338
##  [3,] 0.526490376 0.253594543 0.17295303 0.046962050 0.95303795 4998.9139
##  [4,] 0.375078756 0.259879588 0.26201105 0.103030609 0.89696939 4934.8222
##  [5,] 0.267211102 0.232131040 0.31894729 0.181710572 0.81828943 4619.3402
##  [6,] 0.190364748 0.193246592 0.34201150 0.274377156 0.72562284 4122.5390
##  [7,] 0.135618382 0.154205477 0.33814927 0.372026871 0.62797313 3538.5246
##  [8,] 0.096616341 0.119665761 0.31615225 0.467565652 0.53243435 2943.7958
##  [9,] 0.068830769 0.091069271 0.28382491 0.556275049 0.44372495 2388.2259
## [10,] 0.049035956 0.068329982 0.24710442 0.635529645 0.36447035 1898.3296
## [11,] 0.034933868 0.050726280 0.21005370 0.704286151 0.29571385 1483.7941
## [12,] 0.024887353 0.037352379 0.17518445 0.762575819 0.23742418 1143.6893
## [13,] 0.017730082 0.027330637 0.14385255 0.811086728 0.18891327  871.2443
## [14,] 0.012631146 0.019897984 0.11661679 0.850854075 0.14914592  657.1097
## [15,] 0.008998597 0.014429040 0.09352463 0.883047730 0.11695227  491.3844
## [16,] 0.006410720 0.010429784 0.07432258 0.908836912 0.09116309  364.7498
## [17,] 0.004567083 0.007519499 0.05860198 0.929311441 0.07068856  269.0138
## [18,] 0.003253650 0.005409892 0.04589446 0.945441999 0.05455800  197.2900
## [19,] 0.002317944 0.003885459 0.03573076 0.958065836 0.04193416  143.9714
## [20,] 0.001651334 0.002786667 0.02767398 0.967888018 0.03211198  104.6001
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.847313083 0.110392871 0.03675592 0.005538121 0.99446188 6928.3025
##  [2,] 0.717939461 0.177010141 0.08881846 0.016231942 0.98376806 6775.5531
##  [3,] 0.526288153 0.240107654 0.18600056 0.047603633 0.95239637 5061.3297
##  [4,] 0.385797459 0.239314912 0.27240637 0.102481259 0.89751874 4983.6623
##  [5,] 0.282810241 0.211745078 0.32748857 0.177956106 0.82204389 4668.8516
##  [6,] 0.207315084 0.176052592 0.35048252 0.266149805 0.73385020 4185.4774
##  [7,] 0.151973082 0.141006513 0.34793371 0.359086700 0.64091330 3619.9252
##  [8,] 0.111404424 0.110220862 0.32789945 0.450475263 0.54952474 3042.0919
##  [9,] 0.081665422 0.084730539 0.29754627 0.536057768 0.46394223 2498.1236
## [10,] 0.059865137 0.064368079 0.26239587 0.613370916 0.38662908 2013.3372
## [11,] 0.043884358 0.048479458 0.22631081 0.681325377 0.31867462 1597.8661
## [12,] 0.032169589 0.036280475 0.19176351 0.739786430 0.26021357 1252.0486
## [13,] 0.023582035 0.027021437 0.16017185 0.789224682 0.21077532  970.6259
## [14,] 0.017286897 0.020052486 0.13220825 0.830452363 0.16954764  745.6629
## [15,] 0.012672223 0.014839706 0.10805027 0.864437804 0.13556220  568.4130
## [16,] 0.009289420 0.010958704 0.08756889 0.892182991 0.10781701  430.4080
## [17,] 0.006809643 0.008079442 0.07046256 0.914648355 0.08535165  324.0203
## [18,] 0.004991834 0.005949124 0.05634799 0.932711054 0.06728895  242.6918
## [19,] 0.003659282 0.004376206 0.04481867 0.947145841 0.05285416  180.9640
## [20,] 0.002682450 0.003216701 0.03548042 0.958620425 0.04137957  134.4019
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.830138392 0.113271082 0.05086609 0.005724439 0.99427556 7011.0645
##  [2,] 0.689129750 0.179720793 0.11274484 0.018404619 0.98159538 6895.6088
##  [3,] 0.489726470 0.238145472 0.21769680 0.054431255 0.94556875 5198.3406
##  [4,] 0.348021567 0.233860503 0.30328187 0.114836057 0.88516394 5085.9962
##  [5,] 0.247319715 0.204010276 0.35380277 0.194867239 0.80513276 4726.4427
##  [6,] 0.175756468 0.167110688 0.37105574 0.286077103 0.71392290 4203.5543
##  [7,] 0.124900419 0.131708158 0.36288448 0.380506943 0.61949306 3608.5364
##  [8,] 0.088759833 0.101177273 0.33794302 0.472119877 0.52788012 3011.4406
##  [9,] 0.063076713 0.076336748 0.30360816 0.556978381 0.44302162 2456.7463
## [10,] 0.044825138 0.056844104 0.26540614 0.632924622 0.36707538 1967.6364
## [11,] 0.031854751 0.041915055 0.22710301 0.699127180 0.30087282 1552.2435
## [12,] 0.022637413 0.030675703 0.19103402 0.755652863 0.24434714 1209.2642
## [13,] 0.016087160 0.022319775 0.15847293 0.803120132 0.19687987  932.1993
## [14,] 0.011432256 0.016165886 0.12995886 0.842442994 0.15755701  712.2372
## [15,] 0.008124273 0.011666373 0.10555485 0.874654500 0.12534550  540.0519
## [16,] 0.005773473 0.008394915 0.08503857 0.900793038 0.09920696  406.8212
## [17,] 0.004102888 0.006026821 0.06803552 0.921834770 0.07816523  304.7259
## [18,] 0.002915696 0.004318638 0.05410746 0.938658206 0.06134179  227.1274
## [19,] 0.002072024 0.003089914 0.04280803 0.952030028 0.04796997  168.5578
## [20,] 0.001472473 0.002208061 0.03371526 0.962604205 0.03739579  124.6153
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.832044116 0.127991478 0.03402067 0.005943733 0.99405627 6914.3617
##  [2,] 0.692297411 0.204177698 0.08711927 0.016405622 0.98359438 6772.1562
##  [3,] 0.493479382 0.273016042 0.18741230 0.046092280 0.95390772 5083.3057
##  [4,] 0.351759080 0.270470110 0.27995913 0.097811684 0.90218832 5046.9829
##  [5,] 0.250738845 0.237939373 0.34183936 0.169482420 0.83051758 4773.5550
##  [6,] 0.178730194 0.196471968 0.37074324 0.254054598 0.74594540 4321.9445
##  [7,] 0.127401409 0.156035580 0.37248202 0.344080993 0.65591901 3775.1754
##  [8,] 0.090813525 0.120738561 0.35495174 0.433496177 0.56650382 3203.7697
##  [9,] 0.064733165 0.091726041 0.32548867 0.518052121 0.48194788 2656.3848
## [10,] 0.046142715 0.068753002 0.28993438 0.595169900 0.40483010 2161.3482
## [11,] 0.032891180 0.051013228 0.25250646 0.663589133 0.33641087 1731.5559
## [12,] 0.023445298 0.037556193 0.21600445 0.722994055 0.27700594 1369.5523
## [13,] 0.016712140 0.027480683 0.18211739 0.773689787 0.22631021 1071.6702
## [14,] 0.011912650 0.020011198 0.15172580 0.816350349 0.18364965  831.0188
## [15,] 0.008491505 0.014515741 0.12515652 0.851836234 0.14816377  639.4614
## [16,] 0.006052865 0.010496678 0.10238021 0.881070252 0.11892975  488.8213
## [17,] 0.004314568 0.007571239 0.08315585 0.904958345 0.09504165  371.5456
## [18,] 0.003075485 0.005449885 0.06713149 0.924343143 0.07565686  281.0138
## [19,] 0.002192249 0.003916294 0.05391122 0.939980234 0.06001977  211.6267
## [20,] 0.001562666 0.002810359 0.04309750 0.952529476 0.04747052  158.7713
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.876733057 0.090859965 0.02774854 0.004658441 0.99534156 6875.6395
##  [2,] 0.768660852 0.152306553 0.06620419 0.012828402 0.98717160 6664.8043
##  [3,] 0.568625467 0.235296793 0.15615818 0.039919561 0.96008044 4935.9854
##  [4,] 0.420647052 0.244794659 0.24499225 0.089566040 0.91043396 4900.7075
##  [5,] 0.311178364 0.221887567 0.30613778 0.160796291 0.83920371 4635.9131
##  [6,] 0.230197677 0.187676206 0.33579687 0.246329248 0.75367075 4193.5261
##  [7,] 0.170291307 0.152409129 0.33914956 0.338150005 0.66184999 3655.7457
##  [8,] 0.125974900 0.120575626 0.32377764 0.429671829 0.57032817 3093.5549
##  [9,] 0.093191342 0.093713113 0.29681534 0.516280203 0.48371980 2555.9225
## [10,] 0.068939338 0.071930134 0.26394696 0.595183564 0.40481644 2071.1252
## [11,] 0.050998647 0.054713584 0.22926083 0.665026941 0.33497306 1651.7734
## [12,] 0.037726820 0.041341611 0.19545319 0.725478381 0.27452162 1300.0504
## [13,] 0.027908837 0.031082791 0.16413575 0.776872626 0.22312737 1011.9591
## [14,] 0.020645875 0.023282170 0.13613619 0.819935769 0.18006423  780.3614
## [15,] 0.015273017 0.017389554 0.11174979 0.855587635 0.14441237  596.9674
## [16,] 0.011298385 0.012960044 0.09093294 0.884808629 0.11519137  453.5322
## [17,] 0.008358107 0.009642669 0.07344338 0.908555848 0.09144415  342.5015
## [18,] 0.006183003 0.007165187 0.05893711 0.927714697 0.07228530  257.2998
## [19,] 0.004573946 0.005318936 0.04703223 0.943074889 0.05692511  192.4028
## [20,] 0.003383627 0.003945361 0.03734861 0.955322401 0.04467760  143.2871
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.859049923 0.101362972 0.03490277 0.004684333 0.99531567 6920.5882
##  [2,] 0.737966770 0.166058091 0.08239076 0.013584378 0.98641562 6753.6877
##  [3,] 0.534147431 0.240787632 0.18312834 0.041936600 0.95806340 5070.3765
##  [4,] 0.386621038 0.242702761 0.27758403 0.093092176 0.90690782 5047.5311
##  [5,] 0.279840018 0.214487639 0.34055120 0.165121146 0.83487885 4778.7564
##  [6,] 0.202550891 0.177271006 0.36958346 0.250594644 0.74940536 4325.1056
##  [7,] 0.146608279 0.140805054 0.37089969 0.341686975 0.65831302 3773.6139
##  [8,] 0.106116480 0.109004840 0.35278931 0.432089367 0.56791063 3197.5529
##  [9,] 0.076808127 0.082920564 0.32283177 0.517439535 0.48256047 2646.8369
## [10,] 0.055594459 0.062300471 0.28697349 0.595131583 0.40486842 2150.0543
## [11,] 0.040239803 0.046388237 0.24944633 0.663925628 0.33607437 1719.8656
## [12,] 0.029125956 0.034310717 0.21301743 0.723545900 0.27645410 1358.4150
## [13,] 0.021081646 0.025251125 0.17932667 0.774340561 0.22565944 1061.6461
## [14,] 0.015259098 0.018513420 0.14920588 0.817021599 0.18297840  822.3610
## [15,] 0.011044682 0.013534319 0.12294153 0.852479472 0.14752053  632.2116
## [16,] 0.007994247 0.009872368 0.10047455 0.881658834 0.11834117  482.8930
## [17,] 0.005786312 0.007188888 0.08154430 0.905480497 0.09451950  366.7864
## [18,] 0.004188188 0.005227881 0.06578738 0.924796547 0.07520345  277.2476
## [19,] 0.003031451 0.003797888 0.05280256 0.940368105 0.05963190  208.6793
## [20,] 0.002194193 0.002756832 0.04219109 0.952857882 0.04714212  156.4842
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.856328748 0.105669727 0.03390573 0.004095798 0.99590420 6919.8649
##  [2,] 0.733298925 0.173221830 0.08113536 0.012343889 0.98765611 6756.4524
##  [3,] 0.518407559 0.254584148 0.18628268 0.040725610 0.95927439 5095.4792
##  [4,] 0.366489556 0.253608667 0.28533585 0.094565929 0.90543407 5082.5939
##  [5,] 0.259090733 0.220321347 0.34863794 0.171949980 0.82805002 4792.1328
##  [6,] 0.183164859 0.178622893 0.37428070 0.263931547 0.73606845 4298.7575
##  [7,] 0.129488868 0.139020656 0.37024806 0.361242417 0.63875758 3705.0840
##  [8,] 0.091542488 0.105382227 0.34642050 0.456654781 0.54334522 3094.3147
##  [9,] 0.064716197 0.078457570 0.31142081 0.545405423 0.45459458 2520.5073
## [10,] 0.045751282 0.057671105 0.27171572 0.624861895 0.37513810 2012.4608
## [11,] 0.032343986 0.041999709 0.23167754 0.693978769 0.30602123 1580.9732
## [12,] 0.022865664 0.030376679 0.19398190 0.752775761 0.24722424 1225.5757
## [13,] 0.016164940 0.021856536 0.16006084 0.801917683 0.19808232  939.6267
## [14,] 0.011427846 0.015664227 0.13049981 0.842408121 0.15759188  713.7448
## [15,] 0.008078945 0.011192394 0.10534668 0.875381977 0.12461802  537.9223
## [16,] 0.005711431 0.007978544 0.08433542 0.901974607 0.09802539  402.7010
## [17,] 0.004037711 0.005677262 0.06703887 0.923246161 0.07675384  299.7354
## [18,] 0.002854470 0.004034068 0.05296796 0.940143505 0.05985650  221.9829
## [19,] 0.002017975 0.002863326 0.04163228 0.953486419 0.04651358  163.6834
## [20,] 0.001426613 0.002030606 0.03257426 0.963968518 0.03603148  120.2335
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.844104364 0.118966858 0.03183384 0.005094939 0.99490506 6904.6476
##  [2,] 0.712512178 0.194490557 0.07895794 0.014039326 0.98596067 6739.1966
##  [3,] 0.501320990 0.278268077 0.17893732 0.041473608 0.95852639 5059.6519
##  [4,] 0.352727634 0.280941552 0.27567810 0.090652717 0.90934728 5056.7867
##  [5,] 0.248177887 0.248940773 0.34253412 0.160347221 0.83965278 4813.5975
##  [6,] 0.174617063 0.206024652 0.37561664 0.243741649 0.75625835 4382.0118
##  [7,] 0.122859934 0.163545744 0.38025849 0.333335832 0.66666417 3844.9564
##  [8,] 0.086443805 0.126261887 0.36439117 0.422903142 0.57709686 3275.2734
##  [9,] 0.060821548 0.095576006 0.33558642 0.508016027 0.49198397 2724.3243
## [10,] 0.042793821 0.071304290 0.29996441 0.585937477 0.41406252 2222.7319
## [11,] 0.030109578 0.052612405 0.26199438 0.655283634 0.34471637 1785.0734
## [12,] 0.021184990 0.038488824 0.22467610 0.715650090 0.28434991 1415.0012
## [13,] 0.014905682 0.027966253 0.18984506 0.767283004 0.23271700 1109.5061
## [14,] 0.010487584 0.020210214 0.15848174 0.810820465 0.18917953  862.0363
## [15,] 0.007379026 0.014540912 0.13097629 0.847103773 0.15289623  664.5849
## [16,] 0.005191856 0.010424258 0.10733584 0.877048043 0.12295196  508.9776
## [17,] 0.003652971 0.007450872 0.08733717 0.901558989 0.09844101  387.5938
## [18,] 0.002570217 0.005312493 0.07063375 0.921483540 0.07851646  293.7128
## [19,] 0.001808396 0.003780050 0.05682749 0.937584064 0.06241594  221.6253
## [20,] 0.001272381 0.002685038 0.04551427 0.950528310 0.04947169  166.6113
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.827020261 0.119919586 0.04404207 0.009018085 0.99098192 6950.5523
##  [2,] 0.683962512 0.185426566 0.10550053 0.025110395 0.97488960 6814.3102
##  [3,] 0.504426188 0.230889906 0.20039078 0.064293130 0.93570687 5064.0248
##  [4,] 0.372017142 0.224312067 0.27769021 0.125980584 0.87401942 4912.6058
##  [5,] 0.274364728 0.196441426 0.32367292 0.205520925 0.79447907 4543.9527
##  [6,] 0.202345526 0.162674743 0.33992457 0.295055165 0.70494483 4033.5815
##  [7,] 0.149230960 0.130188686 0.33333913 0.387241224 0.61275878 3462.8636
##  [8,] 0.110058670 0.101877835 0.31154558 0.476517911 0.52348209 2894.1504
##  [9,] 0.081168886 0.078500493 0.28107930 0.559251317 0.44074868 2366.9971
## [10,] 0.059862509 0.059825894 0.24687138 0.633440213 0.36655979 1901.9839
## [11,] 0.044148936 0.045230419 0.21231685 0.698303797 0.30169620 1506.2539
## [12,] 0.032560088 0.033993899 0.17955344 0.753892578 0.24610742 1178.4910
## [13,] 0.024013247 0.025435842 0.14977836 0.800772554 0.19922745  912.6910
## [14,] 0.017709904 0.018968654 0.12353085 0.839790592 0.16020941  700.7375
## [15,] 0.013061154 0.014109775 0.10091757 0.871911501 0.12808850  534.0199
## [16,] 0.009632674 0.010475076 0.08178035 0.898111897 0.10188810  404.3591
## [17,] 0.007104151 0.007765051 0.06581468 0.919316114 0.08068389  304.4701
## [18,] 0.005239351 0.005749511 0.05264950 0.936361637 0.06363836  228.1332
## [19,] 0.003864051 0.004253349 0.04189829 0.949984307 0.05001569  170.1958
## [20,] 0.002849759 0.003144360 0.03318982 0.960816059 0.03918394  126.4843</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 9.246995 8.619897 8.874513 8.632212 9.088069 9.104239 9.108164
##  [8] 8.774941 9.210114 8.589310</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 51873.52 48786.66 50223.76 50343.21 51864.02 50313.06 51750.69
##  [8] 50483.83 52437.90 49010.86</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 5731.410 6197.522 6886.292 7067.757 6936.786 6024.199 6236.786
##  [8] 6130.578 6320.790 8104.991</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     8.176415      9.246995       45737.59        51873.52 5731.410
##  [2,]     7.625209      8.619897       42622.06        48786.66 6197.522
##  [3,]     8.050778      8.874513       44551.27        50223.76 6886.292
##  [4,]     7.834823      8.632212       44707.46        50343.21 7067.757
##  [5,]     8.293924      9.088069       46355.21        51864.02 6936.786
##  [6,]     8.092457      9.104239       44217.89        50313.06 6024.199
##  [7,]     8.169588      9.108164       45897.00        51750.69 6236.786
##  [8,]     7.787430      8.774941       44429.81        50483.83 6130.578
##  [9,]     8.303811      9.210114       46709.35        52437.90 6320.790
## [10,]     7.933703      8.589310       43697.17        49010.86 8104.991</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
