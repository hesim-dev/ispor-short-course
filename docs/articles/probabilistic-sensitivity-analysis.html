<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (HESIM)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7279356 0.1984486 0.06528754 0.008328281
## [2,] 0.0000000 0.5903741 0.39398479 0.015641137
## [3,] 0.0000000 0.0000000 0.73804191 0.261958087
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7030348 0.2212052 0.07060308 0.005156886
## [2,] 0.0000000 0.5807682 0.41020811 0.009023662
## [3,] 0.0000000 0.0000000 0.74787066 0.252129338
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7080314 0.2126667 0.07421397 0.00508790
## [2,] 0.0000000 0.5870563 0.40089855 0.01204516
## [3,] 0.0000000 0.0000000 0.74867780 0.25132220
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7121419 0.2080802 0.06817477 0.01160308
## [2,] 0.0000000 0.5816022 0.40759855 0.01079921
## [3,] 0.0000000 0.0000000 0.73930577 0.26069423
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7239831 0.2004316 0.06599742 0.009587785
## [2,] 0.0000000 0.5860281 0.40316842 0.010803511
## [3,] 0.0000000 0.0000000 0.73862295 0.261377053
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7271293 0.1867447 0.07757236 0.008553658
## [2,] 0.0000000 0.5791430 0.40774320 0.013113763
## [3,] 0.0000000 0.0000000 0.75904502 0.240954984
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7341149 0.1919581 0.06024662 0.01368034
## [2,] 0.0000000 0.5679216 0.42044878 0.01162962
## [3,] 0.0000000 0.0000000 0.73387647 0.26612353
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 8
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.7132493 0.2151494 0.0638331 0.007768247
## [2,] 0.0000000 0.5791692 0.4084514 0.012379385
## [3,] 0.0000000 0.0000000 0.7553127 0.244687278
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7251815 0.1932979 0.07471596 0.006804647
## [2,] 0.0000000 0.5983153 0.38685685 0.014827893
## [3,] 0.0000000 0.0000000 0.73918374 0.260816259
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7239531 0.2062752 0.05650992 0.01326174
## [2,] 0.0000000 0.5795944 0.41153436 0.00887122
## [3,] 0.0000000 0.0000000 0.76434542 0.23565458
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.3771873 0.4240069 0.4498642 0.5799581 0.5774087 0.4967199 0.5586676
##  [8] 0.5204513 0.5209258 0.5856051</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8973807 0.0748523 0.02462563 0.003141322
## [2,] 0.0000000 0.8454943 0.14860607 0.005899638
## [3,] 0.0000000 0.0000000 0.90119273 0.098807269
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8740847 0.09379254 0.02993619 0.002186555
## [2,] 0.0000000 0.82224285 0.17393106 0.003826095
## [3,] 0.0000000 0.00000000 0.89309543 0.106904570
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8686538 0.09567114 0.03338621 0.002288864
## [2,] 0.0000000 0.81423142 0.18034990 0.005418687
## [3,] 0.0000000 0.00000000 0.88693914 0.113060857
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.8330544 0.1206778 0.03953851 0.00672930
## [2,] 0.0000000 0.7573468 0.23639009 0.00626309
## [3,] 0.0000000 0.0000000 0.84880826 0.15119174
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 5
## 
##           [,1]     [,2]       [,3]        [,4]
## [1,] 0.8406255 0.115731 0.03810749 0.005536070
## [2,] 0.0000000 0.760969 0.23279296 0.006238041
## [3,] 0.0000000 0.000000 0.84907861 0.150921387
## [4,] 0.0000000 0.000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8644597 0.09275983 0.03853173 0.004248772
## [2,] 0.0000000 0.79095197 0.20253416 0.006513867
## [3,] 0.0000000 0.00000000 0.88031286 0.119687136
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8514586 0.1072408 0.03365783 0.007642765
## [2,] 0.0000000 0.7586118 0.23489111 0.006497092
## [3,] 0.0000000 0.0000000 0.85132541 0.148674591
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8507602 0.1119748 0.03322202 0.004042994
## [2,] 0.0000000 0.7809781 0.21257906 0.006442867
## [3,] 0.0000000 0.0000000 0.87265219 0.127347812
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##         [,1]      [,2]       [,3]        [,4]
## [1,] 0.85684 0.1006939 0.03892147 0.003544716
## [2,] 0.00000 0.7907521 0.20152372 0.007724232
## [3,] 0.00000 0.0000000 0.86413408 0.135865920
## [4,] 0.00000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8383456 0.1207958 0.03309249 0.007766140
## [2,] 0.0000000 0.7538084 0.24099660 0.005195032
## [3,] 0.0000000 0.0000000 0.86199949 0.138000513
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.727935559 0.198448618 0.06528754 0.008328281 0.99167172 5149.93268
##  [2,] 0.529890178 0.261616725 0.17389580 0.034597295 0.96540271 5361.60415
##  [3,] 0.385725903 0.259607705 0.26601063 0.088655764 0.91134424 5312.59295
##  [4,] 0.280783601 0.229812430 0.32379158 0.165612392 0.83438761 4984.13281
##  [5,] 0.204392368 0.191396418 0.34784603 0.256365187 0.74363481 4464.49135
##  [6,] 0.148784472 0.153556865 0.34547650 0.352182161 0.64781784 3853.41402
##  [7,] 0.108305508 0.120182065 0.32518898 0.446323447 0.55367655 3229.21007
##  [8,] 0.078839431 0.092445453 0.29442400 0.534291113 0.46570889 2642.77813
##  [9,] 0.057390025 0.070222975 0.25886659 0.613520410 0.38647959 2121.65963
## [10,] 0.041776240 0.052846795 0.22246803 0.682908934 0.31709107 1676.59525
## [11,] 0.030410411 0.039489815 0.18773903 0.742360742 0.25763926 1307.59289
## [12,] 0.022136819 0.029348667 0.15610308 0.792411432 0.20758857 1008.59357
## [13,] 0.016114178 0.021719713 0.12821880 0.833947305 0.16605270  770.69355
## [14,] 0.011730083 0.016020592 0.10424014 0.868009182 0.13199082  584.18625
## [15,] 0.008538745 0.011785961 0.08401129 0.895664002 0.10433600  439.74340
## [16,] 0.006215656 0.008652628 0.06720482 0.917926898 0.08207310  329.01527
## [17,] 0.004524597 0.006341775 0.05341478 0.935718847 0.06428115  244.86444
## [18,] 0.003293615 0.004641920 0.04221631 0.949848155 0.05015184  181.38438
## [19,] 0.002397539 0.003394082 0.03320128 0.961007094 0.03899291  133.80362
## [20,] 0.001745254 0.002479567 0.02599769 0.969777494 0.03022251   98.33872
## 
## , , 2
## 
##            State A     State B    State C       Death    Disc LY
##  [1,] 0.7030347902 0.221205248 0.07060308 0.005156886 0.99484311
##  [2,] 0.4942579163 0.283983964 0.19317858 0.028579544 0.97142046
##  [3,] 0.3474805105 0.274261307 0.29586124 0.082396937 0.91760306
##  [4,] 0.2442908878 0.236146765 0.35830335 0.161258996 0.83874100
##  [5,] 0.1717449930 0.191184964 0.38208157 0.254988471 0.74501153
##  [6,] 0.1207427052 0.149025046 0.37629895 0.353933303 0.64606670
##  [7,] 0.0848863224 0.113257931 0.35107903 0.450776715 0.54922329
##  [8,] 0.0596780379 0.084553908 0.31501427 0.540753789 0.45924621
##  [9,] 0.0419557368 0.062307318 0.27448808 0.621248866 0.37875113
## [10,] 0.0294963426 0.045466940 0.23380275 0.691233964 0.30876604
## [11,] 0.0207369551 0.032930500 0.19558766 0.750744885 0.24925511
## [12,] 0.0145788008 0.023712111 0.16124672 0.800462364 0.19953764
## [13,] 0.0102494042 0.016996148 0.13134790 0.841406545 0.15859345
## [14,] 0.0072056877 0.012138045 0.10592684 0.874729427 0.12527057
## [15,] 0.0050658492 0.008643327 0.08470744 0.901583380 0.09841662
## [16,] 0.0035614682 0.006140362 0.06725344 0.923044730 0.07695527
## [17,] 0.0025038361 0.004353943 0.05306715 0.940075070 0.05992493
## [18,] 0.0017602839 0.003082493 0.04165017 0.953507056 0.04649294
## [19,] 0.0012375408 0.002179598 0.03253768 0.964045178 0.03595482
## [20,] 0.0008700342 0.001539592 0.02531544 0.972274932 0.02772507
##        Disc cost
##  [1,] 5202.69512
##  [2,] 5501.73470
##  [3,] 5499.35837
##  [4,] 5173.85752
##  [5,] 4629.54138
##  [6,] 3982.07950
##  [7,] 3320.56991
##  [8,] 2701.65496
##  [9,] 2155.04380
## [10,] 1691.53829
## [11,] 1310.18176
## [12,] 1003.60205
## [13,]  761.60370
## [14,]  573.37845
## [15,]  428.73731
## [16,]  318.70061
## [17,]  235.69520
## [18,]  173.52987
## [19,]  127.25901
## [20,]   93.00216
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.708031424 0.212666709 0.07421397 0.00508790 0.99491210 5221.93242
##  [2,] 0.501308498 0.275422043 0.19336594 0.02990352 0.97009648 5494.58984
##  [3,] 0.354942170 0.268299872 0.29238918 0.08436878 0.91563122 5471.31951
##  [4,] 0.251310210 0.232991511 0.35280798 0.16289030 0.83710970 5139.40343
##  [5,] 0.177935526 0.190224448 0.37619619 0.25564384 0.74435616 4599.37235
##  [6,] 0.125983944 0.149513422 0.37111574 0.35338689 0.64661311 3961.27961
##  [7,] 0.089200591 0.114565386 0.34713560 0.44909843 0.55090157 3310.05209
##  [8,] 0.063156822 0.086226327 0.31244174 0.53817511 0.46182489 2700.02070
##  [9,] 0.044717014 0.064051061 0.27317332 0.61805860 0.38194140 2159.99052
## [10,] 0.031661051 0.047111399 0.23351540 0.68771215 0.31228785 1700.70679
## [11,] 0.022417019 0.034390295 0.19606438 0.74712830 0.25287170 1321.56983
## [12,] 0.015871954 0.024956393 0.16223973 0.79693193 0.20306807 1015.70215
## [13,] 0.011237842 0.018026244 0.13264818 0.83808773 0.16191227  773.39025
## [14,] 0.007956745 0.012972335 0.10737145 0.87169947 0.12830053  584.22809
## [15,] 0.005633626 0.009307626 0.08617771 0.89888104 0.10111896  438.33060
## [16,] 0.003988784 0.006662185 0.06866885 0.92068018 0.07931982  326.92990
## [17,] 0.002824185 0.004759359 0.05437772 0.93803873 0.06196127  242.58896
## [18,] 0.001999611 0.003394622 0.04282901 0.95177676 0.04822324  179.19550
## [19,] 0.001415788 0.002418085 0.03357443 0.96259170 0.03740830  131.84259
## [20,] 0.001002422 0.001720643 0.02621091 0.97106603 0.02893397   96.66174
## 
## , , 4
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.712141916 0.208080238 0.06817477 0.01160308 0.98839692 5154.09654
##  [2,] 0.507146108 0.269202591 0.18376531 0.03988599 0.96011401 5394.81566
##  [3,] 0.361160001 0.262095912 0.28015991 0.09658418 0.90341582 5353.96271
##  [4,] 0.257197175 0.227585828 0.33857575 0.17664124 0.82335876 5012.83636
##  [5,] 0.183160889 0.185882076 0.36060902 0.27034802 0.72965198 4470.28981
##  [6,] 0.130436546 0.146221593 0.35485255 0.36848932 0.63151068 3835.33052
##  [7,] 0.092889332 0.112184073 0.33083673 0.46408987 0.53591013 3191.63466
##  [8,] 0.066150387 0.084574942 0.29664827 0.55262640 0.44737360 2592.12991
##  [9,] 0.047108463 0.062953564 0.25829619 0.63164178 0.36835822 2064.28083
## [10,] 0.033547911 0.046416274 0.21983126 0.70020456 0.29979544 1617.71135
## [11,] 0.023890874 0.033976466 0.18372884 0.75840382 0.24159618 1250.98405
## [12,] 0.017013693 0.024732007 0.15130931 0.80694499 0.19305501  956.66307
## [13,] 0.012116164 0.017924404 0.12310448 0.84685495 0.15314505  724.71443
## [14,] 0.008628428 0.012946008 0.09914383 0.87928173 0.12071827  544.59449
## [15,] 0.006144665 0.009324832 0.07916262 0.90536788 0.09463212  406.40940
## [16,] 0.004375874 0.006701927 0.06274508 0.92617712 0.07382288  301.46521
## [17,] 0.003116243 0.004808388 0.04941782 0.94265755 0.05734245  222.44579
## [18,] 0.002219207 0.003444998 0.03870722 0.95562857 0.04437143  163.38084
## [19,] 0.001580391 0.002465392 0.03017194 0.96578228 0.03421772  119.50907
## [20,] 0.001125462 0.001762725 0.02341892 0.97369289 0.02630711   87.10061
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.723983145 0.200431646 0.06599742 0.009587785 0.99041222 5148.69128
##  [2,] 0.524151594 0.262567704 0.17733595 0.035944757 0.96405524 5374.95650
##  [3,] 0.379476919 0.258928611 0.27143606 0.090158410 0.90984159 5334.54819
##  [4,] 0.274734893 0.227798618 0.32992524 0.167541248 0.83245875 5006.33962
##  [5,] 0.198903432 0.188561951 0.35366336 0.258871259 0.74112874 4481.61070
##  [6,] 0.144002732 0.150369138 0.35037321 0.355254920 0.64474508 3863.42269
##  [7,] 0.104255551 0.116983241 0.32892159 0.449839619 0.55016038 3232.32605
##  [8,] 0.075479262 0.089451574 0.29699358 0.538075584 0.46192442 2640.34704
##  [9,] 0.054645713 0.067549566 0.26041176 0.617392961 0.38260704 2115.36959
## [10,] 0.039562575 0.050538672 0.22318643 0.686712323 0.31328768 1668.03017
## [11,] 0.028642638 0.037546673 0.18783724 0.745973447 0.25402655 1298.03296
## [12,] 0.020736787 0.027744295 0.15576887 0.795750047 0.20424995  998.96696
## [13,] 0.015013084 0.020415244 0.12760866 0.836963011 0.16303699  761.60689
## [14,] 0.010869220 0.014973003 0.10347629 0.870681485 0.12931851  575.98719
## [15,] 0.007869132 0.010953136 0.08318395 0.897993786 0.10200621  432.58881
## [16,] 0.005697119 0.007996068 0.06637687 0.919929941 0.08007006  322.93219
## [17,] 0.004124618 0.005827803 0.05262724 0.937420340 0.06257966  239.79888
## [18,] 0.002986154 0.004241960 0.04149349 0.951278400 0.04872160  177.23750
## [19,] 0.002161925 0.003084428 0.03255534 0.962198303 0.03780170  130.45685
## [20,] 0.001565197 0.002240879 0.02543235 0.970761574 0.02923843   95.67016
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.727129251 0.186744735 0.07757236 0.008553658 0.99144634 5218.0397
##  [2,] 0.528716948 0.243939473 0.19142993 0.035913644 0.96408636 5448.5985
##  [3,] 0.384445559 0.240010954 0.28578242 0.089761069 0.91023893 5406.8223
##  [4,] 0.279541611 0.210793857 0.34460690 0.165057630 0.83494237 5084.9503
##  [5,] 0.203262883 0.174282719 0.36920661 0.253247784 0.74675222 4572.2104
##  [6,] 0.147798388 0.138892897 0.36707461 0.346234101 0.65376590 3966.6390
##  [7,] 0.107468531 0.108039425 0.34672386 0.437768185 0.56223182 3344.9882
##  [8,] 0.078143513 0.082639463 0.31556795 0.523649079 0.47635092 2757.4943
##  [9,] 0.056820434 0.062452959 0.27928773 0.601438876 0.39856112 2231.8540
## [10,] 0.041315799 0.046780113 0.24186442 0.670039663 0.32996034 1779.4711
## [11,] 0.030041926 0.034807885 0.20586522 0.729284966 0.27071503 1401.2264
## [12,] 0.021844363 0.025768916 0.17278407 0.779602648 0.22039735 1091.9317
## [13,] 0.015883676 0.019003208 0.14335251 0.821760608 0.17823939  843.4314
## [14,] 0.011549485 0.013971768 0.11779157 0.856687177 0.14331282  646.5943
## [15,] 0.008397968 0.010248458 0.09600192 0.885351655 0.11464834  492.4901
## [16,] 0.006106409 0.007503599 0.07769997 0.908690025 0.09130997  373.0105
## [17,] 0.004440148 0.005485997 0.06251100 0.927562852 0.07243715  281.1335
## [18,] 0.003228562 0.004006351 0.05002998 0.942735111 0.05726489  210.9752
## [19,] 0.002347582 0.002923167 0.03985901 0.954870238 0.04512976  157.7232
## [20,] 0.001706995 0.002131331 0.03162879 0.964532880 0.03546712  117.5142
## 
## , , 7
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.734114889 0.191958148 0.06024662 0.01368034 0.98631966 5092.97583
##  [2,] 0.538924670 0.249936513 0.16915009 0.04198873 0.95801127 5299.00955
##  [3,] 0.395632624 0.245395326 0.26168916 0.09728289 0.90271711 5249.91595
##  [4,] 0.290439800 0.215310212 0.31905921 0.17519078 0.82480922 4919.10806
##  [5,] 0.213216182 0.178031606 0.34217498 0.26657723 0.73342277 4396.63049
##  [6,] 0.156525173 0.142036578 0.33881289 0.36262535 0.63737465 3784.58503
##  [7,] 0.114907460 0.110711923 0.31779603 0.45658459 0.54341541 3162.25806
##  [8,] 0.084355277 0.084933115 0.28669451 0.54401710 0.45598290 2580.34977
##  [9,] 0.061926465 0.064428034 0.25119050 0.62245500 0.37754500 2065.62149
## [10,] 0.045461140 0.048477361 0.21516235 0.69089915 0.30910085 1627.91219
## [11,] 0.033373700 0.036257977 0.18102371 0.74934461 0.25065539 1266.45558
## [12,] 0.024500130 0.026998042 0.15010432 0.79839751 0.20160249  974.63666
## [13,] 0.017985910 0.020035771 0.12298537 0.83899295 0.16100705  743.21377
## [14,] 0.013203724 0.014831289 0.09976368 0.87220131 0.12779869  562.31995
## [15,] 0.009693051 0.010957572 0.08024549 0.89910389 0.10089611  422.59314
## [16,] 0.007115813 0.008083702 0.06408135 0.92071914 0.07928086  315.72997
## [17,] 0.005223824 0.005956847 0.05085528 0.93796405 0.06203595  234.68322
## [18,] 0.003834887 0.004385778 0.04014076 0.95163857 0.04836143  173.65473
## [19,] 0.002815248 0.003226916 0.03153339 0.96242444 0.03757556  127.98316
## [20,] 0.002066715 0.002373045 0.02466798 0.97089226 0.02910774   93.98739
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.713249263 0.215149388 0.06383310 0.007768247 0.99223175 5148.6788
##  [2,] 0.508724512 0.278063044 0.18162094 0.031591509 0.96840849 5422.3812
##  [3,] 0.362847383 0.270497322 0.28322931 0.083425989 0.91657401 5427.7753
##  [4,] 0.258800629 0.234730113 0.34757338 0.158895876 0.84110412 5129.8199
##  [5,] 0.184589358 0.191629252 0.37492249 0.248858902 0.75114110 4619.2564
##  [6,] 0.131658223 0.150700050 0.37323787 0.344403854 0.65559615 4002.7576
##  [7,] 0.093905131 0.115607016 0.35186911 0.438618740 0.56138126 3365.0206
##  [8,] 0.066977765 0.087159656 0.31898532 0.526877258 0.47312274 2761.5407
##  [9,] 0.047771842 0.064890414 0.28080955 0.606528191 0.39347181 2222.7475
## [10,] 0.034073231 0.047860613 0.24165303 0.676413123 0.32358688 1760.9963
## [11,] 0.024302707 0.035050228 0.20424734 0.736399720 0.26360028 1377.0694
## [12,] 0.017333888 0.025528726 0.17013825 0.786999137 0.21300086 1065.1728
## [13,] 0.012363383 0.018514827 0.14004130 0.829080486 0.17091951  816.3835
## [14,] 0.008818174 0.013383192 0.11412658 0.863672055 0.13632794  620.8320
## [15,] 0.006289556 0.009648358 0.09223053 0.891831555 0.10816845  468.9679
## [16,] 0.004486021 0.006941226 0.07400526 0.914567492 0.08543251  352.2066
## [17,] 0.003199651 0.004985309 0.05901863 0.932796415 0.06720359  263.1874
## [18,] 0.002282149 0.003575740 0.04681802 0.947324092 0.05267591  195.8031
## [19,] 0.001627741 0.002561962 0.03696844 0.958841859 0.04115814  145.1078
## [20,] 0.001160985 0.001834017 0.02907307 0.967931926 0.03206807  107.1702
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.725181510 0.193297880 0.07471596 0.006804647 0.99319535 5211.33119
##  [2,] 0.525888223 0.255829120 0.18419007 0.034092589 0.96590741 5419.61147
##  [3,] 0.381364416 0.254719544 0.27441180 0.089504244 0.91049576 5351.88508
##  [4,] 0.276558423 0.226119523 0.32987475 0.167447306 0.83255269 5006.07052
##  [5,] 0.200555055 0.188748917 0.35197727 0.258718762 0.74128124 4474.34978
##  [6,] 0.145438817 0.151698224 0.34817935 0.354683611 0.64531639 3856.05977
##  [7,] 0.105469541 0.118876377 0.32692061 0.448733470 0.55126653 3228.08339
##  [8,] 0.076484561 0.091512589 0.29552280 0.536480050 0.46351995 2640.00079
##  [9,] 0.055465190 0.069537682 0.25956254 0.615434591 0.38456541 2118.41102
## [10,] 0.040222330 0.052326759 0.22290967 0.684541239 0.31545876 1673.46251
## [11,] 0.029168490 0.039082790 0.18801942 0.743729300 0.25627070 1304.82352
## [12,] 0.021152450 0.029022037 0.15627970 0.793545818 0.20645418 1006.25624
## [13,] 0.015339365 0.021453051 0.12832721 0.834880374 0.16511963  768.77207
## [14,] 0.011123824 0.015800755 0.10430274 0.868772680 0.13122732  582.63058
## [15,] 0.008066792 0.011604044 0.08404265 0.896286516 0.10371348  438.49512
## [16,] 0.005849888 0.008502170 0.06721478 0.918433160 0.08156684  328.01904
## [17,] 0.004242231 0.006217749 0.05341028 0.936129744 0.06387026  244.07219
## [18,] 0.003076387 0.004540188 0.04220235 0.950181075 0.04981892  180.75611
## [19,] 0.002230939 0.003311123 0.03318155 0.961276389 0.03872361  133.30667
## [20,] 0.001617836 0.002412331 0.02597488 0.969994954 0.03000505   97.94673
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.723953135 0.206275213 0.05650992 0.01326174 0.98673826 5076.9258
##  [2,] 0.524108142 0.268889550 0.16899296 0.03800934 0.96199066 5320.9570
##  [3,] 0.379429733 0.263957402 0.26944359 0.08716927 0.91283073 5337.9746
##  [4,] 0.274689345 0.231255187 0.33601706 0.15803841 0.84196159 5075.2046
##  [5,] 0.198862212 0.190695819 0.36752523 0.24291674 0.75708326 4606.8491
##  [6,] 0.143966922 0.151546578 0.37063179 0.33385471 0.66614529 4028.8865
##  [7,] 0.104225305 0.117532359 0.35379290 0.42444944 0.57555056 3420.8347
##  [8,] 0.075454236 0.089620196 0.32467835 0.51024722 0.48975278 2836.8497
##  [9,] 0.054625331 0.067507705 0.28931211 0.58855485 0.41144515 2308.2189
## [10,] 0.039546179 0.050394941 0.25200300 0.65805588 0.34194412 1849.1435
## [11,] 0.028629581 0.037366023 0.21559134 0.71841305 0.28158695 1462.4836
## [12,] 0.020726475 0.027562711 0.18178151 0.76992930 0.23007070 1144.3469
## [13,] 0.015004996 0.020250552 0.15145812 0.81328633 0.18671367  887.3601
## [14,] 0.010862914 0.014832266 0.12494805 0.84935677 0.15064323  682.8148
## [15,] 0.007864241 0.010837448 0.10222132 0.87907699 0.12092301  521.9651
## [16,] 0.005693342 0.007903523 0.08303679 0.90336635 0.09663365  396.7389
## [17,] 0.004121713 0.005755233 0.06704309 0.92307996 0.07692004  300.0644
## [18,] 0.002983927 0.004185908 0.05384547 0.93898469 0.06101531  225.9641
## [19,] 0.002160223 0.003041639 0.04304781 0.95175033 0.04824967  169.5138
## [20,] 0.001563900 0.002208518 0.03427721 0.96195037 0.03804963  126.7369</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7.950544 7.887799 7.918793 7.727094 7.901671 8.097258 7.827020
##  [8] 8.047174 7.930329 8.236248</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 43894.63 44883.76 44869.11 43464.36 43898.92 45427.10 43093.62
##  [8] 45272.88 44064.34 45779.83</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.897380743 0.074852302 0.02462563 0.003141322 0.99685868 6862.9451
##  [2,] 0.805292197 0.130458209 0.05541452 0.008835077 0.99116492 6624.3300
##  [3,] 0.586200826 0.236828268 0.14487233 0.032098572 0.96790143 4910.1892
##  [4,] 0.426716426 0.256148013 0.23850020 0.078635360 0.92136464 4914.8098
##  [5,] 0.310622060 0.235904431 0.30480083 0.148672677 0.85132732 4678.3738
##  [6,] 0.226112843 0.200914378 0.33817830 0.234794481 0.76520552 4247.7170
##  [7,] 0.164595579 0.163486421 0.34350932 0.328408682 0.67159132 3708.6640
##  [8,] 0.119814975 0.129181909 0.32868148 0.422321637 0.57767836 3137.6006
##  [9,] 0.087217581 0.100042766 0.30129884 0.511440813 0.48855919 2588.0397
## [10,] 0.063488778 0.076370863 0.26748072 0.592659636 0.40734036 2091.2885
## [11,] 0.046215739 0.057686638 0.23164597 0.664451654 0.33554835 1661.6167
## [12,] 0.033642080 0.043228145 0.19670940 0.726420371 0.27357963 1301.8738
## [13,] 0.024489266 0.032197000 0.16440743 0.778906308 0.22109369 1008.1102
## [14,] 0.017826608 0.023868135 0.13562354 0.822681714 0.17731829  772.9068
## [15,] 0.012976622 0.017628794 0.11066340 0.858731187 0.14126881  587.5602
## [16,] 0.009446144 0.012982775 0.08946691 0.888104166 0.11189583  443.3970
## [17,] 0.006876184 0.009539268 0.07176206 0.911822483 0.08817752  332.4803
## [18,] 0.005005419 0.006996306 0.05717067 0.930827608 0.06917239  247.9238
## [19,] 0.003643623 0.005123756 0.04527758 0.945955043 0.05404496  183.9665
## [20,] 0.002652322 0.003748005 0.03567332 0.957926357 0.04207364  135.9163
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.874084712 0.093792544 0.02993619 0.002186555 0.99781345 6905.9653
##  [2,] 0.764024084 0.159102877 0.06921608 0.007656964 0.99234304 6716.1258
##  [3,] 0.537135512 0.261408032 0.17097241 0.030484042 0.96951596 5060.1072
##  [4,] 0.377624952 0.270634673 0.27302037 0.078720008 0.92127999 5088.7912
##  [5,] 0.265483479 0.240708640 0.34186194 0.151945937 0.84805406 4840.2400
##  [6,] 0.186644122 0.198522268 0.37315311 0.241680504 0.75831950 4376.9047
##  [7,] 0.131217311 0.156582085 0.37368335 0.338517250 0.66148275 3798.9041
##  [8,] 0.092250335 0.119963857 0.35296241 0.434823403 0.56517660 3191.6319
##  [9,] 0.064855195 0.090077455 0.31969353 0.525373818 0.47462618 2612.8383
## [10,] 0.045595458 0.066660433 0.28061889 0.607125216 0.39287478 2094.8805
## [11,] 0.032055193 0.048800216 0.24043047 0.678714123 0.32128588 1651.3360
## [12,] 0.022535916 0.035432392 0.20209233 0.739939360 0.26006064 1283.6283
## [13,] 0.015843533 0.025563070 0.16726469 0.791328711 0.20867129  986.2448
## [14,] 0.011138555 0.018350892 0.13669713 0.833813421 0.16618658  750.3675
## [15,] 0.007830792 0.013121522 0.11054588 0.868501811 0.13149819  566.1737
## [16,] 0.005505319 0.009352775 0.08860945 0.896532456 0.10346754  424.1624
## [17,] 0.003870431 0.006649600 0.07049368 0.918986285 0.08101372  315.8259
## [18,] 0.002721047 0.004718036 0.05572114 0.936839774 0.06316023  233.9098
## [19,] 0.001912991 0.003341995 0.04379970 0.950945315 0.04905469  172.4361
## [20,] 0.001344899 0.002364088 0.03426249 0.962028526 0.03797147  126.5999
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.868653795 0.095671135 0.03338621 0.002288864 0.99771114 6926.1479
##  [2,] 0.754559416 0.161003539 0.07586687 0.008570179 0.99142982 6747.8396
##  [3,] 0.534251778 0.254987808 0.17734477 0.033415643 0.96658436 5079.5658
##  [4,] 0.378267048 0.263309765 0.27464728 0.083775910 0.91622409 5074.9694
##  [5,] 0.267824956 0.235022462 0.33925552 0.157897062 0.84210294 4804.4210
##  [6,] 0.189628485 0.194928867 0.36808959 0.247353056 0.75264694 4333.7109
##  [7,] 0.134262927 0.154761884 0.36780029 0.343174903 0.65682510 3758.4949
##  [8,] 0.095062371 0.119407193 0.34737191 0.438158529 0.56184147 3159.0692
##  [9,] 0.067307146 0.090315345 0.31499476 0.527382749 0.47261725 2589.5089
## [10,] 0.047655574 0.067334181 0.27703200 0.607978240 0.39202176 2080.0739
## [11,] 0.033741644 0.049663709 0.23793860 0.678656052 0.32134395 1643.4191
## [12,] 0.023890144 0.036331117 0.20055355 0.739225185 0.26077482 1280.7669
## [13,] 0.016914973 0.026409049 0.16648807 0.790187910 0.20981209  986.7786
## [14,] 0.011976332 0.019100850 0.13648860 0.832434221 0.16756578  752.9600
## [15,] 0.008479620 0.013760242 0.11073230 0.867027843 0.13297216  569.8349
## [16,] 0.006003837 0.009881369 0.08904858 0.895066215 0.10493378  428.2101
## [17,] 0.004250905 0.007077736 0.07107569 0.917595670 0.08240433  319.8237
## [18,] 0.003009775 0.005059056 0.05636572 0.935565449 0.06443455  237.6043
## [19,] 0.002131015 0.003610029 0.04445130 0.949807657 0.05019234  175.7013
## [20,] 0.001508826 0.002572486 0.03488511 0.961033581 0.03896642  129.3944
## 
## , , 4
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.833054364 0.120677825 0.03953851 0.00672930 0.99327070 6939.5816
##  [2,] 0.693979574 0.191926156 0.09502539 0.01906888 0.98093112 6796.0344
##  [3,] 0.494211943 0.256028117 0.19579354 0.05396640 0.94603360 5089.7913
##  [4,] 0.351949040 0.251742264 0.28280077 0.11350793 0.88649207 4994.0748
##  [5,] 0.250637663 0.219647504 0.33568006 0.19403477 0.80596523 4648.3798
##  [6,] 0.178489586 0.179900224 0.35478538 0.28682481 0.71317519 4131.8708
##  [7,] 0.127109916 0.141770528 0.34779043 0.38332912 0.61667088 3538.3188
##  [8,] 0.090520299 0.108903118 0.32357463 0.47700196 0.52299804 2941.1037
##  [9,] 0.064463299 0.082173782 0.28978054 0.56358238 0.43641762 2386.9300
## [10,] 0.045907017 0.061205994 0.25212511 0.64076188 0.35923812 1899.9694
## [11,] 0.032692311 0.045149886 0.21447473 0.70768308 0.29231692 1488.4746
## [12,] 0.023281565 0.033061899 0.17919422 0.76446231 0.23553769 1150.7952
## [13,] 0.016579778 0.024073308 0.14754252 0.81180439 0.18819561  879.9127
## [14,] 0.011807155 0.017451014 0.12002160 0.85072023 0.14927977  666.5011
## [15,] 0.008408370 0.012606384 0.09665062 0.88233462 0.11766538  500.8107
## [16,] 0.005987953 0.009081517 0.07716595 0.90776458 0.09223542  373.7142
## [17,] 0.004264272 0.006527805 0.06115907 0.92804885 0.07195115  277.2011
## [18,] 0.003036767 0.004683897 0.04816669 0.94411264 0.05588736  204.5354
## [19,] 0.002162609 0.003356056 0.03772609 0.95675524 0.04324476  150.2226
## [20,] 0.001540085 0.002401886 0.02940648 0.96665155 0.03334845  109.8822
## 
## , , 5
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.840625464 0.115730978 0.03810749 0.00553607 0.99446393 6937.7773
##  [2,] 0.706651171 0.185354094 0.09133173 0.01666300 0.98333700 6789.0016
##  [3,] 0.511603537 0.250257959 0.18882579 0.04931272 0.95068728 5071.4568
##  [4,] 0.370392338 0.249199727 0.27413168 0.10627625 0.89372375 4979.3904
##  [5,] 0.268157809 0.220276381 0.32739435 0.18417146 0.81582854 4646.9182
##  [6,] 0.194141734 0.182835453 0.34832719 0.27469563 0.72530437 4147.0677
##  [7,] 0.140555343 0.146058855 0.34380879 0.36957701 0.63042299 3568.6509
##  [8,] 0.101759699 0.113766328 0.32210767 0.46236630 0.53763370 2982.4787
##  [9,] 0.073672307 0.087066125 0.29049898 0.54876258 0.45123742 2434.6026
## [10,] 0.053337509 0.065789455 0.25453371 0.62633933 0.37366067 1949.6754
## [11,] 0.038615457 0.049244992 0.21804881 0.69409074 0.30590926 1536.9273
## [12,] 0.027956940 0.036598707 0.18345840 0.75198595 0.24801405 1195.7751
## [13,] 0.020240353 0.027051325 0.15210711 0.80060121 0.19939879  920.1445
## [14,] 0.014653675 0.019909643 0.12459186 0.84084483 0.15915517  701.4469
## [15,] 0.010609014 0.014604670 0.10102045 0.87376587 0.12623413  530.4542
## [16,] 0.007680747 0.010685129 0.08120433 0.90042979 0.09957021  398.3730
## [17,] 0.005560731 0.007801250 0.06479420 0.92184382 0.07815618  297.3797
## [18,] 0.004025876 0.005686298 0.05137069 0.93891713 0.06108287  220.8191
## [19,] 0.002914666 0.004139243 0.04050181 0.95244429 0.04755571  163.2065
## [20,] 0.002110169 0.003009904 0.03177674 0.96310319 0.03689681  120.1277
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.864459669 0.092759827 0.03853173 0.004248772 0.99575123 6942.5125
##  [2,] 0.747290519 0.153555697 0.08601614 0.013137642 0.98686236 6773.3947
##  [3,] 0.543376796 0.228483283 0.18587050 0.042269420 0.95773058 5080.3040
##  [4,] 0.395105163 0.233797258 0.27639760 0.094699979 0.90530002 5033.1577
##  [5,] 0.287292521 0.209185864 0.33577670 0.167744914 0.83225509 4745.4117
##  [6,] 0.208898796 0.174798902 0.36244970 0.253852600 0.74614740 4281.5916
##  [7,] 0.151896425 0.140244318 0.36259348 0.345265782 0.65473422 3726.9908
##  [8,] 0.110448334 0.109587378 0.34419140 0.435772888 0.56422711 3152.3065
##  [9,] 0.080310214 0.084092412 0.31450801 0.521089362 0.47891064 2605.3696
## [10,] 0.058395906 0.063699045 0.27924370 0.598661349 0.40133865 2113.3824
## [11,] 0.042461371 0.047795986 0.24246130 0.667281343 0.33271866 1688.1849
## [12,] 0.030874905 0.035610150 0.20682136 0.726693587 0.27330641 1331.4830
## [13,] 0.022450047 0.026389097 0.17390156 0.777259300 0.22274070 1039.0159
## [14,] 0.016324086 0.019475490 0.14450059 0.819699838 0.18030016  803.5144
## [15,] 0.011869720 0.014327531 0.11888975 0.854913002 0.14508700  616.6296
## [16,] 0.008630821 0.010514298 0.09700539 0.883849496 0.11615050  470.0902
## [17,] 0.006275722 0.007701043 0.07858810 0.907435135 0.09256487  356.3261
## [18,] 0.004563261 0.005631963 0.06327878 0.926525999 0.07347400  268.7455
## [19,] 0.003318081 0.004113877 0.05068182 0.941886224 0.05811378  201.8028
## [20,] 0.002412674 0.003002158 0.04040458 0.954180591 0.04581941  150.9486
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.851458604 0.107240797 0.03365783 0.007642765 0.99235724 6895.0135
##  [2,] 0.724981754 0.172665234 0.08250193 0.019851080 0.98014892 6716.3305
##  [3,] 0.532219900 0.237226470 0.17682081 0.053732816 0.94626718 4986.5283
##  [4,] 0.390710553 0.236889983 0.26157067 0.110828799 0.88917120 4896.1571
##  [5,] 0.286826434 0.209535012 0.31509965 0.188538902 0.81146110 4570.6834
##  [6,] 0.210563556 0.174058130 0.33662328 0.278755030 0.72124497 4079.2545
##  [7,] 0.154577841 0.139270762 0.33290818 0.373243217 0.62675678 3509.7237
##  [8,] 0.113477895 0.108767350 0.31218250 0.465572260 0.53442774 2932.4985
##  [9,] 0.083305812 0.083554334 0.28167115 0.551468706 0.44853129 2393.2615
## [10,] 0.061156037 0.063443540 0.24686104 0.628539383 0.37146062 1916.3218
## [11,] 0.044895557 0.047770356 0.21152471 0.695809373 0.30419063 1510.6563
## [12,] 0.032958497 0.035747885 0.17802280 0.753270814 0.24672919 1175.5495
## [13,] 0.024195323 0.026628648 0.14766254 0.801513488 0.19848651  904.9070
## [14,] 0.017762147 0.019767474 0.12101973 0.841450645 0.15854935  690.2031
## [15,] 0.013039457 0.014635964 0.09819485 0.874129724 0.12587028  522.3237
## [16,] 0.009572459 0.010815110 0.07900215 0.900610280 0.09938972  392.6116
## [17,] 0.007027285 0.007979646 0.06310173 0.921891341 0.07810866  293.3816
## [18,] 0.005158834 0.005880758 0.05008728 0.938873131 0.06112687  218.1062
## [19,] 0.003787177 0.004330090 0.03954123 0.952341500 0.04765850  161.4116
## [20,] 0.002780223 0.003186131 0.03106713 0.962966519 0.03703348  118.9754
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.850760207 0.111974778 0.03322202 0.004042994 0.99595701 6917.9483
##  [2,] 0.723792929 0.182713532 0.08105874 0.012434803 0.98756520 6757.9504
##  [3,] 0.516244774 0.261545658 0.18205624 0.040153329 0.95984667 5077.4458
##  [4,] 0.368211204 0.262548940 0.27729159 0.091948266 0.90805173 5055.2975
##  [5,] 0.262626370 0.231280678 0.34018441 0.165908540 0.83409146 4777.7956
##  [6,] 0.187318065 0.190454551 0.36817679 0.254050597 0.74594940 4309.3934
##  [7,] 0.133604472 0.150606780 0.36783713 0.347951616 0.65204838 3741.8382
##  [8,] 0.095293291 0.115971730 0.34787600 0.440858975 0.55914103 3151.8791
##  [9,] 0.067967870 0.087669549 0.31620685 0.528155728 0.47184427 2591.2269
## [10,] 0.048478033 0.065398749 0.27898241 0.607140809 0.39285919 2088.9159
## [11,] 0.034576921 0.048306961 0.24052568 0.676590441 0.32340956 1657.2043
## [12,] 0.024661964 0.035417108 0.20361030 0.736310626 0.26368937 1297.4199
## [13,] 0.017590127 0.025818505 0.16982987 0.786761499 0.21323850 1004.5773
## [14,] 0.012546145 0.018737788 0.13994310 0.828772969 0.17122703  770.6155
## [15,] 0.008948529 0.013551646 0.11415514 0.863344688 0.13665531  586.4735
## [16,] 0.006382532 0.009773966 0.09232923 0.891514274 0.10848573  443.3088
## [17,] 0.004552336 0.007033978 0.07413705 0.914276638 0.08572336  333.1303
## [18,] 0.003246950 0.005053296 0.05916028 0.932539470 0.06746053  249.0605
## [19,] 0.002315885 0.003625293 0.04695580 0.947103019 0.05289698  185.3772
## [20,] 0.001651803 0.002597919 0.03709490 0.958655376 0.04134462  137.4367
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.856839956 0.100693855 0.03892147 0.003544716 0.99645528 6951.7562
##  [2,] 0.734174710 0.165902390 0.08727504 0.012647855 0.98735214 6786.7551
##  [3,] 0.532409925 0.241176346 0.18354734 0.042866388 0.95713361 5068.7423
##  [4,] 0.386093834 0.247213198 0.26875545 0.097937517 0.90206248 4985.5547
##  [5,] 0.279988109 0.222542547 0.32314315 0.174326192 0.82567381 4664.5965
##  [6,] 0.203042200 0.187271709 0.34587385 0.263812237 0.73618776 4175.8049
##  [7,] 0.147242449 0.151295148 0.34328217 0.358180236 0.64181976 3605.6476
##  [8,] 0.106777502 0.118983849 0.32327952 0.450959128 0.54904087 3024.0720
##  [9,] 0.077433070 0.091829717 0.29297067 0.537766546 0.46223345 2477.3463
## [10,] 0.056153031 0.069910769 0.25786960 0.616066605 0.38393339 1990.8768
## [11,] 0.040721140 0.052682941 0.22185400 0.684741919 0.31525808 1574.7853
## [12,] 0.029530217 0.039392318 0.18741415 0.743663320 0.25633668 1229.2959
## [13,] 0.021414768 0.029277153 0.15597906 0.793329024 0.20667098  948.9643
## [14,] 0.015529594 0.021656397 0.12822327 0.834590736 0.16540926  725.6408
## [15,] 0.011261774 0.015959190 0.10431879 0.868460242 0.13153976  550.3692
## [16,] 0.008166830 0.011725504 0.08412611 0.895981553 0.10401845  414.4985
## [17,] 0.005922434 0.008594179 0.06733094 0.918152448 0.08184755  310.2565
## [18,] 0.004294840 0.006286822 0.05353715 0.935881185 0.06411881  230.9802
## [19,] 0.003114538 0.004591685 0.04232679 0.949966990 0.05003301  171.1430
## [20,] 0.002258606 0.003349309 0.03329630 0.961095783 0.03890422  126.2717
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.838345559 0.120795809 0.03309249 0.00776614 0.99223386 6894.6359
##  [2,] 0.702823276 0.192325521 0.08538004 0.01947117 0.98052883 6739.9295
##  [3,] 0.508811114 0.256445820 0.18412488 0.05061818 0.94938182 5042.8044
##  [4,] 0.368355401 0.253589688 0.27502415 0.10303076 0.89696924 4997.7797
##  [5,] 0.266672048 0.222961757 0.33539005 0.17497614 0.82502386 4719.4510
##  [6,] 0.193058065 0.184235224 0.36317989 0.25952682 0.74047318 4266.6419
##  [7,] 0.139764991 0.146604802 0.36432371 0.34930650 0.65069350 3721.9081
##  [8,] 0.101183304 0.113801379 0.34670018 0.43831514 0.56168486 3154.8990
##  [9,] 0.073251970 0.086830252 0.31754973 0.52236805 0.47763195 2613.2935
## [10,] 0.053030993 0.065436395 0.28259078 0.59894183 0.40105817 2124.5642
## [11,] 0.038391954 0.048865549 0.24592307 0.66681943 0.33318057 1700.9760
## [12,] 0.027793975 0.036241508 0.21024955 0.72571496 0.27428504 1344.6740
## [13,] 0.020121536 0.026738584 0.17718854 0.77595134 0.22404866 1051.7846
## [14,] 0.014567049 0.019648108 0.14757417 0.81821068 0.18178932  815.3506
## [15,] 0.010545861 0.014392755 0.12170669 0.85335469 0.14664531  627.2584
## [16,] 0.007634709 0.010517310 0.09954501 0.88230297 0.11769703  479.4044
## [17,] 0.005527171 0.007670626 0.08084645 0.90595576 0.09404424  364.3309
## [18,] 0.004001413 0.005585970 0.06526368 0.92514894 0.07485106  275.5163
## [19,] 0.002896836 0.004062990 0.05240893 0.94063124 0.05936876  207.4542
## [20,] 0.002097173 0.002952431 0.04189429 0.95305611 0.04694389  155.6126</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 9.153165 9.003857 8.983405 8.540855 8.718273 9.063533 8.678970
##  [8] 8.971485 8.856029 9.028533</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 50439.71 51197.07 51078.29 49168.10 49591.67 51381.16 48883.90
##  [8] 51134.30 50013.36 51298.27</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 5442.348 5656.796 5832.346 7009.118 6971.270 6161.876 6796.495
##  [8] 6341.389 6426.504 6965.217</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     7.950544      9.153165       43894.63        50439.71 5442.348
##  [2,]     7.887799      9.003857       44883.76        51197.07 5656.796
##  [3,]     7.918793      8.983405       44869.11        51078.29 5832.346
##  [4,]     7.727094      8.540855       43464.36        49168.10 7009.118
##  [5,]     7.901671      8.718273       43898.92        49591.67 6971.270
##  [6,]     8.097258      9.063533       45427.10        51381.16 6161.876
##  [7,]     7.827020      8.678970       43093.62        48883.90 6796.495
##  [8,]     8.047174      8.971485       45272.88        51134.30 6341.389
##  [9,]     7.930329      8.856029       44064.34        50013.36 6426.504
## [10,]     8.236248      9.028533       45779.83        51298.27 6965.217</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
