<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Semi-Markov Multi-state Models • rcea</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Semi-Markov Multi-state Models">
<meta property="og:description" content="rcea">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rcea</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/markov-cohort.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/markov-cohort-psa.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/markov-cohort-hesim.html">Markov Cohort Model with hesim</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/mstate.html">Semi-Markov Multi-state Models</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Semi-Markov Multi-state Models</h1>
            
            <h4 class="date">2020-09-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/mstate.Rmd"><code>vignettes/mstate.Rmd</code></a></small>
      <div class="hidden name"><code>mstate.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a><span class="header-section-number">1</span> Overview</h1>
<p>Our sick-sicker Markov cohort was time homogeneous, meaning that transition probabilities were constant over time. Although the model could be extended to be time-inhomogeneous so that transition probabilities depend on time since the <em>start of the model</em>, transition probabilities cannot depend on prior history. The partitioned survival model are similarly limited in that it made the somewhat implausible assumption that transition probabilities between the healthy and death and sick and death states are equal. An alternative approach is to use a <em>semi-Markov</em> model which relaxes these assumptions by allowing transition probabilities to depend on <em>time since entering a new state</em>.</p>
<p>If individual patient data is available, semi-Markov models can be parameterized using multi-state models, which are generalizations of survival models to more than 2 states that estimate hazard functions for each possible transition. This is ideal because it ensures that the simulation model is completely integrated with an underlying statistical model. To illustrate, we will continue the 3-state example from the partitioned survival model (PSM) but explicitly model the hazards of each transition: (1) healthy to sick, (2) healthy to dead, and (3) sick to dead. (Note that we could also fit a reversible model where there is also a transition from sick to healhy but we will not do that here to maintain consistency with the PSM.)</p>
<p><img src="illness-death.png" width="600px"></p>
<p>In multi-state modeling, a semi-Markov model is referred to as a “clock reset” model since time resets to 0 each time a patient enters a new state. State occupancy probabilities in clock-reset models can only be simulated in a general fashion using individual-patient simulation. While individual-level simulations can be computationally intensive, they run very quickly in the <code>hesim</code> package because they are implemented fully in <code>C++</code> under the hood. <code>hesim</code> also simulates patients trajectories in continuous-time, which is faster than a discrete time approach. We refer to these types of models as individual-level continuous-time state transition models (iCTSTMs). You can learn more about them in the <a href="https://hesim-dev.github.io/hesim/articles/mstate.html"><code>hesim</code> package vignettes</a>.</p>
</div>
<div id="model-setup" class="section level1">
<h1 class="hasAnchor">
<a href="#model-setup" class="anchor"></a><span class="header-section-number">2</span> Model setup</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"hesim"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"data.table"</span>)</pre></body></html></div>
<pre><code>## Warning: package 'data.table' was built under R version 4.0.2</code></pre>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ggplot2"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">101</span>)</pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">tmat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">NA</span>, <span class="fl">NA</span>, <span class="fl">3</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">NA</span>, <span class="fl">NA</span>, <span class="fl">NA</span>)
)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">tmat</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">tmat</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Healthy"</span>, <span class="st">"Sick"</span>, <span class="st">"Dead"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">tmat</span>)</pre></body></html></div>
<pre><code>##         Healthy Sick Dead
## Healthy      NA    1    2
## Sick         NA   NA    3
## Dead         NA   NA   NA</code></pre>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">n_patients</span> <span class="kw">&lt;-</span> <span class="fl">1000</span>
<span class="no">patients</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span>(
  <span class="kw">patient_id</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="no">n_patients</span>,
  <span class="kw">age</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n_patients</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">7</span>),
  <span class="kw">female</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="no">n_patients</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="fl">.51</span>)
)

<span class="no">states</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span>(
  <span class="kw">state_id</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>),
  <span class="kw">state_name</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Healthy"</span>, <span class="st">"Sick"</span>) <span class="co"># Non-death health states</span>
)

<span class="no">strategies</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">strategy_id</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">2</span>,
  <span class="kw">strategy_name</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SOC"</span>, <span class="st">"New"</span>)
)

<span class="no">hesim_dat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/hesim_data.html">hesim_data</a></span>(
  <span class="kw">strategies</span> <span class="kw">=</span> <span class="no">strategies</span>,
  <span class="kw">patients</span> <span class="kw">=</span> <span class="no">patients</span>,
  <span class="kw">states</span> <span class="kw">=</span> <span class="no">states</span>
)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">hesim_dat</span>)</pre></body></html></div>
<pre><code>## $strategies
##   strategy_id strategy_name
## 1           1           SOC
## 2           2           New
## 
## $patients
##       patient_id      age female
##    1:          1 42.71774      0
##    2:          2 48.86723      0
##    3:          3 40.27539      1
##    4:          4 46.50052      1
##    5:          5 47.17538      1
##   ---                           
##  996:        996 43.22279      0
##  997:        997 54.22166      0
##  998:        998 37.27172      0
##  999:        999 45.20616      0
## 1000:       1000 39.15981      1
## 
## $states
##    state_id state_name
## 1:        1    Healthy
## 2:        2       Sick
## 
## attr(,"class")
## [1] "hesim_data"</code></pre>
</div>
<div id="parameter-estimation" class="section level1">
<h1 class="hasAnchor">
<a href="#parameter-estimation" class="anchor"></a><span class="header-section-number">3</span> Parameter estimation</h1>
<div id="multi-state-model" class="section level2">
<h2 class="hasAnchor">
<a href="#multi-state-model" class="anchor"></a><span class="header-section-number">3.1</span> Multi-state model</h2>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">data</span> <span class="kw">&lt;-</span> <span class="kw pkg">rcea</span><span class="kw ns">::</span><span class="fu"><a href="../reference/sim_mstate_data.html">sim_mstate_data</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">2000</span>)</pre></body></html></div>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"flexsurv"</span>)</pre></body></html></div>
<pre><code>## Loading required package: survival</code></pre>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">n_trans</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">tmat</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="co"># Number of transitions</span>
<span class="no">wei_fits</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="kw">length</span> <span class="kw">=</span> <span class="no">n_trans</span>, <span class="kw">mode</span> <span class="kw">=</span> <span class="st">"list"</span>)
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">wei_fits</span>)){
  <span class="no">wei_fits</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="kw pkg">flexsurv</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/flexsurv/man/flexsurvreg.html">flexsurvreg</a></span>(
    <span class="fu">Surv</span>(<span class="no">time</span>, <span class="no">status</span>) ~ <span class="no">strategy_name</span> + <span class="no">female</span>,
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">data</span>,
    <span class="kw">subset</span> <span class="kw">=</span> (<span class="no">transition_id</span> <span class="kw">==</span> <span class="no">i</span>) ,
    <span class="kw">dist</span> <span class="kw">=</span> <span class="st">"weibull"</span>)
}
<span class="no">wei_fits</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/flexsurvreg_list.html">flexsurvreg_list</a></span>(<span class="no">wei_fits</span>)</pre></body></html></div>
</div>
<div id="utility-and-costs" class="section level2">
<h2 class="hasAnchor">
<a href="#utility-and-costs" class="anchor"></a><span class="header-section-number">3.2</span> Utility and costs</h2>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">utility_tbl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/stateval_tbl.html">stateval_tbl</a></span>(
  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span>(<span class="kw">state_id</span> <span class="kw">=</span> <span class="no">states</span>$<span class="no">state_id</span>,
             <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">H</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">S</span> <span class="kw">=</span> <span class="fl">.625</span>),
             <span class="kw">se</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.05</span>)
            ),
  <span class="kw">dist</span> <span class="kw">=</span> <span class="st">"beta"</span>,
  <span class="kw">hesim_data</span> <span class="kw">=</span> <span class="no">hesim_dat</span>)</pre></body></html></div>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">drugcost_tbl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/stateval_tbl.html">stateval_tbl</a></span>(
  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span>(<span class="kw">strategy_id</span> <span class="kw">=</span> <span class="no">strategies</span>$<span class="no">strategy_id</span>,
            <span class="kw">est</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2000</span>, <span class="fl">12000</span>)
            ),
  <span class="kw">dist</span> <span class="kw">=</span> <span class="st">"fixed"</span>,
  <span class="kw">hesim_data</span> <span class="kw">=</span> <span class="no">hesim_dat</span>)

<span class="no">medcost_tbl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/stateval_tbl.html">stateval_tbl</a></span>(
  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span>(<span class="kw">state_id</span> <span class="kw">=</span> <span class="no">states</span>$<span class="no">state_id</span>,
             <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">H</span> <span class="kw">=</span> <span class="fl">2000</span>, <span class="kw">S</span> <span class="kw">=</span> <span class="fl">9500</span>),
             <span class="kw">se</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">H</span> <span class="kw">=</span> <span class="fl">2000</span>, <span class="kw">S</span> <span class="kw">=</span> <span class="fl">9500</span>)
             ),
  <span class="kw">dist</span> <span class="kw">=</span> <span class="st">"gamma"</span>,
  <span class="kw">hesim_data</span> <span class="kw">=</span> <span class="no">hesim_dat</span>)</pre></body></html></div>
</div>
</div>
<div id="simulation" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation" class="anchor"></a><span class="header-section-number">4</span> Simulation</h1>
<div id="constructing-the-economic-model" class="section level2">
<h2 class="hasAnchor">
<a href="#constructing-the-economic-model" class="anchor"></a><span class="header-section-number">4.1</span> Constructing the economic model</h2>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">n_samples</span> <span class="kw">&lt;-</span> <span class="fl">500</span></pre></body></html></div>
<div id="disease-model" class="section level3">
<h3 class="hasAnchor">
<a href="#disease-model" class="anchor"></a><span class="header-section-number">4.1.1</span> Disease model</h3>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">transmod_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/expand.html">expand</a></span>(<span class="no">hesim_dat</span>,
                        <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"strategies"</span>, <span class="st">"patients"</span>))
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">transmod_data</span>)</pre></body></html></div>
<pre><code>##    strategy_id patient_id strategy_name      age female
## 1:           1          1           SOC 42.71774      0
## 2:           1          2           SOC 48.86723      0
## 3:           1          3           SOC 40.27539      1
## 4:           1          4           SOC 46.50052      1
## 5:           1          5           SOC 47.17538      1
## 6:           1          6           SOC 53.21776      0</code></pre>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">transmod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/create_IndivCtstmTrans.html">create_IndivCtstmTrans</a></span>(<span class="no">wei_fits</span>, <span class="no">transmod_data</span>,
                                   <span class="kw">trans_mat</span> <span class="kw">=</span> <span class="no">tmat</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n_samples</span>,
                                   <span class="kw">clock</span> <span class="kw">=</span> <span class="st">"reset"</span>,
                                   <span class="kw">start_age</span> <span class="kw">=</span> <span class="no">patients</span>$<span class="no">age</span>)</pre></body></html></div>
</div>
<div id="utility-and-cost-models" class="section level3">
<h3 class="hasAnchor">
<a href="#utility-and-cost-models" class="anchor"></a><span class="header-section-number">4.1.2</span> Utility and cost models</h3>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co"># Utility</span>
<span class="no">utilitymod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/create_StateVals.html">create_StateVals</a></span>(<span class="no">utility_tbl</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n_samples</span>)

<span class="co"># Costs</span>
<span class="no">drugcostmod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/create_StateVals.html">create_StateVals</a></span>(<span class="no">drugcost_tbl</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n_samples</span>)
<span class="no">medcostmod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/create_StateVals.html">create_StateVals</a></span>(<span class="no">medcost_tbl</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n_samples</span>)
<span class="no">costmods</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">Drug</span> <span class="kw">=</span> <span class="no">drugcostmod</span>,
                 <span class="kw">Medical</span> <span class="kw">=</span> <span class="no">medcostmod</span>)</pre></body></html></div>
</div>
<div id="combining-the-disease-progression-cost-and-utility-models" class="section level3">
<h3 class="hasAnchor">
<a href="#combining-the-disease-progression-cost-and-utility-models" class="anchor"></a><span class="header-section-number">4.1.3</span> Combining the disease progression, cost, and utility models</h3>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">econmod</span> <span class="kw">&lt;-</span> <span class="no">IndivCtstm</span>$<span class="fu">new</span>(<span class="kw">trans_model</span> <span class="kw">=</span> <span class="no">transmod</span>,
                          <span class="kw">utility_model</span> <span class="kw">=</span> <span class="no">utilitymod</span>,
                          <span class="kw">cost_models</span> <span class="kw">=</span> <span class="no">costmods</span>)</pre></body></html></div>
</div>
</div>
<div id="simulating-outcomes" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-outcomes" class="anchor"></a><span class="header-section-number">4.2</span> Simulating outcomes</h2>
<div id="disease-progression" class="section level3">
<h3 class="hasAnchor">
<a href="#disease-progression" class="anchor"></a><span class="header-section-number">4.2.1</span> Disease progression</h3>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">econmod</span>$<span class="fu">sim_disease</span>(<span class="kw">max_age</span> <span class="kw">=</span> <span class="fl">100</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">econmod</span>$<span class="no">disprog_</span>)</pre></body></html></div>
<pre><code>##    sample strategy_id patient_id grp_id from to final time_start time_stop
## 1:      1           1          1      1    1  3     1   0.000000  8.547690
## 2:      1           1          2      1    1  2     0   0.000000  2.740025
## 3:      1           1          2      1    2  3     1   2.740025 14.654683
## 4:      1           1          3      1    1  2     0   0.000000  7.151150
## 5:      1           1          3      1    2  3     1   7.151150 26.324771
## 6:      1           1          4      1    1  2     0   0.000000 12.604367</code></pre>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">econmod</span>$<span class="fu">sim_stateprobs</span>(<span class="kw">t</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">20</span> , <span class="fl">1</span>/<span class="fl">12</span>))</pre></body></html></div>
<p><img src="mstate_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
<div id="qalys" class="section level3">
<h3 class="hasAnchor">
<a href="#qalys" class="anchor"></a><span class="header-section-number">4.2.2</span> QALYs</h3>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">econmod</span>$<span class="fu"><a href="https://rdrr.io/pkg/hesim/man/sim_ev.html">sim_qalys</a></span>(<span class="kw">dr</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">.03</span>))
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">econmod</span>$<span class="no">qalys_</span>)</pre></body></html></div>
<pre><code>##    sample strategy_id grp_id state_id dr     qalys       lys
## 1:      1           1      1        1  0  7.333490  7.333490
## 2:      1           1      1        2  0  5.282375  7.995782
## 3:      1           2      1        1  0 11.858581 11.858581
## 4:      1           2      1        2  0  6.594848  9.982434
## 5:      2           1      1        1  0  7.260854  7.260854
## 6:      2           1      1        2  0  3.838045  5.556297</code></pre>
</div>
<div id="costs" class="section level3">
<h3 class="hasAnchor">
<a href="#costs" class="anchor"></a><span class="header-section-number">4.2.3</span> Costs</h3>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">econmod</span>$<span class="fu"><a href="https://rdrr.io/pkg/hesim/man/sim_ev.html">sim_costs</a></span>(<span class="kw">dr</span> <span class="kw">=</span> <span class="fl">0.03</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">econmod</span>$<span class="no">costs_</span>)</pre></body></html></div>
<pre><code>##    sample strategy_id grp_id state_id   dr category      costs
## 1:      1           1      1        1 0.03     Drug  12855.508
## 2:      1           1      1        2 0.03     Drug  10401.950
## 3:      1           2      1        1 0.03     Drug 115346.101
## 4:      1           2      1        2 0.03     Drug  65683.092
## 5:      2           1      1        1 0.03     Drug  12772.939
## 6:      2           1      1        2 0.03     Drug   7765.597</code></pre>
</div>
</div>
</div>
<div id="cost-effectiveness-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#cost-effectiveness-analysis" class="anchor"></a><span class="header-section-number">5</span> Cost-effectiveness analysis</h1>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">ce_sim</span> <span class="kw">&lt;-</span> <span class="no">econmod</span>$<span class="fu">summarize</span>()
<span class="no">icea_pw_out</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hesim/man/icea.html">icea_pw</a></span>(<span class="no">ce_sim</span>, <span class="kw">comparator</span> <span class="kw">=</span> <span class="fl">1</span>,
                       <span class="kw">dr_qalys</span> <span class="kw">=</span> <span class="fl">.03</span>, <span class="kw">dr_costs</span> <span class="kw">=</span> <span class="fl">.03</span>,
                       <span class="kw">k</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">25000</span>, <span class="fl">500</span>))</pre></body></html></div>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/hesim/man/icer_tbl.html">icer_tbl</a></span>(<span class="no">icea_pw_out</span>, <span class="kw">colnames</span> <span class="kw">=</span> <span class="no">strategies</span>$<span class="no">strategy_name</span>)</pre></body></html></div>
<pre><code>##                   SOC New                         
## Incremental QALYs "-" "3.49 (2.40, 4.53)"         
## Incremental costs "-" "162,029 (132,626, 208,045)"
## Incremental NMB   "-" "12,320 (-23,091, 47,881)"  
## ICER              "-" "46,467"                    
## Conclusion        "-" "Cost-effective"</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
