<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (hesim)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model-simple.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supporting material</li>
    <li>
      <a href="../articles/hesim-overview.html">Overview hesim</a>
    </li>
    <li class="divider">
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="model-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-settings" class="anchor"></a><span class="header-section-number">2</span> Model settings</h1>
<p>Set starting distribution over the 4 health states</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
<p>Set duration of follow-up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
<p>Set discount rates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span></code></pre></div>
<p>Number of PSA simulations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#model-parameters" class="anchor"></a><span class="header-section-number">3</span> Model parameters</h1>
<div id="transition-matrix-monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-monotherapy" class="anchor"></a><span class="header-section-number">3.1</span> Transition matrix monotherapy</h2>
<p>Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7156725 0.2047777 0.07289345 0.006656387
## [2,] 0.0000000 0.5960878 0.38935525 0.014556904
## [3,] 0.0000000 0.0000000 0.76543377 0.234566227
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7222348 0.2099722 0.06065762 0.007135347
## [2,] 0.0000000 0.5838014 0.40732036 0.008878254
## [3,] 0.0000000 0.0000000 0.77029934 0.229700656
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.6910291 0.2171627 0.07826225 0.01354596
## [2,] 0.0000000 0.5807053 0.40424788 0.01504682
## [3,] 0.0000000 0.0000000 0.76931887 0.23068113
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7180609 0.2035854 0.06578473 0.01256893
## [2,] 0.0000000 0.5786243 0.40606163 0.01531408
## [3,] 0.0000000 0.0000000 0.77119085 0.22880915
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7213266 0.1946795 0.07281394 0.01118002
## [2,] 0.0000000 0.5845307 0.40456927 0.01090000
## [3,] 0.0000000 0.0000000 0.76130295 0.23869705
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7404855 0.1929945 0.05837943 0.008140549
## [2,] 0.0000000 0.5898379 0.39030757 0.019854520
## [3,] 0.0000000 0.0000000 0.74245677 0.257543235
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7331195 0.1900563 0.06784022 0.008984061
## [2,] 0.0000000 0.5987300 0.38980695 0.011463073
## [3,] 0.0000000 0.0000000 0.75445019 0.245549805
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]      [,3]       [,4]
## [1,] 0.7417397 0.1774742 0.0694768 0.01130937
## [2,] 0.0000000 0.5792174 0.4105147 0.01026792
## [3,] 0.0000000 0.0000000 0.7509922 0.24900776
## [4,] 0.0000000 0.0000000 0.0000000 1.00000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7197671 0.1919788 0.08172285 0.006531186
## [2,] 0.0000000 0.5834286 0.40678558 0.009785856
## [3,] 0.0000000 0.0000000 0.76306505 0.236934954
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7123727 0.2068117 0.07061656 0.01019910
## [2,] 0.0000000 0.5893639 0.39617548 0.01446058
## [3,] 0.0000000 0.0000000 0.75256468 0.24743532
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000</code></pre>
</div>
<div id="relative-treatment-effect-with-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-treatment-effect-with-combination-therapy" class="anchor"></a><span class="header-section-number">3.2</span> Relative treatment effect with combination therapy</h2>
<p>Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.5744680 0.3750950 0.5265565 0.6373316 0.7459205 0.5448879 0.4617193
##  [8] 0.5925918 0.4516371 0.6547893</code></pre>
</div>
<div id="transition-matrix-combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#transition-matrix-combination-therapy" class="anchor"></a><span class="header-section-number">3.3</span> Transition matrix combination therapy</h2>
<p>Define array for transition matrix for combination therapy for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))</code></pre></div>
<p>Create PSA samples for transition matrix for combination therapy based on samples for monotherapy and RR</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
<p>Show first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8366629 0.1176382 0.04187495 0.003823881
## [2,] 0.0000000 0.7679654 0.22367213 0.008362475
## [3,] 0.0000000 0.0000000 0.86524921 0.134750790
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8958117 0.07875953 0.02275237 0.002676433
## [2,] 0.0000000 0.84388600 0.15278381 0.003330188
## [3,] 0.0000000 0.00000000 0.91384044 0.086159558
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]      [,3]        [,4]
## [1,] 0.8373094 0.1143484 0.0412095 0.007132715
## [2,] 0.0000000 0.7792176 0.2128594 0.007923000
## [3,] 0.0000000 0.0000000 0.8785333 0.121466662
## [4,] 0.0000000 0.0000000 0.0000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8203113 0.1297514 0.04192669 0.008010577
## [2,] 0.0000000 0.7314439 0.25879591 0.009760149
## [3,] 0.0000000 0.0000000 0.85417270 0.145827303
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7921318 0.1452154 0.05431342 0.008339406
## [2,] 0.0000000 0.6900929 0.30177653 0.008130534
## [3,] 0.0000000 0.0000000 0.82195097 0.178049033
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8585937 0.1051604 0.03181024 0.004435686
## [2,] 0.0000000 0.7765076 0.21267386 0.010818487
## [3,] 0.0000000 0.0000000 0.85966781 0.140332187
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8767761 0.08775265 0.03132314 0.004148115
## [2,] 0.0000000 0.81472588 0.17998140 0.005292722
## [3,] 0.0000000 0.00000000 0.88662491 0.113375087
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 8
## 
##          [,1]      [,2]       [,3]        [,4]
## [1,] 0.846957 0.1051697 0.04117138 0.006701842
## [2,] 0.000000 0.7506477 0.24326765 0.006084688
## [3,] 0.000000 0.0000000 0.85244004 0.147559957
## [4,] 0.000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8734364 0.08670476 0.03690907 0.002949726
## [2,] 0.0000000 0.81186089 0.18371945 0.004419655
## [3,] 0.0000000 0.00000000 0.89299139 0.107008611
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8116647 0.1354181 0.04623897 0.006678263
## [2,] 0.0000000 0.7311199 0.25941145 0.009468633
## [3,] 0.0000000 0.0000000 0.83798201 0.162017989
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="other-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a><span class="header-section-number">3.4</span> Other parameters</h2>
<p>Parameters for which no uncertainty is propagated in the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
</div>
<div id="model-output" class="section level1">
<h1 class="hasAnchor">
<a href="#model-output" class="anchor"></a><span class="header-section-number">4</span> Model output</h1>
<div id="monotherapy" class="section level2">
<h2 class="hasAnchor">
<a href="#monotherapy" class="anchor"></a><span class="header-section-number">4.1</span> Monotherapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.715672467 0.204777699 0.07289345 0.006656387 0.99334361 5204.4933
##  [2,] 0.512187080 0.268619258 0.18769421 0.031499451 0.96850055 5454.0936
##  [3,] 0.366558191 0.265005166 0.28559089 0.082845754 0.91715425 5441.2574
##  [4,] 0.262335605 0.233029301 0.34850175 0.156133339 0.84386666 5145.0332
##  [5,] 0.187746370 0.192626415 0.37660874 0.243018474 0.75698153 4649.3235
##  [6,] 0.134364908 0.153268534 0.37695464 0.335411922 0.66458808 4051.5826
##  [7,] 0.096161265 0.118876447 0.35800404 0.426958249 0.57304175 3430.2069
##  [8,] 0.068819970 0.090552487 0.32732308 0.513304466 0.48669553 2837.7394
##  [9,] 0.049252558 0.068070032 0.29081775 0.591859661 0.40814034 2304.0411
## [10,] 0.035248699 0.050661544 0.25269534 0.661394417 0.33860558 1842.2197
## [11,] 0.025226524 0.037416878 0.21571628 0.721640314 0.27835969 1454.3448
## [12,] 0.018053928 0.027469576 0.18152384 0.772952660 0.22704734 1135.9690
## [13,] 0.012920699 0.020071322 0.15095591 0.816052067 0.18394793  879.3359
## [14,] 0.009246989 0.014610142 0.12430346 0.851839407 0.14816059  675.4758
## [15,] 0.006617815 0.010602505 0.10150865 0.881271031 0.11872897  515.4686
## [16,] 0.004736188 0.007675205 0.08230868 0.905279922 0.09472008  391.1286
## [17,] 0.003389560 0.005544962 0.06633547 0.924730013 0.07526999  295.3140
## [18,] 0.002425814 0.003999391 0.05318144 0.940393353 0.05960665  222.0062
## [19,] 0.001736089 0.002880741 0.04244088 0.952942289 0.04705771  166.2610
## [20,] 0.001242471 0.002072687 0.03373387 0.962950977 0.03704902  124.0948
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.722234791 0.209972242 0.06065762 0.007135347 0.99286465 5131.5125
##  [2,] 0.521623093 0.274231345 0.17605954 0.028086025 0.97191398 5406.1371
##  [3,] 0.376734345 0.269623010 0.27895897 0.074683673 0.92531633 5442.0959
##  [4,] 0.272090651 0.236510043 0.34755666 0.143842644 0.85615736 5190.1777
##  [5,] 0.196513334 0.195206376 0.38056240 0.227717895 0.77228211 4725.9183
##  [6,] 0.141928767 0.155224099 0.38457853 0.318268609 0.68173139 4146.4246
##  [7,] 0.102505893 0.120421146 0.36807558 0.408997379 0.59100262 3532.5123
##  [8,] 0.074033322 0.091825425 0.33879613 0.495345126 0.50465487 2939.6952
##  [9,] 0.053469441 0.069152753 0.30286748 0.574510322 0.42548968 2400.5087
## [10,] 0.038617491 0.051598572 0.26470928 0.645074660 0.35492534 1930.1837
## [11,] 0.027890895 0.038231919 0.22726498 0.706612209 0.29338779 1532.3533
## [12,] 0.020143775 0.028176161 0.19232650 0.759353567 0.24064643 1203.6534
## [13,] 0.014548535 0.020678916 0.16084757 0.803924978 0.19607502  937.0314
## [14,] 0.010507458 0.015127168 0.13320620 0.841159172 0.15884083  723.9380
## [15,] 0.007588852 0.011037536 0.10940761 0.871966001 0.12803400  555.6707
## [16,] 0.005480933 0.008037177 0.08923275 0.897249144 0.10275086  424.1227
## [17,] 0.003958520 0.005842959 0.07234209 0.917856429 0.08214357  322.1403
## [18,] 0.002858981 0.004242307 0.05834514 0.934553576 0.06544642  243.6390
## [19,] 0.002064856 0.003076971 0.04684462 0.948013556 0.05198644  183.5789
## [20,] 0.001491311 0.002229903 0.03746294 0.958815847 0.04118415  137.8682
## 
## , , 3
## 
##            State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.6910291351 0.217162650 0.07826225 0.01354596 0.98645404 5206.8935
##  [2,] 0.4775212655 0.276173221 0.20207767 0.04422785 0.95577215 5479.0778
##  [3,] 0.3299811071 0.264075038 0.30447649 0.10146736 0.89853264 5461.4397
##  [4,] 0.2280265590 0.225009347 0.36681635 0.18014775 0.81985225 5138.0803
##  [5,] 0.1575729958 0.180182973 0.39100416 0.27123987 0.72876013 4607.6534
##  [6,] 0.1088875310 0.138852178 0.38597748 0.36628281 0.63371719 3978.7816
##  [7,] 0.0752444564 0.104278501 0.36159224 0.45888480 0.54111520 3335.3635
##  [8,] 0.0519961116 0.076895364 0.32622289 0.54488563 0.45511437 2731.1424
##  [9,] 0.0359308280 0.055945159 0.28612355 0.62200047 0.37799953 2194.7404
## [10,] 0.0248292490 0.040290485 0.24554798 0.68933228 0.31066772 1737.0253
## [11,] 0.0171577345 0.028788884 0.20713523 0.74691815 0.25308185 1357.7094
## [12,] 0.0118564944 0.020443877 0.17233369 0.79536594 0.20463406 1050.3135
## [13,] 0.0081931831 0.014446655 0.14177187 0.83558829 0.16441171  805.5314
## [14,] 0.0056617282 0.010168503 0.11554902 0.86862075 0.13137925  613.3255
## [15,] 0.0039124192 0.007134419 0.09344774 0.89550543 0.10449457  464.1153
## [16,] 0.0027035956 0.004992626 0.07508137 0.91722240 0.08277760  349.3666
## [17,] 0.0018682633 0.003486365 0.05999137 0.93465401 0.06534599  261.8081
## [18,] 0.0012910244 0.002430267 0.04770806 0.94857065 0.05142935  195.4350
## [19,] 0.0008921355 0.001691631 0.03778618 0.95963005 0.04036995  145.4008
## [20,] 0.0006164916 0.001176078 0.02982328 0.96838415 0.03161585  107.8619
## 
## , , 4
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.718060948 0.203585393 0.06578473 0.01256893 0.98743107 5134.1600
##  [2,] 0.515611525 0.263986174 0.18063824 0.03976406 0.96023594 5376.5907
##  [3,] 0.370240501 0.257719788 0.28042058 0.09161913 0.90838087 5375.2287
##  [4,] 0.265855245 0.224498487 0.34526407 0.16438220 0.83561780 5094.1106
##  [5,] 0.190900269 0.184024523 0.37491393 0.25016128 0.74983872 4612.6352
##  [6,] 0.137078028 0.145345565 0.37641381 0.34116260 0.65883740 4027.1382
##  [7,] 0.098430379 0.112007559 0.35832379 0.43123828 0.56876172 3415.8549
##  [8,] 0.070679011 0.084849282 0.32829321 0.51617849 0.48382151 2831.4077
##  [9,] 0.050751838 0.063485070 0.29228036 0.59348273 0.40651727 2303.8133
## [10,] 0.036442913 0.047066336 0.25452149 0.66196927 0.33803073 1846.3838
## [11,] 0.026168232 0.034652970 0.21779386 0.72138494 0.27861506 1461.4324
## [12,] 0.018790386 0.025378520 0.18375334 0.77207775 0.22792225 1144.7763
## [13,] 0.013492642 0.018510076 0.15325026 0.81474702 0.18525298  888.9234
## [14,] 0.009688539 0.013457285 0.12658904 0.85026513 0.14973487  685.1493
## [15,] 0.006956962 0.009759157 0.10372616 0.87955773 0.12044227  524.7472
## [16,] 0.004995523 0.007063221 0.08441314 0.90352811 0.09647189  399.7072
## [17,] 0.003587090 0.005103967 0.06829538 0.92301357 0.07698643  303.0240
## [18,] 0.002575749 0.003683558 0.05497727 0.93876342 0.06123658  228.7809
## [19,] 0.001849545 0.002655781 0.04406316 0.95143151 0.04856849  172.1043
## [20,] 0.001328086 0.001913240 0.03518119 0.96157748 0.03842252  129.0569
## 
## , , 5
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.721326586 0.194679451 0.07281394 0.01118002 0.98881998 5179.7216
##  [2,] 0.520312044 0.254223585 0.18671743 0.03874694 0.96125306 5412.3965
##  [3,] 0.375314910 0.249895561 0.28288555 0.09190398 0.90809602 5385.0175
##  [4,] 0.270724623 0.219137735 0.34378983 0.16634781 0.83365219 5077.7165
##  [5,] 0.195280868 0.180797261 0.37009713 0.25382474 0.74617526 4575.6407
##  [6,] 0.140861282 0.143698727 0.36912023 0.34631977 0.65368023 3976.3522
##  [7,] 0.101606988 0.111419119 0.34940507 0.43756882 0.56243118 3357.4675
##  [8,] 0.073291821 0.084908692 0.31847827 0.52332122 0.47667878 2770.3654
##  [9,] 0.052867339 0.063900151 0.28214656 0.60108595 0.39891405 2243.7367
## [10,] 0.038134617 0.047643787 0.24450053 0.66972107 0.33027893 1789.7108
## [11,] 0.027507513 0.035273284 0.20819092 0.72902829 0.27097171 1409.6381
## [12,] 0.019841901 0.025973466 0.17476978 0.77941486 0.22058514 1098.6003
## [13,] 0.014312491 0.019045099 0.14500558 0.82163683 0.17836317  848.5740
## [14,] 0.010323980 0.013918794 0.11914039 0.85661684 0.14338316  650.4732
## [15,] 0.007446961 0.010145829 0.09708477 0.88532244 0.11467756  495.3633
## [16,] 0.005371691 0.007380319 0.07855786 0.90869013 0.09130987  375.1070
## [17,] 0.003874744 0.005359781 0.06318331 0.92758216 0.07241784  282.6443
## [18,] 0.002794956 0.003887290 0.05055218 0.94276557 0.05723443  212.0527
## [19,] 0.002016076 0.002816361 0.04026171 0.95490585 0.04509415  158.4855
## [20,] 0.001454249 0.002038738 0.03193757 0.96456944 0.03543056  118.0501
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.740485526 0.192994495 0.05837943 0.008140549 0.99185945 5108.5629
##  [2,] 0.548318815 0.256745099 0.16190054 0.033035548 0.96696445 5300.5837
##  [3,] 0.406022146 0.257260505 0.25242425 0.084293103 0.91570690 5259.1414
##  [4,] 0.300653523 0.230102038 0.31152815 0.157716287 0.84228371 4954.9648
##  [5,] 0.222629582 0.193747380 0.33865873 0.244964305 0.75503569 4464.9832
##  [6,] 0.164853983 0.157245833 0.34005752 0.337842659 0.66215734 3881.1916
##  [7,] 0.122071989 0.124565465 0.32347633 0.429886216 0.57011378 3277.9832
##  [8,] 0.090392541 0.097032655 0.29591253 0.516662277 0.48333772 2705.1468
##  [9,] 0.066934368 0.074678801 0.26285190 0.595534928 0.40446507 2190.7756
## [10,] 0.049563931 0.056966352 0.22821146 0.665258252 0.33474175 1746.9391
## [11,] 0.036701373 0.043166480 0.19456506 0.725567088 0.27443291 1375.1782
## [12,] 0.027176836 0.032544389 0.16344695 0.776831821 0.22316818 1070.8540
## [13,] 0.020124054 0.024440894 0.13564119 0.819793866 0.18020613  826.2281
## [14,] 0.014901570 0.018299998 0.11142201 0.855376419 0.14462358  632.4687
## [15,] 0.011034397 0.013669953 0.09073860 0.884557049 0.11544295  480.8534
## [16,] 0.008170811 0.010192635 0.07334916 0.908287398 0.09171260  363.4158
## [17,] 0.006050368 0.007588924 0.05891385 0.927446862 0.07255314  273.2311
## [18,] 0.004480210 0.005643923 0.04705622 0.942819652 0.05718035  204.4834
## [19,] 0.003317530 0.004193655 0.03740162 0.955087191 0.04491281  152.4094
## [20,] 0.002456583 0.003113842 0.02959958 0.964829995 0.03517000  113.1834
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.733119461 0.190056261 0.06784022 0.008984061 0.99101594 5159.5284
##  [2,] 0.537464144 0.253126324 0.17500230 0.034407232 0.96559277 5366.3748
##  [3,] 0.394025424 0.253702744 0.26716260 0.085109229 0.91489077 5332.1614
##  [4,] 0.288867706 0.226786437 0.32718674 0.157159116 0.84284088 5033.9407
##  [5,] 0.211774537 0.190684955 0.35484588 0.242694631 0.75730537 4548.4555
##  [6,] 0.155256034 0.154417875 0.35641069 0.333915398 0.66608460 3966.6020
##  [7,] 0.113821220 0.121961992 0.33961988 0.424596907 0.57540309 3362.2919
##  [8,] 0.083444552 0.094654737 0.31148957 0.510411139 0.48958886 2785.5412
##  [9,] 0.061174825 0.072531788 0.27756134 0.588732048 0.41126795 2265.0937
## [10,] 0.044848455 0.055053614 0.24182972 0.658268216 0.34173178 1813.8065
## [11,] 0.032879275 0.041485979 0.20695129 0.718683461 0.28131654 1433.9577
## [12,] 0.024104436 0.031087811 0.17453650 0.770271255 0.22972875 1121.5029
## [13,] 0.017671431 0.023194404 0.14543259 0.813701575 0.18629842  869.1295
## [14,] 0.012955270 0.017245751 0.11996182 0.849837160 0.15016284  668.2751
## [15,] 0.009497761 0.012787778 0.09810662 0.879607841 0.12039216  510.3585
## [16,] 0.006962993 0.009461535 0.07964565 0.903929818 0.09607018  387.4593
## [17,] 0.005104706 0.006988265 0.06424922 0.923657807 0.07634219  292.6341
## [18,] 0.003742359 0.005154265 0.05154322 0.939560159 0.06043984  220.0077
## [19,] 0.002743596 0.003797272 0.04114984 0.952309291 0.04769071  164.7365
## [20,] 0.002011384 0.002794978 0.03271183 0.962481804 0.03751820  122.9058
## 
## , , 8
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.741739672 0.177474151 0.06947680 0.01130937 0.98869063 5154.6231
##  [2,] 0.550177741 0.234435729 0.17656599 0.03882054 0.96117946 5350.3777
##  [3,] 0.408088658 0.233431573 0.26706359 0.09141617 0.90858383 5299.9466
##  [4,] 0.302695547 0.207632809 0.32474248 0.16492917 0.83507083 4986.3651
##  [5,] 0.224521296 0.173985165 0.35014572 0.25134782 0.74865218 4490.2561
##  [6,] 0.166536353 0.140621955 0.34997921 0.34286248 0.65713752 3903.6305
##  [7,] 0.123526620 0.111006577 0.33212947 0.43333734 0.56666266 3299.7335
##  [8,] 0.091624594 0.086219719 0.30357872 0.51857697 0.48142303 2727.1578
##  [9,] 0.067961597 0.066200956 0.26974551 0.59609194 0.40390806 2213.1367
## [10,] 0.050409812 0.050406170 0.23447501 0.66470901 0.33529099 1769.2617
## [11,] 0.037390958 0.038142568 0.20028370 0.72418278 0.27581722 1396.8970
## [12,] 0.027734357 0.028728766 0.16866739 0.77486948 0.22513052 1091.4196
## [13,] 0.020571673 0.021562332 0.14038838 0.81747762 0.18252238  845.2079
## [14,] 0.015258826 0.016140217 0.11571149 0.85288947 0.14711053  649.5829
## [15,] 0.011318076 0.012056741 0.09458436 0.88204082 0.11795918  495.9705
## [16,] 0.008395066 0.008992140 0.07676794 0.90584486 0.09415514  376.5286
## [17,] 0.006226954 0.006698311 0.06192679 0.92514794 0.07485206  284.4252
## [18,] 0.004618779 0.004984901 0.04968893 0.94070740 0.05929260  213.9059
## [19,] 0.003425931 0.003707055 0.03968327 0.95318374 0.04681626  160.2428
## [20,] 0.002541149 0.002755205 0.03156165 0.96314199 0.03685801  119.6241
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.719767134 0.191978834 0.08172285 0.006531186 0.99346881 5253.5823
##  [2,] 0.518064727 0.250185991 0.19927549 0.032473795 0.96752621 5509.3032
##  [3,] 0.372885963 0.245423116 0.29616994 0.085520984 0.91447902 5480.6072
##  [4,] 0.268391061 0.214773069 0.35630481 0.160531057 0.83946894 5161.8533
##  [5,] 0.193179065 0.176830147 0.38118402 0.248806772 0.75119323 4645.4274
##  [6,] 0.139043942 0.140254051 0.37858730 0.342114712 0.65788529 4032.2748
##  [7,] 0.100079259 0.108521713 0.35730312 0.434095904 0.56590410 3401.3584
##  [8,] 0.072033762 0.082527767 0.32496935 0.520469117 0.47953088 2804.3891
##  [9,] 0.051847534 0.061978014 0.28743066 0.598743787 0.40125621 2269.9296
## [10,] 0.037318151 0.046113373 0.24877718 0.667791292 0.33220871 1809.8102
## [11,] 0.026860379 0.034068154 0.21164117 0.727430293 0.27256971 1425.0493
## [12,] 0.019333218 0.025032959 0.17754952 0.778084301 0.22191570 1110.4261
## [13,] 0.013915415 0.018316512 0.14724485 0.820523227 0.17947677  857.6638
## [14,] 0.010015858 0.013357841 0.12094550 0.855680805 0.14431920  657.4747
## [15,] 0.007209086 0.009716179 0.09854158 0.884533154 0.11546685  500.7679
## [16,] 0.005188863 0.007052688 0.07973519 0.908023264 0.09197674  379.2873
## [17,] 0.003734773 0.005110892 0.06413611 0.927018222 0.07298178  285.8830
## [18,] 0.002688167 0.003698837 0.05132428 0.942288716 0.05771128  214.5651
## [19,] 0.001934854 0.002674079 0.04088808 0.954502985 0.04549701  160.4359
## [20,] 0.001392644 0.001931585 0.03244616 0.964229606 0.03577039  119.5649
## 
## , , 10
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.712372651 0.206811681 0.07061656 0.01019910 0.98980090 5174.8095
##  [2,] 0.507474794 0.269214334 0.18538256 0.03792831 0.96207169 5412.5869
##  [3,] 0.361511165 0.263616936 0.28200461 0.09286729 0.90713271 5379.7325
##  [4,] 0.257530667 0.230131049 0.34219395 0.17014433 0.82985567 5057.2540
##  [5,] 0.183457804 0.188891292 0.36688129 0.26076961 0.73923039 4536.2849
##  [6,] 0.130690322 0.149266934 0.36389116 0.35615158 0.64384842 3919.5803
##  [7,] 0.093100211 0.115000834 0.34221644 0.44968252 0.55031748 3287.7320
##  [8,] 0.066322044 0.087031556 0.30967493 0.53697147 0.46302853 2693.1205
##  [9,] 0.047246011 0.065009434 0.27221362 0.61553094 0.38446906 2164.1391
## [10,] 0.033656766 0.048085243 0.23394985 0.68430814 0.31569186 1711.9527
## [11,] 0.023976160 0.035300321 0.19748931 0.74323421 0.25676579 1336.7305
## [12,] 0.017079960 0.025763286 0.16430172 0.79285503 0.20714497 1032.4259
## [13,] 0.012167297 0.018716287 0.13506058 0.83405584 0.16594416  790.0719
## [14,] 0.008667649 0.013547044 0.10991597 0.86786934 0.13213066  599.8664
## [15,] 0.006174596 0.009776710 0.08869796 0.89535073 0.10464927  452.3776
## [16,] 0.004398614 0.007039019 0.07106028 0.91750209 0.08249791  339.1561
## [17,] 0.003133452 0.005058229 0.05657676 0.93523156 0.06476844  252.9745
## [18,] 0.002232186 0.003629172 0.04480289 0.94933575 0.05066425  187.8477
## [19,] 0.001590148 0.002600545 0.03531249 0.96049682 0.03950318  138.9368
## [20,] 0.001132778 0.001861529 0.02771750 0.96928820 0.03071180  102.4018</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.220866 8.436834 7.837525 8.181126 8.089447 8.166069 8.241682
##  [8] 8.147113 8.140607 7.920227</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 46219.39 47109.16 45221.07 45955.02 45417.11 44382.58 45424.76
##  [8] 44828.29 46079.65 44569.98</code></pre>
</div>
<div id="combination-therapy" class="section level2">
<h2 class="hasAnchor">
<a href="#combination-therapy" class="anchor"></a><span class="header-section-number">4.2</span> Combination therapy</h2>
<p>Define array for trace and outcomes by follow-up time for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)</code></pre></div>
<p>Define matrix for expected outcomes for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)</code></pre></div>
<p>Trace and expected LY and cost for each PSA sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.836662933 0.117638233 0.04187495 0.003823881 0.99617612 6972.0296
##  [2,] 0.700004864 0.188765642 0.09757988 0.013649611 0.98635039 6843.7590
##  [3,] 0.500974208 0.255866290 0.19921360 0.043945903 0.95605410 5150.0542
##  [4,] 0.358533447 0.255107130 0.28862544 0.097733985 0.90226602 5086.6009
##  [5,] 0.256592517 0.225485914 0.34638570 0.171535872 0.82846413 4784.3124
##  [6,] 0.183636200 0.186953837 0.37163335 0.257776615 0.74222339 4310.6722
##  [7,] 0.131423372 0.149045508 0.37063805 0.348893070 0.65110693 3750.0231
##  [8,] 0.094056089 0.115756791 0.35131043 0.438876685 0.56112331 3171.5697
##  [9,] 0.067313353 0.088261806 0.32083146 0.523593383 0.47640662 2622.0355
## [10,] 0.048174314 0.066396063 0.28484713 0.600582490 0.39941751 2127.9869
## [11,] 0.034477030 0.049442911 0.24739486 0.668685196 0.33131480 1700.9648
## [12,] 0.024674261 0.036532445 0.21112839 0.727664904 0.27233510 1342.5687
## [13,] 0.017658689 0.026829285 0.17762749 0.777884534 0.22211547 1048.5210
## [14,] 0.012637838 0.019608716 0.14769541 0.820058039 0.17994196  811.5674
## [15,] 0.009044552 0.014276465 0.12160702 0.855071958 0.14492804  623.3769
## [16,] 0.006472937 0.010362150 0.09930003 0.883864884 0.11613512  475.6884
## [17,] 0.004632503 0.007502265 0.08051399 0.907351245 0.09264876  360.9318
## [18,] 0.003315355 0.005420642 0.06488685 0.926377153 0.07362285  272.5078
## [19,] 0.002372708 0.003910090 0.05201881 0.941698392 0.05830161  204.8577
## [20,] 0.001698082 0.002816635 0.04151232 0.953972961 0.04602704  153.4165
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.895811670 0.078759529 0.02275237 0.002676433 0.99732357 6856.1123
##  [2,] 0.802478548 0.137017770 0.05320705 0.007296630 0.99270337 6623.5273
##  [3,] 0.579577926 0.248489384 0.14547192 0.026460766 0.97353923 4940.0632
##  [4,] 0.418591342 0.266763725 0.24842753 0.066217404 0.93378260 5015.9681
##  [5,] 0.302321230 0.243629596 0.32541261 0.128636561 0.87136344 4851.7322
##  [6,] 0.218346910 0.205710363 0.36823850 0.207704224 0.79229578 4477.3215
##  [7,] 0.157697735 0.165940786 0.38068830 0.295673179 0.70432682 3973.3054
##  [8,] 0.113894791 0.129988609 0.37040058 0.385716024 0.61428398 3416.9858
##  [9,] 0.082258780 0.099802275 0.34517491 0.472764030 0.52723597 2865.5792
## [10,] 0.059410153 0.075536767 0.31152913 0.553523949 0.44647605 2354.9115
## [11,] 0.042908079 0.056572953 0.27434203 0.626176942 0.37382306 1903.5377
## [12,] 0.030989708 0.042036874 0.23697150 0.690001918 0.30999808 1517.8846
## [13,] 0.022381845 0.031048164 0.20154123 0.745028764 0.25497124 1196.7349
## [14,] 0.016164947 0.022825527 0.16925125 0.791758271 0.20824173  934.5973
## [15,] 0.011674887 0.016719765 0.14065196 0.830953389 0.16904661  724.0154
## [16,] 0.008432010 0.012212424 0.11586258 0.863492983 0.13650702  557.0285
## [17,] 0.006089891 0.008900118 0.09473471 0.890275285 0.10972472  426.0201
## [18,] 0.004398331 0.006474609 0.07696868 0.912158380 0.08784162  324.1529
## [19,] 0.003176628 0.004703413 0.06219296 0.929927003 0.07007300  245.5407
## [20,] 0.002294271 0.003412863 0.05001568 0.944277190 0.05572281  185.2640
## 
## , , 3
## 
##            State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.8373093674 0.114348416 0.04120950 0.007132715 0.99286729 6944.9582
##  [2,] 0.7010869767 0.184847301 0.09504916 0.019016567 0.98098343 6794.6334
##  [3,] 0.4844715271 0.259591714 0.20271588 0.053220874 0.94677913 5130.1597
##  [4,] 0.3347839403 0.255955406 0.29880839 0.110452266 0.88954773 5086.5066
##  [5,] 0.2313454567 0.221337230 0.35954931 0.187768008 0.81223199 4783.8231
##  [6,] 0.1598664509 0.178771296 0.38418879 0.277173467 0.72282653 4295.4579
##  [7,] 0.1104723753 0.138530462 0.38034311 0.370654056 0.62934594 3715.4462
##  [8,] 0.0763396299 0.104435848 0.35725159 0.461972932 0.53802707 3119.8212
##  [9,] 0.0527529084 0.077224567 0.32303287 0.546989655 0.45301035 2558.5350
## [10,] 0.0364537967 0.056300677 0.28386171 0.623383816 0.37661618 2058.7850
## [11,] 0.0251906356 0.040610505 0.24399255 0.690206305 0.30979369 1631.3133
## [12,] 0.0174074631 0.029053201 0.20609626 0.747443075 0.25255693 1276.3560
## [13,] 0.0120290642 0.020651599 0.17166078 0.795658553 0.20434145  988.2279
## [14,] 0.0083124338 0.014604756 0.14135167 0.835731144 0.16426886  758.4761
## [15,] 0.0057441340 0.010286210 0.11529899 0.868670661 0.13132934  577.8665
## [16,] 0.0039693639 0.007220668 0.09330942 0.895500549 0.10449945  437.5240
## [17,] 0.0027429461 0.005055078 0.07501429 0.917187689 0.08281231  329.5071
## [18,] 0.0018954557 0.003531176 0.05996808 0.934605288 0.06539471  247.0283
## [19,] 0.0013098151 0.002462195 0.04771039 0.948517602 0.05148240  184.4688
## [20,] 0.0009051204 0.001714252 0.03780235 0.959578279 0.04042172  137.2854
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.820311330 0.129751406 0.04192669 0.008010577 0.99198942 6947.5913
##  [2,] 0.672910678 0.201342429 0.10378470 0.021962193 0.97803781 6828.9095
##  [3,] 0.483190880 0.253496405 0.20606249 0.057250224 0.94274978 5129.1787
##  [4,] 0.346960501 0.245049783 0.29363525 0.114354465 0.88564554 5042.7758
##  [5,] 0.249138786 0.212427847 0.34877884 0.189654532 0.81034547 4724.4458
##  [6,] 0.178896833 0.173636930 0.37162337 0.275842866 0.72415713 4243.7364
##  [7,] 0.128458830 0.136891328 0.36886852 0.365781325 0.63421868 3683.7339
##  [8,] 0.092241269 0.105360989 0.34850497 0.453892772 0.54610723 3111.2095
##  [9,] 0.066234853 0.079743402 0.31761497 0.536406778 0.46359322 2570.4632
## [10,] 0.047560661 0.059625918 0.28167973 0.611133687 0.38886631 2086.1530
## [11,] 0.034151454 0.044183661 0.24456940 0.677095490 0.32290451 1668.5378
## [12,] 0.024522825 0.032518476 0.20879761 0.734161084 0.26583892 1318.4858
## [13,] 0.017608883 0.023808469 0.17584054 0.782742105 0.21725790 1031.4003
## [14,] 0.012644251 0.017361070 0.14643272 0.823561960 0.17643804  799.9804
## [15,] 0.009079343 0.012619722 0.12080904 0.857491899 0.14250810  616.0078
## [16,] 0.006519522 0.009150499 0.09888849 0.885441489 0.11455851  471.4103
## [17,] 0.004681414 0.006621980 0.08040645 0.908290155 0.09170985  358.8302
## [18,] 0.003361541 0.004784706 0.06500562 0.926848136 0.07315186  271.8713
## [19,] 0.002413791 0.003452908 0.05229576 0.941837541 0.05816246  205.1536
## [20,] 0.001733249 0.002489349 0.04189090 0.953886506 0.04611349  154.2598
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.792131775 0.145215402 0.05431342 0.008339406 0.99166059 7022.7472
##  [2,] 0.627472748 0.215241858 0.13148895 0.025796445 0.97420356 6962.3999
##  [3,] 0.452612776 0.247971530 0.23287193 0.066543763 0.93345624 5229.2335
##  [4,] 0.326481628 0.233061386 0.31056427 0.129892715 0.87010729 5061.8298
##  [5,] 0.235499878 0.199790806 0.35449539 0.210213929 0.78978607 4671.0151
##  [6,] 0.169872323 0.162630853 0.36785528 0.299641544 0.70035846 4140.3789
##  [7,] 0.122533423 0.128133382 0.35821383 0.391119366 0.60888063 3552.8862
##  [8,] 0.088386616 0.098752639 0.33347022 0.479390529 0.52060947 2970.4846
##  [9,] 0.063755616 0.074931010 0.30025992 0.561053453 0.43894655 2431.9695
## [10,] 0.045988621 0.056211386 0.26354585 0.634254147 0.36574585 1957.3012
## [11,] 0.033172815 0.041810322 0.22672824 0.698288621 0.30171138 1553.2168
## [12,] 0.023928433 0.030897483 0.19193950 0.753234588 0.24676541 1218.1596
## [13,] 0.017260215 0.022718903 0.16036660 0.799654282 0.20034572  945.9844
## [14,] 0.012450252 0.016640106 0.13253572 0.838373922 0.16162608  728.4838
## [15,] 0.008980698 0.012150462 0.10853846 0.870330378 0.12966962  556.9768
## [16,] 0.006478016 0.008850675 0.08820028 0.896471033 0.10352897  423.2188
## [17,] 0.004672765 0.006434628 0.07119953 0.917693075 0.08230692  319.8584
## [18,] 0.003370590 0.004670929 0.05714791 0.934810572 0.06518943  240.6083
## [19,] 0.002431296 0.003386486 0.04564201 0.948540206 0.05145979  180.2483
## [20,] 0.001753758 0.002452829 0.03629450 0.959498914 0.04050109  134.5392
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.858593709 0.105160361 0.03181024 0.004435686 0.99556431 6905.0819
##  [2,] 0.737183157 0.171947849 0.07702318 0.013845816 0.98615418 6723.7205
##  [3,] 0.545873458 0.243693650 0.16733526 0.043097632 0.95690237 4983.3021
##  [4,] 0.404211395 0.249090326 0.25122245 0.095475826 0.90452417 4908.9981
##  [5,] 0.299312688 0.224933491 0.30734128 0.168412541 0.83158746 4613.5585
##  [6,] 0.221636713 0.190440001 0.33345456 0.254468724 0.74553128 4154.8958
##  [7,] 0.164118778 0.155103397 0.33484479 0.345933030 0.65406697 3612.3232
##  [8,] 0.121527580 0.123159884 0.31872697 0.436585562 0.56341444 3052.3900
##  [9,] 0.089989414 0.096098523 0.29180594 0.522106119 0.47789388 2520.4468
## [10,] 0.066635859 0.074050013 0.25941481 0.599899319 0.40010068 2042.4001
## [11,] 0.049342889 0.056537859 0.22539672 0.668722528 0.33127747 1629.5334
## [12,] 0.036537695 0.042871078 0.19229509 0.728296140 0.27170386 1283.4153
## [13,] 0.027055634 0.032338561 0.16163674 0.778969060 0.22103094  999.8617
## [14,] 0.020034306 0.024296098 0.13420977 0.821459824 0.17854018  771.7746
## [15,] 0.014835113 0.018197270 0.11029750 0.856670121 0.14332988  591.0053
## [16,] 0.010985187 0.013596535 0.08985972 0.885558559 0.11444144  449.4795
## [17,] 0.008134372 0.010139832 0.07266510 0.909060700 0.09093930  339.8056
## [18,] 0.006023385 0.007550746 0.05838323 0.928042643 0.07195736  255.5484
## [19,] 0.004460229 0.005616197 0.04664578 0.943277798 0.05672220  191.2959
## [20,] 0.003302735 0.004173445 0.03708490 0.955438918 0.04456108  142.6112
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.876776101 0.087752646 0.03132314 0.004148115 0.99585189 6899.2802
##  [2,] 0.768736331 0.148433775 0.07102910 0.011800796 0.98819920 6697.1394
##  [3,] 0.563575565 0.234974903 0.16359967 0.037849859 0.96215014 4983.7097
##  [4,] 0.413168214 0.247797583 0.25325574 0.085778458 0.91422154 4957.4299
##  [5,] 0.302901658 0.226889047 0.31569149 0.154517807 0.84548219 4705.2635
##  [6,] 0.222063101 0.193413631 0.34716535 0.237357923 0.76264208 4276.6581
##  [7,] 0.162798781 0.158007022 0.35237775 0.326816449 0.67318355 3749.7845
##  [8,] 0.119350954 0.125544468 0.33848800 0.416616577 0.58338342 3193.4046
##  [9,] 0.087498507 0.097850633 0.31240724 0.502243621 0.49775638 2656.1604
## [10,] 0.064146858 0.075215746 0.27977448 0.580862919 0.41913708 2167.1693
## [11,] 0.047027310 0.057225434 0.24474727 0.650999990 0.34900001 1740.3584
## [12,] 0.034476636 0.043200418 0.21014684 0.712176109 0.28782389 1379.2493
## [13,] 0.025275493 0.032417886 0.17772405 0.764582574 0.23541743 1080.9740
## [14,] 0.018529956 0.024213326 0.14843535 0.808821364 0.19117864  839.2350
## [15,] 0.013584671 0.018018978 0.12268268 0.845713670 0.15428633  646.3020
## [16,] 0.009959187 0.013370354 0.10050348 0.876166977 0.12383302  494.2545
## [17,] 0.007301274 0.009898038 0.08171236 0.901088326 0.09891167  375.6853
## [18,] 0.005352706 0.007313905 0.06600155 0.921331838 0.07866816  284.0434
## [19,] 0.003924173 0.005396369 0.05300902 0.937670435 0.06232957  213.7506
## [20,] 0.002876887 0.003976782 0.04236243 0.950783904 0.04921610  160.1861
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.846957046 0.105169728 0.04117138 0.006701842 0.99329816 6945.0649
##  [2,] 0.717336237 0.168019652 0.09555092 0.019093188 0.98090681 6792.5063
##  [3,] 0.532076745 0.224628540 0.19057077 0.052723946 0.94727605 5059.8276
##  [4,] 0.394662431 0.224538620 0.27229748 0.108501469 0.89149853 4955.6537
##  [5,] 0.292736782 0.200099048 0.32408958 0.183074585 0.81692542 4631.1444
##  [6,] 0.217134485 0.167854056 0.34587078 0.269140677 0.73085932 4152.8301
##  [7,] 0.161057262 0.135759743 0.34373864 0.359444353 0.64055565 3600.2549
##  [8,] 0.119462560 0.107217902 0.32506617 0.448253369 0.55174663 3037.4399
##  [9,] 0.088610120 0.083303987 0.29643657 0.531649319 0.46835068 2506.9033
## [10,] 0.065725642 0.063977122 0.26297543 0.607321810 0.39267819 2032.2994
## [11,] 0.048751316 0.048721263 0.22832246 0.674204959 0.32579504 1623.4103
## [12,] 0.036160785 0.036872300 0.19485628 0.732110637 0.26788936 1280.9464
## [13,] 0.026821889 0.027774681 0.16398451 0.781418919 0.21858108 1000.3270
## [14,] 0.019894859 0.020847770 0.13641651 0.822840862 0.17715914  774.3494
## [15,] 0.014756806 0.015606213 0.11238829 0.857248693 0.14275131  594.9235
## [16,] 0.010945709 0.011658342 0.09183457 0.885561382 0.11443862  454.1075
## [17,] 0.008118866 0.008695294 0.07451344 0.908672398 0.09132760  344.6635
## [18,] 0.006022085 0.006477354 0.06009264 0.927407925 0.07259208  260.3001
## [19,] 0.004466820 0.004820561 0.04820655 0.942506072 0.05749393  195.7266
## [20,] 0.003313217 0.003584897 0.03849199 0.954609891 0.04539011  146.6007
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.873436446 0.086704760 0.03690907 0.002949726 0.99705027 6939.9794
##  [2,] 0.762891226 0.146123302 0.08112656 0.009858917 0.99014108 6765.0136
##  [3,] 0.549104031 0.231711477 0.18369133 0.035493160 0.96450684 5098.3098
##  [4,] 0.395227034 0.240603446 0.27929967 0.084869853 0.91513015 5088.3194
##  [5,] 0.284471430 0.216250149 0.34329690 0.155981518 0.84401848 4826.3522
##  [6,] 0.204753185 0.180779008 0.37317312 0.241294683 0.75870532 4374.6597
##  [7,] 0.147374613 0.144779915 0.37502667 0.332818799 0.66718120 3821.2431
##  [8,] 0.106075403 0.112761545 0.35710800 0.424055053 0.57594495 3240.5638
##  [9,] 0.076349589 0.086152539 0.32703519 0.510462687 0.48953731 2683.7440
## [10,] 0.054953925 0.064921357 0.29083424 0.589290483 0.41070952 2180.3826
## [11,] 0.039554029 0.048426965 0.25282550 0.659193505 0.34080650 1743.8598
## [12,] 0.028469690 0.035847211 0.21585416 0.719828937 0.28017106 1376.7524
## [13,] 0.020491547 0.026379865 0.18161952 0.771509070 0.22849093 1075.2051
## [14,] 0.014749142 0.019324710 0.15099308 0.814933066 0.18506693  832.0587
## [15,] 0.010615948 0.014106111 0.12428390 0.850994043 0.14900596  638.9038
## [16,] 0.007641010 0.010267945 0.10144243 0.880648618 0.11935138  487.3226
## [17,] 0.005499748 0.007457525 0.08220847 0.904834260 0.09516574  369.5659
## [18,] 0.003958538 0.005406768 0.06621348 0.924421218 0.07557878  278.8612
## [19,] 0.002849225 0.003914419 0.05304809 0.940188268 0.05981173  209.4972
## [20,] 0.002050779 0.002830775 0.04230432 0.952814129 0.04718587  156.7804
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.811664701 0.135418068 0.04623897 0.006678263 0.99332174 6983.5544
##  [2,] 0.658799586 0.208920913 0.11140696 0.020872542 0.97912746 6880.2173
##  [3,] 0.469310808 0.259377903 0.21313245 0.058178841 0.94182116 5163.8219
##  [4,] 0.334324185 0.249926941 0.29629623 0.119452640 0.88054736 5036.7664
##  [5,] 0.238163406 0.216440074 0.34560583 0.199790689 0.80020931 4672.3827
##  [6,] 0.169661097 0.176816949 0.36265727 0.290864680 0.70913532 4151.5800
##  [7,] 0.120861925 0.139297431 0.35495448 0.384886164 0.61511384 3562.4021
##  [8,] 0.086098730 0.107092541 0.33084729 0.475961443 0.52403856 2972.5768
##  [9,] 0.061334381 0.080922705 0.29749142 0.560251497 0.43974850 2425.1654
## [10,] 0.043692935 0.060377591 0.26027235 0.635657125 0.36434288 1942.6198
## [11,] 0.031125652 0.044620585 0.22287734 0.701376420 0.29862358 1532.7858
## [12,] 0.022173063 0.032734912 0.18760519 0.757486839 0.24251316 1194.3271
## [13,] 0.015795484 0.023878425 0.15571959 0.804606499 0.19539350  920.8383
## [14,] 0.011252271 0.017339773 0.12776453 0.843643421 0.15635658  703.6512
## [15,] 0.008015810 0.012546538 0.10381527 0.875622386 0.12437761  533.5902
## [16,] 0.005710244 0.009052240 0.08366438 0.901573133 0.09842687  401.9705
## [17,] 0.004067822 0.006516009 0.06695237 0.922463796 0.07753620  301.0894
## [18,] 0.002897805 0.004681574 0.05325473 0.939165891 0.06083411  224.4022
## [19,] 0.002064317 0.003358451 0.04213699 0.952440246 0.04755975  166.5152
## [20,] 0.001470563 0.002406275 0.03318712 0.962936044 0.03706396  123.0833</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 9.036959 9.629281 8.749137 8.874354 8.576859 9.040243 9.272672
##  [8] 8.927514 9.193560 8.586091</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 51813.44 53390.28 51056.18 51264.13 50301.54 50171.45 51500.04
##  [8] 50389.28 52187.37 49893.34</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}</code></pre></div>
<p>Presentation of results for first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1]  6854.676  5267.422  6400.881  7658.535 10021.148  6622.096  5892.659
##  [8]  7125.810  5800.563  7994.659</code></pre>
</div>
<div id="overview-psa-results" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">4.4</span> Overview PSA results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)</code></pre></div>
<p>Presentation of results first 10 PSA samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi      ICER
##  [1,]     8.220866      9.036959       46219.39        51813.44  6854.676
##  [2,]     8.436834      9.629281       47109.16        53390.28  5267.422
##  [3,]     7.837525      8.749137       45221.07        51056.18  6400.881
##  [4,]     8.181126      8.874354       45955.02        51264.13  7658.535
##  [5,]     8.089447      8.576859       45417.11        50301.54 10021.148
##  [6,]     8.166069      9.040243       44382.58        50171.45  6622.096
##  [7,]     8.241682      9.272672       45424.76        51500.04  5892.659
##  [8,]     8.147113      8.927514       44828.29        50389.28  7125.810
##  [9,]     8.140607      9.193560       46079.65        52187.37  5800.563
## [10,]     7.920227      8.586091       44569.98        49893.34  7994.659</code></pre>
</div>
</div>
<div id="appendix-dirichlet-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix-dirichlet-distribution" class="anchor"></a><span class="header-section-number">5</span> Appendix: Dirichlet distribution</h1>
<p>The multinomial distribution is a discrete probability distribution for the number of successes for each of k mutually exclusive categories in n trials. The probabilities of the categories are given by <span class="math inline">\(\pi_1,\ldots, \pi_k\)</span> with <span class="math inline">\(\sum_{j=1}^k \pi_j=1\)</span> and each <span class="math inline">\(\pi_j\)</span> defined on <span class="math inline">\([0,1]\)</span>. The Dirichlet distribution is parameterized by the concentration parameters <span class="math inline">\(\alpha_1,\ldots, \alpha_k\)</span> with <span class="math inline">\(\alpha_j &gt; 0\)</span>. Letting <span class="math inline">\(x_1,\ldots, x_k\)</span> denote the number of successes in each category, the prior distribution and likelihood are,</p>
<p><span class="math display">\[
\begin{aligned}
p(\pi_1,\ldots,\pi_k |\alpha_1,\ldots, \alpha_k) = \text{Dirichlet}(\alpha_1,\ldots,\alpha_k) \\
p(x_1,\ldots,x_k | \pi_1,\ldots,\pi_k) = \text{Multin}(n, \pi_1,\ldots,\pi_k).
\end{aligned}
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#model-settings"><span class="toc-section-number">2</span> Model settings</a></li>
      <li>
<a href="#model-parameters"><span class="toc-section-number">3</span> Model parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#transition-matrix-monotherapy"><span class="toc-section-number">3.1</span> Transition matrix monotherapy</a></li>
      <li><a href="#relative-treatment-effect-with-combination-therapy"><span class="toc-section-number">3.2</span> Relative treatment effect with combination therapy</a></li>
      <li><a href="#transition-matrix-combination-therapy"><span class="toc-section-number">3.3</span> Transition matrix combination therapy</a></li>
      <li><a href="#other-parameters"><span class="toc-section-number">3.4</span> Other parameters</a></li>
      </ul>
</li>
      <li>
<a href="#model-output"><span class="toc-section-number">4</span> Model output</a><ul class="nav nav-pills nav-stacked">
<li><a href="#monotherapy"><span class="toc-section-number">4.1</span> Monotherapy</a></li>
      <li><a href="#combination-therapy"><span class="toc-section-number">4.2</span> Combination therapy</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">4.3</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">4.4</span> Overview PSA results</a></li>
      </ul>
</li>
      <li><a href="#appendix-dirichlet-distribution"><span class="toc-section-number">5</span> Appendix: Dirichlet distribution</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
