<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Probabilistic Sensitivity Analysis â€¢ learnCEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating Probabilistic Sensitivity Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">learnCEA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple-markov-cohort-model.html">Simple Markov Cohort Model</a>
    </li>
    <li>
      <a href="../articles/probabilistic-sensitivity-analysis.html">Incorporating Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/simple-markov-cohort-models-hesim.html">Simple Markov Cohort Models (HESIM)</a>
    </li>
    <li>
      <a href="../articles/partitioned-survival-model.html">Partitioned Survival Model</a>
    </li>
    <li>
      <a href="../articles/individual-patient-simulation.html">Individual Patient Simulation</a>
    </li>
    <li>
      <a href="../articles/decision-analysis.html">Decision Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hesim-dev/ispor-short-course">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Probabilistic Sensitivity Analysis</h1>
            
            <h4 class="date">2020-03-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hesim-dev/ispor-short-course/blob/master/vignettes/probabilistic-sensitivity-analysis.Rmd"><code>vignettes/probabilistic-sensitivity-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>probabilistic-sensitivity-analysis.Rmd</code></div>

    </div>

    
    
<div id="required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a><span class="header-section-number">1</span> Required R-packages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages("expm")</span>
<span class="co">#install.packages("hesim")</span>
<span class="co">#install.packages("data.table")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(expm)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hesim)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(data.table)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</code></pre></div>
</div>
<div id="number-of-psa-simulations" class="section level1">
<h1 class="hasAnchor">
<a href="#number-of-psa-simulations" class="anchor"></a><span class="header-section-number">2</span> Number of PSA simulations</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PSA_samples  &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
</div>
<div id="create-psa-samples-for-transition-matrix-monotherapy-based-on-dirichlet-distribution-using-rdirichlet_mat-function-from-hesim-package" class="section level1">
<h1 class="hasAnchor">
<a href="#create-psa-samples-for-transition-matrix-monotherapy-based-on-dirichlet-distribution-using-rdirichlet_mat-function-from-hesim-package" class="anchor"></a><span class="header-section-number">3</span> Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transitions_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1251</span>, <span class="dv">350</span>, <span class="dv">116</span>, <span class="dv">17</span>,
                             <span class="dv">0</span>, <span class="dv">731</span>, <span class="dv">512</span>, <span class="dv">15</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1312</span>, <span class="dv">437</span>,
                             <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">469</span>),
                             <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
p_mono =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/hesim/man/rdirichlet_mat.html">rdirichlet_mat</a></span>(<span class="dt">n=</span>PSA_samples,transitions_mono)

<span class="co">#Show first 10 PSA samples</span>
<span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_mono[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7211997 0.2069305 0.06235713 0.009512645
## [2,] 0.0000000 0.5456346 0.44008418 0.014281206
## [3,] 0.0000000 0.0000000 0.74045663 0.259543370
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7194531 0.2079024 0.06248244 0.010162130
## [2,] 0.0000000 0.5776961 0.41379598 0.008507908
## [3,] 0.0000000 0.0000000 0.74467507 0.255324933
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7129911 0.1877691 0.08665729 0.01258250
## [2,] 0.0000000 0.5924074 0.39424554 0.01334704
## [3,] 0.0000000 0.0000000 0.76177545 0.23822455
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7222764 0.1992839 0.06777304 0.01066660
## [2,] 0.0000000 0.5886952 0.40030561 0.01099919
## [3,] 0.0000000 0.0000000 0.74404015 0.25595985
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7237761 0.1984515 0.06624272 0.011529610
## [2,] 0.0000000 0.5950090 0.39598572 0.009005237
## [3,] 0.0000000 0.0000000 0.73916455 0.260835447
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7106367 0.2071970 0.06965864 0.012507610
## [2,] 0.0000000 0.5934718 0.39712313 0.009405029
## [3,] 0.0000000 0.0000000 0.75053893 0.249461073
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7337255 0.2005730 0.05712213 0.008579401
## [2,] 0.0000000 0.5781599 0.41094583 0.010894298
## [3,] 0.0000000 0.0000000 0.75263983 0.247360173
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7121233 0.2110163 0.06833047 0.008529902
## [2,] 0.0000000 0.5810476 0.41201477 0.006937599
## [3,] 0.0000000 0.0000000 0.74772473 0.252275268
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]       [,4]
## [1,] 0.7118358 0.2033829 0.07595152 0.00882978
## [2,] 0.0000000 0.5837145 0.40320340 0.01308209
## [3,] 0.0000000 0.0000000 0.75490990 0.24509010
## [4,] 0.0000000 0.0000000 0.00000000 1.00000000
## 
## , , 10
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.7223659 0.1946460 0.07627916 0.006708979
## [2,] 0.0000000 0.5868391 0.39898360 0.014177330
## [3,] 0.0000000 0.0000000 0.75613197 0.243868027
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000</code></pre>
</div>
<div id="create-psa-samples-for-relative-risk-according-to-normal-distribution-of-log-transformed-relative-risk" class="section level1">
<h1 class="hasAnchor">
<a href="#create-psa-samples-for-relative-risk-according-to-normal-distribution-of-log-transformed-relative-risk" class="anchor"></a><span class="header-section-number">4</span> Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RR&lt;-<span class="fl">0.509</span>
RR_low&lt;-<span class="fl">0.365</span>
RR_high&lt;-<span class="fl">0.710</span>

RR_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(PSA_samples, <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR), (<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_high)<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(RR_low))<span class="op">/</span><span class="fl">3.92</span> )   )

<span class="co">#Show first 10 PSA samples</span>
RR_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 0.4678461 0.3948278 0.6100327 0.6940868 0.5045676 0.4748660 0.5472977
##  [8] 0.6791629 0.5724395 0.4455140</code></pre>
</div>
<div id="create-psa-samples-for-transition-matrix-for-combination-therapy" class="section level1">
<h1 class="hasAnchor">
<a href="#create-psa-samples-for-transition-matrix-for-combination-therapy" class="anchor"></a><span class="header-section-number">5</span> Create PSA samples for transition matrix for combination therapy</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, PSA_samples))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){ 
p_combi[,,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>((<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">1</span>,<span class="dv">2</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">1</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i]<span class="op">-</span>p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">2</span>,<span class="dv">3</span>,i]<span class="op">*</span>RR_combi[i], p_mono[<span class="dv">2</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, (<span class="dv">1</span><span class="op">-</span>p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i]), p_mono[<span class="dv">3</span>,<span class="dv">4</span>,i]<span class="op">*</span>RR_combi[i],
                                      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                      <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
}

<span class="co">#Show first 10 PSA samples</span>
<span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(p_combi[, , <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</code></pre></div>
<pre><code>## , , 1
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8695644 0.09681164 0.02917354 0.004450454
## [2,] 0.0000000 0.78742694 0.20589165 0.006681406
## [3,] 0.0000000 0.00000000 0.87857366 0.121426342
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 2
## 
##           [,1]       [,2]      [,3]        [,4]
## [1,] 0.8892323 0.08208563 0.0246698 0.004012291
## [2,] 0.0000000 0.83326269 0.1633781 0.003359159
## [3,] 0.0000000 0.00000000 0.8991906 0.100809378
## [4,] 0.0000000 0.00000000 0.0000000 1.000000000
## 
## , , 3
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8249152 0.1145453 0.05286378 0.007675733
## [2,] 0.0000000 0.7513552 0.24050266 0.008142132
## [3,] 0.0000000 0.0000000 0.85467525 0.145324753
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 4
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8072357 0.1383203 0.04704038 0.007403544
## [2,] 0.0000000 0.7145187 0.27784686 0.007634391
## [3,] 0.0000000 0.0000000 0.82234163 0.177658367
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 5
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8606264 0.1001322 0.03342393 0.005817467
## [2,] 0.0000000 0.7956547 0.19980155 0.004543750
## [3,] 0.0000000 0.0000000 0.86839089 0.131609105
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 6
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8625912 0.09839081 0.03307852 0.005939439
## [2,] 0.0000000 0.80695360 0.18858027 0.004466128
## [3,] 0.0000000 0.00000000 0.88153942 0.118460582
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000
## 
## , , 7
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8542686 0.1097731 0.03126281 0.004695487
## [2,] 0.0000000 0.7691279 0.22490972 0.005962424
## [3,] 0.0000000 0.0000000 0.86462034 0.135379661
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 8
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8044848 0.1433144 0.04640752 0.005793193
## [2,] 0.0000000 0.7154631 0.27982515 0.004711760
## [3,] 0.0000000 0.0000000 0.82866400 0.171336003
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 9
## 
##           [,1]      [,2]       [,3]        [,4]
## [1,] 0.8350435 0.1164244 0.04347765 0.005054515
## [2,] 0.0000000 0.7617018 0.23080954 0.007488704
## [3,] 0.0000000 0.0000000 0.85970076 0.140299244
## [4,] 0.0000000 0.0000000 0.00000000 1.000000000
## 
## , , 10
## 
##           [,1]       [,2]       [,3]        [,4]
## [1,] 0.8763101 0.08671751 0.03398343 0.002988944
## [2,] 0.0000000 0.81593103 0.17775277 0.006316198
## [3,] 0.0000000 0.00000000 0.89135339 0.108646614
## [4,] 0.0000000 0.00000000 0.00000000 1.000000000</code></pre>
</div>
<div id="parameters-for-which-no-uncertainty-is-propagated" class="section level1">
<h1 class="hasAnchor">
<a href="#parameters-for-which-no-uncertainty-is-propagated" class="anchor"></a><span class="header-section-number">6</span> Parameters for which no uncertainty is propagated</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define LY by health state per cycle</span>
LY &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define costs by health state per cycle</span>
drug_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">2278</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
drug_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">2278</span><span class="op">+</span><span class="dv">2087</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
other_cost &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2756</span>, <span class="dv">3052</span>, <span class="dv">9007</span>, <span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</code></pre></div>
</div>
<div id="model-simulation-settings" class="section level1">
<h1 class="hasAnchor">
<a href="#model-simulation-settings" class="anchor"></a><span class="header-section-number">7</span> Model simulation settings</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># discount rates</span>
discount_LY &lt;-<span class="st"> </span><span class="fl">0.00</span>
discount_cost &lt;-<span class="st"> </span><span class="fl">0.06</span>

<span class="co"># define starting distribution</span>
initial&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)

<span class="co"># define duration of follow-up</span>
follow_up &lt;-<span class="st"> </span><span class="dv">20</span></code></pre></div>
</div>
<div id="monotherapy-results" class="section level1">
<h1 class="hasAnchor">
<a href="#monotherapy-results" class="anchor"></a><span class="header-section-number">8</span> Monotherapy results</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data format</span>
trace_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_mono) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)

Expected_LY_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_mono &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)

<span class="co"># Trace and expected LY and cost by PSA sample</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>follow_up){
trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span>t)
trace_mono[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_mono[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_mono[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">5</span>,i])
Expected_total_cost_mono[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_mono[,<span class="dv">6</span>,i])
}

<span class="co"># Presentation of results for first 10 PSA samples</span>
trace_mono[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.721199683 0.206930542 0.06235713 0.009512645 0.99048735 5129.39548
##  [2,] 0.520128983 0.262146706 0.18221155 0.035512759 0.96448724 5403.90584
##  [3,] 0.375116857 0.250666888 0.28272012 0.091496133 0.90850387 5386.06479
##  [4,] 0.270534159 0.214395664 0.34304773 0.172022445 0.82797755 5050.30326
##  [5,] 0.195109149 0.172963475 0.36523384 0.266693534 0.73330647 4502.78248
##  [6,] 0.140712657 0.134748900 0.35872476 0.365813687 0.63418631 3859.49543
##  [7,] 0.101481923 0.102641410 0.33369542 0.462181246 0.53781875 3208.03038
##  [8,] 0.073188731 0.077004415 0.29858597 0.551220884 0.44877912 2602.76267
##  [9,] 0.052783690 0.057161258 0.25954223 0.630512828 0.36948717 2071.24012
## [10,] 0.038067580 0.042111718 0.22062697 0.699193736 0.30080626 1622.61870
## [11,] 0.027454327 0.030854956 0.18427119 0.757419531 0.24258047 1254.89340
## [12,] 0.019800052 0.022516670 0.15173557 0.805947705 0.19405229  960.15636
## [13,] 0.014279791 0.016383110 0.12349752 0.845839583 0.15416042  728.04882
## [14,] 0.010298581 0.011894117 0.09954495 0.878262354 0.12173765  547.83550
## [15,] 0.007427333 0.008620933 0.07958532 0.904366414 0.09563359  409.52859
## [16,] 0.005356590 0.006240821 0.06318656 0.925216027 0.07478397  304.40234
## [17,] 0.003863171 0.004513650 0.04986742 0.941755762 0.05824424  225.14293
## [18,] 0.002786118 0.003262212 0.03915194 0.954799729 0.04520027  165.79759
## [19,] 0.002009347 0.002356509 0.03059970 0.965034447 0.03496555  121.62642
## [20,] 0.001449141 0.001701588 0.02382011 0.973029164 0.02697084   88.91871
## 
## , , 2
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.719453076 0.207902353 0.06248244 0.01016213 0.98983787 5127.32139
##  [2,] 0.517612729 0.269680369 0.17751146 0.03519544 0.96480456 5381.16380
##  [3,] 0.372398070 0.263406206 0.27612271 0.08807301 0.91192699 5369.07296
##  [4,] 0.267922937 0.229591177 0.33788647 0.16459942 0.83540058 5057.90922
##  [5,] 0.192757981 0.188335740 0.36336001 0.25554626 0.74445374 4539.36244
##  [6,] 0.138680323 0.148875663 0.36056170 0.35188231 0.64811769 3919.97739
##  [7,] 0.099773985 0.114836858 0.33877055 0.44661861 0.55338139 3283.63191
##  [8,] 0.071782700 0.087084053 0.30602713 0.53510612 0.46489388 2684.71528
##  [9,] 0.051644285 0.065231911 0.26841096 0.61471284 0.38528716 2152.54597
## [10,] 0.037155639 0.048421190 0.23009852 0.68432466 0.31567534 1698.51863
## [11,] 0.026731739 0.035697478 0.19370670 0.74386409 0.25613591 1322.66612
## [12,] 0.019232232 0.026179886 0.16069028 0.79389760 0.20610240 1018.65982
## [13,] 0.013836688 0.019122445 0.13169686 0.83534401 0.16465599  777.22986
## [14,] 0.009954848 0.013923642 0.10684871 0.86927280 0.13072720  588.31042
## [15,] 0.007162046 0.010113270 0.08595112 0.89677357 0.10322643  442.26584
## [16,] 0.005152756 0.007331403 0.06863799 0.91887785 0.08112215  330.50346
## [17,] 0.003707166 0.005306593 0.05446866 0.93651758 0.06348242  245.70392
## [18,] 0.002667132 0.003836327 0.04298893 0.95050761 0.04949239  181.82985
## [19,] 0.001918876 0.002770734 0.03376689 0.96154350 0.03845650  134.01873
## [20,] 0.001380542 0.001999581 0.02641178 0.97020810 0.02979190   98.42563
## 
## , , 3
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.712991091 0.187769120 0.08665729 0.01258250 0.98741750 5252.7680
##  [2,] 0.508356296 0.245113529 0.20182641 0.04470376 0.95529624 5467.3654
##  [3,] 0.362453510 0.240660686 0.29443411 0.10245170 0.89754830 5398.7531
##  [4,] 0.258426124 0.210626751 0.35058132 0.18036581 0.81963419 5053.4529
##  [5,] 0.184255524 0.173301295 0.37249741 0.26994577 0.73005423 4524.5522
##  [6,] 0.131372547 0.137262469 0.36804973 0.36331525 0.63668475 3909.9787
##  [7,] 0.093667456 0.105983012 0.34587076 0.45447878 0.54552122 3285.0914
##  [8,] 0.066784062 0.080372978 0.31337615 0.53946681 0.46053319 2698.5187
##  [9,] 0.047616441 0.060153532 0.27619627 0.61603375 0.38396625 2176.5257
## [10,] 0.033950098 0.044576296 0.23824111 0.68323249 0.31676751 1729.3751
## [11,] 0.024206118 0.032782108 0.20200226 0.74100951 0.25899049 1357.0983
## [12,] 0.017258746 0.023965525 0.16890220 0.78987353 0.21012647 1053.9121
## [13,] 0.012305332 0.017438014 0.13960945 0.83064721 0.16935279  811.2707
## [14,] 0.008773592 0.012640970 0.11429226 0.86429318 0.13570682  619.8099
## [15,] 0.006255493 0.009136014 0.09280898 0.89179952 0.10820048  470.4807
## [16,] 0.004460111 0.006586831 0.07484352 0.91410954 0.08589046  355.1355
## [17,] 0.003180019 0.004739559 0.05999728 0.93208314 0.06791686  266.7657
## [18,] 0.002267325 0.003404859 0.04784858 0.94647924 0.05352076  199.5323
## [19,] 0.001616583 0.002442797 0.03798870 0.95795191 0.04204809  148.6848
## [20,] 0.001152609 0.001750676 0.03004201 0.96705470 0.03294530  110.4280
## 
## , , 4
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.722276446 0.199283917 0.06777304 0.01066660 0.98933340 5153.71855
##  [2,] 0.521683265 0.261255564 0.17915120 0.03790997 0.96209003 5375.90517
##  [3,] 0.376799535 0.257762981 0.27323382 0.09220367 0.90779633 5335.04939
##  [4,] 0.272153429 0.226833917 0.33201775 0.16899491 0.83100509 5010.67793
##  [5,] 0.196570011 0.187771839 0.35628209 0.25937606 0.74062394 4491.76943
##  [6,] 0.141977889 0.149713622 0.35357645 0.35473204 0.64526796 3879.25723
##  [7,] 0.102547285 0.116429601 0.33262855 0.44839456 0.55160544 3252.46580
##  [8,] 0.074067489 0.088977572 0.30104636 0.53590858 0.46409142 2662.99808
##  [9,] 0.053497203 0.067141129 0.26462858 0.61473309 0.38526691 2138.82548
## [10,] 0.038639769 0.050186792 0.22739693 0.68377651 0.31622349 1690.92130
## [11,] 0.027908595 0.037245008 0.19190123 0.74294516 0.25705484 1319.39897
## [12,] 0.020157721 0.027487692 0.15958306 0.79277153 0.20722847 1018.22968
## [13,] 0.014559447 0.020198982 0.13110583 0.83413574 0.16586426  778.49881
## [14,] 0.010515946 0.014792507 0.10662050 0.86807104 0.13192896  590.46901
## [15,] 0.007595420 0.010803937 0.08596416 0.89563649 0.10436351  444.77361
## [16,] 0.005485993 0.007873871 0.06880043 0.91783971 0.08216029  333.02358
## [17,] 0.003962403 0.005728580 0.05471404 0.93559498 0.06440502  248.04468
## [18,] 0.002861951 0.004162031 0.04327117 0.94970485 0.05029515  183.89749
## [19,] 0.002067120 0.003020508 0.03405553 0.96085684 0.03914316  135.78197
## [20,] 0.001493032 0.002190102 0.02668790 0.96962896 0.03037104   99.89044
## 
## , , 5
## 
##           State A     State B    State C      Death    Disc LY  Disc cost
##  [1,] 0.723776144 0.198451525 0.06624272 0.01152961 0.98847039 5140.36306
##  [2,] 0.523851906 0.261714931 0.17549314 0.03894002 0.96105998 5351.06016
##  [3,] 0.379151513 0.259681959 0.26805506 0.09311147 0.90688853 5304.50887
##  [4,] 0.274420820 0.229756309 0.32608318 0.16973969 0.83026031 4979.00903
##  [5,] 0.198619243 0.191166311 0.35018773 0.26002672 0.73997328 4461.60520
##  [6,] 0.143755870 0.153161974 0.34770256 0.35537959 0.64462041 3851.79428
##  [7,] 0.104047069 0.119661331 0.32718215 0.44910946 0.55089054 3228.06642
##  [8,] 0.075306786 0.091847873 0.29611798 0.53672736 0.46327264 2641.61625
##  [9,] 0.054505255 0.069595061 0.26023889 0.61566079 0.38433921 2120.24955
## [10,] 0.039449604 0.052226341 0.22352859 0.68479547 0.31520453 1674.89164
## [11,] 0.028552682 0.038903979 0.18851855 0.74402479 0.25597521 1305.65563
## [12,] 0.020665750 0.028814543 0.15664305 0.79387665 0.20612335 1006.52684
## [13,] 0.014957377 0.021246063 0.12856410 0.83523246 0.16476754  768.60662
## [14,] 0.010825793 0.015609914 0.10443398 0.86913032 0.13086968  582.17215
## [15,] 0.007835450 0.011436435 0.08409233 0.89663579 0.10336421  437.87035
## [16,] 0.005671112 0.008359739 0.06720577 0.91876337 0.08123663  327.32592
## [17,] 0.004104616 0.006099561 0.05336213 0.93643369 0.06356631  243.37923
## [18,] 0.002970823 0.004443861 0.04213064 0.95045468 0.04954532  180.10654
## [19,] 0.002150211 0.003233702 0.03309797 0.96151811 0.03848189  132.72425
## [20,] 0.001556271 0.002350794 0.02588779 0.97020515 0.02979485   97.44137
## 
## , , 6
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.710636745 0.207197006 0.06965864 0.01250761 0.98749239 5158.3049
##  [2,] 0.505004583 0.270207394 0.18406623 0.04072179 0.95927821 5393.0099
##  [3,] 0.358874813 0.264995917 0.28063241 0.09549686 0.90450314 5361.7590
##  [4,] 0.255029629 0.231625401 0.34086029 0.17248468 0.82751532 5041.6690
##  [5,] 0.181233426 0.190304529 0.36557774 0.26288431 0.73711569 4522.5536
##  [6,] 0.128791132 0.150491402 0.36257913 0.35813834 0.64186166 3907.0035
##  [7,] 0.091523711 0.115997546 0.34086478 0.45161396 0.54838604 3275.8428
##  [8,] 0.065040112 0.087804716 0.30827301 0.53888216 0.46111784 2681.7311
##  [9,] 0.046219893 0.065585743 0.27077078 0.61742358 0.38257642 2153.2622
## [10,] 0.032845555 0.048499915 0.23248924 0.68616529 0.31383471 1701.7026
## [11,] 0.023341258 0.035588834 0.19604064 0.74502926 0.25497074 1327.2449
## [12,] 0.016587156 0.025957210 0.16289520 0.79456043 0.20543957 1023.8185
## [13,] 0.011787442 0.018841682 0.13372284 0.83564804 0.16435196  782.4109
## [14,] 0.008376590 0.013624330 0.10866776 0.86933132 0.13066868  593.1703
## [15,] 0.005952712 0.009821261 0.08755342 0.89667260 0.10332740  446.6212
## [16,] 0.004230216 0.007062026 0.07002716 0.91868060 0.08131940  334.2813
## [17,] 0.003006147 0.005067602 0.05565727 0.93626898 0.06373102  248.9017
## [18,] 0.002136279 0.003630344 0.04399482 0.95023856 0.04976144  184.4859
## [19,] 0.001518118 0.002597137 0.03461033 0.96127442 0.03872558  136.1920
## [20,] 0.001078830 0.001855877 0.02711353 0.96995176 0.03004824  100.1825
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.733725476 0.200572994 0.05712213 0.008579401 0.99142060 5101.1805
##  [2,] 0.538353074 0.263128773 0.16732899 0.031189168 0.96881083 5340.7381
##  [3,] 0.395003365 0.260109586 0.26482200 0.080065046 0.91993495 5342.7891
##  [4,] 0.289824032 0.229611933 0.32876997 0.151794066 0.84820593 5063.8349
##  [5,] 0.212651276 0.190883280 0.35835880 0.238106640 0.76189336 4582.1673
##  [6,] 0.156027658 0.153013156 0.36030489 0.330654296 0.66934570 3995.0424
##  [7,] 0.114481468 0.119761001 0.34297256 0.422784971 0.57721503 3381.8628
##  [8,] 0.083997970 0.092202896 0.31388952 0.509909617 0.49009038 2796.0823
##  [9,] 0.061631450 0.070155739 0.27893429 0.589278521 0.41072148 2268.1290
## [10,] 0.045220565 0.052922838 0.24228778 0.659568814 0.34043119 1811.3973
## [11,] 0.033179481 0.039667885 0.20668695 0.720465684 0.27953432 1428.0776
## [12,] 0.024344630 0.029589287 0.17375746 0.772308618 0.22769138 1113.7654
## [13,] 0.017862275 0.021990214 0.14432700 0.815820511 0.18417949  860.7213
## [14,] 0.013106006 0.016296549 0.11868337 0.851914079 0.14808592  659.9918
## [15,] 0.009616211 0.012050722 0.09677147 0.881561598 0.11843840  502.6810
## [16,] 0.007055659 0.008895996 0.07833555 0.905712791 0.09428721  380.6365
## [17,] 0.005176917 0.006558483 0.06301726 0.925247336 0.07475266  286.7554
## [18,] 0.003798436 0.004830201 0.05042020 0.940951162 0.05904884  215.0614
## [19,] 0.002787009 0.003554492 0.04015018 0.953508322 0.04649168  160.6525
## [20,] 0.002044900 0.002614063 0.03183853 0.963502511 0.03649749  119.5848
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY  Disc cost
##  [1,] 0.712123322 0.211016307 0.06833047 0.008529902 0.99147010 5170.42931
##  [2,] 0.507119626 0.272880159 0.18669394 0.033306278 0.96669372 5441.55618
##  [3,] 0.361131713 0.265566881 0.28667805 0.086623354 0.91337665 5431.13639
##  [4,] 0.257170315 0.230511687 0.34845005 0.163867951 0.83613205 5113.34593
##  [5,] 0.183136979 0.188205400 0.37309151 0.255566115 0.74443388 4584.71582
##  [6,] 0.130416114 0.148001191 0.36902699 0.352555708 0.64744429 3954.70922
##  [7,] 0.092872357 0.113515668 0.34582068 0.447791300 0.55220870 3308.75509
##  [8,] 0.066136571 0.085555592 0.31169482 0.536613021 0.46338698 2701.90043
##  [9,] 0.047097395 0.063667769 0.27283123 0.616403603 0.38359640 2163.58892
## [10,] 0.033539153 0.046932325 0.23345291 0.686075613 0.31392439 1705.05927
## [11,] 0.023884013 0.034347224 0.19618707 0.745581692 0.25441831 1326.06850
## [12,] 0.017008363 0.024997290 0.16247749 0.795516853 0.20448315 1019.98697
## [13,] 0.012112052 0.018113658 0.13294988 0.836824407 0.16317559  777.26819
## [14,] 0.008625275 0.013080738 0.10770063 0.870593354 0.12940665  587.61523
## [15,] 0.006142259 0.009420606 0.08650925 0.897927882 0.10207212  441.21144
## [16,] 0.004374046 0.006769937 0.06898624 0.919869776 0.08013022  329.32938
## [17,] 0.003114860 0.004856651 0.05467091 0.937357576 0.06264242  244.55365
## [18,] 0.002218165 0.003479232 0.04309265 0.951209958 0.04879004  180.78127
## [19,] 0.001579607 0.002489668 0.03380650 0.962124225 0.03787578  133.10685
## [20,] 0.001124875 0.001779939 0.02641167 0.970683515 0.02931649   97.65893
## 
## , , 9
## 
##           State A     State B    State C      Death    Disc LY Disc cost
##  [1,] 0.711835842 0.203382860 0.07595152 0.00882978 0.99117022 5211.8162
##  [2,] 0.506710266 0.263492735 0.19340623 0.03639077 0.96360923 5462.6068
##  [3,] 0.360694529 0.256860715 0.29073086 0.09171390 0.90828610 5428.7277
##  [4,] 0.256755293 0.223292410 0.35043801 0.16951428 0.83048572 5098.9823
##  [5,] 0.182767620 0.182558645 0.37408234 0.26059139 0.73940861 4569.1915
##  [6,] 0.130100543 0.143733931 0.36988821 0.35627732 0.64372268 3944.4068
##  [7,] 0.092610229 0.110359801 0.34706761 0.44996236 0.55003764 3306.0492
##  [8,] 0.065923281 0.083253950 0.31353611 0.53728666 0.46271334 2706.5669
##  [9,] 0.046926554 0.062004204 0.27526677 0.61580248 0.38419752 2174.1000
## [10,] 0.033404003 0.045736810 0.23636606 0.68449313 0.31550687 1719.4784
## [11,] 0.023778167 0.033491041 0.19941340 0.74331739 0.25668261 1342.5637
## [12,] 0.016926151 0.024385278 0.16584884 0.79283973 0.20716027 1037.0677
## [13,] 0.012048641 0.017676530 0.13631872 0.83395611 0.16604389  793.8502
## [14,] 0.008576655 0.012768534 0.11095070 0.86770411 0.13229589  602.9933
## [15,] 0.006105170 0.009197523 0.08955751 0.89513980 0.10486020  454.9911
## [16,] 0.004345879 0.006610415 0.07178002 0.91726369 0.08273631  341.3497
## [17,] 0.003093552 0.004742472 0.05718287 0.93498111 0.06501889  254.8150
## [18,] 0.002202101 0.003397425 0.04531505 0.94908542 0.05091458  189.3868
## [19,] 0.001567535 0.002430996 0.03574589 0.96025558 0.03974442  140.2170
## [20,] 0.001115827 0.001737817 0.02808417 0.96906219 0.03093781  103.4598
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.722365867 0.194645991 0.07627916 0.006708979 0.99329102 5221.3804
##  [2,] 0.521812446 0.254831494 0.19043913 0.032916926 0.96708307 5459.3818
##  [3,] 0.376939500 0.251113779 0.28547412 0.086472601 0.91352740 5421.8628
##  [4,] 0.272288229 0.220733141 0.34479902 0.162179613 0.83782039 5099.7077
##  [5,] 0.196691723 0.182534644 0.36955238 0.251221252 0.74877875 4583.2739
##  [6,] 0.142083387 0.145403717 0.36726218 0.345250716 0.65474928 3972.3140
##  [7,] 0.102636189 0.112984545 0.34655038 0.437828890 0.56217111 3345.0372
##  [8,] 0.074140880 0.086281468 0.31494580 0.524631850 0.47536815 2752.6267
##  [9,] 0.053556841 0.065064562 0.27822089 0.603157712 0.39684229 2223.2428
## [10,] 0.038687634 0.048607052 0.24041667 0.672288644 0.32771136 1768.3979
## [11,] 0.027946626 0.036054910 0.20413121 0.731867255 0.26813274 1388.8630
## [12,] 0.020187689 0.026598129 0.17086720 0.782346986 0.21765301 1079.2332
## [13,] 0.014582897 0.019538274 0.14135027 0.824528561 0.17547144  831.1049
## [14,] 0.010534187 0.014304325 0.11578728 0.859374209 0.14062579  635.1135
## [15,] 0.007609537 0.010444774 0.09406119 0.887884495 0.11211551  482.1321
## [16,] 0.005496870 0.007610568 0.07587042 0.911022144 0.08897786  363.8997
## [17,] 0.003970751 0.005536122 0.06082384 0.929669289 0.07033071  273.2846
## [18,] 0.002868335 0.004021704 0.04850256 0.944607405 0.05539259  204.3297
## [19,] 0.002071987 0.002918403 0.03849772 0.956511889 0.04348811  152.1789
## [20,] 0.001496733 0.002115937 0.03043180 0.965955528 0.03404447  112.9467</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 7.764169 7.936972 7.898122 7.926119 7.908705 7.886025 8.247077
##  [8] 7.924978 7.925533 8.083575</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_mono[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 43642.95 44353.83 44889.50 44143.60 43834.97 44374.15 45411.15
##  [8] 44712.78 44882.62 45370.31</code></pre>
</div>
<div id="combination-therapy-results" class="section level1">
<h1 class="hasAnchor">
<a href="#combination-therapy-results" class="anchor"></a><span class="header-section-number">9</span> Combination therapy results</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data format</span>
trace_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(follow_up, <span class="dv">6</span>, PSA_samples))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(trace_combi) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"State A"</span>, <span class="st">"State B"</span>, <span class="st">"State C"</span>, <span class="st">"Death"</span>, <span class="st">"Disc LY"</span>, <span class="st">"Disc cost"</span>)

Expected_LY_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
Expected_total_cost_combi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)

<span class="co"># Trace and expected LY and cost by PSA sample</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>initial <span class="op">%*%</span><span class="st"> </span>(p_combi[,,i] <span class="op">%^%</span>t)
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_combi <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span>follow_up){
trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] &lt;-<span class="st"> </span>trace_combi[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">%*%</span><span class="st"> </span>(p_mono[,,i] <span class="op">%^%</span><span class="st"> </span>(t<span class="op">-</span><span class="dv">2</span>))
trace_combi[t,<span class="dv">5</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>LY <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_LY)<span class="op">^</span>t  )
trace_combi[t,<span class="dv">6</span>,i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(  trace_combi[t,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,i] <span class="op">*</span><span class="st"> </span>(drug_cost_mono <span class="op">+</span><span class="st"> </span>other_cost) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>discount_cost)<span class="op">^</span>t  )
}
Expected_LY_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">5</span>,i])
Expected_total_cost_combi[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(trace_combi[,<span class="dv">6</span>,i])
}

<span class="co"># Presentation of results for first 10 PSA samples</span>
trace_combi[,,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>## , , 1
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.869564371 0.096811638 0.02917354 0.004450454 0.99554955 6887.1022
##  [2,] 0.756142195 0.160416043 0.07093208 0.012509683 0.98749032 6695.2635
##  [3,] 0.545329511 0.243997459 0.17026955 0.040403481 0.95959652 5010.1653
##  [4,] 0.393291471 0.245978790 0.26746182 0.093267917 0.90673208 4997.4796
##  [5,] 0.283641684 0.215598558 0.33081978 0.169939976 0.83006002 4715.4186
##  [6,] 0.204562293 0.176332162 0.35752630 0.261579247 0.73842075 4232.7955
##  [7,] 0.147530261 0.138543117 0.35508963 0.358836992 0.64116301 3650.0254
##  [8,] 0.106398777 0.106122436 0.33309867 0.454380117 0.54561988 3049.3888
##  [9,] 0.076734764 0.079921231 0.29998265 0.543361359 0.45663864 2484.5335
## [10,] 0.055341088 0.059486556 0.26208117 0.623091188 0.37690881 1984.1086
## [11,] 0.039911975 0.043909685 0.22368974 0.692488597 0.30751140 1558.9193
## [12,] 0.028784504 0.032217650 0.18744531 0.751552539 0.24844746 1208.6004
## [13,] 0.020759375 0.023535458 0.15476852 0.800936649 0.19906335  926.6647
## [14,] 0.014971655 0.017137509 0.12625145 0.841639383 0.15836062  703.9034
## [15,] 0.010797553 0.012448911 0.10195926 0.874794275 0.12520572  530.4765
## [16,] 0.007787191 0.009026900 0.08164828 0.901537624 0.09846238  397.0769
## [17,] 0.005616120 0.006536797 0.06491520 0.922931887 0.07706811  295.4875
## [18,] 0.004050344 0.004728849 0.05129383 0.939926973 0.06007303  218.7705
## [19,] 0.002921107 0.003418364 0.04031452 0.953346011 0.04665399  161.2487
## [20,] 0.002106701 0.002469644 0.03153767 0.963885983 0.03611402  118.3832
## 
## , , 2
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.889232279 0.082085626 0.02466980 0.004012291 0.99598771 6859.3743
##  [2,] 0.790734046 0.141392078 0.05753104 0.010342836 0.98965716 6629.4297
##  [3,] 0.568896042 0.246077123 0.15075640 0.034270438 0.96572956 4934.1904
##  [4,] 0.409294008 0.260432624 0.24963627 0.080637102 0.91936290 4962.9715
##  [5,] 0.294467833 0.235544102 0.31923756 0.150750501 0.84924950 4737.9135
##  [6,] 0.211855788 0.197293468 0.35359453 0.237256219 0.76274378 4306.1601
##  [7,] 0.152420299 0.158020987 0.35818954 0.331369178 0.66863082 3758.7063
##  [8,] 0.109659253 0.122976649 0.34164686 0.425717240 0.57428276 3176.5732
##  [9,] 0.078894687 0.093841549 0.31215492 0.515108847 0.48489115 2616.1909
## [10,] 0.056761025 0.070614289 0.27621477 0.596409914 0.40359009 2110.2816
## [11,] 0.040836894 0.052594351 0.23845673 0.668112025 0.33188798 1673.5434
## [12,] 0.029380229 0.038873639 0.20188770 0.729858431 0.27014157 1308.7188
## [13,] 0.021137696 0.028565369 0.16826224 0.782034694 0.21796531 1011.5202
## [14,] 0.015207581 0.020896679 0.13844167 0.825454075 0.17454592  774.1366
## [15,] 0.010941141 0.015233622 0.11269122 0.861134012 0.13886599  587.5064
## [16,] 0.007871637 0.011075093 0.09090559 0.890147683 0.10985232  442.6653
## [17,] 0.005663274 0.008034570 0.07276979 0.913532365 0.08646764  331.4577
## [18,] 0.004074460 0.005818948 0.05786838 0.932238215 0.06776178  246.8419
## [19,] 0.002931383 0.004208673 0.04575558 0.947104367 0.05289563  182.9523
## [20,] 0.002108992 0.003040776 0.03599773 0.958852503 0.04114750  135.0296
## 
## , , 3
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.824915194 0.114545295 0.05286378 0.007675733 0.99232427 7010.0924
##  [2,] 0.680485077 0.180554358 0.11633794 0.022622621 0.97737738 6889.0859
##  [3,] 0.485179798 0.234735825 0.21877514 0.061309242 0.93869076 5174.0820
##  [4,] 0.345928873 0.230161026 0.30124545 0.122664652 0.87733535 5043.8300
##  [5,] 0.246644205 0.201303858 0.35019861 0.201853330 0.79814667 4682.7290
##  [6,] 0.175855121 0.165566063 0.36750937 0.291069446 0.70893055 4169.8874
##  [7,] 0.125383135 0.131102725 0.36047243 0.383041713 0.61695829 3589.9035
##  [8,] 0.089397058 0.101209307 0.33715107 0.472242561 0.52775744 3007.9531
##  [9,] 0.063739306 0.076743150 0.30448164 0.555035906 0.44496409 2465.8371
## [10,] 0.045445557 0.057431485 0.26772576 0.629397200 0.37060280 1985.7456
## [11,] 0.032402277 0.042556110 0.23052721 0.694514407 0.30548559 1575.8515
## [12,] 0.023102535 0.031294702 0.19519542 0.750407346 0.24959265 1235.4058
## [13,] 0.016471902 0.022877156 0.16303488 0.797616065 0.20238393  958.6367
## [14,] 0.011744319 0.016645511 0.13464259 0.836967575 0.16303242  737.4409
## [15,] 0.008373595 0.012066145 0.11014757 0.869412688 0.13058731  563.0911
## [16,] 0.005970299 0.008720376 0.08939037 0.895918951 0.10408105  427.2261
## [17,] 0.004256770 0.006287053 0.07205073 0.917405445 0.08259455  322.3559
## [18,] 0.003035039 0.004523787 0.05773400 0.934707173 0.06529283  242.0590
## [19,] 0.002163956 0.003249811 0.04602684 0.948559397 0.05144060  180.9981
## [20,] 0.001542881 0.002331536 0.03653086 0.959594722 0.04040528  134.8383
## 
## , , 4
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.807235734 0.138320346 0.04704038 0.007403544 0.99259646 6984.2185
##  [2,] 0.651629529 0.210489606 0.11508781 0.022793058 0.97720694 6888.9368
##  [3,] 0.470656661 0.253773506 0.21405303 0.061516800 0.93848320 5153.1524
##  [4,] 0.339944220 0.243189547 0.29274884 0.124117389 0.87588261 4999.0221
##  [5,] 0.245533704 0.210909935 0.33820609 0.205350275 0.79464973 4615.6810
##  [6,] 0.177343211 0.173092584 0.35270790 0.296856301 0.70314370 4085.6960
##  [7,] 0.128090824 0.137240423 0.34373786 0.390930890 0.60906911 3495.1295
##  [8,] 0.092516985 0.106319220 0.31937399 0.481789808 0.51821019 2909.0272
##  [9,] 0.066822839 0.081026761 0.28645741 0.565692993 0.43430701 2368.1447
## [10,] 0.048264563 0.061016783 0.25010007 0.640618589 0.35938141 1893.2724
## [11,] 0.034860357 0.045538638 0.21378089 0.705820118 0.29417988 1491.1908
## [12,] 0.025178815 0.033755486 0.17965353 0.761412171 0.23858783 1159.9548
## [13,] 0.018186065 0.024889426 0.14888839 0.808036117 0.19196388  892.8640
## [14,] 0.013135366 0.018276476 0.12197484 0.846613314 0.15338669  681.1537
## [15,] 0.009487366 0.013376941 0.09896058 0.878175113 0.12182489  515.6681
## [16,] 0.006852501 0.009765620 0.07962850 0.903753382 0.09624662  387.8021
## [17,] 0.004949400 0.007114567 0.06362045 0.924315587 0.07568441  289.9586
## [18,] 0.003574835 0.005174647 0.05051960 0.940730915 0.05926909  215.7033
## [19,] 0.002582019 0.003758697 0.03990233 0.953756953 0.04624305  159.7467
## [20,] 0.001864932 0.002727282 0.03136855 0.964039232 0.03596077  117.8368
## 
## , , 5
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.860626403 0.100132202 0.03342393 0.005817467 0.99418253 6903.9112
##  [2,] 0.740677805 0.165847074 0.07779712 0.015678002 0.98432200 6714.8073
##  [3,] 0.536084925 0.245669148 0.17224246 0.046003467 0.95399653 4997.2664
##  [4,] 0.388005480 0.252562234 0.26010872 0.099323565 0.90067643 4938.4689
##  [5,] 0.280829110 0.227277092 0.31797672 0.173917074 0.82608293 4643.0498
##  [6,] 0.203257410 0.190962889 0.34363849 0.262141209 0.73785879 4172.6547
##  [7,] 0.147112865 0.153961388 0.34308829 0.355837454 0.64416255 3613.2099
##  [8,] 0.106476782 0.120803190 0.32431037 0.448409655 0.55159035 3036.5050
##  [9,] 0.077065355 0.093009470 0.29460838 0.535316793 0.46468321 2490.9118
## [10,] 0.055778065 0.070635212 0.25969951 0.613887208 0.38611279 2003.5101
## [11,] 0.040370833 0.053097832 0.22362610 0.682905233 0.31709477 1585.5561
## [12,] 0.029219446 0.039605343 0.18899675 0.742178466 0.25782153 1237.9584
## [13,] 0.021148338 0.029364181 0.15731842 0.792169061 0.20783094  955.6394
## [14,] 0.015306662 0.021668873 0.12931292 0.833711545 0.16628846  730.6127
## [15,] 0.011078597 0.015930806 0.10517805 0.867812551 0.13218745  553.9674
## [16,] 0.008018424 0.011677538 0.08478613 0.895517906 0.10448209  417.0358
## [17,] 0.005803544 0.008539509 0.06782620 0.917830743 0.08216926  312.0016
## [18,] 0.004200467 0.006232807 0.05390069 0.935666034 0.06433397  232.1502
## [19,] 0.003040198 0.004542166 0.04258783 0.949829803 0.05017020  171.9057
## [20,] 0.002200423 0.003305962 0.03347944 0.961014175 0.03898582  126.7527
## 
## , , 6
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.862591228 0.098390813 0.03307852 0.005939439 0.99406056 6900.5686
##  [2,] 0.744063627 0.164267874 0.07624783 0.015420673 0.98457933 6707.4028
##  [3,] 0.528758954 0.251656113 0.17429199 0.045292940 0.95470706 5012.5144
##  [4,] 0.375755542 0.258908088 0.26758402 0.097752351 0.90224765 4983.2348
##  [5,] 0.267025695 0.231510083 0.32982523 0.171638989 0.82836101 4707.9012
##  [6,] 0.189758271 0.192721640 0.35808533 0.259434758 0.74056524 4246.2892
##  [7,] 0.134849200 0.153692212 0.35850950 0.352949084 0.64705092 3686.9371
##  [8,] 0.095828797 0.119152350 0.33950348 0.445515370 0.55448463 3104.9264
##  [9,] 0.068099464 0.090569004 0.30880404 0.532527494 0.46747251 2551.3186
## [10,] 0.048393981 0.067860159 0.27248021 0.611265646 0.38873435 2055.0319
## [11,] 0.034390541 0.050300181 0.23482690 0.680482373 0.31951763 1628.4286
## [12,] 0.024439182 0.036977358 0.19861770 0.739965762 0.26003424 1272.9954
## [13,] 0.017367381 0.027008746 0.16545728 0.790166595 0.20983341  983.8912
## [14,] 0.012341899 0.019627400 0.13611771 0.831912987 0.16808701  753.1640
## [15,] 0.008770607 0.014205514 0.11081586 0.866208022 0.13379198  571.8299
## [16,] 0.006232716 0.010247816 0.08942390 0.894095567 0.10590443  431.0998
## [17,] 0.004429197 0.007373190 0.07161993 0.916577687 0.08342231  323.0226
## [18,] 0.003147550 0.005293497 0.05699014 0.934568814 0.06543119  240.7537
## [19,] 0.002236765 0.003793704 0.04509474 0.948874789 0.05112521  178.6008
## [20,] 0.001589527 0.002714908 0.03550774 0.960187829 0.03981217  131.9486
## 
## , , 7
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.854268558 0.109773144 0.03126281 0.004695487 0.99530451 6901.3963
##  [2,] 0.729774769 0.178205329 0.07842635 0.013593557 0.98640644 6734.7741
##  [3,] 0.535454340 0.249404281 0.17394582 0.041195564 0.95880444 5027.4560
##  [4,] 0.392876490 0.251593228 0.26399649 0.091533793 0.90846621 4988.5525
##  [5,] 0.288263490 0.224261522 0.32452740 0.162947587 0.83705241 4714.2456
##  [6,] 0.211506266 0.187476885 0.35287781 0.248139041 0.75186096 4262.3327
##  [7,] 0.155187536 0.150814057 0.35471442 0.339283983 0.66071602 3716.3426
##  [8,] 0.113865048 0.118321065 0.33781325 0.430000634 0.56999937 3147.1447
##  [9,] 0.083545687 0.091246745 0.30937947 0.515828098 0.48417190 2603.3242
## [10,] 0.061299599 0.069512215 0.27512109 0.594067099 0.40593290 2112.8674
## [11,] 0.044977077 0.052484218 0.23913441 0.663404299 0.33659570 1688.2419
## [12,] 0.033000827 0.039365456 0.20411943 0.723514282 0.27648572 1331.5955
## [13,] 0.024213548 0.029378602 0.17169056 0.774717287 0.22528271 1038.9505
## [14,] 0.017766097 0.021842112 0.14267730 0.817714492 0.18228551  803.2036
## [15,] 0.013035438 0.016191632 0.11737538 0.853397550 0.14660245  616.0931
## [16,] 0.009564433 0.011975909 0.09573988 0.882719777 0.11728022  469.3852
## [17,] 0.007017668 0.008842357 0.07752544 0.906614537 0.09338546  355.5188
## [18,] 0.005149042 0.006519851 0.06238333 0.925947782 0.07405222  267.8963
## [19,] 0.003777983 0.004802275 0.04992561 0.941494137 0.05850586  200.9602
## [20,] 0.002772002 0.003534244 0.03976528 0.953928473 0.04607153  150.1474
## 
## , , 8
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.804484840 0.143314448 0.04640752 0.005793193 0.99420681 6992.6992
##  [2,] 0.647195857 0.217830498 0.11589337 0.019080271 0.98091973 6918.8828
##  [3,] 0.460883264 0.263138775 0.22062892 0.055349041 0.94465096 5216.0621
##  [4,] 0.328205721 0.250150046 0.30487913 0.116765101 0.88323490 5090.0322
##  [5,] 0.233722949 0.214605851 0.35345763 0.198213569 0.80178643 4714.5862
##  [6,] 0.166439563 0.174015575 0.36868019 0.290864670 0.70913533 4177.5368
##  [7,] 0.118525494 0.136232800 0.35874118 0.386500528 0.61349947 3572.1364
##  [8,] 0.084404769 0.104168558 0.33246848 0.478958194 0.52104181 2968.9271
##  [9,] 0.060106604 0.078337676 0.29728131 0.564274413 0.43572559 2411.9484
## [10,] 0.042803315 0.058201395 0.25866798 0.640327313 0.35967269 1923.5323
## [11,] 0.030481239 0.042849980 0.22031705 0.706351732 0.29364827 1510.8850
## [12,] 0.021706401 0.031329918 0.18447413 0.762489552 0.23751045 1171.8781
## [13,] 0.015457634 0.022784579 0.15232747 0.809430320 0.19056968  899.3603
## [14,] 0.011007742 0.016500739 0.12434282 0.848148695 0.15185130  684.0497
## [15,] 0.007838870 0.011910528 0.10052492 0.879725685 0.12027432  516.3103
## [16,] 0.005582242 0.008574714 0.08060791 0.905235130 0.09476487  387.1372
## [17,] 0.003975245 0.006160261 0.06418688 0.925677617 0.07432238  288.6224
## [18,] 0.002830864 0.004418247 0.05080386 0.941947025 0.05805298  214.1026
## [19,] 0.002015925 0.003164570 0.04000112 0.954818382 0.04518162  158.1267
## [20,] 0.001435587 0.002264159 0.03135143 0.964948826 0.03505117  116.3330
## 
## , , 9
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.835043465 0.116424375 0.04347765 0.005054515 0.99494549 6972.8747
##  [2,] 0.697297588 0.185900064 0.10055535 0.016247003 0.98375300 6843.0963
##  [3,] 0.496361415 0.250330941 0.20382658 0.049481068 0.95051893 5149.4944
##  [4,] 0.353327846 0.247073206 0.29250439 0.107094557 0.89290544 5066.5991
##  [5,] 0.251511425 0.216081042 0.34727100 0.185136528 0.81486347 4735.2060
##  [6,] 0.179034847 0.177282752 0.36838561 0.275296795 0.72470320 4232.1672
##  [7,] 0.127443421 0.139895133 0.36317692 0.369484527 0.63051547 3648.2657
##  [8,] 0.090718795 0.107578626 0.34025157 0.461451012 0.53854899 3055.3799
##  [9,] 0.064576890 0.081245853 0.30712557 0.547051683 0.45294832 2500.1984
## [10,] 0.045968145 0.060558215 0.26951545 0.623958186 0.37604181 2007.7982
## [11,] 0.032721773 0.044697841 0.23136851 0.691211872 0.30878813 1587.7137
## [12,] 0.023292531 0.032745826 0.19516997 0.748791671 0.25120833 1239.5822
## [13,] 0.016580458 0.023851515 0.16230808 0.797259951 0.20274005  957.4824
## [14,] 0.011802564 0.017294657 0.13340430 0.837498483 0.16250152  732.9202
## [15,] 0.008401488 0.012495581 0.10857791 0.870525019 0.12947498  556.7135
## [16,] 0.005980481 0.009002571 0.08764291 0.897374042 0.10262596  420.0756
## [17,] 0.004257120 0.006471258 0.07024659 0.919025029 0.08097497  315.1602
## [18,] 0.003030371 0.004643193 0.05596242 0.936364021 0.06363598  235.2695
## [19,] 0.002157127 0.003326624 0.04434889 0.950167355 0.04983265  174.8636
## [20,] 0.001535520 0.002380522 0.03498456 0.961099396 0.03890060  129.4672
## 
## , , 10
## 
##           State A     State B    State C       Death    Disc LY Disc cost
##  [1,] 0.876310114 0.086717510 0.03398343 0.002988944 0.99701106 6922.4666
##  [2,] 0.767919415 0.146746938 0.07548555 0.009848096 0.99015190 6733.8635
##  [3,] 0.554718774 0.235589273 0.17420291 0.035489043 0.96451096 5049.4913
##  [4,] 0.400709909 0.246226777 0.26803013 0.085033187 0.91496681 5033.1868
##  [5,] 0.289459161 0.222492071 0.33147241 0.156576358 0.84342364 4770.2618
##  [6,] 0.209095418 0.186909107 0.36148728 0.242508199 0.75749180 4320.1362
##  [7,] 0.151043393 0.150385152 0.36385538 0.334716077 0.66528392 3769.5525
##  [8,] 0.109108591 0.117651874 0.34664536 0.426594177 0.57340582 3192.4184
##  [9,] 0.078816322 0.090280267 0.31737352 0.513529893 0.48647011 2639.5803
## [10,] 0.056934221 0.068321270 0.28200865 0.592735857 0.40726414 2140.4539
## [11,] 0.041127338 0.051175609 0.24483772 0.662859334 0.33714067 1708.2638
## [12,] 0.029708985 0.038037118 0.20868502 0.723568882 0.27643112 1345.4468
## [13,] 0.021460757 0.028104402 0.17523577 0.775199066 0.22480093 1048.0266
## [14,] 0.015502518 0.020670012 0.14535158 0.818475894 0.18152411  808.7488
## [15,] 0.011198490 0.015147474 0.11933449 0.854319548 0.14568045  619.1375
## [16,] 0.008089407 0.011068871 0.09713043 0.883711295 0.11628870  470.7364
## [17,] 0.005843511 0.008070216 0.07847677 0.907609499 0.09239050  355.7823
## [18,] 0.004221153 0.005873334 0.06300442 0.926901093 0.07309891  267.5082
## [19,] 0.003049217 0.004268333 0.05030501 0.942377444 0.05762256  200.2221
## [20,] 0.002202650 0.003098342 0.03997281 0.954726198 0.04527380  149.2595</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_LY_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 8.795140 9.105657 8.647984 8.516277 8.865033 8.899223 9.115263
##  [8] 8.545101 8.750427 9.150232</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Expected_total_cost_combi[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 49825.81 50786.16 50397.05 49304.16 49837.87 50471.86 51130.43
##  [8] 49933.15 50560.33 51544.54</code></pre>
</div>
<div id="incremental-cost-effectiveness-ratio" class="section level1">
<h1 class="hasAnchor">
<a href="#incremental-cost-effectiveness-ratio" class="anchor"></a><span class="header-section-number">10</span> Incremental Cost-Effectiveness Ratio</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ICER &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA</span>, PSA_samples), <span class="dt">nrow=</span>PSA_samples)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>PSA_samples){
ICER[i]  &lt;-<span class="st"> </span>(Expected_total_cost_combi[i] <span class="op">-</span><span class="st"> </span>Expected_total_cost_mono[i]) <span class="op">/</span><span class="st"> </span>(Expected_LY_combi[i] <span class="op">-</span><span class="st"> </span>Expected_LY_mono[i])
}

<span class="co">#Presentation of results for first 10 PSA samples</span>
ICER[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 5997.130 5503.907 7344.752 8744.364 6277.034 6018.286 6587.620
##  [8] 8418.287 6882.951 5788.396</code></pre>
</div>
<div id="overview-psa-results" class="section level1">
<h1 class="hasAnchor">
<a href="#overview-psa-results" class="anchor"></a><span class="header-section-number">11</span> Overview PSA results</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Results_by_PSA_sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Expected_LY_mono, Expected_LY_combi, Expected_total_cost_mono, Expected_total_cost_combi, ICER)
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Results_by_PSA_sample) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Disc LY mono"</span>, <span class="st">"Disc LY combi"</span>, <span class="st">"Disc cost mono"</span>, <span class="st">"Disc cost combi"</span>, <span class="st">"ICER"</span>)

<span class="co"># Presentation of results first 10 PSA samples</span>
Results_by_PSA_sample[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre></div>
<pre><code>##       Disc LY mono Disc LY combi Disc cost mono Disc cost combi     ICER
##  [1,]     7.764169      8.795140       43642.95        49825.81 5997.130
##  [2,]     7.936972      9.105657       44353.83        50786.16 5503.907
##  [3,]     7.898122      8.647984       44889.50        50397.05 7344.752
##  [4,]     7.926119      8.516277       44143.60        49304.16 8744.364
##  [5,]     7.908705      8.865033       43834.97        49837.87 6277.034
##  [6,]     7.886025      8.899223       44374.15        50471.86 6018.286
##  [7,]     8.247077      9.115263       45411.15        51130.43 6587.620
##  [8,]     7.924978      8.545101       44712.78        49933.15 8418.287
##  [9,]     7.925533      8.750427       44882.62        50560.33 6882.951
## [10,]     8.083575      9.150232       45370.31        51544.54 5788.396</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#required-r-packages"><span class="toc-section-number">1</span> Required R-packages</a></li>
      <li><a href="#number-of-psa-simulations"><span class="toc-section-number">2</span> Number of PSA simulations</a></li>
      <li><a href="#create-psa-samples-for-transition-matrix-monotherapy-based-on-dirichlet-distribution-using-rdirichlet_mat-function-from-hesim-package"><span class="toc-section-number">3</span> Create PSA samples for transition matrix monotherapy based on Dirichlet distribution (using rdirichlet_mat function from hesim package)</a></li>
      <li><a href="#create-psa-samples-for-relative-risk-according-to-normal-distribution-of-log-transformed-relative-risk"><span class="toc-section-number">4</span> Create PSA samples for relative risk according to normal distribution of log-transformed relative risk</a></li>
      <li><a href="#create-psa-samples-for-transition-matrix-for-combination-therapy"><span class="toc-section-number">5</span> Create PSA samples for transition matrix for combination therapy</a></li>
      <li><a href="#parameters-for-which-no-uncertainty-is-propagated"><span class="toc-section-number">6</span> Parameters for which no uncertainty is propagated</a></li>
      <li><a href="#model-simulation-settings"><span class="toc-section-number">7</span> Model simulation settings</a></li>
      <li><a href="#monotherapy-results"><span class="toc-section-number">8</span> Monotherapy results</a></li>
      <li><a href="#combination-therapy-results"><span class="toc-section-number">9</span> Combination therapy results</a></li>
      <li><a href="#incremental-cost-effectiveness-ratio"><span class="toc-section-number">10</span> Incremental Cost-Effectiveness Ratio</a></li>
      <li><a href="#overview-psa-results"><span class="toc-section-number">11</span> Overview PSA results</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devin Incerti, Jeroen P. Jansen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
